{"episode_reward_max": -1.4973324737257463, "episode_reward_min": -1.9925929838780772, "episode_reward_mean": -1.6846732069101193, "episode_len_mean": 162.97826086956522, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 1.0, "failure_code_ratio/distance_min": 1, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 0.0, "reward_component_totals/rejoin_reward_min": 0, "reward_component_totals/rejoin_reward_max": 0, "reward_component_totals/rejoin_first_time_reward_mean": 0.0, "reward_component_totals/rejoin_first_time_reward_min": 0, "reward_component_totals/rejoin_first_time_reward_max": 0, "reward_component_totals/rejoin_dist_change_reward_mean": -0.6846732069101197, "reward_component_totals/rejoin_dist_change_reward_min": -0.9925929838780772, "reward_component_totals/rejoin_dist_change_reward_max": -0.49733247372574624, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0}, "hist_stats": {"episode_reward": [-1.6041741117110473, -1.6569691410205911, -1.6331827913367238, -1.5126521258663879, -1.726671625410067, -1.8374146008634862, -1.90659417430602, -1.716911538424469, -1.8351345244449386, -1.9925929838780772, -1.4997500453500408, -1.7744750546350523, -1.6446280894459888, -1.498727822841397, -1.5669646815557026, -1.658301784023788, -1.5575477310605141, -1.6049453749451068, -1.5142533142916077, -1.691966489153577, -1.6961930637692133, -1.864061327035968, -1.578386751619902, -1.9173534477551966, -1.7069887003145592, -1.7367964595900884, -1.577330652012742, -1.5619802480397857, -1.620164663401494, -1.4973324737257463, -1.5959838701415912, -1.6693168412175474, -1.919480374947601, -1.78655961919804, -1.5530949337463462, -1.685918685953367, -1.8068308993632525, -1.680777720935652, -1.7468844403081247, -1.889911990974604, -1.6214583542873282, -1.7463290386660066, -1.5324859473646923, -1.7091182930833249, -1.565499555792262, -1.7948711600564913], "episode_lengths": [314, 85, 160, 131, 65, 231, 131, 65, 353, 85, 283, 146, 102, 155, 210, 93, 59, 264, 162, 203, 292, 329, 292, 78, 70, 187, 83, 238, 85, 97, 68, 60, 302, 69, 360, 129, 156, 76, 194, 314, 84, 80, 175, 88, 114, 180]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0743322119857005, "mean_inference_ms": 0.426428896359235, "mean_action_processing_ms": 0.038849743282209005, "mean_env_wait_ms": 0.7328714906494733, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 7992, "agent_timesteps_total": 7992, "timers": {"sample_time_ms": 1767.796, "sample_throughput": 4520.884, "load_time_ms": 21.313, "load_throughput": 374983.249, "learn_time_ms": 2364.887, "learn_throughput": 3379.442, "update_time_ms": 1.422}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.061934925615787506, "policy_loss": -0.01293416228145361, "vf_loss": 0.0720963329076767, "vf_explained_var": 0.2563098967075348, "kl": 0.013863768428564072, "entropy": 2.807671546936035, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 7992, "num_agent_steps_sampled": 7992, "num_steps_trained": 7992, "num_agent_steps_trained": 7992}, "done": false, "episodes_total": 46, "training_iteration": 1, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-35-55", "timestamp": 1716402955, "time_this_iter_s": 4.161369323730469, "time_total_s": 4.161369323730469, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4.161369323730469, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 30.516666666666666, "ram_util_percent": 33.416666666666664}, "trial_id": "15bc3_00000"}
{"episode_reward_max": -0.7169017514344952, "episode_reward_min": -1.9925929838780772, "episode_reward_mean": -1.6754095018857795, "episode_len_mean": 248.51785714285714, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.9285714285714286, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.07142857142857142, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 0.0, "reward_component_totals/rejoin_reward_min": 0, "reward_component_totals/rejoin_reward_max": 0, "reward_component_totals/rejoin_first_time_reward_mean": 0.004464285714285714, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": -0.6798737876000652, "reward_component_totals/rejoin_dist_change_reward_min": -0.9925929838780772, "reward_component_totals/rejoin_dist_change_reward_max": 0.2830982485655048, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0}, "hist_stats": {"episode_reward": [-1.6041741117110473, -1.6569691410205911, -1.6331827913367238, -1.5126521258663879, -1.726671625410067, -1.8374146008634862, -1.90659417430602, -1.716911538424469, -1.8351345244449386, -1.9925929838780772, -1.4997500453500408, -1.7744750546350523, -1.6446280894459888, -1.498727822841397, -1.5669646815557026, -1.658301784023788, -1.5575477310605141, -1.6049453749451068, -1.5142533142916077, -1.691966489153577, -1.6961930637692133, -1.864061327035968, -1.578386751619902, -1.9173534477551966, -1.7069887003145592, -1.7367964595900884, -1.577330652012742, -1.5619802480397857, -1.620164663401494, -1.4973324737257463, -1.5959838701415912, -1.6693168412175474, -1.919480374947601, -1.78655961919804, -1.5530949337463462, -1.685918685953367, -1.8068308993632525, -1.680777720935652, -1.7468844403081247, -1.889911990974604, -1.6214583542873282, -1.7463290386660066, -1.5324859473646923, -1.7091182930833249, -1.565499555792262, -1.7948711600564913, -1.8997688404183783, -0.7169017514344952, -1.5337998447237062, -1.9742844137548947, -1.4750798049459708, -1.7671220384342883, -1.4349881971333756, -1.9010973953843187, -1.772690077047986, -1.8522322244607343], "episode_lengths": [314, 85, 160, 131, 65, 231, 131, 65, 353, 85, 283, 146, 102, 155, 210, 93, 59, 264, 162, 203, 292, 329, 292, 78, 70, 187, 83, 238, 85, 97, 68, 60, 302, 69, 360, 129, 156, 76, 194, 314, 84, 80, 175, 88, 114, 180, 1001, 1001, 98, 65, 399, 855, 79, 1001, 1001, 920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.07300521229725236, "mean_inference_ms": 0.42294375615351437, "mean_action_processing_ms": 0.03860886697130818, "mean_env_wait_ms": 0.7294038450964957, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 15984, "agent_timesteps_total": 15984, "timers": {"sample_time_ms": 1696.95, "sample_throughput": 4709.626, "load_time_ms": 11.157, "load_throughput": 716319.292, "learn_time_ms": 2308.492, "learn_throughput": 3462.0, "update_time_ms": 1.285}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.039142828434705734, "policy_loss": -0.012849855236709118, "vf_loss": 0.04971450939774513, "vf_explained_var": 0.32168591022491455, "kl": 0.011390899308025837, "entropy": 2.761568307876587, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 15984, "num_agent_steps_sampled": 15984, "num_steps_trained": 15984, "num_agent_steps_trained": 15984}, "done": false, "episodes_total": 56, "training_iteration": 2, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-35-59", "timestamp": 1716402959, "time_this_iter_s": 3.885838031768799, "time_total_s": 8.047207355499268, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 8.047207355499268, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 30.599999999999994, "ram_util_percent": 33.516666666666666}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 0.0011304437133499157, "episode_reward_min": -1.9925929838780772, "episode_reward_mean": -1.6048836033404874, "episode_len_mean": 315.015625, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.84375, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.15625, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 0.0, "reward_component_totals/rejoin_reward_min": 0, "reward_component_totals/rejoin_reward_max": 0, "reward_component_totals/rejoin_first_time_reward_mean": 0.00390625, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": -0.6087898533404872, "reward_component_totals/rejoin_dist_change_reward_min": -0.9925929838780772, "reward_component_totals/rejoin_dist_change_reward_max": 1.00113044371335, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0}, "hist_stats": {"episode_reward": [-1.6041741117110473, -1.6569691410205911, -1.6331827913367238, -1.5126521258663879, -1.726671625410067, -1.8374146008634862, -1.90659417430602, -1.716911538424469, -1.8351345244449386, -1.9925929838780772, -1.4997500453500408, -1.7744750546350523, -1.6446280894459888, -1.498727822841397, -1.5669646815557026, -1.658301784023788, -1.5575477310605141, -1.6049453749451068, -1.5142533142916077, -1.691966489153577, -1.6961930637692133, -1.864061327035968, -1.578386751619902, -1.9173534477551966, -1.7069887003145592, -1.7367964595900884, -1.577330652012742, -1.5619802480397857, -1.620164663401494, -1.4973324737257463, -1.5959838701415912, -1.6693168412175474, -1.919480374947601, -1.78655961919804, -1.5530949337463462, -1.685918685953367, -1.8068308993632525, -1.680777720935652, -1.7468844403081247, -1.889911990974604, -1.6214583542873282, -1.7463290386660066, -1.5324859473646923, -1.7091182930833249, -1.565499555792262, -1.7948711600564913, -1.8997688404183783, -0.7169017514344952, -1.5337998447237062, -1.9742844137548947, -1.4750798049459708, -1.7671220384342883, -1.4349881971333756, -1.9010973953843187, -1.772690077047986, -1.8522322244607343, -1.6302761785622857, -1.5786526223107074, -1.4901710549725808, -0.14055310789068431, -1.4046519289522696, 0.0011304437133499157, -1.0162271544551515, -1.6302169047572008], "episode_lengths": [314, 85, 160, 131, 65, 231, 131, 65, 353, 85, 283, 146, 102, 155, 210, 93, 59, 264, 162, 203, 292, 329, 292, 78, 70, 187, 83, 238, 85, 97, 68, 60, 302, 69, 360, 129, 156, 76, 194, 314, 84, 80, 175, 88, 114, 180, 1001, 1001, 98, 65, 399, 855, 79, 1001, 1001, 920, 1001, 72, 1001, 1001, 1001, 1001, 1001, 166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.07237470921502633, "mean_inference_ms": 0.4204486074972805, "mean_action_processing_ms": 0.03848098250891529, "mean_env_wait_ms": 0.7273413943812967, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 23976, "agent_timesteps_total": 23976, "timers": {"sample_time_ms": 1690.06, "sample_throughput": 4728.827, "load_time_ms": 7.807, "load_throughput": 1023694.536, "learn_time_ms": 2283.825, "learn_throughput": 3499.393, "update_time_ms": 1.261}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05549531802535057, "policy_loss": -0.007727515883743763, "vf_loss": 0.061561472713947296, "vf_explained_var": 0.3147004544734955, "kl": 0.008306809701025486, "entropy": 2.7328407764434814, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 23976, "num_agent_steps_sampled": 23976, "num_steps_trained": 23976, "num_agent_steps_trained": 23976}, "done": false, "episodes_total": 64, "training_iteration": 3, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-36-03", "timestamp": 1716402963, "time_this_iter_s": 3.919069766998291, "time_total_s": 11.966277122497559, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 11.966277122497559, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 30.150000000000002, "ram_util_percent": 33.6}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 0.3846547784939265, "episode_reward_min": -1.9925929838780772, "episode_reward_mean": -1.4052749308175585, "episode_len_mean": 389.85526315789474, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.06578947368421052, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.7105263157894737, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.2236842105263158, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 0.0, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 0.0, "reward_component_totals/rejoin_first_time_reward_mean": 0.01644736842105263, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": -0.42172229923861115, "reward_component_totals/rejoin_dist_change_reward_min": -0.9925929838780772, "reward_component_totals/rejoin_dist_change_reward_max": 1.3706167083551466, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0}, "hist_stats": {"episode_reward": [-1.6041741117110473, -1.6569691410205911, -1.6331827913367238, -1.5126521258663879, -1.726671625410067, -1.8374146008634862, -1.90659417430602, -1.716911538424469, -1.8351345244449386, -1.9925929838780772, -1.4997500453500408, -1.7744750546350523, -1.6446280894459888, -1.498727822841397, -1.5669646815557026, -1.658301784023788, -1.5575477310605141, -1.6049453749451068, -1.5142533142916077, -1.691966489153577, -1.6961930637692133, -1.864061327035968, -1.578386751619902, -1.9173534477551966, -1.7069887003145592, -1.7367964595900884, -1.577330652012742, -1.5619802480397857, -1.620164663401494, -1.4973324737257463, -1.5959838701415912, -1.6693168412175474, -1.919480374947601, -1.78655961919804, -1.5530949337463462, -1.685918685953367, -1.8068308993632525, -1.680777720935652, -1.7468844403081247, -1.889911990974604, -1.6214583542873282, -1.7463290386660066, -1.5324859473646923, -1.7091182930833249, -1.565499555792262, -1.7948711600564913, -1.8997688404183783, -0.7169017514344952, -1.5337998447237062, -1.9742844137548947, -1.4750798049459708, -1.7671220384342883, -1.4349881971333756, -1.9010973953843187, -1.772690077047986, -1.8522322244607343, -1.6302761785622857, -1.5786526223107074, -1.4901710549725808, -0.14055310789068431, -1.4046519289522696, 0.0011304437133499157, -1.0162271544551515, -1.6302169047572008, -1.8233554407941943, 0.36222928035128876, 0.21190964520908917, -1.0584226923689073, -0.32072086804106914, 0.3706167083551466, -1.3750807664320095, 0.3846547784939265, 0.10226677758578373, -0.8983732249441411, -0.310284483609775, 0.266216157851612], "episode_lengths": [314, 85, 160, 131, 65, 231, 131, 65, 353, 85, 283, 146, 102, 155, 210, 93, 59, 264, 162, 203, 292, 329, 292, 78, 70, 187, 83, 238, 85, 97, 68, 60, 302, 69, 360, 129, 156, 76, 194, 314, 84, 80, 175, 88, 114, 180, 1001, 1001, 98, 65, 399, 855, 79, 1001, 1001, 920, 1001, 72, 1001, 1001, 1001, 1001, 1001, 166, 1001, 159, 1001, 1001, 1001, 709, 1001, 811, 12, 1001, 1001, 770]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.07177704337874422, "mean_inference_ms": 0.4204354473716048, "mean_action_processing_ms": 0.038321374185721166, "mean_env_wait_ms": 0.7251799405941574, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 31968, "agent_timesteps_total": 31968, "timers": {"sample_time_ms": 1723.496, "sample_throughput": 4637.086, "load_time_ms": 6.121, "load_throughput": 1305686.035, "learn_time_ms": 2273.687, "learn_throughput": 3514.996, "update_time_ms": 1.257}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.07351896166801453, "policy_loss": -0.006807699333876371, "vf_loss": 0.07862765341997147, "vf_explained_var": 0.20798732340335846, "kl": 0.008495049551129341, "entropy": 2.69006609916687, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 31968, "num_agent_steps_sampled": 31968, "num_steps_trained": 31968, "num_agent_steps_trained": 31968}, "done": false, "episodes_total": 76, "training_iteration": 4, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-36-07", "timestamp": 1716402967, "time_this_iter_s": 4.075495958328247, "time_total_s": 16.041773080825806, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 16.041773080825806, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 31.940000000000005, "ram_util_percent": 33.6}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 0.6389738371717271, "episode_reward_min": -1.9925929838780772, "episode_reward_mean": -1.193368004829173, "episode_len_mean": 422.32183908045977, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.13793103448275862, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.6206896551724138, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.2413793103448276, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 0.0, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 0.0, "reward_component_totals/rejoin_first_time_reward_mean": 0.034482758620689655, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": -0.22785076344986285, "reward_component_totals/rejoin_dist_change_reward_min": -0.9925929838780772, "reward_component_totals/rejoin_dist_change_reward_max": 1.388973837171727, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0}, "hist_stats": {"episode_reward": [-1.6041741117110473, -1.6569691410205911, -1.6331827913367238, -1.5126521258663879, -1.726671625410067, -1.8374146008634862, -1.90659417430602, -1.716911538424469, -1.8351345244449386, -1.9925929838780772, -1.4997500453500408, -1.7744750546350523, -1.6446280894459888, -1.498727822841397, -1.5669646815557026, -1.658301784023788, -1.5575477310605141, -1.6049453749451068, -1.5142533142916077, -1.691966489153577, -1.6961930637692133, -1.864061327035968, -1.578386751619902, -1.9173534477551966, -1.7069887003145592, -1.7367964595900884, -1.577330652012742, -1.5619802480397857, -1.620164663401494, -1.4973324737257463, -1.5959838701415912, -1.6693168412175474, -1.919480374947601, -1.78655961919804, -1.5530949337463462, -1.685918685953367, -1.8068308993632525, -1.680777720935652, -1.7468844403081247, -1.889911990974604, -1.6214583542873282, -1.7463290386660066, -1.5324859473646923, -1.7091182930833249, -1.565499555792262, -1.7948711600564913, -1.8997688404183783, -0.7169017514344952, -1.5337998447237062, -1.9742844137548947, -1.4750798049459708, -1.7671220384342883, -1.4349881971333756, -1.9010973953843187, -1.772690077047986, -1.8522322244607343, -1.6302761785622857, -1.5786526223107074, -1.4901710549725808, -0.14055310789068431, -1.4046519289522696, 0.0011304437133499157, -1.0162271544551515, -1.6302169047572008, -1.8233554407941943, 0.36222928035128876, 0.21190964520908917, -1.0584226923689073, -0.32072086804106914, 0.3706167083551466, -1.3750807664320095, 0.3846547784939265, 0.10226677758578373, -0.8983732249441411, -0.310284483609775, 0.266216157851612, 0.3287672790321057, -0.03450287746440184, 0.2769590013426122, -0.2752242177774664, 0.6389738371717271, 0.4361783927028686, 0.3992714031811839, 0.548737046930823, -0.2538116271231834, 0.3228381049149438, 0.5896919790851542], "episode_lengths": [314, 85, 160, 131, 65, 231, 131, 65, 353, 85, 283, 146, 102, 155, 210, 93, 59, 264, 162, 203, 292, 329, 292, 78, 70, 187, 83, 238, 85, 97, 68, 60, 302, 69, 360, 129, 156, 76, 194, 314, 84, 80, 175, 88, 114, 180, 1001, 1001, 98, 65, 399, 855, 79, 1001, 1001, 920, 1001, 72, 1001, 1001, 1001, 1001, 1001, 166, 1001, 159, 1001, 1001, 1001, 709, 1001, 811, 12, 1001, 1001, 770, 845, 149, 1001, 1001, 584, 262, 438, 132, 1001, 1001, 699]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.07106359669382999, "mean_inference_ms": 0.4200739497726175, "mean_action_processing_ms": 0.03820241885270725, "mean_env_wait_ms": 0.7237599706009994, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 39960, "agent_timesteps_total": 39960, "timers": {"sample_time_ms": 1719.108, "sample_throughput": 4648.923, "load_time_ms": 5.091, "load_throughput": 1569770.421, "learn_time_ms": 2267.837, "learn_throughput": 3524.063, "update_time_ms": 1.249}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.049953147768974304, "policy_loss": -0.006974157877266407, "vf_loss": 0.055186640471220016, "vf_explained_var": 0.4420201778411865, "kl": 0.008703317493200302, "entropy": 2.702723979949951, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 39960, "num_agent_steps_sampled": 39960, "num_steps_trained": 39960, "num_agent_steps_trained": 39960}, "done": false, "episodes_total": 87, "training_iteration": 5, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-36-11", "timestamp": 1716402971, "time_this_iter_s": 3.9547364711761475, "time_total_s": 19.996509552001953, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 19.996509552001953, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 30.41666666666667, "ram_util_percent": 33.6}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 0.6389738371717271, "episode_reward_min": -1.9925929838780772, "episode_reward_mean": -0.959790306716843, "episode_len_mean": 448.04, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.24, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.52, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.24, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 0.0, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 0.0, "reward_component_totals/rejoin_first_time_reward_mean": 0.0575, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": -0.017290306716843083, "reward_component_totals/rejoin_dist_change_reward_min": -0.9925929838780772, "reward_component_totals/rejoin_dist_change_reward_max": 1.388973837171727, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0}, "hist_stats": {"episode_reward": [-1.6331827913367238, -1.5126521258663879, -1.726671625410067, -1.8374146008634862, -1.90659417430602, -1.716911538424469, -1.8351345244449386, -1.9925929838780772, -1.4997500453500408, -1.7744750546350523, -1.6446280894459888, -1.498727822841397, -1.5669646815557026, -1.658301784023788, -1.5575477310605141, -1.6049453749451068, -1.5142533142916077, -1.691966489153577, -1.6961930637692133, -1.864061327035968, -1.578386751619902, -1.9173534477551966, -1.7069887003145592, -1.7367964595900884, -1.577330652012742, -1.5619802480397857, -1.620164663401494, -1.4973324737257463, -1.5959838701415912, -1.6693168412175474, -1.919480374947601, -1.78655961919804, -1.5530949337463462, -1.685918685953367, -1.8068308993632525, -1.680777720935652, -1.7468844403081247, -1.889911990974604, -1.6214583542873282, -1.7463290386660066, -1.5324859473646923, -1.7091182930833249, -1.565499555792262, -1.7948711600564913, -1.8997688404183783, -0.7169017514344952, -1.5337998447237062, -1.9742844137548947, -1.4750798049459708, -1.7671220384342883, -1.4349881971333756, -1.9010973953843187, -1.772690077047986, -1.8522322244607343, -1.6302761785622857, -1.5786526223107074, -1.4901710549725808, -0.14055310789068431, -1.4046519289522696, 0.0011304437133499157, -1.0162271544551515, -1.6302169047572008, -1.8233554407941943, 0.36222928035128876, 0.21190964520908917, -1.0584226923689073, -0.32072086804106914, 0.3706167083551466, -1.3750807664320095, 0.3846547784939265, 0.10226677758578373, -0.8983732249441411, -0.310284483609775, 0.266216157851612, 0.3287672790321057, -0.03450287746440184, 0.2769590013426122, -0.2752242177774664, 0.6389738371717271, 0.4361783927028686, 0.3992714031811839, 0.548737046930823, -0.2538116271231834, 0.3228381049149438, 0.5896919790851542, 0.5342134303775588, 0.4606986136920892, 0.3675230981323534, 0.360127787659025, 0.5374996534706926, 0.07110576843789684, 0.40091120360265275, 0.4097653080560486, 0.08064912163037241, 0.35927639547998713, -0.12040106302498166, 0.36017734445022787, 0.32203542150210995, 0.3016064780631571, 0.1376539341929377], "episode_lengths": [160, 131, 65, 231, 131, 65, 353, 85, 283, 146, 102, 155, 210, 93, 59, 264, 162, 203, 292, 329, 292, 78, 70, 187, 83, 238, 85, 97, 68, 60, 302, 69, 360, 129, 156, 76, 194, 314, 84, 80, 175, 88, 114, 180, 1001, 1001, 98, 65, 399, 855, 79, 1001, 1001, 920, 1001, 72, 1001, 1001, 1001, 1001, 1001, 166, 1001, 159, 1001, 1001, 1001, 709, 1001, 811, 12, 1001, 1001, 770, 845, 149, 1001, 1001, 584, 262, 438, 132, 1001, 1001, 699, 599, 263, 321, 577, 460, 287, 977, 298, 315, 1001, 1001, 785, 1001, 146, 430]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.06940985987066292, "mean_inference_ms": 0.4191312938643184, "mean_action_processing_ms": 0.03808284903020052, "mean_env_wait_ms": 0.7225417411520337, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 47952, "agent_timesteps_total": 47952, "timers": {"sample_time_ms": 1720.094, "sample_throughput": 4646.258, "load_time_ms": 4.42, "load_throughput": 1808257.65, "learn_time_ms": 2265.176, "learn_throughput": 3528.203, "update_time_ms": 1.247}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0484064482152462, "policy_loss": -0.009652562439441681, "vf_loss": 0.05611748993396759, "vf_explained_var": 0.5341497659683228, "kl": 0.009707578457891941, "entropy": 2.671199321746826, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 47952, "num_agent_steps_sampled": 47952, "num_steps_trained": 47952, "num_agent_steps_trained": 47952}, "done": false, "episodes_total": 102, "training_iteration": 6, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-36-15", "timestamp": 1716402975, "time_this_iter_s": 3.986588478088379, "time_total_s": 23.983098030090332, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 23.983098030090332, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 30.433333333333334, "ram_util_percent": 33.61666666666667}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 0.6389738371717271, "episode_reward_min": -1.9742844137548947, "episode_reward_mean": -0.6147584272639961, "episode_len_mean": 505.63, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.38, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.35, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.27, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 0.0, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 0.0, "reward_component_totals/rejoin_first_time_reward_mean": 0.095, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 0.2902415727360037, "reward_component_totals/rejoin_dist_change_reward_min": -0.9742844137548948, "reward_component_totals/rejoin_dist_change_reward_max": 1.388973837171727, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0}, "hist_stats": {"episode_reward": [-1.691966489153577, -1.6961930637692133, -1.864061327035968, -1.578386751619902, -1.9173534477551966, -1.7069887003145592, -1.7367964595900884, -1.577330652012742, -1.5619802480397857, -1.620164663401494, -1.4973324737257463, -1.5959838701415912, -1.6693168412175474, -1.919480374947601, -1.78655961919804, -1.5530949337463462, -1.685918685953367, -1.8068308993632525, -1.680777720935652, -1.7468844403081247, -1.889911990974604, -1.6214583542873282, -1.7463290386660066, -1.5324859473646923, -1.7091182930833249, -1.565499555792262, -1.7948711600564913, -1.8997688404183783, -0.7169017514344952, -1.5337998447237062, -1.9742844137548947, -1.4750798049459708, -1.7671220384342883, -1.4349881971333756, -1.9010973953843187, -1.772690077047986, -1.8522322244607343, -1.6302761785622857, -1.5786526223107074, -1.4901710549725808, -0.14055310789068431, -1.4046519289522696, 0.0011304437133499157, -1.0162271544551515, -1.6302169047572008, -1.8233554407941943, 0.36222928035128876, 0.21190964520908917, -1.0584226923689073, -0.32072086804106914, 0.3706167083551466, -1.3750807664320095, 0.3846547784939265, 0.10226677758578373, -0.8983732249441411, -0.310284483609775, 0.266216157851612, 0.3287672790321057, -0.03450287746440184, 0.2769590013426122, -0.2752242177774664, 0.6389738371717271, 0.4361783927028686, 0.3992714031811839, 0.548737046930823, -0.2538116271231834, 0.3228381049149438, 0.5896919790851542, 0.5342134303775588, 0.4606986136920892, 0.3675230981323534, 0.360127787659025, 0.5374996534706926, 0.07110576843789684, 0.40091120360265275, 0.4097653080560486, 0.08064912163037241, 0.35927639547998713, -0.12040106302498166, 0.36017734445022787, 0.32203542150210995, 0.3016064780631571, 0.1376539341929377, 0.27865190877783097, 0.55582185549375, -0.1092641580945255, -0.19299222739190114, 0.42599772745662245, 0.4226951023566552, 0.27087360815654393, 0.2263645209136429, 0.38245604751681705, 0.5502023548532193, 0.6193017284972175, 0.5197631547072892, 0.4688818793839671, 0.5188365330141078, 0.1357079342766787, 0.5411827933398521, 0.40795891934754747], "episode_lengths": [203, 292, 329, 292, 78, 70, 187, 83, 238, 85, 97, 68, 60, 302, 69, 360, 129, 156, 76, 194, 314, 84, 80, 175, 88, 114, 180, 1001, 1001, 98, 65, 399, 855, 79, 1001, 1001, 920, 1001, 72, 1001, 1001, 1001, 1001, 1001, 166, 1001, 159, 1001, 1001, 1001, 709, 1001, 811, 12, 1001, 1001, 770, 845, 149, 1001, 1001, 584, 262, 438, 132, 1001, 1001, 699, 599, 263, 321, 577, 460, 287, 977, 298, 315, 1001, 1001, 785, 1001, 146, 430, 131, 570, 1001, 1001, 554, 415, 202, 275, 50, 469, 395, 1001, 948, 772, 338, 202, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.06695031591818297, "mean_inference_ms": 0.41687140310505855, "mean_action_processing_ms": 0.03786056007693373, "mean_env_wait_ms": 0.7194438418943193, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 55944, "agent_timesteps_total": 55944, "timers": {"sample_time_ms": 1733.684, "sample_throughput": 4609.836, "load_time_ms": 3.928, "load_throughput": 2034474.73, "learn_time_ms": 2264.756, "learn_throughput": 3528.857, "update_time_ms": 1.246}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.057897381484508514, "policy_loss": -0.005238939542323351, "vf_loss": 0.061636827886104584, "vf_explained_var": 0.5828269124031067, "kl": 0.007497495971620083, "entropy": 2.7241106033325195, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 55944, "num_agent_steps_sampled": 55944, "num_steps_trained": 55944, "num_agent_steps_trained": 55944}, "done": false, "episodes_total": 119, "training_iteration": 7, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-36-19", "timestamp": 1716402979, "time_this_iter_s": 4.0867600440979, "time_total_s": 28.069858074188232, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 28.069858074188232, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 29.233333333333334, "ram_util_percent": 33.666666666666664}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 0.6389738371717271, "episode_reward_min": -1.9742844137548947, "episode_reward_mean": -0.32625164631866693, "episode_len_mean": 569.58, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.5, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.2, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.3, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 0.0, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 0.0, "reward_component_totals/rejoin_first_time_reward_mean": 0.1225, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 0.5512483536813328, "reward_component_totals/rejoin_dist_change_reward_min": -0.9742844137548948, "reward_component_totals/rejoin_dist_change_reward_max": 1.388973837171727, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0}, "hist_stats": {"episode_reward": [-1.5530949337463462, -1.685918685953367, -1.8068308993632525, -1.680777720935652, -1.7468844403081247, -1.889911990974604, -1.6214583542873282, -1.7463290386660066, -1.5324859473646923, -1.7091182930833249, -1.565499555792262, -1.7948711600564913, -1.8997688404183783, -0.7169017514344952, -1.5337998447237062, -1.9742844137548947, -1.4750798049459708, -1.7671220384342883, -1.4349881971333756, -1.9010973953843187, -1.772690077047986, -1.8522322244607343, -1.6302761785622857, -1.5786526223107074, -1.4901710549725808, -0.14055310789068431, -1.4046519289522696, 0.0011304437133499157, -1.0162271544551515, -1.6302169047572008, -1.8233554407941943, 0.36222928035128876, 0.21190964520908917, -1.0584226923689073, -0.32072086804106914, 0.3706167083551466, -1.3750807664320095, 0.3846547784939265, 0.10226677758578373, -0.8983732249441411, -0.310284483609775, 0.266216157851612, 0.3287672790321057, -0.03450287746440184, 0.2769590013426122, -0.2752242177774664, 0.6389738371717271, 0.4361783927028686, 0.3992714031811839, 0.548737046930823, -0.2538116271231834, 0.3228381049149438, 0.5896919790851542, 0.5342134303775588, 0.4606986136920892, 0.3675230981323534, 0.360127787659025, 0.5374996534706926, 0.07110576843789684, 0.40091120360265275, 0.4097653080560486, 0.08064912163037241, 0.35927639547998713, -0.12040106302498166, 0.36017734445022787, 0.32203542150210995, 0.3016064780631571, 0.1376539341929377, 0.27865190877783097, 0.55582185549375, -0.1092641580945255, -0.19299222739190114, 0.42599772745662245, 0.4226951023566552, 0.27087360815654393, 0.2263645209136429, 0.38245604751681705, 0.5502023548532193, 0.6193017284972175, 0.5197631547072892, 0.4688818793839671, 0.5188365330141078, 0.1357079342766787, 0.5411827933398521, 0.40795891934754747, 0.41141485773514197, 0.2128024106651072, -0.18714380294765554, 0.2825950014422183, 0.13131583290670457, 0.25335628896313755, 0.11912272275902791, 0.35043631141782305, 0.5025107389029915, 0.3837433429106327, 0.2783719665429105, 0.14929239223790614, 0.11729213579363407, 0.23330319817322231, 0.1923697151070669], "episode_lengths": [360, 129, 156, 76, 194, 314, 84, 80, 175, 88, 114, 180, 1001, 1001, 98, 65, 399, 855, 79, 1001, 1001, 920, 1001, 72, 1001, 1001, 1001, 1001, 1001, 166, 1001, 159, 1001, 1001, 1001, 709, 1001, 811, 12, 1001, 1001, 770, 845, 149, 1001, 1001, 584, 262, 438, 132, 1001, 1001, 699, 599, 263, 321, 577, 460, 287, 977, 298, 315, 1001, 1001, 785, 1001, 146, 430, 131, 570, 1001, 1001, 554, 415, 202, 275, 50, 469, 395, 1001, 948, 772, 338, 202, 130, 818, 1001, 274, 220, 38, 213, 882, 346, 966, 1001, 400, 1001, 460, 975, 253]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.06683764043275803, "mean_inference_ms": 0.4126491729743724, "mean_action_processing_ms": 0.03759796716490472, "mean_env_wait_ms": 0.7147384802456566, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 63936, "agent_timesteps_total": 63936, "timers": {"sample_time_ms": 1725.068, "sample_throughput": 4632.861, "load_time_ms": 3.569, "load_throughput": 2239072.704, "learn_time_ms": 2263.045, "learn_throughput": 3531.525, "update_time_ms": 1.247}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.060641899704933167, "policy_loss": -0.0054461900144815445, "vf_loss": 0.06480702757835388, "vf_explained_var": 0.5709781050682068, "kl": 0.006405305117368698, "entropy": 2.6781938076019287, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 63936, "num_agent_steps_sampled": 63936, "num_steps_trained": 63936, "num_agent_steps_trained": 63936}, "done": false, "episodes_total": 134, "training_iteration": 8, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-36-23", "timestamp": 1716402983, "time_this_iter_s": 3.925765037536621, "time_total_s": 31.995623111724854, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 31.995623111724854, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 32.18, "ram_util_percent": 33.620000000000005}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 0.6389738371717271, "episode_reward_min": -1.9742844137548947, "episode_reward_mean": -0.058983277135005306, "episode_len_mean": 608.66, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.61, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.08, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.31, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 0.0, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 0.0, "reward_component_totals/rejoin_first_time_reward_mean": 0.15, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 0.7910167228649945, "reward_component_totals/rejoin_dist_change_reward_min": -0.9742844137548948, "reward_component_totals/rejoin_dist_change_reward_max": 1.388973837171727, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0}, "hist_stats": {"episode_reward": [-0.7169017514344952, -1.5337998447237062, -1.9742844137548947, -1.4750798049459708, -1.7671220384342883, -1.4349881971333756, -1.9010973953843187, -1.772690077047986, -1.8522322244607343, -1.6302761785622857, -1.5786526223107074, -1.4901710549725808, -0.14055310789068431, -1.4046519289522696, 0.0011304437133499157, -1.0162271544551515, -1.6302169047572008, -1.8233554407941943, 0.36222928035128876, 0.21190964520908917, -1.0584226923689073, -0.32072086804106914, 0.3706167083551466, -1.3750807664320095, 0.3846547784939265, 0.10226677758578373, -0.8983732249441411, -0.310284483609775, 0.266216157851612, 0.3287672790321057, -0.03450287746440184, 0.2769590013426122, -0.2752242177774664, 0.6389738371717271, 0.4361783927028686, 0.3992714031811839, 0.548737046930823, -0.2538116271231834, 0.3228381049149438, 0.5896919790851542, 0.5342134303775588, 0.4606986136920892, 0.3675230981323534, 0.360127787659025, 0.5374996534706926, 0.07110576843789684, 0.40091120360265275, 0.4097653080560486, 0.08064912163037241, 0.35927639547998713, -0.12040106302498166, 0.36017734445022787, 0.32203542150210995, 0.3016064780631571, 0.1376539341929377, 0.27865190877783097, 0.55582185549375, -0.1092641580945255, -0.19299222739190114, 0.42599772745662245, 0.4226951023566552, 0.27087360815654393, 0.2263645209136429, 0.38245604751681705, 0.5502023548532193, 0.6193017284972175, 0.5197631547072892, 0.4688818793839671, 0.5188365330141078, 0.1357079342766787, 0.5411827933398521, 0.40795891934754747, 0.41141485773514197, 0.2128024106651072, -0.18714380294765554, 0.2825950014422183, 0.13131583290670457, 0.25335628896313755, 0.11912272275902791, 0.35043631141782305, 0.5025107389029915, 0.3837433429106327, 0.2783719665429105, 0.14929239223790614, 0.11729213579363407, 0.23330319817322231, 0.1923697151070669, 0.19675901045648625, 0.24927989909458526, 0.1692668070886174, 0.49115171146524217, 0.23274623051932863, 0.44191685529489444, 0.6352373423796438, 0.22580873521729572, 0.4720783475654733, 0.31967223035198344, 0.35776099579540177, 0.3602901752853447, 0.3419187169020468], "episode_lengths": [1001, 98, 65, 399, 855, 79, 1001, 1001, 920, 1001, 72, 1001, 1001, 1001, 1001, 1001, 166, 1001, 159, 1001, 1001, 1001, 709, 1001, 811, 12, 1001, 1001, 770, 845, 149, 1001, 1001, 584, 262, 438, 132, 1001, 1001, 699, 599, 263, 321, 577, 460, 287, 977, 298, 315, 1001, 1001, 785, 1001, 146, 430, 131, 570, 1001, 1001, 554, 415, 202, 275, 50, 469, 395, 1001, 948, 772, 338, 202, 130, 818, 1001, 274, 220, 38, 213, 882, 346, 966, 1001, 400, 1001, 460, 975, 253, 363, 675, 317, 1001, 202, 139, 356, 282, 731, 1001, 834, 537, 421]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.06688742561808186, "mean_inference_ms": 0.4108067397050842, "mean_action_processing_ms": 0.03737627271195512, "mean_env_wait_ms": 0.7131577653860092, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 71928, "agent_timesteps_total": 71928, "timers": {"sample_time_ms": 1718.396, "sample_throughput": 4650.848, "load_time_ms": 3.281, "load_throughput": 2435756.254, "learn_time_ms": 2263.537, "learn_throughput": 3530.757, "update_time_ms": 1.249}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.06064252927899361, "policy_loss": -0.00769328186288476, "vf_loss": 0.06682156026363373, "vf_explained_var": 0.5341435074806213, "kl": 0.0075712730176746845, "entropy": 2.663206100463867, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 71928, "num_agent_steps_sampled": 71928, "num_steps_trained": 71928, "num_agent_steps_trained": 71928}, "done": false, "episodes_total": 147, "training_iteration": 9, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-36-27", "timestamp": 1716402987, "time_this_iter_s": 3.942197799682617, "time_total_s": 35.93782091140747, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 35.93782091140747, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 29.449999999999992, "ram_util_percent": 33.5}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 0.6389738371717271, "episode_reward_min": -1.8233554407941943, "episode_reward_mean": 0.2045925145930127, "episode_len_mean": 594.4, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.71, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.01, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 1, "failure_code_ratio/timeout_mean": 0.28, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 0.0, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 0.0, "reward_component_totals/rejoin_first_time_reward_mean": 0.18, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.0245925145930126, "reward_component_totals/rejoin_dist_change_reward_min": -0.8233554407941942, "reward_component_totals/rejoin_dist_change_reward_max": 1.388973837171727, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0}, "hist_stats": {"episode_reward": [-1.0162271544551515, -1.6302169047572008, -1.8233554407941943, 0.36222928035128876, 0.21190964520908917, -1.0584226923689073, -0.32072086804106914, 0.3706167083551466, -1.3750807664320095, 0.3846547784939265, 0.10226677758578373, -0.8983732249441411, -0.310284483609775, 0.266216157851612, 0.3287672790321057, -0.03450287746440184, 0.2769590013426122, -0.2752242177774664, 0.6389738371717271, 0.4361783927028686, 0.3992714031811839, 0.548737046930823, -0.2538116271231834, 0.3228381049149438, 0.5896919790851542, 0.5342134303775588, 0.4606986136920892, 0.3675230981323534, 0.360127787659025, 0.5374996534706926, 0.07110576843789684, 0.40091120360265275, 0.4097653080560486, 0.08064912163037241, 0.35927639547998713, -0.12040106302498166, 0.36017734445022787, 0.32203542150210995, 0.3016064780631571, 0.1376539341929377, 0.27865190877783097, 0.55582185549375, -0.1092641580945255, -0.19299222739190114, 0.42599772745662245, 0.4226951023566552, 0.27087360815654393, 0.2263645209136429, 0.38245604751681705, 0.5502023548532193, 0.6193017284972175, 0.5197631547072892, 0.4688818793839671, 0.5188365330141078, 0.1357079342766787, 0.5411827933398521, 0.40795891934754747, 0.41141485773514197, 0.2128024106651072, -0.18714380294765554, 0.2825950014422183, 0.13131583290670457, 0.25335628896313755, 0.11912272275902791, 0.35043631141782305, 0.5025107389029915, 0.3837433429106327, 0.2783719665429105, 0.14929239223790614, 0.11729213579363407, 0.23330319817322231, 0.1923697151070669, 0.19675901045648625, 0.24927989909458526, 0.1692668070886174, 0.49115171146524217, 0.23274623051932863, 0.44191685529489444, 0.6352373423796438, 0.22580873521729572, 0.4720783475654733, 0.31967223035198344, 0.35776099579540177, 0.3602901752853447, 0.3419187169020468, 0.5656666800343415, 0.45403522824521314, 0.5348820538790955, 0.19030653447538382, 0.25802965801217015, 0.19891638125065136, 0.5093741109056071, 0.2458376198376162, 0.5596265909412514, 0.3659150295666054, 0.08352727135774662, 0.6024587554447678, 0.36001263276525597, 0.302824947722369, 0.4547954820687803], "episode_lengths": [1001, 166, 1001, 159, 1001, 1001, 1001, 709, 1001, 811, 12, 1001, 1001, 770, 845, 149, 1001, 1001, 584, 262, 438, 132, 1001, 1001, 699, 599, 263, 321, 577, 460, 287, 977, 298, 315, 1001, 1001, 785, 1001, 146, 430, 131, 570, 1001, 1001, 554, 415, 202, 275, 50, 469, 395, 1001, 948, 772, 338, 202, 130, 818, 1001, 274, 220, 38, 213, 882, 346, 966, 1001, 400, 1001, 460, 975, 253, 363, 675, 317, 1001, 202, 139, 356, 282, 731, 1001, 834, 537, 421, 1001, 419, 1001, 485, 1001, 394, 606, 1001, 1001, 644, 326, 557, 45, 200, 389]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.06917336716260895, "mean_inference_ms": 0.425733821674985, "mean_action_processing_ms": 0.038756659698363435, "mean_env_wait_ms": 0.7400192775931415, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 79920, "agent_timesteps_total": 79920, "timers": {"sample_time_ms": 2142.388, "sample_throughput": 3730.417, "load_time_ms": 3.387, "load_throughput": 2359329.211, "learn_time_ms": 3302.871, "learn_throughput": 2419.713, "update_time_ms": 1.422}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.06245075538754463, "policy_loss": -0.010680638253688812, "vf_loss": 0.07112890481948853, "vf_explained_var": 0.40434569120407104, "kl": 0.010012451559305191, "entropy": 2.642178535461426, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 79920, "num_agent_steps_sampled": 79920, "num_steps_trained": 79920, "num_agent_steps_trained": 79920}, "done": false, "episodes_total": 162, "training_iteration": 10, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-36-46", "timestamp": 1716403006, "time_this_iter_s": 18.6405827999115, "time_total_s": 54.57840371131897, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 54.57840371131897, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 32.75, "ram_util_percent": 33.43076923076923}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 0.6700127221786829, "episode_reward_min": -0.310284483609775, "episode_reward_mean": 0.31206680775413687, "episode_len_mean": 576.43, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.74, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.26, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 0.0, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 0.0, "reward_component_totals/rejoin_first_time_reward_mean": 0.195, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.1170668077541364, "reward_component_totals/rejoin_dist_change_reward_min": 0.5570077726080989, "reward_component_totals/rejoin_dist_change_reward_max": 1.4200127221786814, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0}, "hist_stats": {"episode_reward": [-0.310284483609775, 0.266216157851612, 0.3287672790321057, -0.03450287746440184, 0.2769590013426122, -0.2752242177774664, 0.6389738371717271, 0.4361783927028686, 0.3992714031811839, 0.548737046930823, -0.2538116271231834, 0.3228381049149438, 0.5896919790851542, 0.5342134303775588, 0.4606986136920892, 0.3675230981323534, 0.360127787659025, 0.5374996534706926, 0.07110576843789684, 0.40091120360265275, 0.4097653080560486, 0.08064912163037241, 0.35927639547998713, -0.12040106302498166, 0.36017734445022787, 0.32203542150210995, 0.3016064780631571, 0.1376539341929377, 0.27865190877783097, 0.55582185549375, -0.1092641580945255, -0.19299222739190114, 0.42599772745662245, 0.4226951023566552, 0.27087360815654393, 0.2263645209136429, 0.38245604751681705, 0.5502023548532193, 0.6193017284972175, 0.5197631547072892, 0.4688818793839671, 0.5188365330141078, 0.1357079342766787, 0.5411827933398521, 0.40795891934754747, 0.41141485773514197, 0.2128024106651072, -0.18714380294765554, 0.2825950014422183, 0.13131583290670457, 0.25335628896313755, 0.11912272275902791, 0.35043631141782305, 0.5025107389029915, 0.3837433429106327, 0.2783719665429105, 0.14929239223790614, 0.11729213579363407, 0.23330319817322231, 0.1923697151070669, 0.19675901045648625, 0.24927989909458526, 0.1692668070886174, 0.49115171146524217, 0.23274623051932863, 0.44191685529489444, 0.6352373423796438, 0.22580873521729572, 0.4720783475654733, 0.31967223035198344, 0.35776099579540177, 0.3602901752853447, 0.3419187169020468, 0.5656666800343415, 0.45403522824521314, 0.5348820538790955, 0.19030653447538382, 0.25802965801217015, 0.19891638125065136, 0.5093741109056071, 0.2458376198376162, 0.5596265909412514, 0.3659150295666054, 0.08352727135774662, 0.6024587554447678, 0.36001263276525597, 0.302824947722369, 0.4547954820687803, 0.6700127221786829, 0.6038861090519236, 0.6048578548302106, 0.36454569711663076, 0.22296171426721045, 0.03954494831994948, 0.06753971579028017, 0.2226071090995061, 0.5967723738102029, 0.19578224303147995, 0.4419268588171317, 0.026272108001760497], "episode_lengths": [1001, 770, 845, 149, 1001, 1001, 584, 262, 438, 132, 1001, 1001, 699, 599, 263, 321, 577, 460, 287, 977, 298, 315, 1001, 1001, 785, 1001, 146, 430, 131, 570, 1001, 1001, 554, 415, 202, 275, 50, 469, 395, 1001, 948, 772, 338, 202, 130, 818, 1001, 274, 220, 38, 213, 882, 346, 966, 1001, 400, 1001, 460, 975, 253, 363, 675, 317, 1001, 202, 139, 356, 282, 731, 1001, 834, 537, 421, 1001, 419, 1001, 485, 1001, 394, 606, 1001, 1001, 644, 326, 557, 45, 200, 389, 1001, 381, 1001, 1001, 114, 67, 1001, 368, 776, 155, 1001, 201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.07222398420641979, "mean_inference_ms": 0.44584567645497103, "mean_action_processing_ms": 0.040730289752149096, "mean_env_wait_ms": 0.77889640881627, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 87912, "agent_timesteps_total": 87912, "timers": {"sample_time_ms": 2540.503, "sample_throughput": 3145.834, "load_time_ms": 1.529, "load_throughput": 5225308.657, "learn_time_ms": 3653.38, "learn_throughput": 2187.563, "update_time_ms": 1.56}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.055017657577991486, "policy_loss": -0.013913590461015701, "vf_loss": 0.06647685170173645, "vf_explained_var": 0.4941122233867645, "kl": 0.012271915562450886, "entropy": 2.5615217685699463, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 87912, "num_agent_steps_sampled": 87912, "num_steps_trained": 87912, "num_agent_steps_trained": 87912}, "done": false, "episodes_total": 174, "training_iteration": 11, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-36-57", "timestamp": 1716403017, "time_this_iter_s": 11.640886306762695, "time_total_s": 66.21929001808167, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 66.21929001808167, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 32.98235294117647, "ram_util_percent": 33.329411764705874}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 0.6700127221786829, "episode_reward_min": -0.2538116271231834, "episode_reward_mean": 0.3350684838853361, "episode_len_mean": 594.88, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.71, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.29, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 0.0, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 0.0, "reward_component_totals/rejoin_first_time_reward_mean": 0.205, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.1300684838853357, "reward_component_totals/rejoin_dist_change_reward_min": 0.5570077726080989, "reward_component_totals/rejoin_dist_change_reward_max": 1.4200127221786814, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0}, "hist_stats": {"episode_reward": [-0.2538116271231834, 0.3228381049149438, 0.5896919790851542, 0.5342134303775588, 0.4606986136920892, 0.3675230981323534, 0.360127787659025, 0.5374996534706926, 0.07110576843789684, 0.40091120360265275, 0.4097653080560486, 0.08064912163037241, 0.35927639547998713, -0.12040106302498166, 0.36017734445022787, 0.32203542150210995, 0.3016064780631571, 0.1376539341929377, 0.27865190877783097, 0.55582185549375, -0.1092641580945255, -0.19299222739190114, 0.42599772745662245, 0.4226951023566552, 0.27087360815654393, 0.2263645209136429, 0.38245604751681705, 0.5502023548532193, 0.6193017284972175, 0.5197631547072892, 0.4688818793839671, 0.5188365330141078, 0.1357079342766787, 0.5411827933398521, 0.40795891934754747, 0.41141485773514197, 0.2128024106651072, -0.18714380294765554, 0.2825950014422183, 0.13131583290670457, 0.25335628896313755, 0.11912272275902791, 0.35043631141782305, 0.5025107389029915, 0.3837433429106327, 0.2783719665429105, 0.14929239223790614, 0.11729213579363407, 0.23330319817322231, 0.1923697151070669, 0.19675901045648625, 0.24927989909458526, 0.1692668070886174, 0.49115171146524217, 0.23274623051932863, 0.44191685529489444, 0.6352373423796438, 0.22580873521729572, 0.4720783475654733, 0.31967223035198344, 0.35776099579540177, 0.3602901752853447, 0.3419187169020468, 0.5656666800343415, 0.45403522824521314, 0.5348820538790955, 0.19030653447538382, 0.25802965801217015, 0.19891638125065136, 0.5093741109056071, 0.2458376198376162, 0.5596265909412514, 0.3659150295666054, 0.08352727135774662, 0.6024587554447678, 0.36001263276525597, 0.302824947722369, 0.4547954820687803, 0.6700127221786829, 0.6038861090519236, 0.6048578548302106, 0.36454569711663076, 0.22296171426721045, 0.03954494831994948, 0.06753971579028017, 0.2226071090995061, 0.5967723738102029, 0.19578224303147995, 0.4419268588171317, 0.026272108001760497, 0.4027454629114555, 0.5343082899084624, 0.503748400637043, 0.4554245995610302, 0.25000782766618523, 0.4712397545797069, 0.3679490875427298, 0.40511145281544625, 0.556970735648304, 0.6277535412108559], "episode_lengths": [1001, 1001, 699, 599, 263, 321, 577, 460, 287, 977, 298, 315, 1001, 1001, 785, 1001, 146, 430, 131, 570, 1001, 1001, 554, 415, 202, 275, 50, 469, 395, 1001, 948, 772, 338, 202, 130, 818, 1001, 274, 220, 38, 213, 882, 346, 966, 1001, 400, 1001, 460, 975, 253, 363, 675, 317, 1001, 202, 139, 356, 282, 731, 1001, 834, 537, 421, 1001, 419, 1001, 485, 1001, 394, 606, 1001, 1001, 644, 326, 557, 45, 200, 389, 1001, 381, 1001, 1001, 114, 67, 1001, 368, 776, 155, 1001, 201, 540, 1001, 1001, 950, 1001, 1001, 360, 172, 1001, 1001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.07603767510011669, "mean_inference_ms": 0.4677708008327423, "mean_action_processing_ms": 0.04292003046066345, "mean_env_wait_ms": 0.8215275241755955, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 95904, "agent_timesteps_total": 95904, "timers": {"sample_time_ms": 2964.059, "sample_throughput": 2696.303, "load_time_ms": 1.661, "load_throughput": 4812276.952, "learn_time_ms": 3993.932, "learn_throughput": 2001.035, "update_time_ms": 1.753}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.046597253531217575, "policy_loss": -0.007180452346801758, "vf_loss": 0.05202265456318855, "vf_explained_var": 0.5853268504142761, "kl": 0.008775279857218266, "entropy": 2.550173282623291, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 95904, "num_agent_steps_sampled": 95904, "num_steps_trained": 95904, "num_agent_steps_trained": 95904}, "done": false, "episodes_total": 184, "training_iteration": 12, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-37-09", "timestamp": 1716403029, "time_this_iter_s": 11.542945384979248, "time_total_s": 77.76223540306091, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 77.76223540306091, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 31.511764705882356, "ram_util_percent": 33.42352941176471}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 0.6700127221786829, "episode_reward_min": -0.19299222739190114, "episode_reward_mean": 0.34063657819261567, "episode_len_mean": 612.94, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.68, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.32, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 0.0, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 0.0, "reward_component_totals/rejoin_first_time_reward_mean": 0.21, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.1306365781926149, "reward_component_totals/rejoin_dist_change_reward_min": 0.5570077726080989, "reward_component_totals/rejoin_dist_change_reward_max": 1.4200127221786814, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0}, "hist_stats": {"episode_reward": [0.40091120360265275, 0.4097653080560486, 0.08064912163037241, 0.35927639547998713, -0.12040106302498166, 0.36017734445022787, 0.32203542150210995, 0.3016064780631571, 0.1376539341929377, 0.27865190877783097, 0.55582185549375, -0.1092641580945255, -0.19299222739190114, 0.42599772745662245, 0.4226951023566552, 0.27087360815654393, 0.2263645209136429, 0.38245604751681705, 0.5502023548532193, 0.6193017284972175, 0.5197631547072892, 0.4688818793839671, 0.5188365330141078, 0.1357079342766787, 0.5411827933398521, 0.40795891934754747, 0.41141485773514197, 0.2128024106651072, -0.18714380294765554, 0.2825950014422183, 0.13131583290670457, 0.25335628896313755, 0.11912272275902791, 0.35043631141782305, 0.5025107389029915, 0.3837433429106327, 0.2783719665429105, 0.14929239223790614, 0.11729213579363407, 0.23330319817322231, 0.1923697151070669, 0.19675901045648625, 0.24927989909458526, 0.1692668070886174, 0.49115171146524217, 0.23274623051932863, 0.44191685529489444, 0.6352373423796438, 0.22580873521729572, 0.4720783475654733, 0.31967223035198344, 0.35776099579540177, 0.3602901752853447, 0.3419187169020468, 0.5656666800343415, 0.45403522824521314, 0.5348820538790955, 0.19030653447538382, 0.25802965801217015, 0.19891638125065136, 0.5093741109056071, 0.2458376198376162, 0.5596265909412514, 0.3659150295666054, 0.08352727135774662, 0.6024587554447678, 0.36001263276525597, 0.302824947722369, 0.4547954820687803, 0.6700127221786829, 0.6038861090519236, 0.6048578548302106, 0.36454569711663076, 0.22296171426721045, 0.03954494831994948, 0.06753971579028017, 0.2226071090995061, 0.5967723738102029, 0.19578224303147995, 0.4419268588171317, 0.026272108001760497, 0.4027454629114555, 0.5343082899084624, 0.503748400637043, 0.4554245995610302, 0.25000782766618523, 0.4712397545797069, 0.3679490875427298, 0.40511145281544625, 0.556970735648304, 0.6277535412108559, 0.22049456366968267, 0.5317920070891549, 0.41153721654138575, 0.19465150084124838, 0.5297304131172738, 0.1936709485768897, 0.5362433034206222, 0.33189670271115457, 0.5966795834070735], "episode_lengths": [977, 298, 315, 1001, 1001, 785, 1001, 146, 430, 131, 570, 1001, 1001, 554, 415, 202, 275, 50, 469, 395, 1001, 948, 772, 338, 202, 130, 818, 1001, 274, 220, 38, 213, 882, 346, 966, 1001, 400, 1001, 460, 975, 253, 363, 675, 317, 1001, 202, 139, 356, 282, 731, 1001, 834, 537, 421, 1001, 419, 1001, 485, 1001, 394, 606, 1001, 1001, 644, 326, 557, 45, 200, 389, 1001, 381, 1001, 1001, 114, 67, 1001, 368, 776, 155, 1001, 201, 540, 1001, 1001, 950, 1001, 1001, 360, 172, 1001, 1001, 1001, 1001, 1001, 1001, 471, 1001, 737, 333, 468]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.08065474225867181, "mean_inference_ms": 0.4931124746690121, "mean_action_processing_ms": 0.045340670151152854, "mean_env_wait_ms": 0.8690714108236272, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 103896, "agent_timesteps_total": 103896, "timers": {"sample_time_ms": 3359.566, "sample_throughput": 2378.878, "load_time_ms": 1.845, "load_throughput": 4332374.028, "learn_time_ms": 4360.648, "learn_throughput": 1832.755, "update_time_ms": 1.915}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04266883060336113, "policy_loss": -0.011767817661166191, "vf_loss": 0.0525333546102047, "vf_explained_var": 0.5721040368080139, "kl": 0.009516465477645397, "entropy": 2.5061042308807373, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 103896, "num_agent_steps_sampled": 103896, "num_steps_trained": 103896, "num_agent_steps_trained": 103896}, "done": false, "episodes_total": 193, "training_iteration": 13, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-37-21", "timestamp": 1716403041, "time_this_iter_s": 11.554872751235962, "time_total_s": 89.31710815429688, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 89.31710815429688, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 33.225, "ram_util_percent": 33.48125}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 1.3126590048931166, "episode_reward_min": -0.19299222739190114, "episode_reward_mean": 0.36356619105505367, "episode_len_mean": 635.36, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.0, "outcome/success_min": 0, "outcome/success_max": 0, "outcome/failure_mean": 1.0, "outcome/failure_min": 1, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.64, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.36, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 0.012, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 0.7999999999999999, "reward_component_totals/rejoin_first_time_reward_mean": 0.2175, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.1340661910550525, "reward_component_totals/rejoin_dist_change_reward_min": 0.5570077726080989, "reward_component_totals/rejoin_dist_change_reward_max": 1.4200127221786814, "reward_component_totals/failure_reward_mean": -1.0, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": -1, "reward_component_totals/success_reward_mean": 0.0, "reward_component_totals/success_reward_min": 0, "reward_component_totals/success_reward_max": 0}, "hist_stats": {"episode_reward": [0.27865190877783097, 0.55582185549375, -0.1092641580945255, -0.19299222739190114, 0.42599772745662245, 0.4226951023566552, 0.27087360815654393, 0.2263645209136429, 0.38245604751681705, 0.5502023548532193, 0.6193017284972175, 0.5197631547072892, 0.4688818793839671, 0.5188365330141078, 0.1357079342766787, 0.5411827933398521, 0.40795891934754747, 0.41141485773514197, 0.2128024106651072, -0.18714380294765554, 0.2825950014422183, 0.13131583290670457, 0.25335628896313755, 0.11912272275902791, 0.35043631141782305, 0.5025107389029915, 0.3837433429106327, 0.2783719665429105, 0.14929239223790614, 0.11729213579363407, 0.23330319817322231, 0.1923697151070669, 0.19675901045648625, 0.24927989909458526, 0.1692668070886174, 0.49115171146524217, 0.23274623051932863, 0.44191685529489444, 0.6352373423796438, 0.22580873521729572, 0.4720783475654733, 0.31967223035198344, 0.35776099579540177, 0.3602901752853447, 0.3419187169020468, 0.5656666800343415, 0.45403522824521314, 0.5348820538790955, 0.19030653447538382, 0.25802965801217015, 0.19891638125065136, 0.5093741109056071, 0.2458376198376162, 0.5596265909412514, 0.3659150295666054, 0.08352727135774662, 0.6024587554447678, 0.36001263276525597, 0.302824947722369, 0.4547954820687803, 0.6700127221786829, 0.6038861090519236, 0.6048578548302106, 0.36454569711663076, 0.22296171426721045, 0.03954494831994948, 0.06753971579028017, 0.2226071090995061, 0.5967723738102029, 0.19578224303147995, 0.4419268588171317, 0.026272108001760497, 0.4027454629114555, 0.5343082899084624, 0.503748400637043, 0.4554245995610302, 0.25000782766618523, 0.4712397545797069, 0.3679490875427298, 0.40511145281544625, 0.556970735648304, 0.6277535412108559, 0.22049456366968267, 0.5317920070891549, 0.41153721654138575, 0.19465150084124838, 0.5297304131172738, 0.1936709485768897, 0.5362433034206222, 0.33189670271115457, 0.5966795834070735, 0.3511927775112662, 0.19265732671732216, 0.6981473598695721, 1.3126590048931166, 0.5118057178903623, 0.6280359312879127, 0.4860155709260876, 0.42953136820513893, -0.06540962710447396], "episode_lengths": [131, 570, 1001, 1001, 554, 415, 202, 275, 50, 469, 395, 1001, 948, 772, 338, 202, 130, 818, 1001, 274, 220, 38, 213, 882, 346, 966, 1001, 400, 1001, 460, 975, 253, 363, 675, 317, 1001, 202, 139, 356, 282, 731, 1001, 834, 537, 421, 1001, 419, 1001, 485, 1001, 394, 606, 1001, 1001, 644, 326, 557, 45, 200, 389, 1001, 381, 1001, 1001, 114, 67, 1001, 368, 776, 155, 1001, 201, 540, 1001, 1001, 950, 1001, 1001, 360, 172, 1001, 1001, 1001, 1001, 1001, 1001, 471, 1001, 737, 333, 468, 1001, 1001, 1001, 1001, 1001, 741, 448, 1001, 1001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.08588603167320792, "mean_inference_ms": 0.5221316853889759, "mean_action_processing_ms": 0.04814513743824164, "mean_env_wait_ms": 0.9238498780601256, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 111888, "agent_timesteps_total": 111888, "timers": {"sample_time_ms": 3743.841, "sample_throughput": 2134.706, "load_time_ms": 2.031, "load_throughput": 3934837.137, "learn_time_ms": 4732.001, "learn_throughput": 1688.926, "update_time_ms": 2.059}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05262831225991249, "policy_loss": -0.005413913633674383, "vf_loss": 0.056915394961833954, "vf_explained_var": 0.5597211122512817, "kl": 0.005634183529764414, "entropy": 2.5039381980895996, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 111888, "num_agent_steps_sampled": 111888, "num_steps_trained": 111888, "num_agent_steps_trained": 111888}, "done": false, "episodes_total": 202, "training_iteration": 14, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-37-32", "timestamp": 1716403052, "time_this_iter_s": 11.644840240478516, "time_total_s": 100.96194839477539, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 100.96194839477539, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 32.83529411764706, "ram_util_percent": 33.48823529411764}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.599218079192312, "episode_reward_min": -0.18714380294765554, "episode_reward_mean": 0.4279192437273809, "episode_len_mean": 672.14, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.01, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.99, "outcome/failure_min": 0, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.5959595959595959, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.40404040404040403, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 0.035, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.2225, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.1415892437273796, "reward_component_totals/rejoin_dist_change_reward_min": 0.6845903728955187, "reward_component_totals/rejoin_dist_change_reward_max": 1.46621807919231, "reward_component_totals/failure_reward_mean": -0.99, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 0.01883, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.883}, "hist_stats": {"episode_reward": [0.5197631547072892, 0.4688818793839671, 0.5188365330141078, 0.1357079342766787, 0.5411827933398521, 0.40795891934754747, 0.41141485773514197, 0.2128024106651072, -0.18714380294765554, 0.2825950014422183, 0.13131583290670457, 0.25335628896313755, 0.11912272275902791, 0.35043631141782305, 0.5025107389029915, 0.3837433429106327, 0.2783719665429105, 0.14929239223790614, 0.11729213579363407, 0.23330319817322231, 0.1923697151070669, 0.19675901045648625, 0.24927989909458526, 0.1692668070886174, 0.49115171146524217, 0.23274623051932863, 0.44191685529489444, 0.6352373423796438, 0.22580873521729572, 0.4720783475654733, 0.31967223035198344, 0.35776099579540177, 0.3602901752853447, 0.3419187169020468, 0.5656666800343415, 0.45403522824521314, 0.5348820538790955, 0.19030653447538382, 0.25802965801217015, 0.19891638125065136, 0.5093741109056071, 0.2458376198376162, 0.5596265909412514, 0.3659150295666054, 0.08352727135774662, 0.6024587554447678, 0.36001263276525597, 0.302824947722369, 0.4547954820687803, 0.6700127221786829, 0.6038861090519236, 0.6048578548302106, 0.36454569711663076, 0.22296171426721045, 0.03954494831994948, 0.06753971579028017, 0.2226071090995061, 0.5967723738102029, 0.19578224303147995, 0.4419268588171317, 0.026272108001760497, 0.4027454629114555, 0.5343082899084624, 0.503748400637043, 0.4554245995610302, 0.25000782766618523, 0.4712397545797069, 0.3679490875427298, 0.40511145281544625, 0.556970735648304, 0.6277535412108559, 0.22049456366968267, 0.5317920070891549, 0.41153721654138575, 0.19465150084124838, 0.5297304131172738, 0.1936709485768897, 0.5362433034206222, 0.33189670271115457, 0.5966795834070735, 0.3511927775112662, 0.19265732671732216, 0.6981473598695721, 1.3126590048931166, 0.5118057178903623, 0.6280359312879127, 0.4860155709260876, 0.42953136820513893, -0.06540962710447396, 0.5591577340538674, 0.665239747223685, 0.3269674271449985, 0.5116947998145032, 0.28046801973575164, 0.2806002693318641, 0.1732320523974693, 0.318872893074015, 0.5254225313708081, 5.599218079192312, 0.6245401824293233], "episode_lengths": [1001, 948, 772, 338, 202, 130, 818, 1001, 274, 220, 38, 213, 882, 346, 966, 1001, 400, 1001, 460, 975, 253, 363, 675, 317, 1001, 202, 139, 356, 282, 731, 1001, 834, 537, 421, 1001, 419, 1001, 485, 1001, 394, 606, 1001, 1001, 644, 326, 557, 45, 200, 389, 1001, 381, 1001, 1001, 114, 67, 1001, 368, 776, 155, 1001, 201, 540, 1001, 1001, 950, 1001, 1001, 360, 172, 1001, 1001, 1001, 1001, 1001, 1001, 471, 1001, 737, 333, 468, 1001, 1001, 1001, 1001, 1001, 741, 448, 1001, 1001, 1001, 1001, 1001, 1001, 570, 1001, 696, 1001, 915, 117, 437]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09217584732674786, "mean_inference_ms": 0.5622734613847084, "mean_action_processing_ms": 0.05203568319104894, "mean_env_wait_ms": 0.9988342597671962, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 119880, "agent_timesteps_total": 119880, "timers": {"sample_time_ms": 4143.951, "sample_throughput": 1928.594, "load_time_ms": 2.223, "load_throughput": 3594963.49, "learn_time_ms": 5107.908, "learn_throughput": 1564.633, "update_time_ms": 2.227}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.14372026920318604, "policy_loss": -0.006776654161512852, "vf_loss": 0.14912976324558258, "vf_explained_var": 0.38399243354797363, "kl": 0.006835784763097763, "entropy": 2.469965934753418, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 119880, "num_agent_steps_sampled": 119880, "num_steps_trained": 119880, "num_agent_steps_trained": 119880}, "done": false, "episodes_total": 213, "training_iteration": 15, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-37-44", "timestamp": 1716403064, "time_this_iter_s": 11.728461027145386, "time_total_s": 112.69040942192078, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 112.69040942192078, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 33.182352941176475, "ram_util_percent": 33.470588235294116}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.599218079192312, "episode_reward_min": -0.18714380294765554, "episode_reward_mean": 0.4288945985482727, "episode_len_mean": 700.12, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.01, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.99, "outcome/failure_min": 0, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.5353535353535354, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.46464646464646464, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 0.035, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.2225, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.1425645985482706, "reward_component_totals/rejoin_dist_change_reward_min": 0.6845903728955187, "reward_component_totals/rejoin_dist_change_reward_max": 1.46621807919231, "reward_component_totals/failure_reward_mean": -0.99, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 0.01883, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.883}, "hist_stats": {"episode_reward": [-0.18714380294765554, 0.2825950014422183, 0.13131583290670457, 0.25335628896313755, 0.11912272275902791, 0.35043631141782305, 0.5025107389029915, 0.3837433429106327, 0.2783719665429105, 0.14929239223790614, 0.11729213579363407, 0.23330319817322231, 0.1923697151070669, 0.19675901045648625, 0.24927989909458526, 0.1692668070886174, 0.49115171146524217, 0.23274623051932863, 0.44191685529489444, 0.6352373423796438, 0.22580873521729572, 0.4720783475654733, 0.31967223035198344, 0.35776099579540177, 0.3602901752853447, 0.3419187169020468, 0.5656666800343415, 0.45403522824521314, 0.5348820538790955, 0.19030653447538382, 0.25802965801217015, 0.19891638125065136, 0.5093741109056071, 0.2458376198376162, 0.5596265909412514, 0.3659150295666054, 0.08352727135774662, 0.6024587554447678, 0.36001263276525597, 0.302824947722369, 0.4547954820687803, 0.6700127221786829, 0.6038861090519236, 0.6048578548302106, 0.36454569711663076, 0.22296171426721045, 0.03954494831994948, 0.06753971579028017, 0.2226071090995061, 0.5967723738102029, 0.19578224303147995, 0.4419268588171317, 0.026272108001760497, 0.4027454629114555, 0.5343082899084624, 0.503748400637043, 0.4554245995610302, 0.25000782766618523, 0.4712397545797069, 0.3679490875427298, 0.40511145281544625, 0.556970735648304, 0.6277535412108559, 0.22049456366968267, 0.5317920070891549, 0.41153721654138575, 0.19465150084124838, 0.5297304131172738, 0.1936709485768897, 0.5362433034206222, 0.33189670271115457, 0.5966795834070735, 0.3511927775112662, 0.19265732671732216, 0.6981473598695721, 1.3126590048931166, 0.5118057178903623, 0.6280359312879127, 0.4860155709260876, 0.42953136820513893, -0.06540962710447396, 0.5591577340538674, 0.665239747223685, 0.3269674271449985, 0.5116947998145032, 0.28046801973575164, 0.2806002693318641, 0.1732320523974693, 0.318872893074015, 0.5254225313708081, 5.599218079192312, 0.6245401824293233, 0.07566966906681549, 0.4636022569041489, 0.4936425137831719, 0.4671458288535377, 0.29859115692715466, 0.5118599252531713, 0.44705492876917496, 0.5565176850017], "episode_lengths": [274, 220, 38, 213, 882, 346, 966, 1001, 400, 1001, 460, 975, 253, 363, 675, 317, 1001, 202, 139, 356, 282, 731, 1001, 834, 537, 421, 1001, 419, 1001, 485, 1001, 394, 606, 1001, 1001, 644, 326, 557, 45, 200, 389, 1001, 381, 1001, 1001, 114, 67, 1001, 368, 776, 155, 1001, 201, 540, 1001, 1001, 950, 1001, 1001, 360, 172, 1001, 1001, 1001, 1001, 1001, 1001, 471, 1001, 737, 333, 468, 1001, 1001, 1001, 1001, 1001, 741, 448, 1001, 1001, 1001, 1001, 1001, 1001, 570, 1001, 696, 1001, 915, 117, 437, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09786560008531547, "mean_inference_ms": 0.5956573912388452, "mean_action_processing_ms": 0.05517970652672766, "mean_env_wait_ms": 1.0609699552191, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 127872, "agent_timesteps_total": 127872, "timers": {"sample_time_ms": 4590.588, "sample_throughput": 1740.953, "load_time_ms": 2.414, "load_throughput": 3310377.007, "learn_time_ms": 5478.018, "learn_throughput": 1458.922, "update_time_ms": 2.391}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05723419412970543, "policy_loss": -0.008347272872924805, "vf_loss": 0.06335724890232086, "vf_explained_var": 0.5308713316917419, "kl": 0.011121084913611412, "entropy": 2.4553635120391846, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 127872, "num_agent_steps_sampled": 127872, "num_steps_trained": 127872, "num_agent_steps_trained": 127872}, "done": false, "episodes_total": 221, "training_iteration": 16, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-37-56", "timestamp": 1716403076, "time_this_iter_s": 12.166768312454224, "time_total_s": 124.857177734375, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 124.857177734375, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 34.241176470588236, "ram_util_percent": 33.39411764705882}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.599218079192312, "episode_reward_min": -0.06540962710447396, "episode_reward_mean": 0.45127338665717487, "episode_len_mean": 738.32, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.01, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.99, "outcome/failure_min": 0, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.48484848484848486, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.5151515151515151, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 0.04100000000000001, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.2275, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.1539433866571727, "reward_component_totals/rejoin_dist_change_reward_min": 0.6845903728955187, "reward_component_totals/rejoin_dist_change_reward_max": 1.46621807919231, "reward_component_totals/failure_reward_mean": -0.99, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 0.01883, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.883}, "hist_stats": {"episode_reward": [0.5025107389029915, 0.3837433429106327, 0.2783719665429105, 0.14929239223790614, 0.11729213579363407, 0.23330319817322231, 0.1923697151070669, 0.19675901045648625, 0.24927989909458526, 0.1692668070886174, 0.49115171146524217, 0.23274623051932863, 0.44191685529489444, 0.6352373423796438, 0.22580873521729572, 0.4720783475654733, 0.31967223035198344, 0.35776099579540177, 0.3602901752853447, 0.3419187169020468, 0.5656666800343415, 0.45403522824521314, 0.5348820538790955, 0.19030653447538382, 0.25802965801217015, 0.19891638125065136, 0.5093741109056071, 0.2458376198376162, 0.5596265909412514, 0.3659150295666054, 0.08352727135774662, 0.6024587554447678, 0.36001263276525597, 0.302824947722369, 0.4547954820687803, 0.6700127221786829, 0.6038861090519236, 0.6048578548302106, 0.36454569711663076, 0.22296171426721045, 0.03954494831994948, 0.06753971579028017, 0.2226071090995061, 0.5967723738102029, 0.19578224303147995, 0.4419268588171317, 0.026272108001760497, 0.4027454629114555, 0.5343082899084624, 0.503748400637043, 0.4554245995610302, 0.25000782766618523, 0.4712397545797069, 0.3679490875427298, 0.40511145281544625, 0.556970735648304, 0.6277535412108559, 0.22049456366968267, 0.5317920070891549, 0.41153721654138575, 0.19465150084124838, 0.5297304131172738, 0.1936709485768897, 0.5362433034206222, 0.33189670271115457, 0.5966795834070735, 0.3511927775112662, 0.19265732671732216, 0.6981473598695721, 1.3126590048931166, 0.5118057178903623, 0.6280359312879127, 0.4860155709260876, 0.42953136820513893, -0.06540962710447396, 0.5591577340538674, 0.665239747223685, 0.3269674271449985, 0.5116947998145032, 0.28046801973575164, 0.2806002693318641, 0.1732320523974693, 0.318872893074015, 0.5254225313708081, 5.599218079192312, 0.6245401824293233, 0.07566966906681549, 0.4636022569041489, 0.4936425137831719, 0.4671458288535377, 0.29859115692715466, 0.5118599252531713, 0.44705492876917496, 0.5565176850017, 0.2919758600353879, 0.6101988408173459, 0.924852510439007, 0.3630352777518473, 0.4412106685940558, 0.5562880077938324], "episode_lengths": [966, 1001, 400, 1001, 460, 975, 253, 363, 675, 317, 1001, 202, 139, 356, 282, 731, 1001, 834, 537, 421, 1001, 419, 1001, 485, 1001, 394, 606, 1001, 1001, 644, 326, 557, 45, 200, 389, 1001, 381, 1001, 1001, 114, 67, 1001, 368, 776, 155, 1001, 201, 540, 1001, 1001, 950, 1001, 1001, 360, 172, 1001, 1001, 1001, 1001, 1001, 1001, 471, 1001, 737, 333, 468, 1001, 1001, 1001, 1001, 1001, 741, 448, 1001, 1001, 1001, 1001, 1001, 1001, 570, 1001, 696, 1001, 915, 117, 437, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 788]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.10252897609902659, "mean_inference_ms": 0.622716456607439, "mean_action_processing_ms": 0.057748195335103135, "mean_env_wait_ms": 1.1109296616337256, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 135864, "agent_timesteps_total": 135864, "timers": {"sample_time_ms": 4993.633, "sample_throughput": 1600.438, "load_time_ms": 2.642, "load_throughput": 3024449.177, "learn_time_ms": 5852.68, "learn_throughput": 1365.528, "update_time_ms": 2.533}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.045795589685440063, "policy_loss": -0.006735899485647678, "vf_loss": 0.051070984452962875, "vf_explained_var": 0.5441135168075562, "kl": 0.007302479352802038, "entropy": 2.465679407119751, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 135864, "num_agent_steps_sampled": 135864, "num_steps_trained": 135864, "num_agent_steps_trained": 135864}, "done": false, "episodes_total": 227, "training_iteration": 17, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-38-08", "timestamp": 1716403088, "time_this_iter_s": 11.876114845275879, "time_total_s": 136.73329257965088, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 136.73329257965088, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 33.60588235294118, "ram_util_percent": 33.4}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.599218079192312, "episode_reward_min": -0.06540962710447396, "episode_reward_mean": 0.4698254759190403, "episode_len_mean": 767.88, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.01, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.99, "outcome/failure_min": 0, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.42424242424242425, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.5757575757575758, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 0.04100000000000001, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.235, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.1649954759190375, "reward_component_totals/rejoin_dist_change_reward_min": 0.6845903728955187, "reward_component_totals/rejoin_dist_change_reward_max": 1.46621807919231, "reward_component_totals/failure_reward_mean": -0.99, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 0.01883, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.883}, "hist_stats": {"episode_reward": [0.49115171146524217, 0.23274623051932863, 0.44191685529489444, 0.6352373423796438, 0.22580873521729572, 0.4720783475654733, 0.31967223035198344, 0.35776099579540177, 0.3602901752853447, 0.3419187169020468, 0.5656666800343415, 0.45403522824521314, 0.5348820538790955, 0.19030653447538382, 0.25802965801217015, 0.19891638125065136, 0.5093741109056071, 0.2458376198376162, 0.5596265909412514, 0.3659150295666054, 0.08352727135774662, 0.6024587554447678, 0.36001263276525597, 0.302824947722369, 0.4547954820687803, 0.6700127221786829, 0.6038861090519236, 0.6048578548302106, 0.36454569711663076, 0.22296171426721045, 0.03954494831994948, 0.06753971579028017, 0.2226071090995061, 0.5967723738102029, 0.19578224303147995, 0.4419268588171317, 0.026272108001760497, 0.4027454629114555, 0.5343082899084624, 0.503748400637043, 0.4554245995610302, 0.25000782766618523, 0.4712397545797069, 0.3679490875427298, 0.40511145281544625, 0.556970735648304, 0.6277535412108559, 0.22049456366968267, 0.5317920070891549, 0.41153721654138575, 0.19465150084124838, 0.5297304131172738, 0.1936709485768897, 0.5362433034206222, 0.33189670271115457, 0.5966795834070735, 0.3511927775112662, 0.19265732671732216, 0.6981473598695721, 1.3126590048931166, 0.5118057178903623, 0.6280359312879127, 0.4860155709260876, 0.42953136820513893, -0.06540962710447396, 0.5591577340538674, 0.665239747223685, 0.3269674271449985, 0.5116947998145032, 0.28046801973575164, 0.2806002693318641, 0.1732320523974693, 0.318872893074015, 0.5254225313708081, 5.599218079192312, 0.6245401824293233, 0.07566966906681549, 0.4636022569041489, 0.4936425137831719, 0.4671458288535377, 0.29859115692715466, 0.5118599252531713, 0.44705492876917496, 0.5565176850017, 0.2919758600353879, 0.6101988408173459, 0.924852510439007, 0.3630352777518473, 0.4412106685940558, 0.5562880077938324, 0.6746084888953854, 0.33655952013881096, 0.47087153428037687, 0.5047044387818911, 0.32658785334935003, 0.4402196523581894, 0.524138056961355, 0.42399672729489657, 0.2745113824992078, 0.35120047793513853], "episode_lengths": [1001, 202, 139, 356, 282, 731, 1001, 834, 537, 421, 1001, 419, 1001, 485, 1001, 394, 606, 1001, 1001, 644, 326, 557, 45, 200, 389, 1001, 381, 1001, 1001, 114, 67, 1001, 368, 776, 155, 1001, 201, 540, 1001, 1001, 950, 1001, 1001, 360, 172, 1001, 1001, 1001, 1001, 1001, 1001, 471, 1001, 737, 333, 468, 1001, 1001, 1001, 1001, 1001, 741, 448, 1001, 1001, 1001, 1001, 1001, 1001, 570, 1001, 696, 1001, 915, 117, 437, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 788, 1001, 1001, 1001, 719, 1001, 1001, 1001, 1001, 1001, 640]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.10967679385886527, "mean_inference_ms": 0.6699723543604447, "mean_action_processing_ms": 0.06226109084791732, "mean_env_wait_ms": 1.1996887987734146, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 143856, "agent_timesteps_total": 143856, "timers": {"sample_time_ms": 5427.767, "sample_throughput": 1472.429, "load_time_ms": 2.83, "load_throughput": 2824356.706, "learn_time_ms": 6241.117, "learn_throughput": 1280.54, "update_time_ms": 2.689}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.06180847808718681, "policy_loss": -0.00662448862567544, "vf_loss": 0.06613042950630188, "vf_explained_var": 0.6045117974281311, "kl": 0.011512678116559982, "entropy": 2.444000720977783, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 143856, "num_agent_steps_sampled": 143856, "num_steps_trained": 143856, "num_agent_steps_trained": 143856}, "done": false, "episodes_total": 237, "training_iteration": 18, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-38-20", "timestamp": 1716403100, "time_this_iter_s": 12.163880109786987, "time_total_s": 148.89717268943787, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 148.89717268943787, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 33.38235294117648, "ram_util_percent": 33.45294117647059}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.599218079192312, "episode_reward_min": -0.07843027787417955, "episode_reward_mean": 0.48402757038767413, "episode_len_mean": 803.32, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.01, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.99, "outcome/failure_min": 0, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.35353535353535354, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.6464646464646465, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 0.048, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.235, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.1721975703876708, "reward_component_totals/rejoin_dist_change_reward_min": 0.6845903728955187, "reward_component_totals/rejoin_dist_change_reward_max": 1.46621807919231, "reward_component_totals/failure_reward_mean": -0.99, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 0.01883, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.883}, "hist_stats": {"episode_reward": [0.5656666800343415, 0.45403522824521314, 0.5348820538790955, 0.19030653447538382, 0.25802965801217015, 0.19891638125065136, 0.5093741109056071, 0.2458376198376162, 0.5596265909412514, 0.3659150295666054, 0.08352727135774662, 0.6024587554447678, 0.36001263276525597, 0.302824947722369, 0.4547954820687803, 0.6700127221786829, 0.6038861090519236, 0.6048578548302106, 0.36454569711663076, 0.22296171426721045, 0.03954494831994948, 0.06753971579028017, 0.2226071090995061, 0.5967723738102029, 0.19578224303147995, 0.4419268588171317, 0.026272108001760497, 0.4027454629114555, 0.5343082899084624, 0.503748400637043, 0.4554245995610302, 0.25000782766618523, 0.4712397545797069, 0.3679490875427298, 0.40511145281544625, 0.556970735648304, 0.6277535412108559, 0.22049456366968267, 0.5317920070891549, 0.41153721654138575, 0.19465150084124838, 0.5297304131172738, 0.1936709485768897, 0.5362433034206222, 0.33189670271115457, 0.5966795834070735, 0.3511927775112662, 0.19265732671732216, 0.6981473598695721, 1.3126590048931166, 0.5118057178903623, 0.6280359312879127, 0.4860155709260876, 0.42953136820513893, -0.06540962710447396, 0.5591577340538674, 0.665239747223685, 0.3269674271449985, 0.5116947998145032, 0.28046801973575164, 0.2806002693318641, 0.1732320523974693, 0.318872893074015, 0.5254225313708081, 5.599218079192312, 0.6245401824293233, 0.07566966906681549, 0.4636022569041489, 0.4936425137831719, 0.4671458288535377, 0.29859115692715466, 0.5118599252531713, 0.44705492876917496, 0.5565176850017, 0.2919758600353879, 0.6101988408173459, 0.924852510439007, 0.3630352777518473, 0.4412106685940558, 0.5562880077938324, 0.6746084888953854, 0.33655952013881096, 0.47087153428037687, 0.5047044387818911, 0.32658785334935003, 0.4402196523581894, 0.524138056961355, 0.42399672729489657, 0.2745113824992078, 0.35120047793513853, 0.6278779701713437, 0.47480322602249303, 0.6480056726111254, 0.6139928129746943, 0.4672565779132003, 0.7305122033300487, -0.07843027787417955, 0.6669181660502236, 0.6393774119847492, 0.5084770244563269], "episode_lengths": [1001, 419, 1001, 485, 1001, 394, 606, 1001, 1001, 644, 326, 557, 45, 200, 389, 1001, 381, 1001, 1001, 114, 67, 1001, 368, 776, 155, 1001, 201, 540, 1001, 1001, 950, 1001, 1001, 360, 172, 1001, 1001, 1001, 1001, 1001, 1001, 471, 1001, 737, 333, 468, 1001, 1001, 1001, 1001, 1001, 741, 448, 1001, 1001, 1001, 1001, 1001, 1001, 570, 1001, 696, 1001, 915, 117, 437, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 788, 1001, 1001, 1001, 719, 1001, 1001, 1001, 1001, 1001, 640, 1001, 1001, 1001, 1001, 1001, 1001, 39, 1001, 1001, 1001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.11868130648680389, "mean_inference_ms": 0.7220884413276019, "mean_action_processing_ms": 0.06717453758971263, "mean_env_wait_ms": 1.2953249644135765, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 151848, "agent_timesteps_total": 151848, "timers": {"sample_time_ms": 5913.659, "sample_throughput": 1351.448, "load_time_ms": 3.059, "load_throughput": 2612695.056, "learn_time_ms": 6652.259, "learn_throughput": 1201.396, "update_time_ms": 2.849}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05631180480122566, "policy_loss": -0.011736967600882053, "vf_loss": 0.06516584753990173, "vf_explained_var": 0.5331190228462219, "kl": 0.01441462803632021, "entropy": 2.4963204860687256, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 151848, "num_agent_steps_sampled": 151848, "num_steps_trained": 151848, "num_agent_steps_trained": 151848}, "done": false, "episodes_total": 247, "training_iteration": 19, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-38-33", "timestamp": 1716403113, "time_this_iter_s": 12.92551040649414, "time_total_s": 161.822683095932, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 161.822683095932, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 34.51052631578948, "ram_util_percent": 33.57368421052632}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.599218079192312, "episode_reward_min": -0.07843027787417955, "episode_reward_mean": 0.6716898255417317, "episode_len_mean": 805.44, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.05, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.95, "outcome/failure_min": 0, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.3263157894736842, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.6736842105263158, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 0.13200000000000003, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.235, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.1770198255417275, "reward_component_totals/rejoin_dist_change_reward_min": 0.6845903728955187, "reward_component_totals/rejoin_dist_change_reward_max": 1.46621807919231, "reward_component_totals/failure_reward_mean": -0.95, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 0.07766999999999999, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.883}, "hist_stats": {"episode_reward": [0.3659150295666054, 0.08352727135774662, 0.6024587554447678, 0.36001263276525597, 0.302824947722369, 0.4547954820687803, 0.6700127221786829, 0.6038861090519236, 0.6048578548302106, 0.36454569711663076, 0.22296171426721045, 0.03954494831994948, 0.06753971579028017, 0.2226071090995061, 0.5967723738102029, 0.19578224303147995, 0.4419268588171317, 0.026272108001760497, 0.4027454629114555, 0.5343082899084624, 0.503748400637043, 0.4554245995610302, 0.25000782766618523, 0.4712397545797069, 0.3679490875427298, 0.40511145281544625, 0.556970735648304, 0.6277535412108559, 0.22049456366968267, 0.5317920070891549, 0.41153721654138575, 0.19465150084124838, 0.5297304131172738, 0.1936709485768897, 0.5362433034206222, 0.33189670271115457, 0.5966795834070735, 0.3511927775112662, 0.19265732671732216, 0.6981473598695721, 1.3126590048931166, 0.5118057178903623, 0.6280359312879127, 0.4860155709260876, 0.42953136820513893, -0.06540962710447396, 0.5591577340538674, 0.665239747223685, 0.3269674271449985, 0.5116947998145032, 0.28046801973575164, 0.2806002693318641, 0.1732320523974693, 0.318872893074015, 0.5254225313708081, 5.599218079192312, 0.6245401824293233, 0.07566966906681549, 0.4636022569041489, 0.4936425137831719, 0.4671458288535377, 0.29859115692715466, 0.5118599252531713, 0.44705492876917496, 0.5565176850017, 0.2919758600353879, 0.6101988408173459, 0.924852510439007, 0.3630352777518473, 0.4412106685940558, 0.5562880077938324, 0.6746084888953854, 0.33655952013881096, 0.47087153428037687, 0.5047044387818911, 0.32658785334935003, 0.4402196523581894, 0.524138056961355, 0.42399672729489657, 0.2745113824992078, 0.35120047793513853, 0.6278779701713437, 0.47480322602249303, 0.6480056726111254, 0.6139928129746943, 0.4672565779132003, 0.7305122033300487, -0.07843027787417955, 0.6669181660502236, 0.6393774119847492, 0.5084770244563269, 0.23138442191772346, 4.401137467218645, 0.25414933699341224, 0.36415348011878734, 4.986525942211214, 0.66272116489588, 0.837366797051205, 5.380631201284785, 5.164830561295444], "episode_lengths": [644, 326, 557, 45, 200, 389, 1001, 381, 1001, 1001, 114, 67, 1001, 368, 776, 155, 1001, 201, 540, 1001, 1001, 950, 1001, 1001, 360, 172, 1001, 1001, 1001, 1001, 1001, 1001, 471, 1001, 737, 333, 468, 1001, 1001, 1001, 1001, 1001, 741, 448, 1001, 1001, 1001, 1001, 1001, 1001, 570, 1001, 696, 1001, 915, 117, 437, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 788, 1001, 1001, 1001, 719, 1001, 1001, 1001, 1001, 1001, 640, 1001, 1001, 1001, 1001, 1001, 1001, 39, 1001, 1001, 1001, 1001, 811, 1001, 1001, 539, 1001, 1001, 273, 493]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12485884616266586, "mean_inference_ms": 0.760519104201991, "mean_action_processing_ms": 0.07084896367405605, "mean_env_wait_ms": 1.3669737177218784, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 159840, "agent_timesteps_total": 159840, "timers": {"sample_time_ms": 5918.422, "sample_throughput": 1350.36, "load_time_ms": 2.901, "load_throughput": 2754997.211, "learn_time_ms": 5983.584, "learn_throughput": 1335.654, "update_time_ms": 2.839}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.3085235059261322, "policy_loss": -0.00896045845001936, "vf_loss": 0.31513914465904236, "vf_explained_var": 0.21108874678611755, "kl": 0.01172375027090311, "entropy": 2.4717817306518555, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 159840, "num_agent_steps_sampled": 159840, "num_steps_trained": 159840, "num_agent_steps_trained": 159840}, "done": false, "episodes_total": 256, "training_iteration": 20, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-38-45", "timestamp": 1716403125, "time_this_iter_s": 11.998697280883789, "time_total_s": 173.8213803768158, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 173.8213803768158, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 31.764705882352942, "ram_util_percent": 33.53529411764706}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.599218079192312, "episode_reward_min": -0.07843027787417955, "episode_reward_mean": 0.8720511413837315, "episode_len_mean": 831.51, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.09, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.91, "outcome/failure_min": 0, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.25274725274725274, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.7472527472527473, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 0.21500000000000002, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.1819711413837264, "reward_component_totals/rejoin_dist_change_reward_min": 0.6845903728955187, "reward_component_totals/rejoin_dist_change_reward_max": 1.4931630571895236, "reward_component_totals/failure_reward_mean": -0.91, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 0.14508, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.8980000000000001}, "hist_stats": {"episode_reward": [0.03954494831994948, 0.06753971579028017, 0.2226071090995061, 0.5967723738102029, 0.19578224303147995, 0.4419268588171317, 0.026272108001760497, 0.4027454629114555, 0.5343082899084624, 0.503748400637043, 0.4554245995610302, 0.25000782766618523, 0.4712397545797069, 0.3679490875427298, 0.40511145281544625, 0.556970735648304, 0.6277535412108559, 0.22049456366968267, 0.5317920070891549, 0.41153721654138575, 0.19465150084124838, 0.5297304131172738, 0.1936709485768897, 0.5362433034206222, 0.33189670271115457, 0.5966795834070735, 0.3511927775112662, 0.19265732671732216, 0.6981473598695721, 1.3126590048931166, 0.5118057178903623, 0.6280359312879127, 0.4860155709260876, 0.42953136820513893, -0.06540962710447396, 0.5591577340538674, 0.665239747223685, 0.3269674271449985, 0.5116947998145032, 0.28046801973575164, 0.2806002693318641, 0.1732320523974693, 0.318872893074015, 0.5254225313708081, 5.599218079192312, 0.6245401824293233, 0.07566966906681549, 0.4636022569041489, 0.4936425137831719, 0.4671458288535377, 0.29859115692715466, 0.5118599252531713, 0.44705492876917496, 0.5565176850017, 0.2919758600353879, 0.6101988408173459, 0.924852510439007, 0.3630352777518473, 0.4412106685940558, 0.5562880077938324, 0.6746084888953854, 0.33655952013881096, 0.47087153428037687, 0.5047044387818911, 0.32658785334935003, 0.4402196523581894, 0.524138056961355, 0.42399672729489657, 0.2745113824992078, 0.35120047793513853, 0.6278779701713437, 0.47480322602249303, 0.6480056726111254, 0.6139928129746943, 0.4672565779132003, 0.7305122033300487, -0.07843027787417955, 0.6669181660502236, 0.6393774119847492, 0.5084770244563269, 0.23138442191772346, 4.401137467218645, 0.25414933699341224, 0.36415348011878734, 4.986525942211214, 0.66272116489588, 0.837366797051205, 5.380631201284785, 5.164830561295444, 0.5181561799314245, 0.8493979978438858, 0.6252239437934477, 4.6600505046128555, 0.4464694069937851, 5.468163057189523, 0.15414191745776273, 5.475962484110896, 0.3527417982978802, 0.5617354946542958, 5.559887015684389], "episode_lengths": [67, 1001, 368, 776, 155, 1001, 201, 540, 1001, 1001, 950, 1001, 1001, 360, 172, 1001, 1001, 1001, 1001, 1001, 1001, 471, 1001, 737, 333, 468, 1001, 1001, 1001, 1001, 1001, 741, 448, 1001, 1001, 1001, 1001, 1001, 1001, 570, 1001, 696, 1001, 915, 117, 437, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 788, 1001, 1001, 1001, 719, 1001, 1001, 1001, 1001, 1001, 640, 1001, 1001, 1001, 1001, 1001, 1001, 39, 1001, 1001, 1001, 1001, 811, 1001, 1001, 539, 1001, 1001, 273, 493, 1001, 1001, 1001, 641, 1001, 275, 1001, 241, 1001, 1001, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.132419149804651, "mean_inference_ms": 0.8084016559007181, "mean_action_processing_ms": 0.07532379395352366, "mean_env_wait_ms": 1.4551087137009526, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 167832, "agent_timesteps_total": 167832, "timers": {"sample_time_ms": 6027.63, "sample_throughput": 1325.894, "load_time_ms": 2.944, "load_throughput": 2714790.651, "learn_time_ms": 6002.472, "learn_throughput": 1331.451, "update_time_ms": 2.826}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.3429238796234131, "policy_loss": -0.010116313584148884, "vf_loss": 0.350991427898407, "vf_explained_var": 0.2758442163467407, "kl": 0.010243651457130909, "entropy": 2.4540085792541504, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 167832, "num_agent_steps_sampled": 167832, "num_steps_trained": 167832, "num_agent_steps_trained": 167832}, "done": false, "episodes_total": 267, "training_iteration": 21, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-38-58", "timestamp": 1716403138, "time_this_iter_s": 12.920727252960205, "time_total_s": 186.742107629776, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 186.742107629776, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 34.431578947368415, "ram_util_percent": 33.4}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.599218079192312, "episode_reward_min": -0.07843027787417955, "episode_reward_mean": 1.1553558419723349, "episode_len_mean": 846.91, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.15, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.85, "outcome/failure_min": 0, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.2, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.8, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 0.3350000000000001, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.2475, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.1942458419723294, "reward_component_totals/rejoin_dist_change_reward_min": 0.6845903728955187, "reward_component_totals/rejoin_dist_change_reward_max": 1.4931630571895236, "reward_component_totals/failure_reward_mean": -0.85, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 0.22860999999999998, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.8980000000000001}, "hist_stats": {"episode_reward": [0.503748400637043, 0.4554245995610302, 0.25000782766618523, 0.4712397545797069, 0.3679490875427298, 0.40511145281544625, 0.556970735648304, 0.6277535412108559, 0.22049456366968267, 0.5317920070891549, 0.41153721654138575, 0.19465150084124838, 0.5297304131172738, 0.1936709485768897, 0.5362433034206222, 0.33189670271115457, 0.5966795834070735, 0.3511927775112662, 0.19265732671732216, 0.6981473598695721, 1.3126590048931166, 0.5118057178903623, 0.6280359312879127, 0.4860155709260876, 0.42953136820513893, -0.06540962710447396, 0.5591577340538674, 0.665239747223685, 0.3269674271449985, 0.5116947998145032, 0.28046801973575164, 0.2806002693318641, 0.1732320523974693, 0.318872893074015, 0.5254225313708081, 5.599218079192312, 0.6245401824293233, 0.07566966906681549, 0.4636022569041489, 0.4936425137831719, 0.4671458288535377, 0.29859115692715466, 0.5118599252531713, 0.44705492876917496, 0.5565176850017, 0.2919758600353879, 0.6101988408173459, 0.924852510439007, 0.3630352777518473, 0.4412106685940558, 0.5562880077938324, 0.6746084888953854, 0.33655952013881096, 0.47087153428037687, 0.5047044387818911, 0.32658785334935003, 0.4402196523581894, 0.524138056961355, 0.42399672729489657, 0.2745113824992078, 0.35120047793513853, 0.6278779701713437, 0.47480322602249303, 0.6480056726111254, 0.6139928129746943, 0.4672565779132003, 0.7305122033300487, -0.07843027787417955, 0.6669181660502236, 0.6393774119847492, 0.5084770244563269, 0.23138442191772346, 4.401137467218645, 0.25414933699341224, 0.36415348011878734, 4.986525942211214, 0.66272116489588, 0.837366797051205, 5.380631201284785, 5.164830561295444, 0.5181561799314245, 0.8493979978438858, 0.6252239437934477, 4.6600505046128555, 0.4464694069937851, 5.468163057189523, 0.15414191745776273, 5.475962484110896, 0.3527417982978802, 0.5617354946542958, 5.559887015684389, 4.706491446643497, 5.293195985356993, 0.6284099876646856, 4.734069430744546, 4.6206504905244605, 0.29623812269403027, 4.91711977083897, 0.2903974103033262, 5.371396523780061], "episode_lengths": [1001, 950, 1001, 1001, 360, 172, 1001, 1001, 1001, 1001, 1001, 1001, 471, 1001, 737, 333, 468, 1001, 1001, 1001, 1001, 1001, 741, 448, 1001, 1001, 1001, 1001, 1001, 1001, 570, 1001, 696, 1001, 915, 117, 437, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 788, 1001, 1001, 1001, 719, 1001, 1001, 1001, 1001, 1001, 640, 1001, 1001, 1001, 1001, 1001, 1001, 39, 1001, 1001, 1001, 1001, 811, 1001, 1001, 539, 1001, 1001, 273, 493, 1001, 1001, 1001, 641, 1001, 275, 1001, 241, 1001, 1001, 102, 913, 355, 1001, 631, 888, 1001, 542, 1001, 318]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.13866003212385547, "mean_inference_ms": 0.8442610919752344, "mean_action_processing_ms": 0.0787043559904861, "mean_env_wait_ms": 1.5213349360641024, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 175824, "agent_timesteps_total": 175824, "timers": {"sample_time_ms": 6057.566, "sample_throughput": 1319.342, "load_time_ms": 3.022, "load_throughput": 2644436.539, "learn_time_ms": 6041.338, "learn_throughput": 1322.886, "update_time_ms": 2.818}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.40354853868484497, "policy_loss": -0.008216957561671734, "vf_loss": 0.4097024202346802, "vf_explained_var": 0.18395370244979858, "kl": 0.010315355844795704, "entropy": 2.4451682567596436, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 175824, "num_agent_steps_sampled": 175824, "num_steps_trained": 175824, "num_agent_steps_trained": 175824}, "done": false, "episodes_total": 276, "training_iteration": 22, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-39-11", "timestamp": 1716403151, "time_this_iter_s": 12.229570388793945, "time_total_s": 198.97167801856995, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 198.97167801856995, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 33.24117647058823, "ram_util_percent": 33.42352941176471}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.599218079192312, "episode_reward_min": -0.07843027787417955, "episode_reward_mean": 1.5470266920309745, "episode_len_mean": 819.97, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.23, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.77, "outcome/failure_min": 0, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.16883116883116883, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.8311688311688312, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 0.503, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.2475, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2105466920309687, "reward_component_totals/rejoin_dist_change_reward_min": 0.6845903728955187, "reward_component_totals/rejoin_dist_change_reward_max": 1.4931630571895236, "reward_component_totals/failure_reward_mean": -0.77, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 0.35597999999999996, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.8980000000000001}, "hist_stats": {"episode_reward": [0.5362433034206222, 0.33189670271115457, 0.5966795834070735, 0.3511927775112662, 0.19265732671732216, 0.6981473598695721, 1.3126590048931166, 0.5118057178903623, 0.6280359312879127, 0.4860155709260876, 0.42953136820513893, -0.06540962710447396, 0.5591577340538674, 0.665239747223685, 0.3269674271449985, 0.5116947998145032, 0.28046801973575164, 0.2806002693318641, 0.1732320523974693, 0.318872893074015, 0.5254225313708081, 5.599218079192312, 0.6245401824293233, 0.07566966906681549, 0.4636022569041489, 0.4936425137831719, 0.4671458288535377, 0.29859115692715466, 0.5118599252531713, 0.44705492876917496, 0.5565176850017, 0.2919758600353879, 0.6101988408173459, 0.924852510439007, 0.3630352777518473, 0.4412106685940558, 0.5562880077938324, 0.6746084888953854, 0.33655952013881096, 0.47087153428037687, 0.5047044387818911, 0.32658785334935003, 0.4402196523581894, 0.524138056961355, 0.42399672729489657, 0.2745113824992078, 0.35120047793513853, 0.6278779701713437, 0.47480322602249303, 0.6480056726111254, 0.6139928129746943, 0.4672565779132003, 0.7305122033300487, -0.07843027787417955, 0.6669181660502236, 0.6393774119847492, 0.5084770244563269, 0.23138442191772346, 4.401137467218645, 0.25414933699341224, 0.36415348011878734, 4.986525942211214, 0.66272116489588, 0.837366797051205, 5.380631201284785, 5.164830561295444, 0.5181561799314245, 0.8493979978438858, 0.6252239437934477, 4.6600505046128555, 0.4464694069937851, 5.468163057189523, 0.15414191745776273, 5.475962484110896, 0.3527417982978802, 0.5617354946542958, 5.559887015684389, 4.706491446643497, 5.293195985356993, 0.6284099876646856, 4.734069430744546, 4.6206504905244605, 0.29623812269403027, 4.91711977083897, 0.2903974103033262, 5.371396523780061, 0.6944396277152727, 5.453467095281152, 5.003747763985265, 0.5281642840226961, 5.326342281182739, 0.5670684971618483, 0.6784479665455659, 5.083089677960574, 5.133518206279956, 4.788843097906916, 5.067763154027483, 0.9546513893746261, 5.472325065311996, 0.13529894860485459], "episode_lengths": [737, 333, 468, 1001, 1001, 1001, 1001, 1001, 741, 448, 1001, 1001, 1001, 1001, 1001, 1001, 570, 1001, 696, 1001, 915, 117, 437, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 788, 1001, 1001, 1001, 719, 1001, 1001, 1001, 1001, 1001, 640, 1001, 1001, 1001, 1001, 1001, 1001, 39, 1001, 1001, 1001, 1001, 811, 1001, 1001, 539, 1001, 1001, 273, 493, 1001, 1001, 1001, 641, 1001, 275, 1001, 241, 1001, 1001, 102, 913, 355, 1001, 631, 888, 1001, 542, 1001, 318, 1001, 188, 542, 1001, 323, 1001, 1001, 409, 313, 886, 499, 1001, 103, 1001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.14683338270552315, "mean_inference_ms": 0.8931775545523136, "mean_action_processing_ms": 0.08334515892697962, "mean_env_wait_ms": 1.6124248397549072, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 183816, "agent_timesteps_total": 183816, "timers": {"sample_time_ms": 6114.165, "sample_throughput": 1307.129, "load_time_ms": 3.059, "load_throughput": 2612328.556, "learn_time_ms": 6061.886, "learn_throughput": 1318.402, "update_time_ms": 2.837}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.5361576676368713, "policy_loss": -0.008122378960251808, "vf_loss": 0.5424257516860962, "vf_explained_var": 0.22146360576152802, "kl": 0.009271329268813133, "entropy": 2.4166555404663086, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 183816, "num_agent_steps_sampled": 183816, "num_steps_trained": 183816, "num_agent_steps_trained": 183816}, "done": false, "episodes_total": 290, "training_iteration": 23, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-39-23", "timestamp": 1716403163, "time_this_iter_s": 12.328885316848755, "time_total_s": 211.3005633354187, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 211.3005633354187, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 33.59444444444445, "ram_util_percent": 33.5}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.599218079192312, "episode_reward_min": -0.07843027787417955, "episode_reward_mean": 2.3488442262049607, "episode_len_mean": 744.43, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.4, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.6, "outcome/failure_min": 0, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.1, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.9, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 0.8360000000000002, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.2475, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2338542262049548, "reward_component_totals/rejoin_dist_change_reward_min": 0.8256696690668102, "reward_component_totals/rejoin_dist_change_reward_max": 1.4931630571895236, "reward_component_totals/failure_reward_mean": -0.6, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 0.6314900000000001, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.8980000000000001}, "hist_stats": {"episode_reward": [0.318872893074015, 0.5254225313708081, 5.599218079192312, 0.6245401824293233, 0.07566966906681549, 0.4636022569041489, 0.4936425137831719, 0.4671458288535377, 0.29859115692715466, 0.5118599252531713, 0.44705492876917496, 0.5565176850017, 0.2919758600353879, 0.6101988408173459, 0.924852510439007, 0.3630352777518473, 0.4412106685940558, 0.5562880077938324, 0.6746084888953854, 0.33655952013881096, 0.47087153428037687, 0.5047044387818911, 0.32658785334935003, 0.4402196523581894, 0.524138056961355, 0.42399672729489657, 0.2745113824992078, 0.35120047793513853, 0.6278779701713437, 0.47480322602249303, 0.6480056726111254, 0.6139928129746943, 0.4672565779132003, 0.7305122033300487, -0.07843027787417955, 0.6669181660502236, 0.6393774119847492, 0.5084770244563269, 0.23138442191772346, 4.401137467218645, 0.25414933699341224, 0.36415348011878734, 4.986525942211214, 0.66272116489588, 0.837366797051205, 5.380631201284785, 5.164830561295444, 0.5181561799314245, 0.8493979978438858, 0.6252239437934477, 4.6600505046128555, 0.4464694069937851, 5.468163057189523, 0.15414191745776273, 5.475962484110896, 0.3527417982978802, 0.5617354946542958, 5.559887015684389, 4.706491446643497, 5.293195985356993, 0.6284099876646856, 4.734069430744546, 4.6206504905244605, 0.29623812269403027, 4.91711977083897, 0.2903974103033262, 5.371396523780061, 0.6944396277152727, 5.453467095281152, 5.003747763985265, 0.5281642840226961, 5.326342281182739, 0.5670684971618483, 0.6784479665455659, 5.083089677960574, 5.133518206279956, 4.788843097906916, 5.067763154027483, 0.9546513893746261, 5.472325065311996, 0.13529894860485459, 4.761301589266145, 4.76115515132968, 5.204689718317907, 0.6528445636438733, 5.3050968201110065, 5.016897722708498, 4.978495549618395, 5.382744564004268, 5.166002468087343, 4.489640050463314, 5.311334090539954, 5.4390263060228685, 1.3872357896850067, 5.399218029712566, 5.180320129839074, 5.1431174714813555, 5.2180376575238245, 5.076923646522357, 5.114487167958443], "episode_lengths": [1001, 915, 117, 437, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 1001, 788, 1001, 1001, 1001, 719, 1001, 1001, 1001, 1001, 1001, 640, 1001, 1001, 1001, 1001, 1001, 1001, 39, 1001, 1001, 1001, 1001, 811, 1001, 1001, 539, 1001, 1001, 273, 493, 1001, 1001, 1001, 641, 1001, 275, 1001, 241, 1001, 1001, 102, 913, 355, 1001, 631, 888, 1001, 542, 1001, 318, 1001, 188, 542, 1001, 323, 1001, 1001, 409, 313, 886, 499, 1001, 103, 1001, 832, 567, 154, 1001, 420, 228, 321, 343, 524, 825, 139, 106, 1001, 270, 404, 117, 485, 173, 541]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15616447329274447, "mean_inference_ms": 0.9482537370867894, "mean_action_processing_ms": 0.0885220443801541, "mean_env_wait_ms": 1.7141556268412912, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 191808, "agent_timesteps_total": 191808, "timers": {"sample_time_ms": 6194.908, "sample_throughput": 1290.092, "load_time_ms": 3.068, "load_throughput": 2604675.983, "learn_time_ms": 6078.96, "learn_throughput": 1314.699, "update_time_ms": 2.862}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.726243793964386, "policy_loss": -0.009195835329592228, "vf_loss": 0.7332556247711182, "vf_explained_var": 0.204734206199646, "kl": 0.010919512249529362, "entropy": 2.376307725906372, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 191808, "num_agent_steps_sampled": 191808, "num_steps_trained": 191808, "num_agent_steps_trained": 191808}, "done": false, "episodes_total": 309, "training_iteration": 24, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-39-36", "timestamp": 1716403176, "time_this_iter_s": 12.62151575088501, "time_total_s": 223.9220790863037, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 223.9220790863037, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 34.05555555555556, "ram_util_percent": 33.5}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.628948850474499, "episode_reward_min": -0.07843027787417955, "episode_reward_mean": 3.3889153706268416, "episode_len_mean": 611.6, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.62, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.38, "outcome/failure_min": 0, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.05263157894736842, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.9473684210526315, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 1.2810000000000001, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.2475, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2448653706268362, "reward_component_totals/rejoin_dist_change_reward_min": 0.8852989486048342, "reward_component_totals/rejoin_dist_change_reward_max": 1.4931630571895236, "reward_component_totals/failure_reward_mean": -0.38, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 0.99555, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.934}, "hist_stats": {"episode_reward": [0.524138056961355, 0.42399672729489657, 0.2745113824992078, 0.35120047793513853, 0.6278779701713437, 0.47480322602249303, 0.6480056726111254, 0.6139928129746943, 0.4672565779132003, 0.7305122033300487, -0.07843027787417955, 0.6669181660502236, 0.6393774119847492, 0.5084770244563269, 0.23138442191772346, 4.401137467218645, 0.25414933699341224, 0.36415348011878734, 4.986525942211214, 0.66272116489588, 0.837366797051205, 5.380631201284785, 5.164830561295444, 0.5181561799314245, 0.8493979978438858, 0.6252239437934477, 4.6600505046128555, 0.4464694069937851, 5.468163057189523, 0.15414191745776273, 5.475962484110896, 0.3527417982978802, 0.5617354946542958, 5.559887015684389, 4.706491446643497, 5.293195985356993, 0.6284099876646856, 4.734069430744546, 4.6206504905244605, 0.29623812269403027, 4.91711977083897, 0.2903974103033262, 5.371396523780061, 0.6944396277152727, 5.453467095281152, 5.003747763985265, 0.5281642840226961, 5.326342281182739, 0.5670684971618483, 0.6784479665455659, 5.083089677960574, 5.133518206279956, 4.788843097906916, 5.067763154027483, 0.9546513893746261, 5.472325065311996, 0.13529894860485459, 4.761301589266145, 4.76115515132968, 5.204689718317907, 0.6528445636438733, 5.3050968201110065, 5.016897722708498, 4.978495549618395, 5.382744564004268, 5.166002468087343, 4.489640050463314, 5.311334090539954, 5.4390263060228685, 1.3872357896850067, 5.399218029712566, 5.180320129839074, 5.1431174714813555, 5.2180376575238245, 5.076923646522357, 5.114487167958443, 5.488524035478376, 5.208695136728897, 1.3631880505122922, 5.628948850474499, 5.048996318432103, 5.113141337110872, 5.395195691960017, 5.4075142868619155, 5.607605686805268, 5.5054784063046736, 4.793050741220358, 5.062738228985014, 4.992229314249334, 5.246363774238952, 4.520447304203081, 4.733806119240443, 5.29350168015819, 4.861894815603054, 5.356482719254058, 5.252557297578927, 5.481786604856285, 4.781503275229918, 4.9126299075771485, 5.274085162985294], "episode_lengths": [1001, 1001, 1001, 640, 1001, 1001, 1001, 1001, 1001, 1001, 39, 1001, 1001, 1001, 1001, 811, 1001, 1001, 539, 1001, 1001, 273, 493, 1001, 1001, 1001, 641, 1001, 275, 1001, 241, 1001, 1001, 102, 913, 355, 1001, 631, 888, 1001, 542, 1001, 318, 1001, 188, 542, 1001, 323, 1001, 1001, 409, 313, 886, 499, 1001, 103, 1001, 832, 567, 154, 1001, 420, 228, 321, 343, 524, 825, 139, 106, 1001, 270, 404, 117, 485, 173, 541, 227, 189, 1001, 66, 453, 251, 179, 86, 97, 123, 438, 436, 615, 241, 956, 684, 333, 456, 169, 189, 191, 432, 606, 294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1648214780679262, "mean_inference_ms": 0.9995461144336855, "mean_action_processing_ms": 0.09337303007239557, "mean_env_wait_ms": 1.810489094768632, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 199800, "agent_timesteps_total": 199800, "timers": {"sample_time_ms": 6299.422, "sample_throughput": 1268.688, "load_time_ms": 3.11, "load_throughput": 2569929.664, "learn_time_ms": 6100.738, "learn_throughput": 1310.005, "update_time_ms": 2.851}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.6840654611587524, "policy_loss": -0.008298632688820362, "vf_loss": 0.6904444694519043, "vf_explained_var": 0.28543055057525635, "kl": 0.00959851499646902, "entropy": 2.3290467262268066, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 199800, "num_agent_steps_sampled": 199800, "num_steps_trained": 199800, "num_agent_steps_trained": 199800}, "done": false, "episodes_total": 333, "training_iteration": 25, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-39-49", "timestamp": 1716403189, "time_this_iter_s": 12.989477396011353, "time_total_s": 236.91155648231506, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 236.91155648231506, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 34.31111111111111, "ram_util_percent": 33.50555555555556}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.628948850474499, "episode_reward_min": 0.13529894860485459, "episode_reward_mean": 4.488835981590929, "episode_len_mean": 449.41, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.85, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.15, "outcome/failure_min": 0, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 0.0, "failure_code_ratio/crash_min": 0, "failure_code_ratio/crash_max": 0, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 1.0, "failure_code_ratio/timeout_min": 1, "failure_code_ratio/timeout_max": 1, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 1.7270000000000005, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.261095981590926, "reward_component_totals/rejoin_dist_change_reward_min": 0.8852989486048342, "reward_component_totals/rejoin_dist_change_reward_max": 1.5061704804286398, "reward_component_totals/failure_reward_mean": -0.15, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.4007399999999999, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.934}, "hist_stats": {"episode_reward": [0.15414191745776273, 5.475962484110896, 0.3527417982978802, 0.5617354946542958, 5.559887015684389, 4.706491446643497, 5.293195985356993, 0.6284099876646856, 4.734069430744546, 4.6206504905244605, 0.29623812269403027, 4.91711977083897, 0.2903974103033262, 5.371396523780061, 0.6944396277152727, 5.453467095281152, 5.003747763985265, 0.5281642840226961, 5.326342281182739, 0.5670684971618483, 0.6784479665455659, 5.083089677960574, 5.133518206279956, 4.788843097906916, 5.067763154027483, 0.9546513893746261, 5.472325065311996, 0.13529894860485459, 4.761301589266145, 4.76115515132968, 5.204689718317907, 0.6528445636438733, 5.3050968201110065, 5.016897722708498, 4.978495549618395, 5.382744564004268, 5.166002468087343, 4.489640050463314, 5.311334090539954, 5.4390263060228685, 1.3872357896850067, 5.399218029712566, 5.180320129839074, 5.1431174714813555, 5.2180376575238245, 5.076923646522357, 5.114487167958443, 5.488524035478376, 5.208695136728897, 1.3631880505122922, 5.628948850474499, 5.048996318432103, 5.113141337110872, 5.395195691960017, 5.4075142868619155, 5.607605686805268, 5.5054784063046736, 4.793050741220358, 5.062738228985014, 4.992229314249334, 5.246363774238952, 4.520447304203081, 4.733806119240443, 5.29350168015819, 4.861894815603054, 5.356482719254058, 5.252557297578927, 5.481786604856285, 4.781503275229918, 4.9126299075771485, 5.274085162985294, 5.144285269940037, 5.618170480428638, 5.573090289180399, 5.2593240946320305, 5.325067473373054, 5.380939320814086, 5.357112262232301, 5.368012136131409, 5.492213910452388, 4.852146317222836, 5.207896353051924, 4.850714645873271, 5.25777062059649, 5.466992701259182, 5.217206687676807, 5.026098216931703, 4.774495604275693, 5.1914651982233435, 5.083800615606679, 5.437468151704827, 5.3051441813134845, 5.083205814511988, 4.996009829968673, 5.278149922219024, 5.401336093940939, 5.441634324841011, 5.192369709974539, 5.291000807085242, 4.841938958629464], "episode_lengths": [1001, 241, 1001, 1001, 102, 913, 355, 1001, 631, 888, 1001, 542, 1001, 318, 1001, 188, 542, 1001, 323, 1001, 1001, 409, 313, 886, 499, 1001, 103, 1001, 832, 567, 154, 1001, 420, 228, 321, 343, 524, 825, 139, 106, 1001, 270, 404, 117, 485, 173, 541, 227, 189, 1001, 66, 453, 251, 179, 86, 97, 123, 438, 436, 615, 241, 956, 684, 333, 456, 169, 189, 191, 432, 606, 294, 361, 138, 157, 238, 258, 324, 85, 225, 214, 432, 144, 636, 108, 93, 413, 364, 739, 435, 235, 217, 145, 313, 366, 319, 277, 187, 466, 317, 307]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17211257866614837, "mean_inference_ms": 1.0406945585320924, "mean_action_processing_ms": 0.09722591902417049, "mean_env_wait_ms": 1.8878630429624803, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 207792, "agent_timesteps_total": 207792, "timers": {"sample_time_ms": 6327.356, "sample_throughput": 1263.087, "load_time_ms": 3.127, "load_throughput": 2555938.48, "learn_time_ms": 6126.746, "learn_throughput": 1304.445, "update_time_ms": 2.834}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.7409746050834656, "policy_loss": -0.00784569326788187, "vf_loss": 0.7467662692070007, "vf_explained_var": 0.043374236673116684, "kl": 0.010270263999700546, "entropy": 2.3465847969055176, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 207792, "num_agent_steps_sampled": 207792, "num_steps_trained": 207792, "num_agent_steps_trained": 207792}, "done": false, "episodes_total": 362, "training_iteration": 26, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-40-02", "timestamp": 1716403202, "time_this_iter_s": 12.704123973846436, "time_total_s": 249.6156804561615, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 249.6156804561615, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 33.689473684210526, "ram_util_percent": 33.442105263157885}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.643490541553657, "episode_reward_min": 0.2674515128951418, "episode_reward_mean": 5.234736059259696, "episode_len_mean": 234.35, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.99, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.01, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9800000000000002, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.2475, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2711560592596944, "reward_component_totals/rejoin_dist_change_reward_min": 0.8989389586294587, "reward_component_totals/rejoin_dist_change_reward_max": 1.5061704804286398, "reward_component_totals/failure_reward_mean": -0.01, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.74608, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.9449999999999998, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.113141337110872, 5.395195691960017, 5.4075142868619155, 5.607605686805268, 5.5054784063046736, 4.793050741220358, 5.062738228985014, 4.992229314249334, 5.246363774238952, 4.520447304203081, 4.733806119240443, 5.29350168015819, 4.861894815603054, 5.356482719254058, 5.252557297578927, 5.481786604856285, 4.781503275229918, 4.9126299075771485, 5.274085162985294, 5.144285269940037, 5.618170480428638, 5.573090289180399, 5.2593240946320305, 5.325067473373054, 5.380939320814086, 5.357112262232301, 5.368012136131409, 5.492213910452388, 4.852146317222836, 5.207896353051924, 4.850714645873271, 5.25777062059649, 5.466992701259182, 5.217206687676807, 5.026098216931703, 4.774495604275693, 5.1914651982233435, 5.083800615606679, 5.437468151704827, 5.3051441813134845, 5.083205814511988, 4.996009829968673, 5.278149922219024, 5.401336093940939, 5.441634324841011, 5.192369709974539, 5.291000807085242, 4.841938958629464, 5.320169752240218, 5.394082845343758, 5.603310639874499, 5.609893096505743, 5.356594489344937, 5.274156774920769, 5.551335454077531, 5.352532323727939, 0.2674515128951418, 5.485902300117161, 5.575449884025992, 5.267256957937662, 5.166591816551802, 5.3687629573276405, 5.102179721740898, 5.224168029995693, 5.2812034809382045, 5.5543054745723435, 5.598698616940576, 5.410076695963691, 5.584354212174237, 5.594871508755443, 5.30338537933846, 5.316012828215161, 5.400965075749758, 5.306597816675529, 5.226588082715957, 5.339212620707802, 5.1012303491697, 5.239706896178098, 5.364391889167422, 5.507698433148494, 5.417594066380834, 5.2862208240269055, 5.355012048215626, 5.348003309175094, 5.146604336926055, 5.091106156434772, 5.323209340180903, 5.530360976286017, 5.442699576934366, 5.411482524141295, 5.5736295095093285, 4.776187700884737, 5.100962557562796, 5.515432502783297, 5.520035913270374, 5.329411773020983, 5.643490541553657, 5.545434596018934, 5.3458023136611805, 5.414715095449996], "episode_lengths": [251, 179, 86, 97, 123, 438, 436, 615, 241, 956, 684, 333, 456, 169, 189, 191, 432, 606, 294, 361, 138, 157, 238, 258, 324, 85, 225, 214, 432, 144, 636, 108, 93, 413, 364, 739, 435, 235, 217, 145, 313, 366, 319, 277, 187, 466, 317, 307, 242, 325, 90, 123, 153, 136, 70, 63, 43, 96, 162, 158, 258, 102, 202, 139, 243, 120, 73, 106, 99, 77, 230, 194, 115, 156, 328, 96, 100, 398, 188, 112, 229, 109, 117, 129, 147, 240, 103, 55, 95, 136, 86, 716, 119, 101, 125, 225, 87, 137, 104, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17723261893230802, "mean_inference_ms": 1.0764703895204808, "mean_action_processing_ms": 0.10068285093039712, "mean_env_wait_ms": 1.9573875285358238, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 215784, "agent_timesteps_total": 215784, "timers": {"sample_time_ms": 6388.01, "sample_throughput": 1251.094, "load_time_ms": 3.104, "load_throughput": 2574924.15, "learn_time_ms": 6143.51, "learn_throughput": 1300.885, "update_time_ms": 2.862}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.7591379880905151, "policy_loss": -0.011678952723741531, "vf_loss": 0.7684946656227112, "vf_explained_var": 0.16573697328567505, "kl": 0.01161209773272276, "entropy": 2.29797101020813, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 215784, "num_agent_steps_sampled": 215784, "num_steps_trained": 215784, "num_agent_steps_trained": 215784}, "done": false, "episodes_total": 414, "training_iteration": 27, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-40-14", "timestamp": 1716403214, "time_this_iter_s": 12.647373676300049, "time_total_s": 262.26305413246155, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 262.26305413246155, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 33.0611111111111, "ram_util_percent": 33.5}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.643490541553657, "episode_reward_min": 0.24915708164163797, "episode_reward_mean": 5.255402268946483, "episode_len_mean": 158.44, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.98, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.02, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9600000000000002, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.245, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2669722689464817, "reward_component_totals/rejoin_dist_change_reward_min": 0.9512303491696981, "reward_component_totals/rejoin_dist_change_reward_max": 1.4875205147242785, "reward_component_totals/failure_reward_mean": -0.02, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.8034299999999999, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.9449999999999998, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.609893096505743, 5.356594489344937, 5.274156774920769, 5.551335454077531, 5.352532323727939, 0.2674515128951418, 5.485902300117161, 5.575449884025992, 5.267256957937662, 5.166591816551802, 5.3687629573276405, 5.102179721740898, 5.224168029995693, 5.2812034809382045, 5.5543054745723435, 5.598698616940576, 5.410076695963691, 5.584354212174237, 5.594871508755443, 5.30338537933846, 5.316012828215161, 5.400965075749758, 5.306597816675529, 5.226588082715957, 5.339212620707802, 5.1012303491697, 5.239706896178098, 5.364391889167422, 5.507698433148494, 5.417594066380834, 5.2862208240269055, 5.355012048215626, 5.348003309175094, 5.146604336926055, 5.091106156434772, 5.323209340180903, 5.530360976286017, 5.442699576934366, 5.411482524141295, 5.5736295095093285, 4.776187700884737, 5.100962557562796, 5.515432502783297, 5.520035913270374, 5.329411773020983, 5.643490541553657, 5.545434596018934, 5.3458023136611805, 5.414715095449996, 5.222807787193281, 5.455417867597204, 5.161730139543693, 5.2780981319306655, 5.486538654793593, 5.541977404072814, 5.186956227598193, 4.988715957446366, 5.283184759454807, 5.4998702574635665, 5.408035470554759, 5.211685660780898, 5.526679975834682, 5.31429433400376, 5.377962367238295, 5.1763549638466655, 5.5166108733919454, 5.099065417471413, 5.406045492231976, 5.438310555746945, 5.611520514724278, 5.348825023924246, 5.307343110738043, 5.253318108255002, 5.281230838725086, 5.575249351167747, 5.26690945730942, 5.2845159820254555, 5.048199132173739, 5.438520524465934, 5.358667227702505, 5.517672584735704, 5.433983163800583, 5.340400819584113, 5.557641156563385, 5.3901839336806106, 5.495608473601139, 4.911761229295705, 5.432149534006446, 5.57797535866124, 5.398087640132392, 5.158087838959361, 5.49652053528998, 5.374566955952787, 5.467315174463003, 5.375483605960286, 5.295777953933817, 5.2558068408430785, 5.41006285024537, 5.198372251893737, 0.24915708164163797], "episode_lengths": [123, 153, 136, 70, 63, 43, 96, 162, 158, 258, 102, 202, 139, 243, 120, 73, 106, 99, 77, 230, 194, 115, 156, 328, 96, 100, 398, 188, 112, 229, 109, 117, 129, 147, 240, 103, 55, 95, 136, 86, 716, 119, 101, 125, 225, 87, 137, 104, 89, 279, 127, 141, 122, 59, 89, 185, 261, 120, 150, 117, 181, 59, 68, 159, 101, 125, 123, 169, 154, 126, 375, 141, 343, 134, 150, 61, 212, 352, 111, 181, 150, 63, 339, 178, 69, 138, 441, 149, 98, 154, 127, 167, 227, 84, 135, 184, 134, 127, 272, 144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1824068718554507, "mean_inference_ms": 1.0966461242899035, "mean_action_processing_ms": 0.10268063164785135, "mean_env_wait_ms": 1.9957078790457905, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 223776, "agent_timesteps_total": 223776, "timers": {"sample_time_ms": 6480.109, "sample_throughput": 1233.313, "load_time_ms": 3.319, "load_throughput": 2407849.554, "learn_time_ms": 6165.003, "learn_throughput": 1296.35, "update_time_ms": 2.867}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.5517556667327881, "policy_loss": -0.011248971335589886, "vf_loss": 0.5607030987739563, "vf_explained_var": 0.2939293682575226, "kl": 0.011507237330079079, "entropy": 2.328745126724243, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 223776, "num_agent_steps_sampled": 223776, "num_steps_trained": 223776, "num_agent_steps_trained": 223776}, "done": false, "episodes_total": 465, "training_iteration": 28, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-40-28", "timestamp": 1716403228, "time_this_iter_s": 13.299570798873901, "time_total_s": 275.56262493133545, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 275.56262493133545, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 34.44736842105263, "ram_util_percent": 33.38421052631578}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.670419037256011, "episode_reward_min": -0.058688011461321965, "episode_reward_mean": 5.27025836012565, "episode_len_mean": 145.51, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.98, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.02, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9600000000000002, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.245, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2689883601256506, "reward_component_totals/rejoin_dist_change_reward_min": 0.9241863476803565, "reward_component_totals/rejoin_dist_change_reward_max": 1.519759435829808, "reward_component_totals/failure_reward_mean": -0.02, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.81627, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.941, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.211685660780898, 5.526679975834682, 5.31429433400376, 5.377962367238295, 5.1763549638466655, 5.5166108733919454, 5.099065417471413, 5.406045492231976, 5.438310555746945, 5.611520514724278, 5.348825023924246, 5.307343110738043, 5.253318108255002, 5.281230838725086, 5.575249351167747, 5.26690945730942, 5.2845159820254555, 5.048199132173739, 5.438520524465934, 5.358667227702505, 5.517672584735704, 5.433983163800583, 5.340400819584113, 5.557641156563385, 5.3901839336806106, 5.495608473601139, 4.911761229295705, 5.432149534006446, 5.57797535866124, 5.398087640132392, 5.158087838959361, 5.49652053528998, 5.374566955952787, 5.467315174463003, 5.375483605960286, 5.295777953933817, 5.2558068408430785, 5.41006285024537, 5.198372251893737, 0.24915708164163797, 5.386406084328876, 5.2735563796432485, 5.070682488848509, 5.485571835526066, 5.4882441858609505, 5.445368723008534, 5.411650124044671, 5.569337831225674, 5.526093344888163, 5.16742560021104, 5.364212712737167, 5.062282330915155, 5.344087359982057, 5.314607862501566, 5.254076528230158, 5.59775943582981, 5.463007013418394, 5.3675274251781335, 5.655536934129385, 5.416902019015457, 5.50942747341162, 5.353133888699813, 5.430761644637694, 5.311770368425526, 5.612958190913418, 5.16010770277715, 5.600301918849448, 5.01014785666929, 5.096673996663367, 5.22695522122871, 5.40913157025212, 5.18099958668771, 5.670419037256011, 5.5014241929471535, 5.363866088087285, 5.400885793894535, 5.321477554357807, 5.22093794361257, 5.384420708463842, 5.210244781961759, 5.537442048833704, 5.517125841730979, 5.466831412031489, 5.375559191544169, 5.235791057187508, 5.484794610288126, 5.299179622716962, 5.55837302648974, 5.391271272637211, 5.3964872937024655, -0.058688011461321965, 5.6595342710241185, 5.55868359024083, 5.162398399467351, 5.033186347680358, 5.464413700399825, 5.636503318229795, 5.4360044618052, 5.623621349074977, 5.429017574619402], "episode_lengths": [181, 59, 68, 159, 101, 125, 123, 169, 154, 126, 375, 141, 343, 134, 150, 61, 212, 352, 111, 181, 150, 63, 339, 178, 69, 138, 441, 149, 98, 154, 127, 167, 227, 84, 135, 184, 134, 127, 272, 144, 89, 137, 178, 93, 177, 114, 153, 81, 172, 170, 91, 227, 176, 74, 130, 172, 108, 91, 93, 209, 132, 75, 123, 117, 69, 103, 98, 408, 298, 121, 155, 189, 86, 95, 78, 84, 186, 137, 81, 125, 89, 99, 138, 89, 109, 118, 122, 82, 150, 143, 34, 106, 123, 148, 141, 188, 74, 80, 111, 207]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18074191922807292, "mean_inference_ms": 1.1159682932164705, "mean_action_processing_ms": 0.10456384077761328, "mean_env_wait_ms": 2.032611193219635, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 231768, "agent_timesteps_total": 231768, "timers": {"sample_time_ms": 6499.043, "sample_throughput": 1229.72, "load_time_ms": 3.317, "load_throughput": 2409580.388, "learn_time_ms": 6157.816, "learn_throughput": 1297.863, "update_time_ms": 2.885}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.424653559923172, "policy_loss": -0.011631510220468044, "vf_loss": 0.4337387979030609, "vf_explained_var": 0.21896182000637054, "kl": 0.012731043621897697, "entropy": 2.2920994758605957, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 231768, "num_agent_steps_sampled": 231768, "num_steps_trained": 231768, "num_agent_steps_trained": 231768}, "done": false, "episodes_total": 525, "training_iteration": 29, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-40-41", "timestamp": 1716403241, "time_this_iter_s": 13.041118621826172, "time_total_s": 288.6037435531616, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 288.6037435531616, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 34.66666666666667, "ram_util_percent": 33.4}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.697989441809847, "episode_reward_min": -0.058688011461321965, "episode_reward_mean": 5.34280518586115, "episode_len_mean": 130.02, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.99, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.01, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9800000000000002, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.2475, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2749851858611492, "reward_component_totals/rejoin_dist_change_reward_min": 0.9241863476803565, "reward_component_totals/rejoin_dist_change_reward_max": 1.5189894418098477, "reward_component_totals/failure_reward_mean": -0.01, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.8503199999999997, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.959, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.612958190913418, 5.16010770277715, 5.600301918849448, 5.01014785666929, 5.096673996663367, 5.22695522122871, 5.40913157025212, 5.18099958668771, 5.670419037256011, 5.5014241929471535, 5.363866088087285, 5.400885793894535, 5.321477554357807, 5.22093794361257, 5.384420708463842, 5.210244781961759, 5.537442048833704, 5.517125841730979, 5.466831412031489, 5.375559191544169, 5.235791057187508, 5.484794610288126, 5.299179622716962, 5.55837302648974, 5.391271272637211, 5.3964872937024655, -0.058688011461321965, 5.6595342710241185, 5.55868359024083, 5.162398399467351, 5.033186347680358, 5.464413700399825, 5.636503318229795, 5.4360044618052, 5.623621349074977, 5.429017574619402, 5.2974177264220454, 5.436391627361785, 5.492910752728945, 5.291147650127778, 5.524001052981542, 5.541485188049434, 5.187822529673397, 5.414443327922185, 5.133836650810975, 5.560071090709669, 5.2230477691890895, 5.063997578108714, 5.565569205682351, 5.2280231449838315, 5.395210245432818, 5.697989441809847, 5.585588619870194, 5.286571121458055, 5.44338470158936, 5.327303124378571, 5.40555768841079, 5.261160806460731, 5.369211206435773, 5.514266451105312, 5.1889432438764675, 5.453346521827467, 5.453459665108146, 5.580531752643908, 5.243039746837984, 5.46893808362254, 5.538831491620986, 5.400089824200989, 5.238695968271719, 5.558268086767221, 5.338087757592389, 5.139730062895117, 5.397225476967576, 5.297691049052801, 5.42020937942454, 5.355770560729266, 5.627856054066608, 5.53961205518684, 5.531927621169248, 5.438155764276102, 5.483341666482806, 5.2805321666159575, 5.489547898567243, 5.4477119595098795, 5.482989538019185, 5.607854425390375, 5.39643783527089, 5.498205218753695, 5.233458436828386, 5.322668255032074, 5.476992410075607, 5.360870345549195, 5.618296856729649, 5.191423528257928, 5.514578571527687, 5.4895084262958225, 5.232628080611338, 5.229343406212857, 5.39253832390406, 5.496289845774168], "episode_lengths": [69, 103, 98, 408, 298, 121, 155, 189, 86, 95, 78, 84, 186, 137, 81, 125, 89, 99, 138, 89, 109, 118, 122, 82, 150, 143, 34, 106, 123, 148, 141, 188, 74, 80, 111, 207, 172, 138, 135, 59, 79, 103, 139, 134, 144, 66, 108, 128, 88, 133, 91, 71, 124, 90, 151, 188, 137, 96, 192, 94, 232, 140, 161, 136, 62, 195, 123, 113, 130, 80, 214, 41, 87, 197, 186, 57, 110, 162, 213, 149, 113, 91, 117, 150, 104, 122, 133, 178, 202, 305, 121, 117, 96, 70, 140, 83, 148, 132, 169, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18696181730461572, "mean_inference_ms": 1.1360552896587206, "mean_action_processing_ms": 0.10640579875833399, "mean_env_wait_ms": 2.066158885203164, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 239760, "agent_timesteps_total": 239760, "timers": {"sample_time_ms": 6601.059, "sample_throughput": 1210.715, "load_time_ms": 3.396, "load_throughput": 2353151.439, "learn_time_ms": 6196.329, "learn_throughput": 1289.796, "update_time_ms": 2.891}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.2406400442123413, "policy_loss": -0.01184854842722416, "vf_loss": 0.25019383430480957, "vf_explained_var": 0.31548410654067993, "kl": 0.011473894119262695, "entropy": 2.2973313331604004, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 239760, "num_agent_steps_sampled": 239760, "num_steps_trained": 239760, "num_agent_steps_trained": 239760}, "done": false, "episodes_total": 589, "training_iteration": 30, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-40-54", "timestamp": 1716403254, "time_this_iter_s": 13.402554988861084, "time_total_s": 302.0062985420227, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 302.0062985420227, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 33.665, "ram_util_percent": 33.470000000000006}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.65996221846976, "episode_reward_min": 0.2610427570597227, "episode_reward_mean": 5.34482328104776, "episode_len_mean": 117.12, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.99, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.01, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9800000000000002, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.2475, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2640932810477603, "reward_component_totals/rejoin_dist_change_reward_min": 0.9585468894835871, "reward_component_totals/rejoin_dist_change_reward_max": 1.4949276211692513, "reward_component_totals/failure_reward_mean": -0.01, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.8632300000000002, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.955, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.297691049052801, 5.42020937942454, 5.355770560729266, 5.627856054066608, 5.53961205518684, 5.531927621169248, 5.438155764276102, 5.483341666482806, 5.2805321666159575, 5.489547898567243, 5.4477119595098795, 5.482989538019185, 5.607854425390375, 5.39643783527089, 5.498205218753695, 5.233458436828386, 5.322668255032074, 5.476992410075607, 5.360870345549195, 5.618296856729649, 5.191423528257928, 5.514578571527687, 5.4895084262958225, 5.232628080611338, 5.229343406212857, 5.39253832390406, 5.496289845774168, 5.518066460558883, 5.528442985572646, 5.331314163988944, 5.247611417762105, 5.6188357018985755, 5.4840748644503226, 5.260049935127203, 5.451814903861725, 5.443898688644773, 5.172517851044083, 5.566658950846433, 5.542290439647324, 5.285937442870857, 5.223475161500631, 5.37240337640619, 5.532975753585447, 5.456829087624726, 5.502504142827755, 5.542129921872549, 5.336222245871742, 5.362399198868692, 5.196781986974307, 5.3539183741139045, 5.433972096088496, 5.18469846676063, 5.447742484574431, 5.336663112786523, 5.579403502821437, 5.5243016296215215, 5.495238565632254, 5.2851483812862305, 5.069239641128368, 5.3781192515671155, 5.427046184826418, 5.350269369242988, 5.193807391255882, 5.545576255456976, 5.2740477847652265, 5.285077954453655, 5.41589992696378, 5.172500861439165, 5.403899529072941, 5.645809736669249, 5.376024810850727, 5.500707115769522, 5.393351804058012, 5.181488390417383, 5.546454042933638, 5.366643156384607, 5.602784700638447, 5.212049908772741, 5.231101607778011, 5.536818153174209, 5.138661864501907, 5.30432435769532, 5.40327517291508, 5.162132325774121, 5.560584159522007, 5.263499965093246, 5.583503511032422, 5.164661008683193, 5.459301677069641, 5.143668023778073, 5.529192319611896, 5.137223885855281, 5.518489181684783, 5.24531338764506, 5.498885320379969, 5.65996221846976, 0.2610427570597227, 5.576686275609452, 5.140546889483588, 5.547895250486922], "episode_lengths": [197, 186, 57, 110, 162, 213, 149, 113, 91, 117, 150, 104, 122, 133, 178, 202, 305, 121, 117, 96, 70, 140, 83, 148, 132, 169, 99, 68, 196, 79, 182, 67, 65, 66, 157, 153, 89, 127, 127, 136, 85, 82, 75, 146, 89, 128, 80, 104, 182, 75, 296, 127, 101, 166, 105, 90, 72, 166, 158, 100, 64, 102, 114, 61, 100, 184, 94, 148, 55, 84, 176, 92, 188, 87, 91, 88, 123, 146, 72, 157, 117, 57, 59, 71, 117, 95, 98, 147, 45, 111, 106, 90, 108, 70, 103, 67, 35, 123, 68, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18909936155750182, "mean_inference_ms": 1.1527461565303563, "mean_action_processing_ms": 0.10829349268887806, "mean_env_wait_ms": 2.1010577312430465, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 247752, "agent_timesteps_total": 247752, "timers": {"sample_time_ms": 6643.171, "sample_throughput": 1203.04, "load_time_ms": 3.428, "load_throughput": 2331238.443, "learn_time_ms": 6232.3, "learn_throughput": 1282.352, "update_time_ms": 2.92}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.21043196320533752, "policy_loss": -0.012489055283367634, "vf_loss": 0.22072522342205048, "vf_explained_var": 0.39770618081092834, "kl": 0.010978874750435352, "entropy": 2.2373883724212646, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 247752, "num_agent_steps_sampled": 247752, "num_steps_trained": 247752, "num_agent_steps_trained": 247752}, "done": false, "episodes_total": 662, "training_iteration": 31, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-41-08", "timestamp": 1716403268, "time_this_iter_s": 13.70124077796936, "time_total_s": 315.70753931999207, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 315.70753931999207, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 35.147368421052626, "ram_util_percent": 33.36315789473684}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.664471564420655, "episode_reward_min": -0.08168797814574347, "episode_reward_mean": 5.251149938012122, "episode_len_mean": 100.08, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.97, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.03, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9400000000000004, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.2425, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.258069938012122, "reward_component_totals/rejoin_dist_change_reward_min": 0.9183120218542565, "reward_component_totals/rejoin_dist_change_reward_max": 1.502777286129788, "reward_component_totals/failure_reward_mean": -0.03, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.8405799999999999, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.955, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.536818153174209, 5.138661864501907, 5.30432435769532, 5.40327517291508, 5.162132325774121, 5.560584159522007, 5.263499965093246, 5.583503511032422, 5.164661008683193, 5.459301677069641, 5.143668023778073, 5.529192319611896, 5.137223885855281, 5.518489181684783, 5.24531338764506, 5.498885320379969, 5.65996221846976, 0.2610427570597227, 5.576686275609452, 5.140546889483588, 5.547895250486922, 5.460216260676345, 5.517338219606514, 5.505463263836824, 5.225074181222288, 5.550579062076057, 5.457650454590051, 5.577447395177781, 5.241153473211421, 5.219292571176014, 5.449120708353729, 0.07238736474644769, 5.386009138059696, 5.338447442997077, 5.649032071978169, 5.177855502849496, 5.594526145994535, 5.501399977773277, 5.573527085328363, 5.5969144758690454, 5.403751500055019, 5.248328875161215, 5.101881068592729, 5.485080448563094, 5.341947731029974, 5.248597800771131, 5.2740858976425375, 5.445565851079495, 5.325867795931256, 5.410995976827465, 5.4870606468389695, 5.504822630211647, 5.653532637041394, 5.529116698512709, 5.538943548692711, 5.413597141706223, 5.426659403110726, 5.119209626882528, 5.338485968137507, 5.618075650992809, 5.602640965314625, 5.6128738105445155, 5.223217714936417, 5.452776911940713, 5.295213609020104, 5.603803802575577, -0.08168797814574347, 5.314639880874012, 5.155386897997472, 5.5434548546499105, 5.328430387630046, 5.31003888054179, 5.314283763648775, 5.389843538458071, 5.6119205879584655, 5.462262795977024, 5.369839069533559, 5.414179062502322, 5.2675239503440165, 5.331495865357088, 5.5286933958963775, 5.579740187222385, 5.283615975497511, 5.111234276429727, 5.322143853234165, 5.664471564420655, 5.570426013154448, 5.393591361843741, 5.319940437149025, 5.596186423244073, 5.501172080291765, 5.480348251113018, 5.493132623157974, 5.466034981556854, 5.094568210549166, 5.591768995146939, 5.409442929884278, 5.171901981338653, 5.5069552034630185, 5.6627772861297885], "episode_lengths": [157, 117, 57, 59, 71, 117, 95, 98, 147, 45, 111, 106, 90, 108, 70, 103, 67, 35, 123, 68, 96, 95, 112, 87, 72, 93, 114, 67, 240, 138, 154, 12, 142, 162, 74, 106, 70, 203, 160, 81, 124, 129, 139, 78, 161, 87, 72, 100, 66, 71, 62, 96, 58, 113, 163, 141, 100, 100, 122, 97, 128, 64, 98, 75, 52, 91, 19, 82, 87, 138, 95, 122, 131, 66, 108, 153, 124, 94, 141, 109, 64, 71, 82, 77, 106, 55, 111, 76, 105, 126, 136, 120, 95, 61, 82, 92, 77, 97, 107, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19295536260758867, "mean_inference_ms": 1.1674317047572151, "mean_action_processing_ms": 0.10980080095827305, "mean_env_wait_ms": 2.131655204087499, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 255744, "agent_timesteps_total": 255744, "timers": {"sample_time_ms": 6722.333, "sample_throughput": 1188.873, "load_time_ms": 3.454, "load_throughput": 2313907.071, "learn_time_ms": 6255.418, "learn_throughput": 1277.613, "update_time_ms": 2.939}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.15913254022598267, "policy_loss": -0.014735688455402851, "vf_loss": 0.1714884638786316, "vf_explained_var": 0.5076152682304382, "kl": 0.011898783966898918, "entropy": 2.204925775527954, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 255744, "num_agent_steps_sampled": 255744, "num_steps_trained": 255744, "num_agent_steps_trained": 255744}, "done": false, "episodes_total": 741, "training_iteration": 32, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-41-21", "timestamp": 1716403281, "time_this_iter_s": 13.251622200012207, "time_total_s": 328.9591615200043, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 328.9591615200043, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 34.42631578947368, "ram_util_percent": 33.33157894736841}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.685897774166877, "episode_reward_min": 5.0390435962045625, "episode_reward_mean": 5.414587073128223, "episode_len_mean": 97.04, "episode_media": {}, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.261627073128222, "reward_component_totals/rejoin_dist_change_reward_min": 0.908625000418019, "reward_component_totals/rejoin_dist_change_reward_max": 1.5208977741668777, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.90296, "reward_component_totals/success_reward_min": 1.823, "reward_component_totals/success_reward_max": 1.951}, "hist_stats": {"episode_reward": [5.283615975497511, 5.111234276429727, 5.322143853234165, 5.664471564420655, 5.570426013154448, 5.393591361843741, 5.319940437149025, 5.596186423244073, 5.501172080291765, 5.480348251113018, 5.493132623157974, 5.466034981556854, 5.094568210549166, 5.591768995146939, 5.409442929884278, 5.171901981338653, 5.5069552034630185, 5.6627772861297885, 5.561332049586467, 5.246661751835853, 5.5743786829642215, 5.338906323710285, 5.523329741214629, 5.565362585738248, 5.479093830688254, 5.1282218179469625, 5.326089487007168, 5.165296114501842, 5.537444062990852, 5.456785339750146, 5.658306746602333, 5.605699399195686, 5.597250795718981, 5.5552888291277185, 5.507377062445223, 5.685897774166877, 5.358959084153613, 5.522820822195594, 5.600185332909229, 5.1591309959459135, 5.554576129359163, 5.5918820583331055, 5.407772640057414, 5.130395330730213, 5.499396493980215, 5.489552399111306, 5.406005903924489, 5.449289209558817, 5.508984598172341, 5.605645131489729, 5.256259132115181, 5.62021593437183, 5.475922003673698, 5.497906479672134, 5.634996466649797, 5.141275880151404, 5.317484875254402, 5.560548303456693, 5.254235293979381, 5.283301557719318, 5.479082775711533, 5.526167404238564, 5.456437562065969, 5.4549338250039066, 5.496704438936367, 5.2275189180161075, 5.455580709075816, 5.173386948667229, 5.385197132874305, 5.23359593246685, 5.433370286015626, 5.539761941682363, 5.292617718070272, 5.639243554608724, 5.313816375658131, 5.262213279307066, 5.345852389215273, 5.417325632097084, 5.500993355232647, 5.250995891605978, 5.469491455462008, 5.145715682567685, 5.305914532803821, 5.255524049516374, 5.530248927088092, 5.65139352709292, 5.475966356842848, 5.461527723457278, 5.427656882553029, 5.327683608681889, 5.6049945689181, 5.118914239825267, 5.170981520070757, 5.535371796229041, 5.6227219214394015, 5.2507166979236235, 5.0390435962045625, 5.480325299100249, 5.121916956315905, 5.09862500041802], "episode_lengths": [82, 77, 106, 55, 111, 76, 105, 126, 136, 120, 95, 61, 82, 92, 77, 97, 107, 90, 165, 108, 67, 82, 132, 103, 114, 121, 93, 101, 64, 167, 62, 104, 76, 108, 147, 85, 139, 127, 107, 109, 64, 99, 154, 76, 98, 67, 93, 55, 71, 108, 70, 93, 164, 61, 80, 156, 124, 106, 106, 67, 92, 78, 67, 156, 141, 69, 62, 89, 91, 80, 93, 115, 107, 117, 114, 93, 85, 71, 177, 89, 100, 100, 66, 83, 85, 73, 66, 49, 99, 56, 136, 66, 95, 76, 72, 107, 168, 61, 112, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19692093214903716, "mean_inference_ms": 1.1831893808017224, "mean_action_processing_ms": 0.11135442501154785, "mean_env_wait_ms": 2.1629636671507, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 263736, "agent_timesteps_total": 263736, "timers": {"sample_time_ms": 6834.962, "sample_throughput": 1169.282, "load_time_ms": 3.453, "load_throughput": 2314402.329, "learn_time_ms": 6281.122, "learn_throughput": 1272.384, "update_time_ms": 2.921}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10530123114585876, "policy_loss": -0.011937868781387806, "vf_loss": 0.11514230072498322, "vf_explained_var": 0.5990309715270996, "kl": 0.010484077967703342, "entropy": 2.130659818649292, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 263736, "num_agent_steps_sampled": 263736, "num_steps_trained": 263736, "num_agent_steps_trained": 263736}, "done": false, "episodes_total": 823, "training_iteration": 33, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-41-35", "timestamp": 1716403295, "time_this_iter_s": 13.708256721496582, "time_total_s": 342.66741824150085, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 342.66741824150085, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 34.42, "ram_util_percent": 33.39999999999999}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.654877130748423, "episode_reward_min": -0.05537737535175569, "episode_reward_mean": 5.301365014079075, "episode_len_mean": 89.43, "episode_media": {}, "episodes_this_iter": 89, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.98, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.02, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9600000000000002, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.245, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2453050140790758, "reward_component_totals/rejoin_dist_change_reward_min": 0.908625000418019, "reward_component_totals/rejoin_dist_change_reward_max": 1.5003056223044728, "reward_component_totals/failure_reward_mean": -0.02, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.8710600000000002, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.9529999999999998, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.327683608681889, 5.6049945689181, 5.118914239825267, 5.170981520070757, 5.535371796229041, 5.6227219214394015, 5.2507166979236235, 5.0390435962045625, 5.480325299100249, 5.121916956315905, 5.09862500041802, 5.544061218228479, 0.1675831939824537, 5.426858244718234, 5.434712695522331, 5.2837988747274975, 5.308337116142058, 5.504218078139928, 5.621574940285948, 5.43991142459165, 5.323282747108561, 5.5857125290384815, 5.384425035039953, 5.282677709204712, 5.274520432170052, 5.572155392505938, 5.334422539967181, -0.05537737535175569, 5.522042389869506, 5.281751890738669, 5.456847117226623, 5.275746419006879, 5.343732023333123, 5.404179857054894, 5.193281738511111, 5.591875225798816, 5.230073629600462, 5.411789900703199, 5.637305622304472, 5.336056564591133, 5.447531368029105, 5.546408808294808, 5.631980400049099, 5.355623528209923, 5.504419082731834, 5.265493345210894, 5.541502640439791, 5.340469828149308, 5.155864232601154, 5.526302145459304, 5.32992684168998, 5.548366979531894, 5.19705252126388, 5.6278467595794, 5.393224497848382, 5.281228448997236, 5.537987871402613, 5.402882051213903, 5.456851307280842, 5.454832237357916, 5.322555793709837, 5.234638347464894, 5.239543268080902, 5.152837518082855, 5.53688490400604, 5.56539459169643, 5.6348652341554955, 5.654877130748423, 5.587420226963374, 5.206901113509495, 5.4996601301682695, 5.464465724509962, 5.363839948239996, 5.6234010508930155, 5.609572978346001, 5.300644304787018, 5.472724376037776, 5.4020557884509355, 5.524815724595289, 5.594304977612049, 5.325019270214858, 5.577748659236562, 5.334949861283036, 5.269866919307439, 5.610825895217435, 5.595238305061571, 5.591384357810613, 5.463233685411442, 5.5329921713295604, 5.4717299643466575, 5.378140205278989, 5.37354524854042, 5.291073491271828, 5.346927435022781, 5.3076094199905866, 5.337714547073215, 5.181080821453755, 5.424805620116427, 5.517902989184588, 5.178662133469109], "episode_lengths": [56, 136, 66, 95, 76, 72, 107, 168, 61, 112, 60, 106, 31, 47, 134, 102, 122, 97, 76, 53, 106, 57, 166, 169, 79, 79, 91, 18, 88, 107, 56, 104, 74, 84, 67, 104, 144, 110, 113, 85, 129, 128, 112, 62, 65, 87, 61, 88, 100, 87, 92, 110, 102, 61, 117, 60, 93, 120, 73, 74, 68, 87, 68, 116, 96, 90, 82, 73, 107, 78, 94, 79, 83, 71, 124, 53, 59, 55, 94, 80, 70, 76, 76, 53, 87, 83, 102, 144, 87, 114, 50, 60, 66, 69, 89, 98, 119, 111, 89, 144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20044402455543905, "mean_inference_ms": 1.1982394434735524, "mean_action_processing_ms": 0.11271466812267661, "mean_env_wait_ms": 2.192588422215793, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 271728, "agent_timesteps_total": 271728, "timers": {"sample_time_ms": 6890.933, "sample_throughput": 1159.785, "load_time_ms": 3.501, "load_throughput": 2282707.687, "learn_time_ms": 6305.242, "learn_throughput": 1267.517, "update_time_ms": 2.927}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.14189693331718445, "policy_loss": -0.007940046489238739, "vf_loss": 0.14784827828407288, "vf_explained_var": 0.5637714862823486, "kl": 0.009943374432623386, "entropy": 2.0757057666778564, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 271728, "num_agent_steps_sampled": 271728, "num_steps_trained": 271728, "num_agent_steps_trained": 271728}, "done": false, "episodes_total": 912, "training_iteration": 34, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-41-48", "timestamp": 1716403308, "time_this_iter_s": 13.422882318496704, "time_total_s": 356.09030055999756, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 356.09030055999756, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 34.57368421052631, "ram_util_percent": 33.43684210526315}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.67325373366903, "episode_reward_min": -0.059138862312339446, "episode_reward_mean": 5.290864331547601, "episode_len_mean": 88.37, "episode_media": {}, "episodes_this_iter": 90, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.98, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.02, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9600000000000002, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.245, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2337043315476013, "reward_component_totals/rejoin_dist_change_reward_min": 0.9285851978987907, "reward_component_totals/rejoin_dist_change_reward_max": 1.491697237155219, "reward_component_totals/failure_reward_mean": -0.02, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.8721599999999998, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.9569999999999999, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.378140205278989, 5.37354524854042, 5.291073491271828, 5.346927435022781, 5.3076094199905866, 5.337714547073215, 5.181080821453755, 5.424805620116427, 5.517902989184588, 5.178662133469109, 5.492655281553822, 5.261942974224409, 5.470348621085745, 5.291387823644843, 5.347961233457976, 5.10858519789879, 5.425361468297334, 5.479110726558893, 5.633011455402814, 5.437127000573048, 5.67325373366903, 5.336100891431936, 5.2161226940868755, 5.5726156130210445, 5.211629423422098, 5.45883293031525, 5.357301765995227, 5.439397854236844, 5.530455314315196, 5.3433363571372245, 5.162431355267646, 5.227199497781692, 5.420111588642493, 5.196497109681165, 5.504472378347962, 5.496567668784826, 5.305175602246857, 5.432199105976, 5.163772861607037, 5.477402935461123, 5.434139539160448, 5.560185713337175, 5.188676140695091, 5.186661698004959, 5.33175324620597, 5.544950987918056, 5.43984533259142, 5.322002329618227, 5.403959838437869, 5.378069976436651, 5.543399832569596, 5.455605147518497, 5.2847984067987985, 5.448143773303004, 5.465877626250366, 5.48222187392965, 5.5367355611789275, 5.440685155694258, 5.262271249066124, 5.4716383763832654, 5.5130729729312895, 5.5198528745565465, 5.5498630065547925, 5.589846861131383, 5.274372665920348, 5.293654379522717, 5.139881949747053, 5.668697237155218, 5.3120872004813044, 5.541873591021179, 5.476254218256269, 5.419257232607023, 5.30218790134842, 5.323805066340467, 5.338672303275247, 5.618484577536016, 5.4017312868558625, 5.2223126706064855, 5.150835915447885, 5.517296984744423, 5.6495237766257915, 5.38463821979968, 5.49520346446027, 5.308969484163828, 5.603826479006064, 5.5779468746986485, 5.40499395384276, 5.393785375327486, 5.643867836647824, 5.300587108174894, 5.457759858734939, 5.375353879395531, 5.66695488612746, 5.551310170333995, -0.05604930312194134, 5.20317219489508, -0.059138862312339446, 5.417760436090065, 5.25368046955931, 5.346793775645619], "episode_lengths": [50, 60, 66, 69, 89, 98, 119, 111, 89, 144, 137, 63, 156, 70, 52, 70, 116, 84, 82, 52, 60, 118, 85, 117, 106, 81, 99, 67, 75, 110, 45, 83, 126, 106, 93, 185, 60, 86, 74, 71, 66, 79, 103, 71, 75, 122, 72, 53, 74, 127, 111, 89, 91, 75, 52, 92, 133, 94, 50, 112, 62, 95, 80, 58, 88, 72, 66, 73, 95, 89, 124, 85, 89, 70, 51, 53, 84, 43, 70, 111, 69, 151, 132, 84, 135, 108, 141, 92, 59, 101, 138, 139, 50, 92, 35, 60, 18, 86, 78, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2046617323097787, "mean_inference_ms": 1.21156008287325, "mean_action_processing_ms": 0.11395803319316343, "mean_env_wait_ms": 2.2184020904821433, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 279720, "agent_timesteps_total": 279720, "timers": {"sample_time_ms": 6932.688, "sample_throughput": 1152.8, "load_time_ms": 3.499, "load_throughput": 2284232.095, "learn_time_ms": 6323.028, "learn_throughput": 1263.951, "update_time_ms": 2.952}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.16385354101657867, "policy_loss": -0.013258201070129871, "vf_loss": 0.17495951056480408, "vf_explained_var": 0.5292922258377075, "kl": 0.010761214420199394, "entropy": 2.0493884086608887, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 279720, "num_agent_steps_sampled": 279720, "num_steps_trained": 279720, "num_agent_steps_trained": 279720}, "done": false, "episodes_total": 1002, "training_iteration": 35, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-42-02", "timestamp": 1716403322, "time_this_iter_s": 13.585677862167358, "time_total_s": 369.6759784221649, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 369.6759784221649, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 34.93157894736842, "ram_util_percent": 33.5}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.662421959118342, "episode_reward_min": -0.059138862312339446, "episode_reward_mean": 5.312509236414208, "episode_len_mean": 85.37, "episode_media": {}, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.98, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.02, "outcome/failure_min": 0, "outcome/failure_max": 1, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0, "reward_component_totals/rejoin_reward_mean": 1.9600000000000002, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.245, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2523492364142077, "reward_component_totals/rejoin_dist_change_reward_min": 0.9408611376876606, "reward_component_totals/rejoin_dist_change_reward_max": 1.4919225666358553, "reward_component_totals/failure_reward_mean": -0.02, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.87516, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.958}, "hist_stats": {"episode_reward": [-0.05604930312194134, 5.20317219489508, -0.059138862312339446, 5.417760436090065, 5.25368046955931, 5.346793775645619, 5.219371967147481, 5.490495470894553, 5.2642476578782755, 5.457746482130817, 5.574924158669808, 5.6469225666358565, 5.366592149394855, 5.275493327644423, 5.605321630198578, 5.142192133378103, 5.61868331075441, 5.453336109666676, 5.390580151888418, 5.50997443714591, 5.564419941914805, 5.369932723085579, 5.519877942863646, 5.4242400299960885, 5.250884527218004, 5.4168586841742465, 5.561367663290059, 5.37353952738599, 5.426856197386529, 5.515013326407171, 5.217946085117243, 5.33190255208884, 5.428010249531824, 5.514356711662448, 5.529817362747445, 5.310652503406674, 5.439616963260118, 5.5349058895701475, 5.275396839439325, 5.386666163451596, 5.468631752336309, 5.170418361499719, 5.198492292677294, 5.641843457428186, 5.5080560990439995, 5.4904642628747515, 5.169493681290038, 5.511897819836369, 5.620749207421973, 5.6394943992419515, 5.590593848729872, 5.463009851136352, 5.3895114317606945, 5.547170029553198, 5.611626346332595, 5.3262084177125715, 5.534379052400045, 5.228981391134511, 5.5200220233315145, 5.607620548247405, 5.631645595935613, 5.499173971986558, 5.459847382694393, 5.509409292445014, 5.248729008081016, 5.422311425384302, 5.245986318078466, 5.450079308140976, 5.330295967014045, 5.547533763280443, 5.154474219204739, 5.461424576853215, 5.200426885726619, 5.421302280049469, 5.538998966696202, 5.397808110979306, 5.523088367626272, 5.653710878889388, 5.550307824480763, 5.569727863490234, 5.5976532744508445, 5.135321509487357, 5.15981321190028, 5.3068315297454465, 5.3481576369302, 5.510883901567304, 5.5393334755988235, 5.3497028055332185, 5.235430795338886, 5.486871308560184, 5.556171045056287, 5.430864356333609, 5.265919258514196, 5.235321830771806, 5.2484812916092185, 5.505102774744248, 5.662421959118342, 5.223663444737258, 5.372552412420395, 5.511117389794767], "episode_lengths": [35, 60, 18, 86, 78, 146, 97, 77, 117, 53, 156, 95, 97, 76, 66, 81, 87, 61, 63, 76, 60, 57, 57, 85, 92, 84, 84, 98, 78, 80, 60, 56, 70, 98, 169, 125, 47, 53, 51, 86, 104, 102, 53, 85, 132, 125, 42, 69, 50, 52, 102, 108, 172, 147, 66, 90, 88, 108, 102, 94, 87, 96, 53, 87, 51, 69, 87, 164, 100, 108, 54, 78, 77, 55, 145, 73, 146, 66, 105, 85, 75, 93, 61, 194, 70, 63, 77, 76, 88, 111, 62, 143, 52, 80, 79, 53, 61, 65, 49, 93]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2090955831208006, "mean_inference_ms": 1.2246372086892603, "mean_action_processing_ms": 0.11523264694528113, "mean_env_wait_ms": 2.243440792698445, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 287712, "agent_timesteps_total": 287712, "timers": {"sample_time_ms": 7003.902, "sample_throughput": 1141.078, "load_time_ms": 3.521, "load_throughput": 2269524.548, "learn_time_ms": 6349.743, "learn_throughput": 1258.634, "update_time_ms": 3.015}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0973484069108963, "policy_loss": -0.01255124807357788, "vf_loss": 0.10771860182285309, "vf_explained_var": 0.6318879127502441, "kl": 0.010905289091169834, "entropy": 2.0273118019104004, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 287712, "num_agent_steps_sampled": 287712, "num_steps_trained": 287712, "num_agent_steps_trained": 287712}, "done": false, "episodes_total": 1096, "training_iteration": 36, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-42-16", "timestamp": 1716403336, "time_this_iter_s": 13.684215307235718, "time_total_s": 383.36019372940063, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 383.36019372940063, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 34.36, "ram_util_percent": 33.540000000000006}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.68301229125136, "episode_reward_min": 0.16772916934632742, "episode_reward_mean": 5.186564160515083, "episode_len_mean": 82.71, "episode_media": {}, "episodes_this_iter": 97, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.96, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.04, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9200000000000004, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.228244160515083, "reward_component_totals/rejoin_dist_change_reward_min": 0.9516304618259959, "reward_component_totals/rejoin_dist_change_reward_max": 1.4964025088250477, "reward_component_totals/failure_reward_mean": -0.04, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.83832, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.96, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.223663444737258, 5.372552412420395, 5.511117389794767, 5.351127904072383, 5.396328799722958, 5.300288787198907, 5.424231323409606, 5.357487766034123, 5.309803987348378, 5.449214034909362, 5.5837106657346345, 5.242052723767628, 5.128389677077788, 0.2599211357578186, 5.410811395214529, 5.447256706907942, 5.422337580040315, 5.629598394288022, 5.68301229125136, 5.379635501098636, 5.494966680665242, 5.356826837049533, 5.377886903629536, 5.289787428255544, 5.145630461825997, 5.278272280669958, 5.187407084360082, 5.460402024189119, 5.480044275163078, 5.408192566856246, 5.259643987243802, 5.646212684178986, 5.441779506374759, 5.221385968305231, 5.462086870386244, 0.16772916934632742, 0.21782049565913453, 5.445024644153702, 5.55029626232154, 5.243534607862607, 5.354710622986889, 5.3573741848678855, 5.377004144281396, 5.585853855293872, 5.170328236988761, 5.618633231853247, 5.334679027678629, 5.253799564781984, 5.285136795121173, 5.424240290796702, 5.213778446468735, 5.468005145091231, 0.3933707654630434, 5.075862046496741, 5.418503235789596, 5.254425073948044, 5.221315653810901, 5.188725634638994, 5.533692198210058, 5.476070662462407, 5.202942119578725, 5.623265212426983, 5.4397022582265, 5.490242870456543, 5.24613811175249, 5.573891506353604, 5.3076179674325905, 5.383330760329445, 5.461921370998425, 5.639073738433529, 5.169198536482867, 5.536734910881046, 5.208052630679495, 5.273022964024721, 5.639684218961783, 5.35237204800047, 5.682402508825048, 5.6204070314030785, 5.48996990004404, 5.242196089664389, 5.400259004297007, 5.4632339346003675, 5.529138986432334, 5.428549469581046, 5.502851181840724, 5.314073817327562, 5.591283931978094, 5.512118939469367, 5.196343059948977, 5.213826720746798, 5.30957633007926, 5.295196252015672, 5.271533378310111, 5.486579246751522, 5.316515187364734, 5.328321776467037, 5.485738489261095, 5.244573337194599, 5.615429810515588, 5.54612496605686], "episode_lengths": [65, 49, 93, 125, 88, 69, 120, 115, 147, 89, 80, 79, 78, 49, 60, 81, 110, 52, 59, 54, 123, 104, 112, 134, 56, 69, 93, 76, 85, 53, 104, 78, 89, 130, 82, 13, 21, 106, 105, 85, 97, 70, 67, 106, 60, 64, 50, 77, 148, 60, 84, 73, 20, 194, 66, 57, 73, 45, 89, 57, 91, 97, 68, 81, 81, 61, 81, 71, 109, 54, 125, 106, 96, 75, 60, 40, 64, 68, 112, 114, 86, 73, 108, 72, 84, 75, 89, 77, 114, 81, 87, 75, 60, 82, 83, 93, 79, 94, 82, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20939506726387527, "mean_inference_ms": 1.237429987542682, "mean_action_processing_ms": 0.11629403203639985, "mean_env_wait_ms": 2.2674157202271283, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 295704, "agent_timesteps_total": 295704, "timers": {"sample_time_ms": 7062.533, "sample_throughput": 1131.605, "load_time_ms": 3.568, "load_throughput": 2239966.693, "learn_time_ms": 6370.919, "learn_throughput": 1254.45, "update_time_ms": 3.041}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.14913520216941833, "policy_loss": -0.015554712153971195, "vf_loss": 0.16203998029232025, "vf_explained_var": 0.5686121582984924, "kl": 0.013249489478766918, "entropy": 2.0115036964416504, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 295704, "num_agent_steps_sampled": 295704, "num_steps_trained": 295704, "num_agent_steps_trained": 295704}, "done": false, "episodes_total": 1193, "training_iteration": 37, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-42-29", "timestamp": 1716403349, "time_this_iter_s": 13.447401523590088, "time_total_s": 396.8075952529907, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 396.8075952529907, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 35.17368421052631, "ram_util_percent": 33.61052631578948}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.670009360113827, "episode_reward_min": 0.31580903906733804, "episode_reward_mean": 5.361872049727364, "episode_len_mean": 80.49, "episode_media": {}, "episodes_this_iter": 99, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.99, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.01, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9800000000000002, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.2475, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.244572049727364, "reward_component_totals/rejoin_dist_change_reward_min": 0.9197349280872134, "reward_component_totals/rejoin_dist_change_reward_max": 1.5060093601138265, "reward_component_totals/failure_reward_mean": -0.01, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.8997999999999997, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.955, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.54612496605686, 5.146863415989996, 5.343286973553581, 5.278894649485118, 5.5425978717817035, 5.456464274533523, 5.611471397035993, 5.433518819933722, 5.1197349280872135, 5.183759569986249, 5.45726427154129, 5.259637144451604, 5.518128935792945, 5.593008150211238, 5.6411190545713, 5.642769901366629, 5.462397364816018, 5.366809723144323, 0.31580903906733804, 5.371012047728428, 5.45427793233278, 5.400431529746263, 5.334902328828552, 5.421642852329718, 5.308222103041879, 5.577268749745539, 5.4490205010725425, 5.477491941717542, 5.3084580825448064, 5.3144963557487825, 5.464061614814043, 5.570054413175811, 5.608454490697294, 5.223538603438158, 5.383049051942904, 5.3268626481334636, 5.564930454083754, 5.352051715804302, 5.616328026336178, 5.475386702766201, 5.378115417725228, 5.196719083301151, 5.311860022920471, 5.5095372258511945, 5.570201058497798, 5.384242949957512, 5.479582015999379, 5.350809072418662, 5.491316505577384, 5.24123278804632, 5.337266946809163, 5.583612755872772, 5.189420388050542, 5.3802250047935045, 5.60220851926473, 5.571577164491036, 5.538687411238991, 5.507634105080841, 5.670009360113827, 5.451515283863078, 5.3511750139258165, 5.221887703042398, 5.6698249565141055, 5.594999064767437, 5.356681416591373, 5.310654646471448, 5.563116341468515, 5.506985115232631, 5.261024984103464, 5.43112111827152, 5.609020457771362, 5.272735768302663, 5.274983659005332, 5.145381863133956, 5.1516115393354465, 5.4513357313735415, 5.568956710013277, 5.2416478290323525, 5.140143083458001, 5.302647307887131, 5.184563268799096, 5.3889391792824775, 5.320859144180764, 5.189471030578153, 5.4326417404942795, 5.608857571835889, 5.608057029255324, 5.420607496504415, 5.192574260655455, 5.223765568204506, 5.47504908794008, 5.498769509341491, 5.393864814490628, 5.528573475189382, 5.578743642042239, 5.207760274397046, 5.58046336189107, 5.434871541828972, 5.198632054362138, 5.626830934452082], "episode_lengths": [86, 103, 99, 63, 101, 64, 76, 63, 50, 53, 146, 78, 59, 88, 71, 62, 85, 73, 29, 104, 72, 74, 93, 89, 82, 87, 81, 74, 46, 59, 119, 111, 79, 90, 64, 93, 55, 83, 113, 65, 97, 59, 45, 138, 57, 48, 86, 58, 52, 58, 56, 85, 84, 85, 82, 112, 54, 106, 86, 56, 61, 122, 64, 68, 69, 78, 112, 143, 95, 66, 89, 90, 68, 107, 86, 82, 56, 93, 48, 103, 91, 76, 57, 101, 116, 55, 54, 62, 113, 86, 69, 150, 85, 69, 73, 77, 62, 78, 80, 109]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21472817549701823, "mean_inference_ms": 1.247589572688838, "mean_action_processing_ms": 0.11722207459342217, "mean_env_wait_ms": 2.287340523198734, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 303696, "agent_timesteps_total": 303696, "timers": {"sample_time_ms": 7068.029, "sample_throughput": 1130.725, "load_time_ms": 3.382, "load_throughput": 2363388.015, "learn_time_ms": 6355.171, "learn_throughput": 1257.559, "update_time_ms": 3.045}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.09816189110279083, "policy_loss": -0.010889890603721142, "vf_loss": 0.10685757547616959, "vf_explained_var": 0.6148073077201843, "kl": 0.010970989242196083, "entropy": 1.950016975402832, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 303696, "num_agent_steps_sampled": 303696, "num_steps_trained": 303696, "num_agent_steps_trained": 303696}, "done": false, "episodes_total": 1292, "training_iteration": 38, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-42-42", "timestamp": 1716403362, "time_this_iter_s": 13.194779634475708, "time_total_s": 410.00237488746643, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 410.00237488746643, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 34.142105263157895, "ram_util_percent": 33.5}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.670854201860303, "episode_reward_min": 5.095934003442577, "episode_reward_mean": 5.416584488427593, "episode_len_mean": 83.33, "episode_media": {}, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2499144884275928, "reward_component_totals/rejoin_dist_change_reward_min": 0.9189340034425757, "reward_component_totals/rejoin_dist_change_reward_max": 1.4938542018603023, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.91667, "reward_component_totals/success_reward_min": 1.847, "reward_component_totals/success_reward_max": 1.9529999999999998}, "hist_stats": {"episode_reward": [5.578743642042239, 5.207760274397046, 5.58046336189107, 5.434871541828972, 5.198632054362138, 5.626830934452082, 5.370057524359257, 5.170867384921939, 5.402229474183542, 5.562717817076, 5.52014238697771, 5.428086399065951, 5.592011544050392, 5.293526744541097, 5.35983791295861, 5.571935015958716, 5.146093985028685, 5.386210184868805, 5.230713410511183, 5.310361404146667, 5.143410089375362, 5.204334990570595, 5.251815057163732, 5.291935834318915, 5.670854201860303, 5.321699152284013, 5.570811885583285, 5.32240759345909, 5.60685779539441, 5.244109433613941, 5.634164497831865, 5.388717818939153, 5.501221410756159, 5.504624896621454, 5.144995055013196, 5.423349771472512, 5.588623670029987, 5.232983081684273, 5.491174294548632, 5.143377306086613, 5.304827572339179, 5.5768209295926745, 5.456467296974433, 5.237463537770836, 5.326982478866407, 5.557664038528026, 5.211594256485689, 5.2992394297679795, 5.205813902718678, 5.343998746257759, 5.471035229454509, 5.389901793811796, 5.318079718308799, 5.553313213430981, 5.577495814388991, 5.602173782778195, 5.519245359121752, 5.516089767304842, 5.5614860285470105, 5.4348940658476295, 5.348105357809684, 5.379713641077828, 5.609482791979095, 5.607307995258975, 5.406022754443963, 5.524846124248107, 5.419674079700167, 5.600984613420868, 5.49677308084359, 5.394940744692999, 5.373586955859211, 5.323857340466958, 5.350884359932959, 5.548640046383933, 5.5147932698414195, 5.222573637558549, 5.095934003442577, 5.5859931277245165, 5.63367848806376, 5.581777798482431, 5.630674453567979, 5.268146617889748, 5.5654634626327315, 5.214243648970243, 5.524523386300415, 5.298351125747587, 5.12086900081526, 5.342434483138625, 5.270878627363087, 5.653549032382639, 5.5634726403164905, 5.456880767993335, 5.394730957682689, 5.574092228328894, 5.640923012533376, 5.248767888497644, 5.4573439154749845, 5.320537130791729, 5.539757682480683, 5.435090772093835], "episode_lengths": [73, 77, 62, 78, 80, 109, 117, 81, 64, 83, 103, 97, 70, 73, 153, 84, 117, 62, 106, 96, 71, 81, 56, 65, 73, 54, 117, 68, 60, 83, 85, 62, 77, 116, 102, 99, 104, 80, 64, 47, 67, 77, 57, 48, 49, 69, 90, 77, 75, 66, 130, 58, 69, 136, 90, 61, 86, 129, 151, 56, 71, 115, 111, 115, 58, 61, 119, 60, 60, 139, 54, 66, 111, 59, 82, 86, 73, 77, 81, 82, 66, 110, 77, 61, 99, 49, 97, 93, 77, 59, 56, 129, 112, 117, 63, 57, 72, 82, 100, 87]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21403700174392704, "mean_inference_ms": 1.2552537061080757, "mean_action_processing_ms": 0.11812788368862442, "mean_env_wait_ms": 2.302373514327485, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 311688, "agent_timesteps_total": 311688, "timers": {"sample_time_ms": 7078.962, "sample_throughput": 1128.979, "load_time_ms": 3.375, "load_throughput": 2367795.265, "learn_time_ms": 6342.705, "learn_throughput": 1260.03, "update_time_ms": 3.011}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.06866632401943207, "policy_loss": -0.014494668692350388, "vf_loss": 0.08101741224527359, "vf_explained_var": 0.6561805009841919, "kl": 0.01071791909635067, "entropy": 1.870219349861145, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 311688, "num_agent_steps_sampled": 311688, "num_steps_trained": 311688, "num_agent_steps_trained": 311688}, "done": false, "episodes_total": 1386, "training_iteration": 39, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-42-56", "timestamp": 1716403376, "time_this_iter_s": 13.023624658584595, "time_total_s": 423.025999546051, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 423.025999546051, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 34.17368421052631, "ram_util_percent": 33.526315789473685}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.679171148320773, "episode_reward_min": 0.1227256687936531, "episode_reward_mean": 5.350127074707589, "episode_len_mean": 86.4, "episode_media": {}, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.99, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.01, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9800000000000002, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.2475, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.238727074707588, "reward_component_totals/rejoin_dist_change_reward_min": 0.9422799525055621, "reward_component_totals/rejoin_dist_change_reward_max": 1.4855456152961337, "reward_component_totals/failure_reward_mean": -0.01, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.8939000000000001, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.954, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.640923012533376, 5.248767888497644, 5.4573439154749845, 5.320537130791729, 5.539757682480683, 5.435090772093835, 5.119814966531644, 5.470778892763882, 5.274906716308394, 5.217224644134294, 5.448735865525741, 5.496264852091979, 5.527861616374054, 5.191429285326135, 5.600340740861881, 5.597579754427735, 5.263703533214689, 5.679171148320773, 5.387233524025659, 5.278036639475445, 5.534990034760757, 5.351221998753085, 5.5314895286660395, 5.325886859390505, 5.280191201112613, 5.618168578948953, 5.458619153639313, 5.5242832814662215, 5.351076430297324, 5.641545615296133, 5.5307652735986546, 5.57529879062456, 5.185229541080936, 5.316042197521781, 5.514051760761866, 5.304434842812714, 5.598735897161551, 5.415646903911832, 5.259017749656114, 5.592763347833564, 5.492323508505627, 5.3985030975350385, 5.157266193339578, 5.25065494642754, 5.4291621726296775, 5.57756861206234, 5.181359588579155, 5.265468250124855, 5.42055563797876, 5.548848987291625, 5.125724786267584, 5.486464321739463, 5.50450463056129, 5.3915121311544, 5.424942768593012, 5.471865738559426, 5.499707494889417, 5.394890313743797, 5.619249296073632, 5.469343347255018, 5.329224497272044, 5.187966359751525, 5.214589082632701, 0.1227256687936531, 5.334451359988817, 5.381738873160247, 5.598074821682031, 5.641096333822837, 5.4139876868598975, 5.294871991836492, 5.428974443519987, 5.386386323251533, 5.449231347314296, 5.212976213039553, 5.174693555313816, 5.1266966878130855, 5.3832092329492784, 5.233849060124269, 5.133279952505562, 5.24757424479105, 5.58559846290586, 5.143352791316371, 5.230949295176127, 5.428741227413556, 5.5442399886172335, 5.5545230151222285, 5.197470070177373, 5.666083230859169, 5.431149522668351, 5.26344922819321, 5.248759893408483, 5.323977109911253, 5.1982608618664905, 5.471555594363298, 5.577314272328078, 5.6595270942748535, 5.62276044138285, 5.499183474048564, 5.558860612790648, 5.2964761556518365], "episode_lengths": [63, 57, 72, 82, 100, 87, 91, 111, 75, 113, 49, 60, 81, 65, 135, 70, 116, 55, 79, 96, 70, 109, 73, 69, 81, 61, 80, 115, 73, 94, 76, 68, 107, 58, 78, 60, 83, 71, 141, 96, 66, 139, 128, 54, 153, 125, 70, 163, 156, 135, 74, 162, 97, 65, 96, 120, 76, 46, 72, 93, 62, 92, 103, 30, 59, 87, 84, 67, 119, 54, 84, 72, 70, 82, 59, 74, 59, 85, 59, 56, 110, 130, 104, 124, 78, 75, 108, 57, 121, 86, 68, 71, 95, 73, 98, 58, 83, 69, 100, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21613216941102867, "mean_inference_ms": 1.2648912275082465, "mean_action_processing_ms": 0.11916772776945311, "mean_env_wait_ms": 2.3195347194246017, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 319680, "agent_timesteps_total": 319680, "timers": {"sample_time_ms": 7095.745, "sample_throughput": 1126.309, "load_time_ms": 3.329, "load_throughput": 2400968.21, "learn_time_ms": 6345.375, "learn_throughput": 1259.5, "update_time_ms": 2.982}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10298996418714523, "policy_loss": -0.012928429991006851, "vf_loss": 0.11358840018510818, "vf_explained_var": 0.6177611351013184, "kl": 0.01164995227009058, "entropy": 1.8132106065750122, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 319680, "num_agent_steps_sampled": 319680, "num_steps_trained": 319680, "num_agent_steps_trained": 319680}, "done": false, "episodes_total": 1480, "training_iteration": 40, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-43-09", "timestamp": 1716403389, "time_this_iter_s": 13.59598970413208, "time_total_s": 436.6219892501831, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 436.6219892501831, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 34.163157894736834, "ram_util_percent": 33.6}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.701279291418461, "episode_reward_min": 5.097397174191762, "episode_reward_mean": 5.447572609284448, "episode_len_mean": 81.26, "episode_media": {}, "episodes_this_iter": 98, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2788326092844493, "reward_component_totals/rejoin_dist_change_reward_min": 0.9053971741917617, "reward_component_totals/rejoin_dist_change_reward_max": 1.5132792914184612, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.91874, "reward_component_totals/success_reward_min": 1.831, "reward_component_totals/success_reward_max": 1.956}, "hist_stats": {"episode_reward": [5.558860612790648, 5.2964761556518365, 5.62413325669098, 5.274449811924757, 5.273011907018686, 5.2757253622889095, 5.510074421312996, 5.5980107114968956, 5.557009297121624, 5.485641929883714, 5.231508188292163, 5.309767163923107, 5.606179614570927, 5.37343304404922, 5.593421990150434, 5.510699600886192, 5.523196755720753, 5.412823719497952, 5.575041567122397, 5.466804454014477, 5.593304548875555, 5.536956218973618, 5.360423614108421, 5.596201525949541, 5.474561108769754, 5.4611294820981735, 5.6469621142427, 5.6225854223478, 5.237245436793911, 5.496578587626097, 5.583342437616581, 5.097397174191762, 5.431177397429586, 5.425766867956195, 5.369956880602956, 5.481468866837854, 5.48930292177083, 5.46668319076324, 5.209372219397232, 5.462117097178604, 5.480813727881703, 5.625785684789646, 5.190334456153915, 5.186863181544237, 5.637002765058936, 5.369024024372654, 5.339222001673958, 5.5868848513355225, 5.126416574882464, 5.239005055941293, 5.4603022625989395, 5.476230253732285, 5.24141968840465, 5.647327771705138, 5.5987084970720975, 5.4064251795290295, 5.529052000907731, 5.540000340215579, 5.644493503290966, 5.367015896694012, 5.481026840737755, 5.466933517357093, 5.663979634524717, 5.515522296269126, 5.359892769360512, 5.58860658925877, 5.434591196087675, 5.506280831208693, 5.537202131047083, 5.493769319202115, 5.499668088486025, 5.5627749122322445, 5.405954262649717, 5.310400159889174, 5.2119394455687225, 5.189884095995106, 5.17911256878853, 5.533284070070923, 5.517969860526341, 5.274620213456951, 5.45071815364025, 5.256417352846844, 5.67398530880187, 5.271697976758861, 5.489206885915962, 5.5760372328735475, 5.461867523119669, 5.334202845845951, 5.701279291418461, 5.65254462234064, 5.57631810603684, 5.6610202818268345, 5.474847591882007, 5.494467511165232, 5.610848376934687, 5.3312379403201895, 5.264004628438912, 5.337112185600585, 5.469630944795597, 5.145272969440877], "episode_lengths": [100, 65, 106, 83, 83, 102, 85, 63, 99, 64, 103, 87, 106, 83, 88, 82, 165, 80, 82, 166, 71, 91, 93, 67, 72, 55, 58, 82, 62, 54, 61, 58, 64, 84, 60, 102, 52, 69, 85, 69, 52, 57, 75, 63, 83, 78, 94, 58, 44, 90, 97, 55, 64, 76, 73, 135, 88, 54, 78, 72, 49, 63, 78, 169, 52, 73, 63, 135, 86, 71, 90, 79, 69, 119, 95, 66, 107, 67, 70, 50, 76, 47, 60, 95, 97, 60, 113, 55, 62, 84, 113, 64, 99, 114, 91, 104, 109, 87, 104, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21845910757797807, "mean_inference_ms": 1.2759812062304408, "mean_action_processing_ms": 0.11997255356676739, "mean_env_wait_ms": 2.3424290279035738, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 327672, "agent_timesteps_total": 327672, "timers": {"sample_time_ms": 7092.151, "sample_throughput": 1126.88, "load_time_ms": 3.334, "load_throughput": 2397019.362, "learn_time_ms": 6345.09, "learn_throughput": 1259.557, "update_time_ms": 3.005}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.07578855752944946, "policy_loss": -0.014244217425584793, "vf_loss": 0.08742287755012512, "vf_explained_var": 0.6674765944480896, "kl": 0.013049589470028877, "entropy": 1.8050611019134521, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 327672, "num_agent_steps_sampled": 327672, "num_steps_trained": 327672, "num_agent_steps_trained": 327672}, "done": false, "episodes_total": 1578, "training_iteration": 41, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-43-23", "timestamp": 1716403403, "time_this_iter_s": 13.663241624832153, "time_total_s": 450.28523087501526, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 450.28523087501526, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 34.769999999999996, "ram_util_percent": 33.535}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.680062271133722, "episode_reward_min": 0.35304721918521653, "episode_reward_mean": 5.3775842835786465, "episode_len_mean": 81.2, "episode_media": {}, "episodes_this_iter": 97, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.99, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.01, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9800000000000002, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.2475, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.261094283578646, "reward_component_totals/rejoin_dist_change_reward_min": 0.9457407779750726, "reward_component_totals/rejoin_dist_change_reward_max": 1.4992518948511246, "reward_component_totals/failure_reward_mean": -0.01, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.8989899999999997, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.964, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.337112185600585, 5.469630944795597, 5.145272969440877, 5.335726674662427, 5.197406140361226, 5.188640270672604, 5.351288575279952, 5.191627874993889, 5.546861163788047, 5.199298528619112, 5.471716901977852, 5.437893399495415, 5.535363763822502, 5.299980678629526, 5.617956577899493, 5.6290307764369505, 5.6736898514075875, 5.42058926171906, 5.668202820594757, 5.5956665116466855, 5.621240970085855, 5.309948976419369, 5.372661374333284, 5.546513145809541, 5.4193954805685856, 5.479224290864417, 5.222790327875585, 5.469942964240618, 5.275171019392941, 5.604923652415355, 5.335570982816243, 0.35304721918521653, 5.443675204803919, 5.293523922674487, 5.168706339234225, 5.475307905210697, 5.210905948323348, 5.626239232336637, 5.5749048758728, 5.640891883153735, 5.546930522935514, 5.2141230201391675, 5.595848504806035, 5.315673403905425, 5.377582245362296, 5.165849637389875, 5.467828779715412, 5.331378046736484, 5.485897038255745, 5.461709745011365, 5.31624628409856, 5.667207319733732, 5.625429272080185, 5.450825837434604, 5.542161248746215, 5.401097333860222, 5.305782035769543, 5.282342810530039, 5.587175769486246, 5.192201412741201, 5.662230565440494, 5.383586147369909, 5.453537510899154, 5.417629899163768, 5.494353694207584, 5.237799037726027, 5.449783704908213, 5.167060944576422, 5.5537833731222666, 5.355769278332309, 5.516694293475818, 5.618719894277642, 5.517958563309582, 5.169574121559208, 5.459101361165677, 5.273795465508691, 5.556678469941345, 5.6700296783062685, 5.466363112320242, 5.34478303435447, 5.254741170098937, 5.218647806835872, 5.186768064985092, 5.560074890619509, 5.260622510875153, 5.135740777975073, 5.676251894851125, 5.482357115913398, 5.304905554665295, 5.542960856124518, 5.680062271133722, 5.4783755616411085, 5.396899563129869, 5.633558545885157, 5.498707694707427, 5.650281501707404, 5.594157949580361, 5.371423538649003, 5.39333526985442, 5.5784918124682354], "episode_lengths": [87, 104, 54, 67, 126, 76, 69, 68, 101, 63, 105, 91, 111, 62, 87, 79, 53, 57, 56, 100, 59, 70, 89, 96, 61, 78, 115, 125, 88, 93, 117, 19, 52, 108, 91, 66, 82, 74, 86, 66, 71, 75, 78, 73, 85, 71, 151, 54, 83, 94, 75, 76, 62, 70, 50, 57, 85, 131, 144, 88, 54, 95, 49, 70, 114, 66, 80, 47, 141, 93, 77, 58, 106, 36, 109, 120, 135, 64, 71, 46, 56, 80, 64, 113, 78, 60, 73, 79, 75, 105, 59, 71, 81, 91, 62, 76, 113, 68, 97, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22139443065468659, "mean_inference_ms": 1.2862417817049214, "mean_action_processing_ms": 0.12101131273097188, "mean_env_wait_ms": 2.360474865412542, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 335664, "agent_timesteps_total": 335664, "timers": {"sample_time_ms": 7142.088, "sample_throughput": 1119.0, "load_time_ms": 3.315, "load_throughput": 2410932.167, "learn_time_ms": 6362.701, "learn_throughput": 1256.07, "update_time_ms": 3.013}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0777447298169136, "policy_loss": -0.015412857756018639, "vf_loss": 0.09012261033058167, "vf_explained_var": 0.6646403670310974, "kl": 0.015174943953752518, "entropy": 1.7747212648391724, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 335664, "num_agent_steps_sampled": 335664, "num_steps_trained": 335664, "num_agent_steps_trained": 335664}, "done": false, "episodes_total": 1675, "training_iteration": 42, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-43-37", "timestamp": 1716403417, "time_this_iter_s": 13.927314758300781, "time_total_s": 464.21254563331604, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 464.21254563331604, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 34.715, "ram_util_percent": 33.39999999999999}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.691114278836784, "episode_reward_min": 0.14212260317169556, "episode_reward_mean": 5.378236810319662, "episode_len_mean": 77.96116504854369, "episode_media": {}, "episodes_this_iter": 103, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9902912621359223, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.009708737864077669, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.980582524271845, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24757281553398058, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2570329268245162, "reward_component_totals/rejoin_dist_change_reward_min": 0.9198096239924387, "reward_component_totals/rejoin_dist_change_reward_max": 1.5070567225324776, "reward_component_totals/failure_reward_mean": -0.009708737864077669, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9027572815533982, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.9569999999999999, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.2963430862030245, 5.4761180292002365, 5.56852866246564, 5.511842667622783, 5.457850057816288, 5.573926282553478, 5.559794568258225, 5.44878169477963, 5.529444682769101, 5.212567636696671, 5.425968247314973, 5.342813524080963, 5.403716040536882, 5.526102958851516, 5.160564391417297, 5.5246193527175915, 5.41734769608097, 5.196324003520816, 5.645360735427607, 5.2380888209565395, 5.5393772435760305, 5.315480103996896, 5.383722140482645, 5.498787198059674, 5.2174166781124285, 5.395997888935515, 5.684753694410494, 5.232201046169935, 5.628824357143542, 5.566380227937785, 5.361631315998936, 5.690959574663535, 5.438734377440737, 5.350523113577071, 5.560141619141221, 5.691114278836784, 5.229006823043303, 5.414220219788157, 5.560743005440162, 5.42843301063237, 5.3130710293180545, 5.431910656641103, 5.533102235849259, 5.5796466855443665, 5.290982542473694, 5.483636013481512, 5.420034145568039, 5.392329279251716, 5.483501416868664, 5.098124193117236, 5.529094550899794, 5.5815635488320785, 5.6229582420858915, 5.332926997080877, 5.353995767441994, 5.205888516516378, 5.389099180139705, 5.221513839480736, 5.599680523831054, 5.607699900638089, 5.599289226928745, 5.383981455901971, 5.219472666641133, 5.534803011123177, 5.647353606534711, 5.548607965030438, 5.474822991514815, 5.41953656246138, 5.3962653661654105, 5.2438388077774825, 5.44897235922668, 5.487535380384761, 5.3523727215789885, 5.425171228308805, 5.608954334925366, 5.376096466939177, 5.686056722532477, 5.621662915338784, 0.14212260317169556, 5.194600706688439, 5.4114972989559895, 5.168089454909816, 5.2592603259016855, 5.226954182022535, 5.192073825520435, 5.613451255232882, 5.222907336279853, 5.600787255310681, 5.458913404260869, 5.629424631511041, 5.310497406922249, 5.388988689692063, 5.399591692656063, 5.441998858558975, 5.307444279697062, 5.49572378985293, 5.32189041398989, 5.584441813608706, 5.279933007098483, 5.597256550616732, 5.568981798344348, 5.415647147097289, 5.0758096239924395], "episode_lengths": [109, 62, 59, 79, 55, 69, 65, 68, 82, 101, 60, 60, 43, 148, 84, 124, 52, 139, 87, 108, 82, 81, 56, 101, 60, 129, 60, 93, 94, 88, 53, 64, 71, 124, 111, 65, 74, 94, 65, 85, 47, 92, 129, 90, 93, 108, 64, 64, 70, 107, 51, 60, 85, 113, 67, 59, 101, 79, 77, 75, 56, 76, 47, 75, 62, 107, 88, 83, 92, 59, 66, 52, 96, 66, 64, 77, 71, 70, 14, 118, 50, 73, 67, 78, 54, 115, 75, 64, 90, 69, 58, 50, 62, 43, 52, 88, 103, 54, 51, 114, 98, 54, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22398732209051844, "mean_inference_ms": 1.2959620990219114, "mean_action_processing_ms": 0.12186118884114396, "mean_env_wait_ms": 2.376786873436693, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 343656, "agent_timesteps_total": 343656, "timers": {"sample_time_ms": 7132.093, "sample_throughput": 1120.569, "load_time_ms": 3.301, "load_throughput": 2420839.296, "learn_time_ms": 6375.855, "learn_throughput": 1253.479, "update_time_ms": 3.042}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0712059885263443, "policy_loss": -0.013452930375933647, "vf_loss": 0.08260626345872879, "vf_explained_var": 0.6801533102989197, "kl": 0.010263264179229736, "entropy": 1.719728708267212, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 343656, "num_agent_steps_sampled": 343656, "num_steps_trained": 343656, "num_agent_steps_trained": 343656}, "done": false, "episodes_total": 1778, "training_iteration": 43, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-43-51", "timestamp": 1716403431, "time_this_iter_s": 13.741442680358887, "time_total_s": 477.9539883136749, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 477.9539883136749, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 34.084210526315786, "ram_util_percent": 33.4}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.685114681160718, "episode_reward_min": 5.068834264120495, "episode_reward_mean": 5.4473154030768285, "episode_len_mean": 75.95238095238095, "episode_media": {}, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2732677840292097, "reward_component_totals/rejoin_dist_change_reward_min": 0.9018342641204944, "reward_component_totals/rejoin_dist_change_reward_max": 1.5231146811607177, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9240476190476188, "reward_component_totals/success_reward_min": 1.849, "reward_component_totals/success_reward_max": 1.9609999999999999}, "hist_stats": {"episode_reward": [5.437063103085781, 5.282909975594948, 5.345742979862777, 5.225150204804292, 5.287758448744461, 5.627891241923894, 5.163203450105099, 5.5860834548995975, 5.642138915656107, 5.39395580052571, 5.291211983730315, 5.204992070930395, 5.3351138085870975, 5.536228166199202, 5.544943599893966, 5.389230527864983, 5.398055091925093, 5.437380538485813, 5.612924732373871, 5.158776178539272, 5.487968678503458, 5.495311193535043, 5.264575558608225, 5.523966226181425, 5.521040688025941, 5.566212194564893, 5.5315903520157494, 5.256680066653129, 5.385631953197696, 5.6005030314516855, 5.327296488205187, 5.615779992717643, 5.453828521322837, 5.6390550232680985, 5.2104037146490585, 5.316905059338728, 5.237692852832365, 5.668852222863178, 5.547101346346393, 5.254727820167853, 5.44730154767608, 5.467997410507891, 5.071785216743162, 5.210742529653263, 5.450163775052552, 5.663039226666152, 5.244235296809174, 5.305679736045581, 5.606052744168111, 5.45472593957895, 5.605700660830143, 5.661903403345319, 5.274468623626463, 5.496986192464675, 5.333744342407918, 5.64884475728463, 5.605933542552533, 5.641042630318399, 5.311280439693897, 5.530832419882495, 5.59422507467699, 5.593521516937544, 5.685114681160718, 5.564024779658075, 5.392269192377432, 5.642739760978802, 5.463422874547286, 5.506833440729864, 5.505978756562292, 5.597431748913597, 5.467329823912192, 5.4083545421144485, 5.514149655339222, 5.228737603361827, 5.576629344296265, 5.609526257346052, 5.45932475883326, 5.6044450658363765, 5.590228338902077, 5.627239357634293, 5.291172927167025, 5.327885275919156, 5.256869326135235, 5.36866261029738, 5.348395328664899, 5.303636475765382, 5.605560611160202, 5.318546460208459, 5.356800849629489, 5.512427990066975, 5.445419570429436, 5.523611751568821, 5.230464727618616, 5.570988325170072, 5.604063944721327, 5.587822390673756, 5.541162886827217, 5.293092014890844, 5.617909795680921, 5.566011908126654, 5.556720466283557, 5.068834264120495, 5.562231163424553, 5.347316789390365, 5.292645201518938], "episode_lengths": [105, 54, 46, 58, 98, 77, 70, 93, 62, 60, 84, 39, 49, 80, 151, 62, 52, 141, 79, 69, 78, 71, 54, 85, 53, 90, 83, 56, 53, 56, 98, 92, 93, 57, 140, 85, 83, 59, 55, 66, 136, 69, 95, 58, 50, 60, 83, 111, 111, 76, 90, 59, 63, 84, 114, 95, 78, 73, 64, 80, 130, 68, 88, 106, 57, 59, 76, 56, 65, 81, 45, 63, 85, 50, 56, 53, 56, 54, 75, 47, 70, 42, 63, 73, 89, 61, 116, 47, 64, 95, 76, 103, 110, 130, 91, 51, 72, 73, 77, 59, 53, 83, 57, 98, 67]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22644611652120888, "mean_inference_ms": 1.304870427149895, "mean_action_processing_ms": 0.12267250285263755, "mean_env_wait_ms": 2.396104174672718, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 351648, "agent_timesteps_total": 351648, "timers": {"sample_time_ms": 7179.077, "sample_throughput": 1113.235, "load_time_ms": 3.264, "load_throughput": 2448781.308, "learn_time_ms": 6379.604, "learn_throughput": 1252.742, "update_time_ms": 3.07}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.06348365545272827, "policy_loss": -0.009837144985795021, "vf_loss": 0.07135561853647232, "vf_explained_var": 0.7251632213592529, "kl": 0.009825889952480793, "entropy": 1.6883517503738403, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 351648, "num_agent_steps_sampled": 351648, "num_steps_trained": 351648, "num_agent_steps_trained": 351648}, "done": false, "episodes_total": 1883, "training_iteration": 44, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-44-05", "timestamp": 1716403445, "time_this_iter_s": 13.931251287460327, "time_total_s": 491.88523960113525, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 491.88523960113525, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 34.309999999999995, "ram_util_percent": 33.415}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.700040601813166, "episode_reward_min": 0.2788329835677641, "episode_reward_mean": 5.346854368536443, "episode_len_mean": 76.92307692307692, "episode_media": {}, "episodes_this_iter": 104, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9807692307692307, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.019230769230769232, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.961538461538462, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24519230769230768, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2741139839210585, "reward_component_totals/rejoin_dist_change_reward_min": 0.9156158700279744, "reward_component_totals/rejoin_dist_change_reward_max": 1.5210406018131661, "reward_component_totals/failure_reward_mean": -0.019230769230769232, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.8852403846153847, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.959, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.465712999791086, 5.5609049210200245, 5.405028211875168, 5.578091816014425, 5.570642043007223, 5.530933441817636, 5.607958592340289, 5.312502262748429, 5.487943613270005, 5.596896020123692, 5.251165807134035, 5.505673314411354, 5.319677838272435, 5.4637130392164135, 5.535182669361786, 5.54857025509645, 5.552361952121657, 5.45662960135506, 5.2292094268659906, 5.309345462236433, 5.304191457220976, 5.122615870027975, 5.261242526261609, 0.3136236240587591, 5.204239902137882, 5.372354048066814, 5.63121569762429, 5.389272574544934, 5.64127164707859, 5.302408471389276, 5.12285813283043, 5.220468465110709, 5.23419632124285, 5.428448653003013, 5.346514421665516, 5.197186526214907, 5.692852930648705, 5.369822279999603, 5.496182119818506, 5.614924143943906, 5.306157777489871, 5.32583033148408, 5.210906190529729, 5.478826245569424, 5.238853787083291, 5.255970865058904, 5.540681497238551, 5.297068814225961, 5.619695381357207, 5.16962692888243, 5.193304284571891, 5.357554776804295, 5.4554032108182895, 5.2684490652573315, 5.323341698114534, 5.5812676933984395, 5.489389315105418, 5.51178025330109, 5.378110047720204, 5.700040601813166, 5.5049764674387, 5.4460874274384565, 5.620743036555775, 5.562261126588426, 5.467976555920286, 5.378403419655329, 5.457991311038731, 5.532254345001163, 5.477836435542401, 5.569148985182313, 5.617485507094774, 5.431755669860544, 5.654093105505439, 5.503435314418504, 5.490181952834055, 5.563628754958153, 5.383160936152881, 5.686078146350009, 5.5383967995065015, 5.328136733599289, 5.568677088805546, 5.408351939485621, 5.369627513487282, 5.56039301933767, 5.563807039876837, 5.649917956979299, 5.537242465876596, 5.628002232616929, 5.666768158701769, 5.581594341520672, 0.2788329835677641, 5.480445642199878, 5.552498207321271, 5.657283580048832, 5.6063607797384565, 5.403692618667994, 5.575162654300482, 5.619793640281919, 5.41384753870172, 5.236964079001824, 5.510956471068974, 5.275212498908502, 5.313972611865605, 5.1431253679939655], "episode_lengths": [83, 79, 94, 113, 146, 87, 72, 75, 59, 117, 99, 54, 54, 93, 71, 93, 78, 79, 92, 47, 66, 43, 67, 28, 131, 50, 58, 56, 105, 89, 63, 46, 76, 71, 85, 145, 67, 82, 118, 53, 108, 90, 75, 70, 61, 122, 86, 105, 75, 91, 88, 93, 84, 55, 67, 67, 62, 97, 43, 71, 82, 57, 80, 53, 50, 64, 109, 61, 52, 53, 64, 79, 57, 64, 74, 54, 104, 58, 119, 69, 59, 82, 86, 53, 59, 77, 151, 75, 67, 51, 37, 62, 82, 93, 66, 111, 48, 113, 52, 104, 51, 63, 41, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2262941998913312, "mean_inference_ms": 1.3135282696465658, "mean_action_processing_ms": 0.12362510418687614, "mean_env_wait_ms": 2.412487840446184, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 359640, "agent_timesteps_total": 359640, "timers": {"sample_time_ms": 7191.37, "sample_throughput": 1111.332, "load_time_ms": 3.317, "load_throughput": 2409580.388, "learn_time_ms": 6381.382, "learn_throughput": 1252.393, "update_time_ms": 3.09}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10950222611427307, "policy_loss": -0.00990527868270874, "vf_loss": 0.11718850582838058, "vf_explained_var": 0.6329127550125122, "kl": 0.011094920337200165, "entropy": 1.7213022708892822, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 359640, "num_agent_steps_sampled": 359640, "num_steps_trained": 359640, "num_agent_steps_trained": 359640}, "done": false, "episodes_total": 1987, "training_iteration": 45, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-44-18", "timestamp": 1716403458, "time_this_iter_s": 13.727446794509888, "time_total_s": 505.61268639564514, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 505.61268639564514, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 34.545, "ram_util_percent": 33.5}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.685464726713126, "episode_reward_min": 5.107378586891126, "episode_reward_mean": 5.431331833444345, "episode_len_mean": 78.57692307692308, "episode_media": {}, "episodes_this_iter": 104, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2599087565212672, "reward_component_totals/rejoin_dist_change_reward_min": 0.9163785868911243, "reward_component_totals/rejoin_dist_change_reward_max": 1.5004647267131255, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9214230769230771, "reward_component_totals/success_reward_min": 1.841, "reward_component_totals/success_reward_max": 1.956}, "hist_stats": {"episode_reward": [5.471898183302178, 5.636740422476513, 5.612103266402968, 5.12731726282958, 5.486191942231899, 5.304469632669621, 5.347233798459051, 5.545728806103835, 5.5803742646107946, 5.209521857049655, 5.616117672339074, 5.536711096251407, 5.138938468580357, 5.288696877524851, 5.527657960074607, 5.32141643148931, 5.459367013632849, 5.45870764635323, 5.447449943515626, 5.606875018852616, 5.55363564952306, 5.462067397906113, 5.259257570124379, 5.240977072621703, 5.347145067985494, 5.34671431745916, 5.4184997429452055, 5.416593223164115, 5.416050512508329, 5.597704823343177, 5.473958146537747, 5.633073779867184, 5.202442700949725, 5.540838701584038, 5.173527231961852, 5.296839414117169, 5.541885152806318, 5.624646293326042, 5.188909755914909, 5.177473124009715, 5.433418535650896, 5.332969935917708, 5.612782091022412, 5.485317129681196, 5.225236386234464, 5.470846029046116, 5.284713092099525, 5.610890636629375, 5.4046588959269535, 5.618598212443344, 5.246559436104876, 5.380212361538632, 5.658913142877666, 5.55179646125235, 5.560640482850911, 5.126445767015311, 5.592534733280932, 5.4770877973233905, 5.5935891447317605, 5.478032108830785, 5.4944925623386975, 5.633913720421642, 5.597364017487889, 5.3016384678217685, 5.49517531187982, 5.685464726713126, 5.488684902379208, 5.55228961059764, 5.5304393969680845, 5.514336426850572, 5.425912610495368, 5.400079822695508, 5.516380063670411, 5.107378586891126, 5.207019461540023, 5.60156076868081, 5.552948898323976, 5.642016958820003, 5.423903659195464, 5.383362512465375, 5.408722271309632, 5.51095692057762, 5.507995236573602, 5.262554708064322, 5.451740478012548, 5.137649308910843, 5.302148577553675, 5.493124572006765, 5.372574814630614, 5.553573142529232, 5.383184403680229, 5.242552240768063, 5.5699113492338554, 5.1873320619039625, 5.606307192245526, 5.374266146081913, 5.577202382318122, 5.382423437072186, 5.195357303766571, 5.3801341858846214, 5.293200828163943, 5.2633141221286035, 5.644136101604958, 5.422786783089809], "episode_lengths": [84, 65, 78, 54, 82, 73, 94, 91, 73, 54, 110, 112, 56, 50, 113, 66, 126, 92, 85, 102, 71, 60, 134, 58, 80, 55, 80, 53, 92, 83, 70, 70, 94, 87, 85, 54, 57, 68, 71, 56, 91, 100, 60, 46, 94, 64, 63, 55, 80, 54, 100, 67, 75, 67, 88, 85, 67, 64, 92, 62, 89, 77, 87, 118, 49, 65, 72, 87, 64, 65, 133, 57, 66, 59, 52, 84, 84, 63, 61, 65, 152, 95, 131, 44, 71, 48, 52, 95, 86, 74, 159, 53, 84, 63, 135, 89, 75, 70, 78, 89, 111, 90, 64, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22928749063354234, "mean_inference_ms": 1.320051010961126, "mean_action_processing_ms": 0.12413651117137982, "mean_env_wait_ms": 2.4254844929176036, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 367632, "agent_timesteps_total": 367632, "timers": {"sample_time_ms": 7186.609, "sample_throughput": 1112.068, "load_time_ms": 3.292, "load_throughput": 2427905.52, "learn_time_ms": 6376.29, "learn_throughput": 1253.393, "update_time_ms": 3.049}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.056892842054367065, "policy_loss": -0.010251126252114773, "vf_loss": 0.06541969627141953, "vf_explained_var": 0.7212294936180115, "kl": 0.008621376007795334, "entropy": 1.7323293685913086, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 367632, "num_agent_steps_sampled": 367632, "num_steps_trained": 367632, "num_agent_steps_trained": 367632}, "done": false, "episodes_total": 2091, "training_iteration": 46, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-44-32", "timestamp": 1716403472, "time_this_iter_s": 13.585675477981567, "time_total_s": 519.1983618736267, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 519.1983618736267, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 33.936842105263146, "ram_util_percent": 33.53157894736842}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.704134345547702, "episode_reward_min": 5.126669630063923, "episode_reward_mean": 5.412870995001306, "episode_len_mean": 79.68, "episode_media": {}, "episodes_this_iter": 98, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.242550995001306, "reward_component_totals/rejoin_dist_change_reward_min": 0.9690408589644368, "reward_component_totals/rejoin_dist_change_reward_max": 1.5211343455477015, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.92032, "reward_component_totals/success_reward_min": 1.817, "reward_component_totals/success_reward_max": 1.962}, "hist_stats": {"episode_reward": [5.644136101604958, 5.422786783089809, 5.3696913430734, 5.416200077608794, 5.300437567592493, 5.621739978906195, 5.271845267985977, 5.4707159844919175, 5.516976639977279, 5.154930679457916, 5.358455772137951, 5.504205717505638, 5.650507254969231, 5.510847210615133, 5.227755936498388, 5.526441893149977, 5.671144256887191, 5.181040858964437, 5.389781037310966, 5.355032607705393, 5.509684977131803, 5.399462319316543, 5.422808394158821, 5.536917594164041, 5.537251915593357, 5.612385501312657, 5.189431713350183, 5.518004055704541, 5.527306714375207, 5.647585612285242, 5.335482083355956, 5.429789920164033, 5.387361077522172, 5.258140850010184, 5.4926371129561, 5.453994478911643, 5.38653611267738, 5.286408883877616, 5.258398689806727, 5.571586267642061, 5.489375826377575, 5.464415340650742, 5.160231161180988, 5.34236077399522, 5.149827580063293, 5.204164528955054, 5.483880280532622, 5.278365453959612, 5.44223052811283, 5.282153570638414, 5.384465171840696, 5.704134345547702, 5.2242217129368145, 5.155832127755325, 5.206948624375443, 5.47965763510809, 5.549386880002084, 5.384673601763508, 5.126669630063923, 5.398530977100696, 5.3055825333504885, 5.261367905422851, 5.562263838103563, 5.302187890977798, 5.519418055621568, 5.424227659574814, 5.506562170472909, 5.44368736436461, 5.145747291457024, 5.521392231054802, 5.361513693548132, 5.520065757517775, 5.58341073681664, 5.638036570287119, 5.463525263690678, 5.343442636875395, 5.53961815686004, 5.496023345767707, 5.601355901775606, 5.564996403455652, 5.314421602113245, 5.202212315550586, 5.478784087276107, 5.40548764795738, 5.508266966993825, 5.20711778062029, 5.256784243537913, 5.4561234581271565, 5.562528458138901, 5.548749292247367, 5.171999858073725, 5.25524866334859, 5.411066491020346, 5.625877605251707, 5.229607867398377, 5.466955390833465, 5.581997230581385, 5.2090218240666175, 5.462306452338807, 5.59074386284969], "episode_lengths": [64, 55, 88, 61, 99, 54, 60, 61, 50, 79, 60, 107, 69, 68, 132, 129, 55, 38, 78, 112, 75, 41, 57, 92, 106, 60, 105, 58, 87, 62, 67, 86, 71, 41, 121, 67, 62, 50, 78, 80, 52, 99, 67, 79, 87, 91, 88, 75, 94, 79, 78, 67, 76, 93, 98, 56, 53, 51, 101, 47, 122, 106, 85, 52, 156, 80, 47, 75, 118, 59, 97, 74, 86, 62, 81, 123, 122, 107, 68, 44, 114, 84, 103, 59, 58, 51, 48, 78, 85, 55, 107, 49, 115, 74, 106, 48, 70, 105, 183, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23121306201917072, "mean_inference_ms": 1.327312076163272, "mean_action_processing_ms": 0.1249675428337655, "mean_env_wait_ms": 2.4397381131377114, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 375624, "agent_timesteps_total": 375624, "timers": {"sample_time_ms": 7214.164, "sample_throughput": 1107.821, "load_time_ms": 3.254, "load_throughput": 2455993.843, "learn_time_ms": 6368.899, "learn_throughput": 1254.848, "update_time_ms": 3.024}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.06434278190135956, "policy_loss": -0.01254203636199236, "vf_loss": 0.07463864237070084, "vf_explained_var": 0.7331169843673706, "kl": 0.011230903677642345, "entropy": 1.749637246131897, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 375624, "num_agent_steps_sampled": 375624, "num_steps_trained": 375624, "num_agent_steps_trained": 375624}, "done": false, "episodes_total": 2189, "training_iteration": 47, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-44-46", "timestamp": 1716403486, "time_this_iter_s": 13.648706674575806, "time_total_s": 532.8470685482025, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 532.8470685482025, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 34.00500000000001, "ram_util_percent": 33.60000000000001}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.67360798922945, "episode_reward_min": 5.09531582833849, "episode_reward_mean": 5.426380768905931, "episode_len_mean": 79.36274509803921, "episode_media": {}, "episodes_this_iter": 102, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2557435140039703, "reward_component_totals/rejoin_dist_change_reward_min": 0.9593158283384895, "reward_component_totals/rejoin_dist_change_reward_max": 1.5004337595072856, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9206372549019606, "reward_component_totals/success_reward_min": 1.8439999999999999, "reward_component_totals/success_reward_max": 1.9569999999999999}, "hist_stats": {"episode_reward": [5.603978040902415, 5.60055712312071, 5.353068700129915, 5.227282323396281, 5.491173197523178, 5.548616391915088, 5.385759288820063, 5.52205574672674, 5.2566650030471465, 5.392160145085381, 5.485731936905463, 5.673066701068242, 5.587849247311501, 5.245824483530919, 5.3490951185883, 5.551095504276736, 5.556068516688997, 5.642189619293877, 5.166144573030316, 5.320180341685356, 5.204171052131196, 5.546634379683891, 5.465430261932589, 5.404421722912453, 5.4683950168111135, 5.559083808063633, 5.4000633221050585, 5.28954285576161, 5.380937146635341, 5.626533236161645, 5.332520724711815, 5.514263188966655, 5.180562679139203, 5.58968086009499, 5.631536188053133, 5.2487648393964506, 5.503180100679745, 5.556871438655547, 5.460594138782183, 5.534361213080451, 5.146904101479104, 5.305988948018733, 5.57275417922571, 5.630454833427676, 5.320898197095181, 5.286601018587754, 5.3610032540769, 5.664589484908272, 5.478809750328878, 5.591428194665729, 5.586160963170169, 5.2557056388779415, 5.4047695728332785, 5.262452826177401, 5.1877966374449205, 5.343010909568512, 5.358438511846626, 5.229186167648592, 5.589691260436247, 5.5784350586763605, 5.435748288897169, 5.501318148117228, 5.635263623204414, 5.246402439062458, 5.130360146425459, 5.159748245817777, 5.317184979937146, 5.245918127913285, 5.628606028022494, 5.502842998798701, 5.628604467584292, 5.326691517211217, 5.3189558833417845, 5.494044540210666, 5.389486588033526, 5.355651759251584, 5.608762753074641, 5.401214185097352, 5.09531582833849, 5.282232131089428, 5.570506980110248, 5.669433759507285, 5.67360798922945, 5.449978296330508, 5.383895571962901, 5.5900441117504185, 5.6093642525755385, 5.443741886594828, 5.197927782277175, 5.448754008475911, 5.583635375097769, 5.3779675451952755, 5.3238713561297555, 5.594852347190267, 5.191512093329032, 5.457251596972987, 5.282621071316941, 5.354753938045695, 5.573530736583774, 5.217053517010527, 5.217166155200109, 5.563825692790154], "episode_lengths": [82, 70, 60, 59, 115, 56, 144, 48, 55, 63, 105, 74, 78, 61, 102, 95, 59, 64, 63, 98, 71, 136, 74, 107, 66, 108, 102, 64, 75, 58, 85, 156, 92, 53, 70, 83, 88, 94, 77, 88, 116, 81, 93, 84, 53, 44, 73, 82, 50, 73, 96, 88, 87, 80, 96, 43, 60, 64, 57, 55, 68, 108, 65, 75, 87, 76, 66, 68, 93, 73, 64, 151, 67, 84, 51, 51, 78, 79, 114, 57, 112, 81, 64, 85, 68, 95, 113, 51, 72, 73, 94, 59, 79, 86, 67, 117, 76, 56, 103, 45, 54, 97]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2328174544513567, "mean_inference_ms": 1.3364405572643752, "mean_action_processing_ms": 0.12574609660962113, "mean_env_wait_ms": 2.4563944828352113, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 383616, "agent_timesteps_total": 383616, "timers": {"sample_time_ms": 7257.265, "sample_throughput": 1101.241, "load_time_ms": 3.247, "load_throughput": 2461205.281, "learn_time_ms": 6387.845, "learn_throughput": 1251.126, "update_time_ms": 3.027}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05875260755419731, "policy_loss": -0.01514371670782566, "vf_loss": 0.07133081555366516, "vf_explained_var": 0.7116544842720032, "kl": 0.012827570550143719, "entropy": 1.6360167264938354, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 383616, "num_agent_steps_sampled": 383616, "num_steps_trained": 383616, "num_agent_steps_trained": 383616}, "done": false, "episodes_total": 2291, "training_iteration": 48, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-45-00", "timestamp": 1716403500, "time_this_iter_s": 13.816094398498535, "time_total_s": 546.663162946701, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 546.663162946701, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 34.72631578947369, "ram_util_percent": 33.58947368421053}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.697050082775166, "episode_reward_min": -0.11327751665639896, "episode_reward_mean": 5.407193305786332, "episode_len_mean": 77.08653846153847, "episode_media": {}, "episodes_this_iter": 104, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9903846153846154, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.009615384615384616, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.980769230769231, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24759615384615385, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2844336904017164, "reward_component_totals/rejoin_dist_change_reward_min": 0.886722483343601, "reward_component_totals/rejoin_dist_change_reward_max": 1.5080500827751662, "reward_component_totals/failure_reward_mean": -0.009615384615384616, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9040096153846153, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.959, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.320892416104654, 5.378742893999509, 5.176427523717851, 5.183633441348498, 5.506577663887725, 5.284644314058225, 5.44108200976594, 5.447178457102822, 5.465104753804325, 5.438512651408234, 5.508819725555867, 5.540639807200863, 5.148477665431738, 5.549211641048834, 5.632548934216864, 5.265684016352706, 5.221135245540505, 5.640058928742951, 5.241202225177709, 5.583341186341462, 5.447107976520204, 5.618360131288254, 5.653988848275061, 5.61376127636319, 5.417582150701029, 5.531844943176973, 5.552427389006996, 5.5628800422823765, 5.351402788435518, 5.520601775902042, 5.527949602577261, 5.339092244406398, 5.560180679925473, 5.471396972728061, 5.490389080980021, 5.4372502444828115, 5.258832974771025, 5.460992693851846, 5.48125426271792, 5.486338316205318, 5.578691575188808, 5.304037844747485, 5.622660398008262, 5.568225874374327, 5.648592983581426, 5.629714002089143, 5.295053685225836, 5.456754149567539, 5.320214319932957, 5.264916720760041, 5.399688065442417, 5.576451473521939, 5.515400046010911, 5.229720500315837, 5.529235292467713, 5.4364190054990935, 5.566575049054852, 5.538108715211537, 5.267564178625639, 5.516976821771614, 5.637741183423308, 5.390822629474111, 5.670939149915661, 5.449160196432161, 5.532347577018117, 5.422227206267358, 5.572242947910884, 5.45111949586785, 5.453335567035808, 5.490376128898293, 5.526766344959645, 5.338640834869967, 5.428666069413787, 5.4198833112902935, 5.334402540453709, 5.309359128712046, 5.646682427840847, 5.313314112244394, 5.359914281699719, -0.11327751665639896, 5.367929931539734, 5.697050082775166, 5.504575006843197, 5.290489106776592, 5.39654952071373, 5.5586096134111385, 5.283090186670034, 5.677133956971504, 5.495840931056079, 5.516264121540848, 5.324808673950217, 5.3154339571370475, 5.569027642910854, 5.624147759058934, 5.482973811261887, 5.547706322176484, 5.420063445455259, 5.581311124357092, 5.59232928170643, 5.2305767054402, 5.453206629206052, 5.634162282736725, 5.631337309161993, 5.496272185047316], "episode_lengths": [75, 57, 75, 73, 72, 41, 61, 101, 76, 62, 124, 93, 68, 102, 70, 86, 93, 60, 70, 61, 74, 66, 90, 89, 47, 78, 87, 86, 60, 92, 61, 105, 97, 70, 82, 56, 116, 87, 68, 69, 86, 79, 89, 130, 87, 71, 54, 93, 85, 50, 54, 100, 72, 69, 54, 54, 129, 84, 43, 110, 73, 68, 55, 98, 73, 116, 86, 97, 54, 92, 77, 73, 121, 87, 90, 92, 65, 74, 65, 34, 85, 61, 47, 106, 56, 62, 65, 77, 56, 75, 63, 51, 124, 77, 76, 71, 50, 102, 78, 100, 70, 78, 55, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23505577943747588, "mean_inference_ms": 1.343244736710313, "mean_action_processing_ms": 0.1265280302485706, "mean_env_wait_ms": 2.4712432996446885, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 391608, "agent_timesteps_total": 391608, "timers": {"sample_time_ms": 7320.987, "sample_throughput": 1091.656, "load_time_ms": 3.284, "load_throughput": 2433969.951, "learn_time_ms": 6401.363, "learn_throughput": 1248.484, "update_time_ms": 3.073}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.08674220740795135, "policy_loss": -0.01437853742390871, "vf_loss": 0.0985100194811821, "vf_explained_var": 0.6566721200942993, "kl": 0.01305366586893797, "entropy": 1.6542409658432007, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 391608, "num_agent_steps_sampled": 391608, "num_steps_trained": 391608, "num_agent_steps_trained": 391608}, "done": false, "episodes_total": 2395, "training_iteration": 49, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-45-13", "timestamp": 1716403513, "time_this_iter_s": 13.799484491348267, "time_total_s": 560.4626474380493, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 560.4626474380493, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 34.5, "ram_util_percent": 33.5}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.692701825639606, "episode_reward_min": 5.183320661385793, "episode_reward_mean": 5.445820817215777, "episode_len_mean": 76.07692307692308, "episode_media": {}, "episodes_this_iter": 104, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2718977402927, "reward_component_totals/rejoin_dist_change_reward_min": 0.9803206613857931, "reward_component_totals/rejoin_dist_change_reward_max": 1.506701825639607, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.923923076923077, "reward_component_totals/success_reward_min": 1.8479999999999999, "reward_component_totals/success_reward_max": 1.959}, "hist_stats": {"episode_reward": [5.311345933534268, 5.307693824575018, 5.218082328115084, 5.406983728001501, 5.6329188360484, 5.32263977203924, 5.4374091683385215, 5.325770224691976, 5.553395709250797, 5.559289676418587, 5.216972632830393, 5.634889934208763, 5.357838328295903, 5.45966359374039, 5.508055836403792, 5.499160924494902, 5.55364869335714, 5.554834408340104, 5.505979733456728, 5.59251921558209, 5.506197586493592, 5.373872277987373, 5.46421119663119, 5.226350403321586, 5.274800332421573, 5.663650386064079, 5.448884387388636, 5.54016404548288, 5.578557686503803, 5.464486791299703, 5.390182826509976, 5.642762196164895, 5.299800602632181, 5.497290053698845, 5.238568811457536, 5.588591540804659, 5.3194833443428635, 5.339230198480933, 5.301177971718893, 5.654257802263944, 5.222311018447604, 5.520380361602674, 5.5284159562514645, 5.306324401156996, 5.565467368839961, 5.620422576175259, 5.2725577919797, 5.183320661385793, 5.553295496161139, 5.610242607986376, 5.595562221965296, 5.607101649320965, 5.557410197857897, 5.563722464363085, 5.363387851047895, 5.406155451847186, 5.4051197130084185, 5.376271390089141, 5.692701825639606, 5.433628803228702, 5.351306325543328, 5.309938181056886, 5.612612027049503, 5.557582665502386, 5.586155789320701, 5.6264543834508505, 5.355479614182605, 5.498212063932444, 5.583149783861645, 5.191399300697012, 5.380637107808958, 5.678202780866139, 5.324758357613709, 5.391187730810593, 5.260521538253309, 5.613671824854331, 5.589123345717465, 5.289941496909444, 5.568733283234577, 5.505732148408013, 5.584407827714488, 5.344799748340453, 5.414284655120288, 5.221485599676986, 5.658210881926921, 5.530242903118211, 5.442319760370859, 5.542928238613476, 5.19273094450182, 5.245112552422771, 5.555160384688044, 5.358028676938619, 5.202909602234335, 5.4872196214889755, 5.3957189439950195, 5.621322377040292, 5.443164200212321, 5.3686323032270025, 5.43858712136764, 5.2036024015223425, 5.601774843568465, 5.605382761843597, 5.214087485784514, 5.263038653901605], "episode_lengths": [59, 78, 71, 49, 75, 71, 60, 77, 47, 73, 53, 57, 138, 65, 67, 143, 152, 50, 110, 112, 83, 113, 95, 107, 98, 64, 41, 66, 97, 95, 47, 54, 62, 62, 46, 49, 63, 76, 78, 87, 50, 100, 80, 71, 66, 73, 74, 47, 84, 76, 91, 52, 104, 65, 112, 80, 51, 66, 64, 62, 86, 67, 60, 53, 82, 90, 61, 123, 71, 69, 88, 57, 55, 79, 60, 74, 100, 63, 101, 50, 74, 58, 71, 73, 77, 51, 94, 90, 97, 61, 99, 86, 90, 72, 79, 83, 82, 63, 80, 55, 78, 66, 100, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23622487651355106, "mean_inference_ms": 1.3515638416882572, "mean_action_processing_ms": 0.12721885091798615, "mean_env_wait_ms": 2.4867944064613305, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 399600, "agent_timesteps_total": 399600, "timers": {"sample_time_ms": 7358.567, "sample_throughput": 1086.081, "load_time_ms": 3.303, "load_throughput": 2419319.228, "learn_time_ms": 6402.828, "learn_throughput": 1248.198, "update_time_ms": 3.111}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.053941939026117325, "policy_loss": -0.00892239436507225, "vf_loss": 0.06123017892241478, "vf_explained_var": 0.7390210032463074, "kl": 0.008170759305357933, "entropy": 1.5625461339950562, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 399600, "num_agent_steps_sampled": 399600, "num_steps_trained": 399600, "num_agent_steps_trained": 399600}, "done": false, "episodes_total": 2499, "training_iteration": 50, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-45-27", "timestamp": 1716403527, "time_this_iter_s": 13.987987279891968, "time_total_s": 574.4506347179413, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 574.4506347179413, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 35.37, "ram_util_percent": 33.505}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.682290868870235, "episode_reward_min": 5.0925511153184875, "episode_reward_mean": 5.401962960946415, "episode_len_mean": 76.00952380952381, "episode_media": {}, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2279724847559386, "reward_component_totals/rejoin_dist_change_reward_min": 0.9155511153184861, "reward_component_totals/rejoin_dist_change_reward_max": 1.5072908688702358, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9239904761904763, "reward_component_totals/success_reward_min": 1.851, "reward_component_totals/success_reward_max": 1.9569999999999999}, "hist_stats": {"episode_reward": [5.3974360957249425, 5.261433513916707, 5.553658695054078, 5.187527461943534, 5.408551924055459, 5.28378405585199, 5.413522895037192, 5.134732421287561, 5.422590013975148, 5.373566876610446, 5.542812380859095, 5.375778806275001, 5.388564160730171, 5.575813458493977, 5.29905525623807, 5.36666878360379, 5.5760890077168765, 5.323651394698139, 5.650293053397803, 5.130493472824593, 5.343215429678699, 5.658239628271799, 5.260830519572489, 5.603825648380664, 5.51408953461919, 5.601994003455325, 5.50427664132619, 5.616131484625441, 5.50427393988948, 5.484734377046834, 5.554417793670979, 5.397427871031019, 5.491627605423865, 5.19235215979811, 5.466767164879608, 5.252740822880523, 5.212836638231851, 5.176501424184137, 5.404176940982561, 5.682290868870235, 5.471459961145607, 5.45786945571154, 5.294646198452102, 5.581898681717377, 5.147318902264197, 5.363151582033332, 5.290368237476395, 5.248044998760787, 5.525848027152977, 5.476529213424111, 5.438517664319055, 5.393541947852243, 5.673788353734947, 5.397410759324135, 5.173483378353159, 5.278690187233018, 5.400263793422858, 5.264159425414984, 5.608105941701574, 5.364162443051732, 5.179419838819968, 5.429717368269673, 5.0925511153184875, 5.361340535238538, 5.177437316275854, 5.186682928932389, 5.570924220215297, 5.386838481372253, 5.3416151164523376, 5.665683165237398, 5.148167661455206, 5.639553073590543, 5.432209420441676, 5.3907723657856454, 5.548760089165292, 5.542180368720067, 5.523780972316595, 5.376144525117082, 5.361963343715139, 5.25611287875793, 5.38958855700722, 5.681972682408438, 5.52830486820247, 5.544648325136743, 5.317861346015459, 5.4801537447705835, 5.528898495988189, 5.409328555646266, 5.443316236131352, 5.316472309015674, 5.588797967839774, 5.535819780000344, 5.211330103460716, 5.341226950786691, 5.208365114043158, 5.527111437038554, 5.471277290543869, 5.337757524589896, 5.393771903392354, 5.158591537564519, 5.148291051372318, 5.174882816895469, 5.567794110877313, 5.303066433495134, 5.547593594294], "episode_lengths": [74, 76, 51, 111, 58, 102, 77, 114, 64, 52, 65, 99, 45, 77, 96, 69, 74, 64, 83, 56, 49, 60, 46, 57, 93, 50, 110, 55, 97, 101, 149, 78, 93, 85, 107, 80, 58, 44, 93, 75, 81, 90, 106, 101, 50, 49, 55, 47, 54, 74, 57, 62, 80, 73, 68, 82, 47, 47, 52, 123, 47, 62, 73, 56, 83, 54, 111, 64, 89, 84, 70, 68, 43, 111, 148, 64, 72, 72, 71, 58, 149, 54, 130, 56, 54, 66, 90, 70, 121, 77, 44, 52, 70, 78, 96, 74, 95, 86, 60, 91, 47, 58, 100, 84, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2374165060106384, "mean_inference_ms": 1.3584139600114544, "mean_action_processing_ms": 0.12790087725462185, "mean_env_wait_ms": 2.500169750536088, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 407592, "agent_timesteps_total": 407592, "timers": {"sample_time_ms": 7366.013, "sample_throughput": 1084.983, "load_time_ms": 3.416, "load_throughput": 2339405.782, "learn_time_ms": 6465.213, "learn_throughput": 1236.154, "update_time_ms": 3.136}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05356243997812271, "policy_loss": -0.00913988146930933, "vf_loss": 0.06028888002038002, "vf_explained_var": 0.7532796263694763, "kl": 0.01206719595938921, "entropy": 1.4738740921020508, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 407592, "num_agent_steps_sampled": 407592, "num_steps_trained": 407592, "num_agent_steps_trained": 407592}, "done": false, "episodes_total": 2604, "training_iteration": 51, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-45-42", "timestamp": 1716403542, "time_this_iter_s": 14.363439321517944, "time_total_s": 588.8140740394592, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 588.8140740394592, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 34.92857142857143, "ram_util_percent": 33.52857142857143}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.693716847726478, "episode_reward_min": 0.10413060914505612, "episode_reward_mean": 5.341416527544873, "episode_len_mean": 75.91509433962264, "episode_media": {}, "episodes_this_iter": 106, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9811320754716981, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.018867924528301886, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9622641509433965, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24528301886792453, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2660108671675137, "reward_component_totals/rejoin_dist_change_reward_min": 0.9626072380611128, "reward_component_totals/rejoin_dist_change_reward_max": 1.5087168477264767, "reward_component_totals/failure_reward_mean": -0.018867924528301886, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.88672641509434, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.962, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.389648625394674, 5.409551156837905, 5.539289640126155, 5.326954382342069, 5.232578770971693, 5.429114555708208, 5.247539643270075, 5.381720121219468, 5.591813480061113, 5.309628858463938, 5.44725374918125, 5.4171702325182824, 0.10413060914505612, 5.453878015976147, 5.250959315422854, 5.2670477169738446, 5.2069091139484485, 5.475722172272347, 5.534906281326716, 5.239839224909922, 5.651784791683379, 5.608643378625916, 5.642404187438968, 5.17345062089796, 5.610587693430848, 5.600202114257832, 5.555750469606831, 5.267194841798046, 5.4430888056883315, 5.279369241425879, 5.264205968512454, 5.6317828274905, 5.304915830456025, 5.239556227714116, 5.578219851111125, 5.448054217088224, 5.605544130541498, 5.586009874745098, 5.420276786203887, 5.505201814835621, 5.607148259983125, 5.491794326116413, 5.57103138615239, 5.5422080335683495, 5.535788250054231, 5.235174648894722, 5.558859474990897, 5.476856106731843, 5.590994310557318, 5.577589493693773, 5.693716847726478, 0.31258643126336727, 5.304088976092185, 5.114607238061113, 5.431991690885946, 5.554956462390047, 5.5453255433943625, 5.2296144548204735, 5.192224448703001, 5.594626662004043, 5.340768898110496, 5.659925759340199, 5.615324603641316, 5.4846527556544515, 5.319963137799919, 5.391231486968029, 5.316454687743526, 5.554178335162517, 5.2670287147887365, 5.477628123734332, 5.581482590593337, 5.493549138280878, 5.438598942640649, 5.253678934327248, 5.508059709641444, 5.23697469489889, 5.575708770789676, 5.314447623710876, 5.50644355664895, 5.494275465409395, 5.58059985919591, 5.493283674983045, 5.429872963655878, 5.376158238158766, 5.427089585836999, 5.286467072165545, 5.353950274112847, 5.252419055187468, 5.464125709459655, 5.333220542178137, 5.517314563083366, 5.274344747472912, 5.424148965837148, 5.524045675297167, 5.476554556924234, 5.58570305901595, 5.438091601031749, 5.409842057392866, 5.597411065079356, 5.624680798199982, 5.521917057024673, 5.347369421319241, 5.656701529469322, 5.210671129812596, 5.3096588676216365, 5.611051534648402], "episode_lengths": [104, 86, 57, 59, 54, 54, 50, 89, 94, 96, 54, 110, 15, 96, 72, 45, 82, 57, 135, 68, 61, 55, 65, 52, 65, 98, 56, 71, 74, 79, 127, 63, 142, 82, 49, 75, 60, 75, 115, 88, 84, 57, 49, 49, 70, 99, 77, 67, 64, 82, 65, 25, 69, 98, 91, 112, 62, 110, 66, 75, 56, 84, 54, 58, 86, 85, 88, 114, 110, 81, 84, 73, 97, 88, 60, 44, 85, 50, 94, 62, 68, 131, 57, 102, 74, 91, 129, 80, 59, 115, 58, 38, 64, 70, 101, 74, 74, 70, 81, 69, 57, 70, 61, 62, 45, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23966410947956676, "mean_inference_ms": 1.3664104911005825, "mean_action_processing_ms": 0.12876441075614548, "mean_env_wait_ms": 2.517029494272242, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 415584, "agent_timesteps_total": 415584, "timers": {"sample_time_ms": 7419.744, "sample_throughput": 1077.126, "load_time_ms": 3.412, "load_throughput": 2342528.325, "learn_time_ms": 6443.926, "learn_throughput": 1240.238, "update_time_ms": 3.081}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.08587901294231415, "policy_loss": -0.011013568378984928, "vf_loss": 0.09445081651210785, "vf_explained_var": 0.6830270886421204, "kl": 0.012208742089569569, "entropy": 1.4635059833526611, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 415584, "num_agent_steps_sampled": 415584, "num_steps_trained": 415584, "num_agent_steps_trained": 415584}, "done": false, "episodes_total": 2710, "training_iteration": 52, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-45-56", "timestamp": 1716403556, "time_this_iter_s": 14.25071668624878, "time_total_s": 603.064790725708, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 603.064790725708, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 35.625, "ram_util_percent": 33.585}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.681823224374659, "episode_reward_min": 5.079385458044806, "episode_reward_mean": 5.44019425170735, "episode_len_mean": 73.55555555555556, "episode_media": {}, "episodes_this_iter": 108, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2637498072629052, "reward_component_totals/rejoin_dist_change_reward_min": 0.9132633490457926, "reward_component_totals/rejoin_dist_change_reward_max": 1.494823224374659, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9264444444444446, "reward_component_totals/success_reward_min": 1.874, "reward_component_totals/success_reward_max": 1.9649999999999999}, "hist_stats": {"episode_reward": [5.586956860457619, 5.588638110430072, 5.548523549354398, 5.258020247691897, 5.362428833908356, 5.493273019315465, 5.474619539183726, 5.316627889346507, 5.079385458044806, 5.569767402477804, 5.568187177993014, 5.525402816301964, 5.464340552555521, 5.4039663574560395, 5.469128038214976, 5.548721110779349, 5.328532330789876, 5.410374145205472, 5.540118861600309, 5.529050212508697, 5.596076189482503, 5.560674398662082, 5.322162040937576, 5.5105948926395465, 5.1912385883593135, 5.198582859091908, 5.297791464194541, 5.419546200671324, 5.1156069139797005, 5.41974795524063, 5.347224878352723, 5.521660481650521, 5.672273798057959, 5.16242563903838, 5.341731930829303, 5.355036168119013, 5.378901109620225, 5.133938199903043, 5.500430385579028, 5.383994840062339, 5.374195991191595, 5.3573008493106355, 5.4866587378297424, 5.5222168602303, 5.56252122033753, 5.558974707155316, 5.302140651793616, 5.53657606592161, 5.22985708847788, 5.377714862491158, 5.32372731043896, 5.40675203902518, 5.360164768670261, 5.597610105289353, 5.238794644138736, 5.136570004387126, 5.681823224374659, 5.339353773361365, 5.200772319144323, 5.305560532089663, 5.164436833734873, 5.556416711939972, 5.284420008017156, 5.254156452067376, 5.380143895905433, 5.541661440699463, 5.237470668568786, 5.642839064278396, 5.551854224991436, 5.592517438490324, 5.419845375148972, 5.617822329428997, 5.553025430538911, 5.391194908696315, 5.490977683270112, 5.607046592792577, 5.483423094971565, 5.544903430479776, 5.634235016930498, 5.553077401309788, 5.434561576363809, 5.442989252994366, 5.497052089620832, 5.464693610342257, 5.677909422359241, 5.567649364078383, 5.624469096655442, 5.320179449130635, 5.6017988000688055, 5.35892485021678, 5.353772862201585, 5.596936701658774, 5.609610803099596, 5.611654287439418, 5.657729966118561, 5.512458620835157, 5.514660852080401, 5.652291714943619, 5.15037257201803, 5.30067557328176, 5.59169333668914, 5.534577435115694, 5.586737934444029, 5.450393836726263, 5.396752396115421, 5.589361981171085, 5.440352243571612, 5.104263349045794], "episode_lengths": [126, 53, 115, 92, 116, 87, 81, 79, 107, 74, 65, 79, 115, 47, 94, 100, 50, 46, 85, 66, 54, 72, 51, 51, 35, 106, 47, 99, 66, 115, 69, 63, 72, 80, 73, 80, 61, 74, 98, 71, 53, 90, 44, 94, 55, 53, 56, 62, 46, 76, 78, 107, 58, 68, 60, 53, 63, 79, 63, 66, 73, 102, 39, 58, 68, 48, 74, 60, 64, 57, 50, 57, 73, 74, 71, 78, 65, 62, 50, 74, 83, 54, 51, 62, 62, 72, 98, 68, 104, 116, 48, 93, 66, 80, 57, 116, 126, 75, 101, 105, 67, 111, 61, 62, 52, 66, 94, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.238340794611573, "mean_inference_ms": 1.370824287557988, "mean_action_processing_ms": 0.12910435434325032, "mean_env_wait_ms": 2.5241152097050623, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 423576, "agent_timesteps_total": 423576, "timers": {"sample_time_ms": 7374.853, "sample_throughput": 1083.683, "load_time_ms": 3.41, "load_throughput": 2343969.79, "learn_time_ms": 6401.576, "learn_throughput": 1248.443, "update_time_ms": 3.055}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.049773577600717545, "policy_loss": -0.008889149874448776, "vf_loss": 0.05658600106835365, "vf_explained_var": 0.7563512921333313, "kl": 0.010383673012256622, "entropy": 1.463026523590088, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 423576, "num_agent_steps_sampled": 423576, "num_steps_trained": 423576, "num_agent_steps_trained": 423576}, "done": false, "episodes_total": 2818, "training_iteration": 53, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-46-09", "timestamp": 1716403569, "time_this_iter_s": 12.867296934127808, "time_total_s": 615.9320876598358, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 615.9320876598358, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 34.02222222222222, "ram_util_percent": 33.455555555555556}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.691926634379093, "episode_reward_min": 5.128299228453018, "episode_reward_mean": 5.457684303994054, "episode_len_mean": 73.8348623853211, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2815191663793752, "reward_component_totals/rejoin_dist_change_reward_min": 0.9282992284530183, "reward_component_totals/rejoin_dist_change_reward_max": 1.506926634379093, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9261651376146791, "reward_component_totals/success_reward_min": 1.831, "reward_component_totals/success_reward_max": 1.9609999999999999}, "hist_stats": {"episode_reward": [5.573200658953911, 5.546010344644238, 5.608614410944924, 5.591614007081889, 5.656897900019691, 5.503127402423454, 5.269979159494689, 5.5513175221054345, 5.525076875410519, 5.6445743392769785, 5.59688067382535, 5.588221995943999, 5.504586154408336, 5.272854284014545, 5.264181730543825, 5.274511061387769, 5.211695467396524, 5.610958335432952, 5.53758636270913, 5.524838515399566, 5.304323383292562, 5.526620280481623, 5.342839493602684, 5.325914027774461, 5.598407937559987, 5.291451949082009, 5.602526267355028, 5.604969855979701, 5.647649464444761, 5.586135699545161, 5.59388132461936, 5.614326588744115, 5.379112136914928, 5.536071844490568, 5.221698608247266, 5.326052619684054, 5.308071410932595, 5.141166378721868, 5.465793633304397, 5.299729834894139, 5.438131975578175, 5.450765334777408, 5.441477636411901, 5.524808348380828, 5.312696269288516, 5.629683261760329, 5.39022705352682, 5.4320116183052995, 5.530903209489183, 5.34866230167982, 5.624489868568924, 5.415221338537657, 5.370747525073393, 5.638240068201084, 5.205686268631742, 5.481331753570165, 5.677749136860468, 5.378981620618003, 5.5091647407196, 5.60571546583418, 5.62985229731226, 5.622686352778766, 5.283468749407736, 5.451239309612918, 5.543831110000195, 5.587334985114489, 5.6032176270569956, 5.3240661267041425, 5.391395012662687, 5.590317765833934, 5.49617998599056, 5.506568314855095, 5.46137862130642, 5.50330995037378, 5.6615121356844895, 5.408697201815389, 5.383559558299591, 5.423542982098325, 5.14420846616955, 5.569011354649023, 5.649358897494022, 5.56463738722539, 5.240737222882775, 5.128299228453018, 5.264575209773627, 5.340512315580112, 5.316563041272673, 5.186668354879324, 5.449132450196925, 5.344984860671499, 5.510580183784031, 5.316723831037379, 5.469944741472535, 5.5375775273487315, 5.691926634379093, 5.578608923441372, 5.287908948301358, 5.492819707814466, 5.409241426010277, 5.533868208418344, 5.54309186356222, 5.557113886084678, 5.298497763575199, 5.635818787178632, 5.198116879018663, 5.360839149657988, 5.585927387253243, 5.536016776765422, 5.291954897190074], "episode_lengths": [95, 49, 49, 68, 56, 95, 59, 82, 60, 99, 78, 64, 107, 39, 118, 67, 75, 94, 64, 102, 112, 53, 95, 97, 68, 40, 86, 54, 60, 63, 95, 49, 82, 79, 72, 54, 90, 65, 65, 169, 46, 97, 73, 109, 51, 57, 44, 50, 102, 51, 95, 56, 54, 65, 104, 61, 49, 99, 71, 133, 73, 77, 81, 85, 68, 76, 62, 75, 73, 64, 64, 48, 89, 77, 75, 96, 80, 92, 70, 66, 67, 87, 56, 50, 39, 45, 54, 74, 82, 60, 52, 106, 86, 52, 65, 140, 129, 50, 53, 75, 110, 56, 42, 104, 73, 57, 52, 61, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24158697205897353, "mean_inference_ms": 1.3716053543138242, "mean_action_processing_ms": 0.12920121434107731, "mean_env_wait_ms": 2.5255762137021796, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 431568, "agent_timesteps_total": 431568, "timers": {"sample_time_ms": 7254.053, "sample_throughput": 1101.729, "load_time_ms": 3.399, "load_throughput": 2350956.459, "learn_time_ms": 6366.289, "learn_throughput": 1255.362, "update_time_ms": 3.04}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04710712283849716, "policy_loss": -0.011451182886958122, "vf_loss": 0.05655005946755409, "vf_explained_var": 0.7784086465835571, "kl": 0.010041223838925362, "entropy": 1.4573302268981934, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 431568, "num_agent_steps_sampled": 431568, "num_steps_trained": 431568, "num_agent_steps_trained": 431568}, "done": false, "episodes_total": 2927, "training_iteration": 54, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-46-21", "timestamp": 1716403581, "time_this_iter_s": 12.370039224624634, "time_total_s": 628.3021268844604, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 628.3021268844604, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 32.99444444444444, "ram_util_percent": 33.5}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.71363300140963, "episode_reward_min": 5.0828001915996595, "episode_reward_mean": 5.450781252325838, "episode_len_mean": 73.61467889908256, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2743959312249202, "reward_component_totals/rejoin_dist_change_reward_min": 0.9318001915996597, "reward_component_totals/rejoin_dist_change_reward_max": 1.519633001409631, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9263853211009176, "reward_component_totals/success_reward_min": 1.85, "reward_component_totals/success_reward_max": 1.962}, "hist_stats": {"episode_reward": [5.47720199148676, 5.221834426185049, 5.6653775025304896, 5.409605766067417, 5.6010103668508995, 5.647191304947668, 5.594370551204888, 5.515805293461794, 5.701542531252543, 5.543315516823663, 5.61978121046393, 5.165108585768923, 5.431525352387094, 5.610364535519167, 5.2874142359950715, 5.383268443104488, 5.557712985306836, 5.414626570314229, 5.624769998867405, 5.71363300140963, 5.273823641800178, 5.566229289716251, 5.580033560191721, 5.455826556231242, 5.305933359067666, 5.577036490416151, 5.497843204054951, 5.119872747477592, 5.307316182808704, 5.129347200870387, 5.576895066926323, 5.437684414462044, 5.209609366185269, 5.292528848916586, 5.513304326867519, 5.523885319410633, 5.572203861917185, 5.6816378379808175, 5.416332586122891, 5.350222361824147, 5.46947859520464, 5.270844373519523, 5.3162975647102755, 5.462411139875064, 5.664453646498278, 5.441564744101706, 5.281140881055908, 5.3572551262429435, 5.323869394815684, 5.2398375756667654, 5.598074922140233, 5.239181724413143, 5.397515763560492, 5.267852416758011, 5.313377074134252, 5.5229920120936775, 5.4145196371087, 5.515281266370685, 5.252452822591589, 5.332173311244681, 5.51667343013909, 5.495627011928705, 5.380088035598453, 5.0828001915996595, 5.565222493829381, 5.178732674115258, 5.622120580326236, 5.570774298163506, 5.255787074352588, 5.24180082856271, 5.384788629764705, 5.503555217149441, 5.5300237789681885, 5.600749086614533, 5.580143743476366, 5.6348514631629225, 5.352689500944532, 5.277118831167947, 5.401357010973129, 5.295583196870713, 5.664012181354386, 5.538759804683409, 5.332519350073637, 5.3191317353129115, 5.433327484857853, 5.571681032981683, 5.4916988478445425, 5.354321572778577, 5.466205991710593, 5.6136911993164595, 5.523266426042735, 5.483401527043535, 5.460676068082472, 5.443586399771258, 5.387280458220014, 5.562220671499768, 5.335792825863255, 5.608910464807344, 5.568442056256959, 5.591496615889698, 5.6451611826386445, 5.5992605057174085, 5.558456409825865, 5.655889597937426, 5.483576095232454, 5.642021181400407, 5.360300711339185, 5.335142557278752, 5.380838084744588], "episode_lengths": [49, 40, 55, 50, 88, 74, 61, 126, 50, 103, 78, 60, 56, 55, 136, 102, 57, 67, 53, 56, 88, 62, 117, 125, 62, 58, 150, 75, 49, 61, 53, 76, 64, 69, 116, 90, 111, 61, 59, 74, 67, 72, 54, 52, 83, 131, 56, 75, 83, 69, 57, 73, 78, 83, 50, 60, 64, 134, 89, 40, 60, 101, 47, 99, 85, 54, 54, 70, 38, 62, 127, 129, 80, 47, 57, 54, 59, 62, 63, 49, 53, 88, 64, 54, 80, 83, 97, 117, 54, 52, 98, 78, 92, 68, 50, 48, 53, 95, 76, 71, 56, 116, 44, 56, 83, 87, 46, 113, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2416937014768586, "mean_inference_ms": 1.3753200490947348, "mean_action_processing_ms": 0.12960727771870134, "mean_env_wait_ms": 2.5329095249302656, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 439560, "agent_timesteps_total": 439560, "timers": {"sample_time_ms": 7208.158, "sample_throughput": 1108.744, "load_time_ms": 3.393, "load_throughput": 2355516.033, "learn_time_ms": 6348.576, "learn_throughput": 1258.865, "update_time_ms": 3.011}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04813811182975769, "policy_loss": -0.009310884401202202, "vf_loss": 0.05529481917619705, "vf_explained_var": 0.7916531562805176, "kl": 0.010770914144814014, "entropy": 1.463316559791565, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 439560, "num_agent_steps_sampled": 439560, "num_steps_trained": 439560, "num_agent_steps_trained": 439560}, "done": false, "episodes_total": 3036, "training_iteration": 55, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-46-35", "timestamp": 1716403595, "time_this_iter_s": 13.09049654006958, "time_total_s": 641.39262342453, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 641.39262342453, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 33.56842105263158, "ram_util_percent": 33.5}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.670504457492054, "episode_reward_min": 5.1024335349365755, "episode_reward_mean": 5.4366695261904106, "episode_len_mean": 76.95098039215686, "episode_media": {}, "episodes_this_iter": 102, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2636205065825659, "reward_component_totals/rejoin_dist_change_reward_min": 0.9354335349365748, "reward_component_totals/rejoin_dist_change_reward_max": 1.4992723436724638, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.923049019607843, "reward_component_totals/success_reward_min": 1.865, "reward_component_totals/success_reward_max": 1.959}, "hist_stats": {"episode_reward": [5.435362501688818, 5.358075292236664, 5.582088175204632, 5.5997252029849705, 5.32547947890848, 5.496169358976136, 5.54066584119507, 5.23663493815443, 5.228310208668175, 5.503840404350104, 5.436539285538313, 5.1024335349365755, 5.670504457492054, 5.374642381578999, 5.646734455088595, 5.215377357652953, 5.585696489374881, 5.200470939290009, 5.518679729976817, 5.6296160531992925, 5.603039115992489, 5.368692512533598, 5.506428536814626, 5.149643107050332, 5.147193350371713, 5.544722021297925, 5.340961555847282, 5.228862903665436, 5.584244855384757, 5.646397366734048, 5.463947169864017, 5.208465602370865, 5.594141266186181, 5.277830452581809, 5.570065292927212, 5.4989028137025375, 5.278968546828107, 5.666057176852391, 5.311682283440275, 5.475739471370798, 5.599242282389486, 5.341555209804676, 5.290438883280746, 5.350657620008301, 5.551910770608478, 5.661049770630601, 5.2397949942798085, 5.559019324161703, 5.6672723436724635, 5.287037234646874, 5.556604537244229, 5.632655428461463, 5.308530491688174, 5.382553364614289, 5.535131946459568, 5.403111013791376, 5.3384156187570095, 5.536169421750161, 5.329011432444522, 5.478494054518901, 5.659355352460915, 5.487435888419787, 5.595462981791927, 5.187009425558841, 5.314615039057505, 5.408399705891114, 5.551975154936892, 5.309753981280741, 5.521570197561887, 5.436145067828692, 5.2639297170409485, 5.372554549118585, 5.268308916139036, 5.469592679716981, 5.469171245074706, 5.518348518296543, 5.55654404114407, 5.564062658454235, 5.6622541610015755, 5.323045992043689, 5.488494597800816, 5.246861238576763, 5.668636626188459, 5.4806128902757925, 5.257895975555297, 5.483970956695403, 5.290614916798573, 5.613393659239824, 5.562143034331094, 5.344692152578425, 5.261596849206917, 5.44742754207601, 5.63611450094859, 5.365587630623106, 5.526515747495154, 5.379505146795832, 5.305565833470221, 5.6240117191024535, 5.273123510775871, 5.440146028429102, 5.249562139657096, 5.45259647045706], "episode_lengths": [62, 58, 52, 53, 95, 85, 84, 135, 96, 57, 50, 83, 66, 45, 62, 42, 88, 57, 59, 99, 84, 55, 102, 70, 44, 73, 46, 99, 70, 67, 60, 77, 99, 102, 62, 104, 74, 49, 130, 107, 52, 44, 84, 130, 62, 85, 130, 112, 82, 85, 102, 75, 57, 84, 67, 51, 53, 71, 55, 84, 57, 69, 103, 93, 124, 99, 94, 82, 82, 50, 48, 105, 67, 107, 107, 77, 86, 134, 56, 95, 63, 53, 69, 46, 41, 103, 56, 102, 68, 57, 91, 79, 61, 54, 98, 42, 62, 60, 73, 116, 102, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24353298929161077, "mean_inference_ms": 1.3791906618662626, "mean_action_processing_ms": 0.13004521007779835, "mean_env_wait_ms": 2.5400282600125346, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 447552, "agent_timesteps_total": 447552, "timers": {"sample_time_ms": 7179.555, "sample_throughput": 1113.161, "load_time_ms": 3.395, "load_throughput": 2354341.41, "learn_time_ms": 6328.088, "learn_throughput": 1262.941, "update_time_ms": 2.992}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04246556758880615, "policy_loss": -0.010780507698655128, "vf_loss": 0.05087441951036453, "vf_explained_var": 0.7898785471916199, "kl": 0.011858297511935234, "entropy": 1.484768033027649, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 447552, "num_agent_steps_sampled": 447552, "num_steps_trained": 447552, "num_agent_steps_trained": 447552}, "done": false, "episodes_total": 3138, "training_iteration": 56, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-46-48", "timestamp": 1716403608, "time_this_iter_s": 13.093765497207642, "time_total_s": 654.4863889217377, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 654.4863889217377, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 34.8, "ram_util_percent": 33.56111111111111}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.689060693241945, "episode_reward_min": 0.30430777376231744, "episode_reward_mean": 5.399753550081376, "episode_len_mean": 75.71028037383178, "episode_media": {}, "episodes_this_iter": 107, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9906542056074766, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.009345794392523364, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9813084112149535, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24766355140186916, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2743610267168903, "reward_component_totals/rejoin_dist_change_reward_min": 0.9305609276381421, "reward_component_totals/rejoin_dist_change_reward_max": 1.5150606932419455, "reward_component_totals/failure_reward_mean": -0.009345794392523364, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9057663551401869, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.9609999999999999, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.4523870237842464, 5.687939587768571, 5.540978705950285, 5.42594251997372, 5.224949692479661, 5.607759024581943, 0.30430777376231744, 5.477235026235023, 5.649333847285025, 5.667785209029415, 5.2568133880148125, 5.595664778138724, 5.487282515099262, 5.392630184368173, 5.498864795647748, 5.510126111691467, 5.329125688527155, 5.689060693241945, 5.509642093649832, 5.516393562896528, 5.365104839152519, 5.420772519069358, 5.617469746353363, 5.406055022600982, 5.506414775464245, 5.558548865509336, 5.453998805801022, 5.238569385765738, 5.6783048824910365, 5.665684066817407, 5.167631652218132, 5.249667770050767, 5.200998775904836, 5.376497900527128, 5.302763775440079, 5.344001325034332, 5.492898161122286, 5.617392995937809, 5.181098633475642, 5.415766447708301, 5.576272456753396, 5.544143209900106, 5.4518318483827155, 5.532753369697451, 5.23431058995747, 5.655484527685061, 5.268820398517347, 5.464344108186202, 5.2218234153620955, 5.1850927336498716, 5.316175824833389, 5.425890509014845, 5.516353947180041, 5.1670220562184115, 5.507592548612254, 5.490327161604738, 5.411995439664475, 5.101560927638142, 5.256085882149133, 5.257495937840122, 5.319764704850485, 5.636341353018705, 5.665593746645241, 5.5173765493571425, 5.542158422875568, 5.510600432244292, 5.5339979177813845, 5.618359219847307, 5.288313027866886, 5.441301680436258, 5.554915223158768, 5.65468668451766, 5.250218369939709, 5.424703653282672, 5.632381872444754, 5.476998096375107, 5.371562760160163, 5.396200649228286, 5.681790103301848, 5.4885021415007245, 5.353087862805287, 5.5123629102578295, 5.226213592791952, 5.340029002024709, 5.567865374568596, 5.664121030904835, 5.569195147560851, 5.512783627752707, 5.474385568153204, 5.258782956992768, 5.530321662399473, 5.563107626249161, 5.270296407800742, 5.528899192036072, 5.286117987192977, 5.367662634596761, 5.618577990504866, 5.577411166411023, 5.380468653955941, 5.635337833611742, 5.526691157352422, 5.378266075863795, 5.454442343667022, 5.176642846458868, 5.267697153153675, 5.499249749833059, 5.558606233556489], "episode_lengths": [93, 62, 105, 62, 53, 86, 18, 46, 79, 81, 53, 59, 62, 81, 88, 111, 125, 76, 100, 55, 77, 124, 64, 97, 81, 63, 117, 100, 66, 65, 50, 62, 50, 60, 57, 78, 53, 48, 101, 49, 94, 78, 97, 56, 39, 57, 61, 68, 46, 88, 52, 69, 76, 142, 55, 57, 60, 79, 43, 120, 58, 49, 55, 104, 67, 82, 67, 57, 110, 124, 69, 98, 53, 95, 86, 53, 101, 61, 57, 102, 43, 72, 123, 79, 85, 95, 67, 98, 73, 52, 76, 90, 69, 95, 103, 95, 53, 59, 95, 55, 78, 95, 70, 57, 72, 84, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24359619405903166, "mean_inference_ms": 1.3819121386777777, "mean_action_processing_ms": 0.13015061042511442, "mean_env_wait_ms": 2.545599688351825, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 455544, "agent_timesteps_total": 455544, "timers": {"sample_time_ms": 7113.016, "sample_throughput": 1123.574, "load_time_ms": 3.393, "load_throughput": 2355615.351, "learn_time_ms": 6317.043, "learn_throughput": 1265.149, "update_time_ms": 2.979}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05466054379940033, "policy_loss": -0.011781002394855022, "vf_loss": 0.06414720416069031, "vf_explained_var": 0.7572490572929382, "kl": 0.011471731588244438, "entropy": 1.4495600461959839, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 455544, "num_agent_steps_sampled": 455544, "num_steps_trained": 455544, "num_agent_steps_trained": 455544}, "done": false, "episodes_total": 3245, "training_iteration": 57, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-47-01", "timestamp": 1716403621, "time_this_iter_s": 12.873881340026855, "time_total_s": 667.3602702617645, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 667.3602702617645, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 33.75263157894737, "ram_util_percent": 33.5}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.691446195623161, "episode_reward_min": 5.087892484782599, "episode_reward_mean": 5.452904793596932, "episode_len_mean": 75.84615384615384, "episode_media": {}, "episodes_this_iter": 104, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2787509474430863, "reward_component_totals/rejoin_dist_change_reward_min": 0.9378924847825991, "reward_component_totals/rejoin_dist_change_reward_max": 1.509446195623161, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9241538461538459, "reward_component_totals/success_reward_min": 1.851, "reward_component_totals/success_reward_max": 1.9569999999999999}, "hist_stats": {"episode_reward": [5.481056320206882, 5.691446195623161, 5.449824224661068, 5.360227542520583, 5.504753839693514, 5.244889137507749, 5.254202272559281, 5.22475663684456, 5.67335655075407, 5.354483995433254, 5.655617446894993, 5.647460374675936, 5.480059222912184, 5.589939938555516, 5.46048267062473, 5.459657677069356, 5.561718564499888, 5.2107440768788225, 5.333445250914094, 5.540913405637944, 5.538299527664163, 5.5765545472175635, 5.609747829263791, 5.431409992319013, 5.688996073865271, 5.539108979945038, 5.2385694708330846, 5.584289933972913, 5.498055113060594, 5.52265768138071, 5.390189451275326, 5.58545456898876, 5.405373727641818, 5.54645775165808, 5.267162193171442, 5.262823243014756, 5.399212793472362, 5.633680769788231, 5.358286797649574, 5.39327741473375, 5.529603159274808, 5.340690206193795, 5.578306820543942, 5.622966655807927, 5.626087177379157, 5.612429943432577, 5.404067631392934, 5.291542761629006, 5.436329983749184, 5.310876439334051, 5.524360781100321, 5.193901834684871, 5.505878987804025, 5.356169193113377, 5.487295812392401, 5.656639337422291, 5.494192160055449, 5.169912131059865, 5.441870603738659, 5.465565455819628, 5.44600437948788, 5.134638030608649, 5.477984851774256, 5.590898679015634, 5.584859718384906, 5.496124311685538, 5.442433985648604, 5.632424743480868, 5.531528346620549, 5.589680540924731, 5.258535971654, 5.47759087985298, 5.270362557317052, 5.087892484782599, 5.546640876970171, 5.323302133531082, 5.472035430346137, 5.280680787040641, 5.478511544814078, 5.175520986857967, 5.273966621154954, 5.573168595920744, 5.498273438487532, 5.46226147948475, 5.376009921578454, 5.426707241463808, 5.498780122933438, 5.229703733912568, 5.280885254340249, 5.370687720261663, 5.367705700426239, 5.577727811303512, 5.574859738292643, 5.561732370895378, 5.327968774868559, 5.616554204958652, 5.449067744409865, 5.662531993915737, 5.51728201075238, 5.585787585003741, 5.352052085039818, 5.545789572886411, 5.527786288932914, 5.449827000746549], "episode_lengths": [91, 68, 73, 59, 60, 99, 73, 78, 58, 55, 54, 105, 108, 87, 45, 48, 83, 70, 62, 47, 50, 53, 76, 46, 59, 51, 56, 60, 79, 140, 90, 59, 51, 55, 57, 86, 78, 50, 58, 61, 94, 125, 84, 75, 50, 69, 71, 58, 55, 70, 133, 67, 102, 89, 51, 99, 55, 98, 107, 111, 67, 75, 85, 93, 51, 128, 100, 75, 49, 59, 47, 71, 69, 100, 64, 71, 86, 43, 122, 61, 54, 143, 71, 79, 81, 56, 47, 102, 58, 75, 64, 80, 58, 91, 113, 95, 120, 75, 91, 49, 47, 94, 149, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24537658308760407, "mean_inference_ms": 1.382887506727216, "mean_action_processing_ms": 0.13027247567890457, "mean_env_wait_ms": 2.5476647592760986, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 463536, "agent_timesteps_total": 463536, "timers": {"sample_time_ms": 7002.06, "sample_throughput": 1141.378, "load_time_ms": 3.398, "load_throughput": 2352243.244, "learn_time_ms": 6288.475, "learn_throughput": 1270.896, "update_time_ms": 2.952}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04773615673184395, "policy_loss": -0.009895151481032372, "vf_loss": 0.05531007796525955, "vf_explained_var": 0.7820088267326355, "kl": 0.011606129817664623, "entropy": 1.4203588962554932, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 463536, "num_agent_steps_sampled": 463536, "num_steps_trained": 463536, "num_agent_steps_trained": 463536}, "done": false, "episodes_total": 3349, "training_iteration": 58, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-47-13", "timestamp": 1716403633, "time_this_iter_s": 12.418984651565552, "time_total_s": 679.7792549133301, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 679.7792549133301, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 32.83888888888889, "ram_util_percent": 33.5}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.710683775425922, "episode_reward_min": 5.075647502013249, "episode_reward_mean": 5.45757437707928, "episode_len_mean": 76.0952380952381, "episode_media": {}, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2836696151745184, "reward_component_totals/rejoin_dist_change_reward_min": 0.9246475020132492, "reward_component_totals/rejoin_dist_change_reward_max": 1.5166837754259217, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9239047619047625, "reward_component_totals/success_reward_min": 1.855, "reward_component_totals/success_reward_max": 1.9609999999999999}, "hist_stats": {"episode_reward": [5.47794447832379, 5.46538450050338, 5.572392961163377, 5.64843885872677, 5.075647502013249, 5.681162748471414, 5.436329325030339, 5.388753410861556, 5.620625005344204, 5.21262020008041, 5.655012139193388, 5.5809143965985815, 5.498217016748356, 5.568993654270514, 5.441133743698794, 5.280761434426084, 5.17892922070282, 5.522351449494003, 5.552176150167724, 5.623441297745333, 5.404390881650011, 5.367970367227949, 5.5536150340231085, 5.68717082333708, 5.296294428264684, 5.584883271309396, 5.608701199745081, 5.555796577953199, 5.5336895029188025, 5.628758864009722, 5.558406163569552, 5.337943476032471, 5.172950585389683, 5.257919332165622, 5.6375830949493455, 5.308705689075689, 5.208809758463595, 5.295530823434184, 5.338570224653568, 5.251598409190462, 5.546214317333309, 5.442725876975001, 5.215420740042164, 5.314317041964015, 5.5936837836994515, 5.5750263630529835, 5.2756299258078885, 5.67741615776003, 5.391276759319334, 5.548964556238884, 5.430331579519503, 5.539332644104443, 5.2484432491253035, 5.247433366637391, 5.162770761709962, 5.430157734021735, 5.20149399777047, 5.1225937735946445, 5.643079926696865, 5.525323781592333, 5.617170318728764, 5.35650864906912, 5.358131231277605, 5.554036233959254, 5.173385000922486, 5.594348690974184, 5.270473864689131, 5.64528029568191, 5.587574025803149, 5.649240524633672, 5.5066594441695, 5.526372003388763, 5.289620540056844, 5.448697437462992, 5.577685683422301, 5.385538234364995, 5.30869295628897, 5.5418581067131, 5.647041718693149, 5.173510349747168, 5.474686870593853, 5.610855300832464, 5.585260649944091, 5.710683775425922, 5.464766466290449, 5.634398581731987, 5.450575476300008, 5.449144228809258, 5.541299653051994, 5.4455234749465005, 5.257524540749275, 5.117434412366846, 5.447413859970595, 5.573355817655303, 5.655220056118434, 5.498451993372161, 5.5870441879805, 5.5374901925908215, 5.229489120522924, 5.299123927369079, 5.64867242893948, 5.624142731976873, 5.529240688600066, 5.680119538190482, 5.579411971054966], "episode_lengths": [111, 75, 145, 88, 99, 63, 48, 113, 98, 48, 69, 72, 48, 61, 60, 39, 59, 63, 114, 52, 96, 76, 101, 64, 45, 92, 58, 67, 49, 77, 107, 105, 50, 58, 102, 74, 79, 54, 52, 83, 128, 54, 72, 91, 50, 94, 65, 54, 61, 107, 62, 106, 58, 59, 76, 72, 62, 110, 71, 74, 90, 128, 87, 78, 130, 120, 50, 105, 45, 59, 43, 79, 40, 140, 69, 70, 60, 46, 64, 57, 54, 55, 64, 56, 57, 105, 76, 111, 97, 76, 64, 60, 100, 70, 87, 61, 109, 102, 80, 84, 54, 55, 61, 77, 75]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24499282025697808, "mean_inference_ms": 1.3848659168223945, "mean_action_processing_ms": 0.13054271765535452, "mean_env_wait_ms": 2.5518449317836245, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 471528, "agent_timesteps_total": 471528, "timers": {"sample_time_ms": 6933.483, "sample_throughput": 1152.667, "load_time_ms": 3.343, "load_throughput": 2390813.409, "learn_time_ms": 6281.968, "learn_throughput": 1272.213, "update_time_ms": 2.97}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.041437115520238876, "policy_loss": -0.01438993588089943, "vf_loss": 0.05346255004405975, "vf_explained_var": 0.7819733619689941, "kl": 0.011822480708360672, "entropy": 1.421027660369873, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 471528, "num_agent_steps_sampled": 471528, "num_steps_trained": 471528, "num_agent_steps_trained": 471528}, "done": false, "episodes_total": 3454, "training_iteration": 59, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-47-26", "timestamp": 1716403646, "time_this_iter_s": 13.04996132850647, "time_total_s": 692.8292162418365, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 692.8292162418365, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 34.0, "ram_util_percent": 33.53333333333333}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.660629263973517, "episode_reward_min": 5.095473604674304, "episode_reward_mean": 5.433964911876929, "episode_len_mean": 74.8411214953271, "episode_media": {}, "episodes_this_iter": 107, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2588060333722555, "reward_component_totals/rejoin_dist_change_reward_min": 0.9641557603138111, "reward_component_totals/rejoin_dist_change_reward_max": 1.4776925821169977, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9251588785046732, "reward_component_totals/success_reward_min": 1.838, "reward_component_totals/success_reward_max": 1.9569999999999999}, "hist_stats": {"episode_reward": [5.329167348617958, 5.468141224710225, 5.510115413256031, 5.161249431756023, 5.644980519709336, 5.501694368793164, 5.565301735547983, 5.465561858003284, 5.600390897573228, 5.46564199848635, 5.6253726037845375, 5.36407840259579, 5.624214247446131, 5.4393527747373644, 5.551224861939124, 5.1670908420504436, 5.453883297716309, 5.558211171589759, 5.522869512876686, 5.564478252497537, 5.462897714855687, 5.617692582116997, 5.389385704466175, 5.639743594945136, 5.569242081323392, 5.562146331114954, 5.597100226706304, 5.499009372384148, 5.572116913898048, 5.545490373612195, 5.22773125670971, 5.433713384639908, 5.523247708684471, 5.3103698998061155, 5.286005935238174, 5.64864386190135, 5.42037109466677, 5.1902367132779155, 5.316591143877926, 5.660629263973517, 5.3733683536175345, 5.493443620060471, 5.438558191082908, 5.2950263469560515, 5.5290939311932625, 5.429925915795801, 5.254118414176514, 5.233152953656093, 5.250496649522205, 5.599540762813914, 5.422736343988623, 5.455449593753707, 5.374440335301075, 5.580488412151601, 5.400249365493147, 5.246067279531532, 5.298987203635783, 5.642066290655803, 5.3367552333697335, 5.515753097828485, 5.373924265548284, 5.446038027133005, 5.607266710499994, 5.305187884192328, 5.508003113841468, 5.460483730240375, 5.178672706877405, 5.605650529705341, 5.344841573182302, 5.45906470349696, 5.535439321611998, 5.3953732188672205, 5.624521937185486, 5.2515988007386625, 5.462911668479258, 5.144314440533347, 5.557275625018907, 5.540785915655164, 5.4083930537783695, 5.2268541435031, 5.613287808258936, 5.39968823309928, 5.095473604674304, 5.193685155820889, 5.649942678738741, 5.430341593733833, 5.571890721848871, 5.321710925803779, 5.506500819677607, 5.152155760313811, 5.615207239709203, 5.564491637245686, 5.153670074120286, 5.314308690048607, 5.412341495088391, 5.267261150978369, 5.352730209482703, 5.646344326288663, 5.585795705163301, 5.184556020586882, 5.21316706333914, 5.485966932650793, 5.5689143101703245, 5.435035459627155, 5.178766826744212, 5.412291630027827, 5.44701391103038], "episode_lengths": [143, 59, 79, 91, 55, 53, 76, 81, 115, 70, 62, 86, 92, 95, 77, 67, 98, 128, 162, 49, 43, 110, 52, 75, 89, 103, 104, 46, 54, 61, 46, 51, 56, 57, 78, 60, 74, 45, 56, 52, 91, 127, 49, 71, 57, 47, 106, 63, 99, 96, 44, 78, 69, 81, 66, 72, 73, 65, 83, 48, 46, 69, 54, 58, 66, 80, 45, 56, 66, 54, 89, 67, 79, 108, 49, 95, 60, 66, 73, 86, 109, 57, 127, 96, 50, 93, 100, 116, 83, 62, 80, 85, 95, 60, 69, 74, 95, 54, 87, 55, 50, 53, 50, 93, 51, 90, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24522517828300747, "mean_inference_ms": 1.3954402648814428, "mean_action_processing_ms": 0.13151975175732358, "mean_env_wait_ms": 2.571992371470515, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 479520, "agent_timesteps_total": 479520, "timers": {"sample_time_ms": 7030.724, "sample_throughput": 1136.725, "load_time_ms": 3.415, "load_throughput": 2340598.231, "learn_time_ms": 6294.956, "learn_throughput": 1269.588, "update_time_ms": 2.965}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04841829463839531, "policy_loss": -0.009691234678030014, "vf_loss": 0.05589447170495987, "vf_explained_var": 0.7730624675750732, "kl": 0.011075337417423725, "entropy": 1.4058544635772705, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 479520, "num_agent_steps_sampled": 479520, "num_steps_trained": 479520, "num_agent_steps_trained": 479520}, "done": false, "episodes_total": 3561, "training_iteration": 60, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-47-41", "timestamp": 1716403661, "time_this_iter_s": 15.090805768966675, "time_total_s": 707.9200220108032, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 707.9200220108032, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 36.53181818181818, "ram_util_percent": 33.5}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.71546577872063, "episode_reward_min": 5.159639272025151, "episode_reward_mean": 5.4550258001000405, "episode_len_mean": 74.91743119266054, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2799432312927015, "reward_component_totals/rejoin_dist_change_reward_min": 0.9826392720251502, "reward_component_totals/rejoin_dist_change_reward_max": 1.5206020063275634, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9250825688073396, "reward_component_totals/success_reward_min": 1.8399999999999999, "reward_component_totals/success_reward_max": 1.9609999999999999}, "hist_stats": {"episode_reward": [5.4298752808043975, 5.298193479919718, 5.67600437591558, 5.224854227812141, 5.455997137528398, 5.241148720533866, 5.591213833389083, 5.52329251427379, 5.5131966569862065, 5.41689439685628, 5.525758003313922, 5.3668214451144465, 5.592285770300777, 5.30154612282959, 5.193547189730906, 5.377999885794886, 5.254762421634085, 5.429475695781708, 5.692062705971816, 5.436828313862726, 5.498415001432262, 5.615918783883985, 5.5294820428209945, 5.484228997172693, 5.486086991773291, 5.475792220111629, 5.475790385244377, 5.56323685196249, 5.706602006327563, 5.605560284647036, 5.397190188076792, 5.6307471713998805, 5.663760372922212, 5.268227769961957, 5.300342632167846, 5.193895250603042, 5.275713039311237, 5.6128232002530964, 5.537583553659046, 5.524439804104366, 5.289587728446749, 5.590968552917907, 5.3002589135320175, 5.6552568535192, 5.494283501914603, 5.193064501326911, 5.516001219213749, 5.667724537513783, 5.518172043435892, 5.4616418555513615, 5.489057136149526, 5.386474995588741, 5.362616666491517, 5.34257614734273, 5.607725671476124, 5.597317599721571, 5.651764578659716, 5.27050950114067, 5.4895671318453925, 5.241654345996875, 5.61751858265753, 5.440161859457303, 5.27748446609484, 5.4685550859380445, 5.314529037805489, 5.314774963157626, 5.433755946953632, 5.652869802708352, 5.267760301080055, 5.302215027645511, 5.418097677500355, 5.549130118324009, 5.5661153308511615, 5.390939239153759, 5.329979906824015, 5.429907688314211, 5.563869895498538, 5.447743142214227, 5.3547223826407, 5.627041732661924, 5.506436982614824, 5.49976762868386, 5.436696195124192, 5.627862989615286, 5.397255434250077, 5.66087687017269, 5.3408096886826035, 5.159639272025151, 5.492573100768693, 5.611266004492693, 5.198168509104436, 5.550916582664344, 5.638810615740097, 5.246949841096669, 5.309528869868998, 5.71546577872063, 5.644769922186226, 5.5481981537633285, 5.501559272520871, 5.2546933410985766, 5.555911182358933, 5.509287753832929, 5.463033470534215, 5.536287433326526, 5.340364961817135, 5.654246791784713, 5.474843168597114, 5.26224409833177, 5.178357901670439], "episode_lengths": [75, 75, 71, 83, 116, 56, 95, 102, 90, 84, 85, 71, 61, 53, 82, 116, 54, 80, 54, 77, 82, 59, 47, 59, 47, 50, 66, 63, 64, 80, 124, 50, 75, 74, 39, 96, 76, 74, 160, 56, 91, 68, 47, 64, 125, 59, 45, 86, 72, 57, 72, 86, 114, 91, 52, 105, 93, 52, 43, 109, 56, 96, 70, 109, 53, 66, 80, 86, 81, 41, 48, 89, 112, 65, 54, 79, 92, 137, 52, 76, 68, 58, 49, 68, 65, 102, 46, 73, 89, 78, 85, 53, 67, 80, 70, 51, 59, 56, 51, 80, 83, 96, 54, 110, 51, 58, 122, 89, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24595962462964224, "mean_inference_ms": 1.3995499963652855, "mean_action_processing_ms": 0.1319998765037263, "mean_env_wait_ms": 2.580379265905959, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 487512, "agent_timesteps_total": 487512, "timers": {"sample_time_ms": 7029.09, "sample_throughput": 1136.989, "load_time_ms": 3.291, "load_throughput": 2428222.096, "learn_time_ms": 6256.914, "learn_throughput": 1277.307, "update_time_ms": 2.959}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04279491677880287, "policy_loss": -0.012774664908647537, "vf_loss": 0.05318592116236687, "vf_explained_var": 0.7822821140289307, "kl": 0.011918294243514538, "entropy": 1.3402845859527588, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 487512, "num_agent_steps_sampled": 487512, "num_steps_trained": 487512, "num_agent_steps_trained": 487512}, "done": false, "episodes_total": 3670, "training_iteration": 61, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-47-55", "timestamp": 1716403675, "time_this_iter_s": 13.966017246246338, "time_total_s": 721.8860392570496, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 721.8860392570496, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 34.17, "ram_util_percent": 33.5}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.688272082936111, "episode_reward_min": 5.121102805337479, "episode_reward_mean": 5.459184009547586, "episode_len_mean": 73.47222222222223, "episode_media": {}, "episodes_this_iter": 108, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2826562317698091, "reward_component_totals/rejoin_dist_change_reward_min": 0.9301028053374778, "reward_component_totals/rejoin_dist_change_reward_max": 1.519702178131074, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.926527777777778, "reward_component_totals/success_reward_min": 1.867, "reward_component_totals/success_reward_max": 1.964}, "hist_stats": {"episode_reward": [5.310998807389752, 5.332979884421697, 5.392408978253099, 5.444790675237702, 5.589703359103298, 5.474660809980461, 5.388046253506762, 5.557068351696907, 5.433011683966849, 5.363943502406442, 5.455373388554871, 5.569623123480958, 5.6060496518122775, 5.410913959280558, 5.569855337257783, 5.664406527111792, 5.522719084059436, 5.496863279003727, 5.603780955322284, 5.469490491560854, 5.266136726786359, 5.282435321056731, 5.222648771349245, 5.325085983112752, 5.35536157600816, 5.437391020879629, 5.44286660468823, 5.688272082936111, 5.264985884904324, 5.475441771484698, 5.4148888870358896, 5.517882273550256, 5.174061994283651, 5.258005320114046, 5.549354428262262, 5.259449412703917, 5.386934348696977, 5.453666830216576, 5.352469400601786, 5.165231761984253, 5.5150803312009025, 5.639984302940807, 5.530409293663267, 5.270822822319966, 5.55776403178827, 5.494791805345536, 5.6594345905090115, 5.60100553226408, 5.499205577912303, 5.377428591223694, 5.668702178131074, 5.592991344613722, 5.497633234067909, 5.595059122125438, 5.31002243592132, 5.592313690516869, 5.5243539820221725, 5.373368135113894, 5.566589960404372, 5.539984017899865, 5.548813520147719, 5.536522692178435, 5.40783887565531, 5.522840913359486, 5.456185852900575, 5.349628055850383, 5.4230486554676345, 5.5113630514443415, 5.291044817654673, 5.407666330899462, 5.325911182542999, 5.433873828395005, 5.3622512130581175, 5.121102805337479, 5.515865890491534, 5.27388119314859, 5.406023432093415, 5.524111996077816, 5.616775463219783, 5.4770821242097405, 5.5271385110297455, 5.404844681572515, 5.3761364858986855, 5.479792345150933, 5.5687511320279155, 5.512777519151688, 5.631545469888569, 5.6026406746995825, 5.525443673930631, 5.644048883745919, 5.389917101330824, 5.668141651221377, 5.5761819571661615, 5.444004272673563, 5.460842732101877, 5.644544072625761, 5.157183911784724, 5.621722960245696, 5.587676811871898, 5.583923775783567, 5.228372417115454, 5.650460338954121, 5.337241612464146, 5.5371468875490155, 5.545894274664558, 5.368965993115916, 5.39298403172543, 5.255513473468787], "episode_lengths": [93, 66, 61, 67, 69, 94, 67, 101, 74, 98, 114, 47, 65, 60, 76, 63, 59, 74, 59, 96, 76, 64, 69, 65, 64, 66, 104, 50, 70, 54, 44, 106, 90, 87, 66, 71, 51, 68, 45, 62, 90, 53, 78, 86, 62, 100, 54, 58, 66, 46, 101, 77, 56, 71, 84, 81, 46, 55, 133, 68, 119, 66, 67, 54, 50, 64, 73, 61, 76, 88, 47, 76, 44, 59, 85, 99, 71, 69, 84, 99, 54, 92, 111, 99, 91, 57, 104, 55, 52, 98, 101, 56, 83, 52, 122, 88, 36, 63, 70, 107, 59, 52, 72, 49, 87, 101, 86, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24910607120928036, "mean_inference_ms": 1.405915423361196, "mean_action_processing_ms": 0.13250792901612443, "mean_env_wait_ms": 2.5923670927785083, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 495504, "agent_timesteps_total": 495504, "timers": {"sample_time_ms": 7002.971, "sample_throughput": 1141.23, "load_time_ms": 3.303, "load_throughput": 2419371.613, "learn_time_ms": 6281.344, "learn_throughput": 1272.339, "update_time_ms": 2.983}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04184703901410103, "policy_loss": -0.011003530584275723, "vf_loss": 0.05079485848546028, "vf_explained_var": 0.7773312926292419, "kl": 0.010278568603098392, "entropy": 1.3195703029632568, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 495504, "num_agent_steps_sampled": 495504, "num_steps_trained": 495504, "num_agent_steps_trained": 495504}, "done": false, "episodes_total": 3778, "training_iteration": 62, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-48-10", "timestamp": 1716403690, "time_this_iter_s": 14.234128475189209, "time_total_s": 736.1201677322388, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 736.1201677322388, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 34.525000000000006, "ram_util_percent": 33.555}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.659151297438927, "episode_reward_min": 5.127750211549125, "episode_reward_mean": 5.448140524591693, "episode_len_mean": 75.71428571428571, "episode_media": {}, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.273854810305979, "reward_component_totals/rejoin_dist_change_reward_min": 0.9477502115491245, "reward_component_totals/rejoin_dist_change_reward_max": 1.503151297438928, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9242857142857144, "reward_component_totals/success_reward_min": 1.8719999999999999, "reward_component_totals/success_reward_max": 1.958}, "hist_stats": {"episode_reward": [5.587812363171057, 5.165036503510764, 5.403157234360172, 5.39428158750875, 5.127750211549125, 5.363302318941548, 5.590901071056676, 5.3774734568313365, 5.59913515078466, 5.397907563545749, 5.478593643618657, 5.4717400551709705, 5.224419996173246, 5.388272702694957, 5.500105319266435, 5.556292776271102, 5.573071119600741, 5.187028417637631, 5.633271478215445, 5.39959439974368, 5.621350204425592, 5.565990092366803, 5.296950726297769, 5.3222183458723205, 5.3933118133104845, 5.309462905267829, 5.338084695542319, 5.5863195324112995, 5.556453966644841, 5.354163321250975, 5.249921900752607, 5.196997711896455, 5.5425664484028525, 5.59621561839576, 5.5946237490524915, 5.420812134275052, 5.443119734253565, 5.465569359289287, 5.313528024084532, 5.408033462542853, 5.3133458994406855, 5.230096539666121, 5.328457015220248, 5.620660300379385, 5.5532941703348655, 5.525912608492675, 5.299670357451616, 5.5537781650507085, 5.5707194583577575, 5.161925868207449, 5.5906089471733225, 5.54165660415366, 5.289931696472736, 5.577150738136847, 5.590701398991067, 5.582251907999366, 5.622498607289178, 5.219419278114001, 5.356624569216628, 5.426615714824484, 5.532911927321653, 5.197945282461907, 5.217340085173409, 5.587866644302022, 5.623986430310643, 5.30423079765259, 5.309910846032285, 5.514151360237617, 5.611162216821215, 5.489173301187755, 5.5751495667145345, 5.310186327457257, 5.572142586731246, 5.260802746193482, 5.32440796709849, 5.536092181678571, 5.2777145120433, 5.381268864301113, 5.658556547092937, 5.273056566967229, 5.518793216636526, 5.655808668829222, 5.466598986286932, 5.404556133394594, 5.659151297438927, 5.603718933346962, 5.255167734102691, 5.379671354839547, 5.51348719905619, 5.2812368080086465, 5.626847879984462, 5.591452525786973, 5.594521353390735, 5.600191988302294, 5.365349351013268, 5.40694211698442, 5.468059783182959, 5.410255009726612, 5.504877626542772, 5.65111978312315, 5.638800264134877, 5.557422814027917, 5.598043099255115, 5.400845964042823, 5.393617471948737], "episode_lengths": [75, 55, 93, 82, 70, 77, 70, 66, 57, 89, 87, 91, 70, 42, 74, 118, 51, 77, 58, 88, 53, 111, 90, 80, 49, 78, 80, 72, 124, 78, 46, 81, 60, 80, 85, 46, 72, 56, 60, 86, 42, 50, 73, 74, 80, 97, 63, 116, 93, 53, 111, 56, 111, 110, 45, 89, 70, 86, 74, 120, 96, 46, 42, 110, 57, 69, 73, 107, 48, 58, 71, 53, 116, 44, 93, 52, 73, 80, 90, 69, 61, 66, 101, 58, 94, 53, 82, 81, 64, 71, 56, 55, 90, 47, 78, 87, 128, 70, 100, 97, 64, 110, 61, 63, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2504363312259581, "mean_inference_ms": 1.4105553532599562, "mean_action_processing_ms": 0.13296655557833872, "mean_env_wait_ms": 2.601696584695214, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 503496, "agent_timesteps_total": 503496, "timers": {"sample_time_ms": 7068.489, "sample_throughput": 1130.652, "load_time_ms": 3.367, "load_throughput": 2373579.576, "learn_time_ms": 6343.555, "learn_throughput": 1259.861, "update_time_ms": 3.01}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04393469914793968, "policy_loss": -0.010070107877254486, "vf_loss": 0.052122149616479874, "vf_explained_var": 0.7721531391143799, "kl": 0.0094132786616683, "entropy": 1.3249578475952148, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 503496, "num_agent_steps_sampled": 503496, "num_steps_trained": 503496, "num_agent_steps_trained": 503496}, "done": false, "episodes_total": 3883, "training_iteration": 63, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-48-24", "timestamp": 1716403704, "time_this_iter_s": 14.146754264831543, "time_total_s": 750.2669219970703, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 750.2669219970703, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 34.769999999999996, "ram_util_percent": 33.575}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.700578139240604, "episode_reward_min": 0.20715136206369777, "episode_reward_mean": 5.404433653356536, "episode_len_mean": 75.39622641509433, "episode_media": {}, "episodes_this_iter": 106, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9905660377358491, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.009433962264150943, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9811320754716983, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24764150943396226, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2792166722244598, "reward_component_totals/rejoin_dist_change_reward_min": 0.9861720476508689, "reward_component_totals/rejoin_dist_change_reward_max": 1.5025781392406046, "reward_component_totals/failure_reward_mean": -0.009433962264150943, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.905877358490566, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.962, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.586517777203357, 5.454074671934187, 5.317450585171597, 5.352747759363579, 5.26911329551387, 5.617410907307539, 5.630765628958271, 5.433312120781091, 5.2753880317847175, 5.536221818461585, 5.526368205590787, 5.387237644373818, 5.6968349335891295, 5.26069813712456, 5.522167250245762, 5.522639390991009, 5.537120273500889, 5.534033829428165, 5.44546976387554, 5.57198834981118, 5.200857227314829, 5.19756514412482, 5.575876959110635, 5.568643968195564, 5.287205196756421, 5.623547835976216, 5.449034470833632, 5.603900929679542, 5.323223277781441, 5.465215563979836, 5.511002995323949, 5.4404274618561015, 5.252542206871681, 5.357272806204568, 5.620599961629017, 5.293312405253903, 5.447663090175801, 5.4276911165862884, 5.52882952867139, 5.418539788685651, 5.224878496093066, 5.498763591018795, 5.6426967832330766, 5.700578139240604, 5.488745679249231, 5.272960899903506, 5.487853974285491, 5.407441788496435, 0.20715136206369777, 5.620404809399776, 5.196024801467249, 5.223570346775466, 5.60371291866365, 5.187172047650869, 5.508034893000822, 5.576734860603793, 5.484361836511463, 5.614626028785832, 5.530239628931614, 5.198005769500561, 5.268293744868756, 5.359648474780844, 5.4036284532784915, 5.563630451485874, 5.530384523782523, 5.682977359808672, 5.276821113542532, 5.456442826052994, 5.497905084753916, 5.368450923883149, 5.666769324994509, 5.43759569294574, 5.45527737783327, 5.4504916860462895, 5.342273392644357, 5.31232013738927, 5.481311422143969, 5.403766842962176, 5.606400498211949, 5.352602904603165, 5.629023910522147, 5.4805176729370295, 5.642066368421, 5.333197502292978, 5.560647052898615, 5.16605250949323, 5.530977474702799, 5.375080049622801, 5.455400556734583, 5.509028758702309, 5.30668731491213, 5.52876673833936, 5.451222254330885, 5.520873984225551, 5.491310652119672, 5.478134349921285, 5.510554829094199, 5.396595493942616, 5.39946547017673, 5.67645075655188, 5.594997841491917, 5.389933288056733, 5.687080797142737, 5.45221795893414, 5.3294735985293205, 5.312746870786755], "episode_lengths": [81, 65, 61, 76, 111, 65, 48, 63, 38, 106, 53, 87, 54, 87, 61, 108, 123, 54, 97, 65, 84, 71, 137, 57, 60, 111, 123, 86, 71, 101, 74, 49, 58, 102, 58, 54, 57, 52, 50, 83, 86, 109, 79, 52, 61, 52, 56, 89, 15, 61, 93, 92, 55, 49, 89, 53, 101, 88, 99, 61, 50, 46, 70, 58, 85, 61, 117, 113, 94, 111, 49, 73, 103, 53, 77, 79, 60, 55, 128, 109, 76, 120, 87, 71, 56, 71, 67, 70, 107, 56, 61, 66, 48, 85, 52, 106, 82, 104, 60, 64, 93, 40, 57, 79, 70, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2515237737972373, "mean_inference_ms": 1.4163865124690578, "mean_action_processing_ms": 0.13346021131471084, "mean_env_wait_ms": 2.61305775182548, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 511488, "agent_timesteps_total": 511488, "timers": {"sample_time_ms": 7212.929, "sample_throughput": 1108.01, "load_time_ms": 3.431, "load_throughput": 2329262.158, "learn_time_ms": 6391.762, "learn_throughput": 1250.36, "update_time_ms": 2.985}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.06028379872441292, "policy_loss": -0.012349031865596771, "vf_loss": 0.07040580362081528, "vf_explained_var": 0.7480150461196899, "kl": 0.011135156266391277, "entropy": 1.3393940925598145, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 511488, "num_agent_steps_sampled": 511488, "num_steps_trained": 511488, "num_agent_steps_trained": 511488}, "done": false, "episodes_total": 3989, "training_iteration": 64, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-48-38", "timestamp": 1716403718, "time_this_iter_s": 14.298956155776978, "time_total_s": 764.5658781528473, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 764.5658781528473, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 34.73333333333333, "ram_util_percent": 33.5}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.695774543648098, "episode_reward_min": 0.3887341592582314, "episode_reward_mean": 5.407839573276699, "episode_len_mean": 76.47115384615384, "episode_media": {}, "episodes_this_iter": 104, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9903846153846154, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.009615384615384616, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.980769230769231, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24759615384615385, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2845991886613144, "reward_component_totals/rejoin_dist_change_reward_min": 0.945617360755556, "reward_component_totals/rejoin_dist_change_reward_max": 1.5110784077620838, "reward_component_totals/failure_reward_mean": -0.009615384615384616, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9044903846153847, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.962, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.555632014207208, 5.241176692975435, 5.231023240840365, 5.5198299250455385, 5.617899201514216, 5.59659760870692, 5.6374574688548345, 5.403632818172166, 5.615894070867625, 5.257606188239588, 5.649622561254925, 5.557844591521269, 5.185578695726319, 5.690078407762083, 5.45505157454263, 5.196216138142532, 5.07282930685207, 5.536241861184214, 5.3428200406068775, 5.614355388925116, 5.380801310605508, 5.595422280916937, 5.518390052888529, 5.176132865744172, 5.556062573138976, 5.507665913211719, 5.158300647202674, 5.598468741508075, 5.55222466649306, 5.559509163113747, 5.683106051814543, 5.619666136567712, 5.503560155586571, 5.281491399252639, 5.478141787208971, 5.6261728957759995, 5.2364430918895915, 5.621152973379176, 5.084617360755557, 5.605226268400345, 5.591219346916215, 5.49572133968912, 5.613847775176591, 5.4722666899427255, 5.315012004293026, 5.4968849404926035, 5.486774673793134, 5.390284365424817, 5.419810081448837, 5.379763071224451, 5.276506486591947, 5.517491503234625, 5.391100934554505, 5.466894330734975, 5.695774543648098, 5.6309230946098445, 5.3447588885573385, 5.2910120219158205, 5.479461205597566, 5.274735560826749, 5.267791089212762, 5.6515918693803915, 5.468519626567735, 5.543205541754636, 5.527268305804064, 5.457185110193837, 5.507309149293216, 5.441124598357295, 5.391625828276651, 5.305845356660152, 5.4670920354250185, 5.424497896742135, 5.503712587765326, 5.563964978464863, 5.221634621333332, 5.374589848915424, 5.690813792252317, 5.533426144388117, 5.618618064113237, 5.684098822848645, 5.304844543322153, 5.636436250135551, 5.4518778711992635, 5.329247659919496, 5.664913248379753, 5.5616667533492485, 0.3887341592582314, 5.5552675477568085, 5.450198806195909, 5.681208585467361, 5.564295111389914, 5.216340838810169, 5.242959801839694, 5.457250822611373, 5.412976785128569, 5.261034492146891, 5.530785629557937, 5.434967843689979, 5.297299847069804, 5.4196385702004815, 5.291053685488979, 5.409833144500879, 5.319962885138403, 5.538418480401262], "episode_lengths": [131, 87, 55, 79, 56, 85, 82, 86, 124, 81, 82, 44, 86, 71, 90, 82, 133, 57, 95, 71, 56, 60, 79, 83, 96, 79, 87, 82, 90, 135, 54, 50, 99, 74, 54, 88, 56, 68, 111, 80, 73, 93, 56, 87, 62, 51, 63, 106, 95, 77, 74, 66, 116, 46, 65, 98, 43, 82, 94, 52, 68, 64, 61, 49, 101, 75, 62, 75, 50, 61, 57, 101, 68, 52, 61, 90, 56, 109, 62, 68, 78, 76, 50, 61, 85, 58, 20, 83, 99, 57, 134, 60, 81, 48, 38, 74, 116, 108, 71, 57, 52, 160, 78, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2511249002238485, "mean_inference_ms": 1.4205207514463976, "mean_action_processing_ms": 0.13391445792422174, "mean_env_wait_ms": 2.6206330886499654, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 519480, "agent_timesteps_total": 519480, "timers": {"sample_time_ms": 7256.651, "sample_throughput": 1101.335, "load_time_ms": 3.38, "load_throughput": 2364555.005, "learn_time_ms": 6408.662, "learn_throughput": 1247.062, "update_time_ms": 2.994}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.06722941249608994, "policy_loss": -0.014383578673005104, "vf_loss": 0.07929714024066925, "vf_explained_var": 0.7152836918830872, "kl": 0.01157921738922596, "entropy": 1.3732402324676514, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 519480, "num_agent_steps_sampled": 519480, "num_steps_trained": 519480, "num_agent_steps_trained": 519480}, "done": false, "episodes_total": 4093, "training_iteration": 65, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-48-52", "timestamp": 1716403732, "time_this_iter_s": 13.696501016616821, "time_total_s": 778.2623791694641, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 778.2623791694641, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 34.857894736842105, "ram_util_percent": 33.521052631578954}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.691913560817959, "episode_reward_min": 5.104427887079835, "episode_reward_mean": 5.438299494709451, "episode_len_mean": 77.91346153846153, "episode_media": {}, "episodes_this_iter": 104, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2662129562479136, "reward_component_totals/rejoin_dist_change_reward_min": 0.9284278870798333, "reward_component_totals/rejoin_dist_change_reward_max": 1.4959135608179606, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9220865384615387, "reward_component_totals/success_reward_min": 1.839, "reward_component_totals/success_reward_max": 1.962}, "hist_stats": {"episode_reward": [5.452912588692367, 5.652608989239603, 5.499055094307248, 5.5856893183872725, 5.22382924271634, 5.286638860814541, 5.163944097698523, 5.442993298041967, 5.203799523442375, 5.240256261683997, 5.629337161494503, 5.252289499351162, 5.380649345109856, 5.51712146894912, 5.261963808753139, 5.684393440711272, 5.340825586784598, 5.252701117706533, 5.329344583222538, 5.299454750201013, 5.366597463426643, 5.372768434540087, 5.447764875928373, 5.590732785244029, 5.170341965805234, 5.547593983210739, 5.425998275968619, 5.325880864610597, 5.285850578755127, 5.403432104297002, 5.500076636515013, 5.217655878986747, 5.572600101581786, 5.4234876596642625, 5.470030526168372, 5.470286861379655, 5.556567274615677, 5.267734773205959, 5.453644438923104, 5.622843507454318, 5.65252494403535, 5.5475861017447015, 5.4041162686034365, 5.286539637530884, 5.433872636858784, 5.619600919614951, 5.104427887079835, 5.602410999738382, 5.3648897528523465, 5.451943499750586, 5.6189604547041405, 5.489621036832572, 5.288821236760158, 5.465764690135616, 5.676395018747411, 5.5570274803800945, 5.603575112363499, 5.582664995046389, 5.593034366070591, 5.1425638348808285, 5.4957792686742515, 5.598994070146254, 5.629143651225814, 5.372910937132439, 5.268663591398385, 5.572902020157082, 5.426313329833394, 5.665108327673306, 5.691913560817959, 5.53362844718118, 5.259557040363333, 5.606561543668774, 5.546051689013931, 5.3272356367296405, 5.34878966575647, 5.653033598740704, 5.4283471903403075, 5.296936969907834, 5.404446632455191, 5.461704285373134, 5.40299583136032, 5.5340804133095745, 5.3613716698738045, 5.377502010877521, 5.27498952791157, 5.239829152681583, 5.164041214622487, 5.309791035451926, 5.396255026325492, 5.5786129493101715, 5.54298993062567, 5.473283845756074, 5.588365594573644, 5.634579862311644, 5.363713085464994, 5.601709243545537, 5.33024243864789, 5.56923866904568, 5.33635567642096, 5.310272349100093, 5.65658690813627, 5.564255634080435, 5.480550686494826, 5.225475335945603], "episode_lengths": [61, 85, 98, 113, 96, 68, 101, 120, 59, 68, 56, 101, 103, 63, 59, 51, 62, 38, 69, 65, 46, 84, 53, 69, 71, 95, 86, 73, 83, 82, 73, 46, 67, 74, 80, 52, 89, 68, 65, 98, 77, 130, 51, 65, 72, 63, 74, 58, 131, 143, 52, 96, 44, 83, 60, 141, 101, 68, 114, 57, 63, 61, 68, 63, 91, 96, 84, 69, 54, 93, 114, 46, 113, 42, 117, 54, 65, 82, 68, 89, 62, 108, 142, 78, 74, 54, 70, 51, 52, 82, 57, 81, 70, 67, 49, 87, 98, 108, 54, 72, 67, 161, 43, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2521819522558153, "mean_inference_ms": 1.4245692794066658, "mean_action_processing_ms": 0.13437764917629808, "mean_env_wait_ms": 2.6303440232199717, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 527472, "agent_timesteps_total": 527472, "timers": {"sample_time_ms": 7330.342, "sample_throughput": 1090.263, "load_time_ms": 3.415, "load_throughput": 2340336.768, "learn_time_ms": 6448.759, "learn_throughput": 1239.308, "update_time_ms": 3.014}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04875922203063965, "policy_loss": -0.009528842754662037, "vf_loss": 0.05612056702375412, "vf_explained_var": 0.7819145917892456, "kl": 0.010837465524673462, "entropy": 1.325387716293335, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 527472, "num_agent_steps_sampled": 527472, "num_steps_trained": 527472, "num_agent_steps_trained": 527472}, "done": false, "episodes_total": 4197, "training_iteration": 66, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-49-06", "timestamp": 1716403746, "time_this_iter_s": 14.233860492706299, "time_total_s": 792.4962396621704, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 792.4962396621704, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 34.009523809523806, "ram_util_percent": 33.60000000000001}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.675803818688346, "episode_reward_min": 5.102979850907381, "episode_reward_mean": 5.450278181238572, "episode_len_mean": 77.12745098039215, "episode_media": {}, "episodes_this_iter": 102, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2774056322189633, "reward_component_totals/rejoin_dist_change_reward_min": 0.924979850907381, "reward_component_totals/rejoin_dist_change_reward_max": 1.507803818688346, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9228725490196075, "reward_component_totals/success_reward_min": 1.841, "reward_component_totals/success_reward_max": 1.9569999999999999}, "hist_stats": {"episode_reward": [5.571185260602163, 5.3006539230408425, 5.64003062039054, 5.476886641759908, 5.350842356612125, 5.199125893166711, 5.232740268671792, 5.34753012446062, 5.58323995624705, 5.653913750664152, 5.425503182171285, 5.239919427488871, 5.534591936394287, 5.663885475825448, 5.63288786101011, 5.583885925135846, 5.179660594758514, 5.388848569004328, 5.369293076066418, 5.232102059230304, 5.660998046933672, 5.184165355912793, 5.628338936019222, 5.551932525533113, 5.419975571155858, 5.538159572529008, 5.2264374135565905, 5.4755039939597605, 5.522858743015602, 5.522048976907205, 5.6738325882011384, 5.562886096097582, 5.352910977372861, 5.196677773518855, 5.157749905290031, 5.241855092261311, 5.324921628641105, 5.421103432171618, 5.483232903884369, 5.500349378504415, 5.667062552130073, 5.491888161992635, 5.640390092670028, 5.670664309034545, 5.363127340796376, 5.2662668386334, 5.287733155290718, 5.339406439244414, 5.322959851020078, 5.592639228792954, 5.325036389394798, 5.626543148782238, 5.286149340134463, 5.626029452710718, 5.543344202310912, 5.608793193944474, 5.499799338136013, 5.537073682979834, 5.5506459871833425, 5.5679350305311, 5.33338362296356, 5.675803818688346, 5.26543354080065, 5.548012096783135, 5.660200460681854, 5.384060719335418, 5.5559573149481105, 5.489070340366068, 5.455467995384932, 5.218202787930805, 5.458105905849239, 5.534629706939382, 5.645782970698463, 5.210118894014887, 5.52653170917353, 5.576059723564007, 5.383957070549185, 5.364055682435848, 5.529874428880072, 5.545148310067646, 5.375007483188596, 5.532375827540369, 5.466618084017087, 5.4098418726562185, 5.436386808592564, 5.486438035058292, 5.613791130369403, 5.4896708838595965, 5.390828095727192, 5.49871187512874, 5.102979850907381, 5.291072826591355, 5.330647658886833, 5.4390952654483105, 5.589383741878538, 5.636890679461345, 5.294362262088487, 5.544734131549084, 5.287091032261146, 5.396618217030117, 5.4252770275882165, 5.464541046569719], "episode_lengths": [108, 97, 87, 64, 60, 91, 43, 60, 79, 95, 99, 67, 95, 60, 79, 93, 94, 85, 73, 71, 78, 101, 57, 88, 94, 69, 53, 70, 91, 86, 60, 53, 65, 79, 95, 82, 79, 71, 49, 93, 57, 62, 59, 59, 73, 77, 71, 159, 63, 89, 78, 61, 65, 61, 88, 70, 51, 61, 123, 118, 88, 82, 61, 50, 77, 48, 73, 68, 45, 44, 69, 69, 64, 115, 96, 118, 59, 95, 107, 60, 53, 87, 76, 109, 60, 69, 47, 92, 105, 52, 72, 68, 43, 71, 93, 68, 55, 148, 62, 120, 115, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25502007377463676, "mean_inference_ms": 1.434283805085292, "mean_action_processing_ms": 0.13523301719123293, "mean_env_wait_ms": 2.646743701536418, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 535464, "agent_timesteps_total": 535464, "timers": {"sample_time_ms": 7537.474, "sample_throughput": 1060.302, "load_time_ms": 3.485, "load_throughput": 2293311.639, "learn_time_ms": 6491.689, "learn_throughput": 1231.112, "update_time_ms": 3.028}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.042693544179201126, "policy_loss": -0.012270526960492134, "vf_loss": 0.05291245877742767, "vf_explained_var": 0.7784950137138367, "kl": 0.010258038528263569, "entropy": 1.3425984382629395, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 535464, "num_agent_steps_sampled": 535464, "num_steps_trained": 535464, "num_agent_steps_trained": 535464}, "done": false, "episodes_total": 4299, "training_iteration": 67, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-49-21", "timestamp": 1716403761, "time_this_iter_s": 15.3752121925354, "time_total_s": 807.8714518547058, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 807.8714518547058, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 37.85454545454545, "ram_util_percent": 33.74090909090909}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.69156593664357, "episode_reward_min": 5.119507492480237, "episode_reward_mean": 5.466410496628129, "episode_len_mean": 77.03846153846153, "episode_media": {}, "episodes_this_iter": 104, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2934489581665904, "reward_component_totals/rejoin_dist_change_reward_min": 0.9235074924802358, "reward_component_totals/rejoin_dist_change_reward_max": 1.5062370726622596, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9229615384615384, "reward_component_totals/success_reward_min": 1.8359999999999999, "reward_component_totals/success_reward_max": 1.9609999999999999}, "hist_stats": {"episode_reward": [5.595428648497181, 5.2823364051321295, 5.200726816729573, 5.638383908131441, 5.38720421803845, 5.391847952226916, 5.622940536777753, 5.452806581801795, 5.574546076700558, 5.266041256824172, 5.492998934929015, 5.640360347336282, 5.657229223389955, 5.383116624358887, 5.638874328168555, 5.48195331329344, 5.538010082501948, 5.482774199001518, 5.633201938598017, 5.582975125152915, 5.594215306716375, 5.458244058361004, 5.474943522058988, 5.497369047733054, 5.509396840252112, 5.572377496702542, 5.593081516469368, 5.367055169377942, 5.30290516130424, 5.465018190045171, 5.314766315980224, 5.24266054002444, 5.571838121346257, 5.527261185935605, 5.465812334396732, 5.47597175591256, 5.525474040961925, 5.562015983140327, 5.201970905975669, 5.647690884379276, 5.210392574113499, 5.342195854517569, 5.668091579799869, 5.506635154516202, 5.412487780341346, 5.525105691374162, 5.56000636753068, 5.342757616511919, 5.570107849634276, 5.417339840642084, 5.348354767972312, 5.465690105893559, 5.619084375933033, 5.282736863611884, 5.497950970850786, 5.531299001714301, 5.408625517362329, 5.439645821212444, 5.419797001753425, 5.669237072662259, 5.617983117660307, 5.212511032081487, 5.299172383404435, 5.672618054559943, 5.610732926042409, 5.57577298238691, 5.28631593986119, 5.629694899001384, 5.467920644621396, 5.612045537898714, 5.2673001045512216, 5.612565118841972, 5.477688079758844, 5.119507492480237, 5.643897917470697, 5.345374057221303, 5.574247539330218, 5.4743816443880515, 5.653497990825576, 5.642746764017462, 5.53566043060372, 5.271343277746514, 5.340137177631638, 5.5533551989923975, 5.366716574197973, 5.513705939437255, 5.21614648792217, 5.213229110825011, 5.69156593664357, 5.411271477222936, 5.396998418628888, 5.23716224372728, 5.2783512863068704, 5.222559834492178, 5.545133133159343, 5.4184000049700725, 5.576007064366403, 5.349509162795133, 5.558579000982057, 5.523058413552931, 5.376500925056122, 5.423658640399642, 5.609157144956338, 5.531143835692967], "episode_lengths": [45, 68, 62, 54, 45, 58, 71, 64, 107, 122, 89, 84, 58, 63, 49, 85, 51, 102, 60, 77, 108, 74, 107, 70, 128, 62, 119, 88, 57, 79, 115, 115, 127, 125, 56, 50, 53, 104, 89, 87, 85, 152, 86, 99, 59, 81, 51, 68, 101, 50, 53, 63, 48, 45, 74, 64, 56, 77, 96, 87, 82, 91, 63, 50, 63, 81, 80, 72, 66, 62, 44, 57, 61, 54, 79, 110, 55, 72, 61, 62, 78, 54, 59, 99, 88, 89, 62, 110, 56, 87, 62, 77, 73, 90, 70, 51, 114, 70, 109, 164, 39, 45, 61, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2572942350229156, "mean_inference_ms": 1.4400905927674819, "mean_action_processing_ms": 0.13564339697899735, "mean_env_wait_ms": 2.6559537935403514, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 543456, "agent_timesteps_total": 543456, "timers": {"sample_time_ms": 7654.835, "sample_throughput": 1044.046, "load_time_ms": 3.544, "load_throughput": 2254974.845, "learn_time_ms": 6541.809, "learn_throughput": 1221.68, "update_time_ms": 3.052}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.049736615270376205, "policy_loss": -0.01088834647089243, "vf_loss": 0.0584440715610981, "vf_explained_var": 0.772300660610199, "kl": 0.01090444065630436, "entropy": 1.316419005393982, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 543456, "num_agent_steps_sampled": 543456, "num_steps_trained": 543456, "num_agent_steps_trained": 543456}, "done": false, "episodes_total": 4403, "training_iteration": 68, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-49-36", "timestamp": 1716403776, "time_this_iter_s": 14.09731936454773, "time_total_s": 821.9687712192535, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 821.9687712192535, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 34.91, "ram_util_percent": 33.720000000000006}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.701808026778295, "episode_reward_min": 5.1562763569884424, "episode_reward_mean": 5.44805309863536, "episode_len_mean": 71.73214285714286, "episode_media": {}, "episodes_this_iter": 112, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2697852414925024, "reward_component_totals/rejoin_dist_change_reward_min": 0.9926347938849984, "reward_component_totals/rejoin_dist_change_reward_max": 1.5208080267782949, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9282678571428573, "reward_component_totals/success_reward_min": 1.8780000000000001, "reward_component_totals/success_reward_max": 1.956}, "hist_stats": {"episode_reward": [5.383960761726728, 5.210664674955184, 5.191680715549403, 5.50258279257195, 5.614879036247798, 5.478409298844493, 5.667590738360687, 5.500821863398218, 5.6089614450436285, 5.629173448691155, 5.445850887260937, 5.3339049308257, 5.4880240586699, 5.391388934933664, 5.60255611268879, 5.656339509780575, 5.549773497439908, 5.433441318285208, 5.228700844472049, 5.356132643125962, 5.368839957527154, 5.663237265620946, 5.684228004287975, 5.5481265846646775, 5.628626953811947, 5.347698817906235, 5.675001690209173, 5.6316919895787745, 5.39437699722796, 5.607329171005029, 5.237092409756233, 5.545647814067845, 5.373593961646179, 5.445088437882351, 5.520272066447758, 5.160813334903952, 5.701808026778295, 5.218012060991219, 5.2614780005449795, 5.447061560658499, 5.373885335957587, 5.178634793884998, 5.2734096744005114, 5.481306161372312, 5.399808911176899, 5.545115409861886, 5.693994326641654, 5.498727366447559, 5.631631506545123, 5.5555286472475185, 5.5130961024649805, 5.4894474054903695, 5.673777446750579, 5.430988010778106, 5.350433430095961, 5.579465933966052, 5.328780113058901, 5.587416443141631, 5.274990564638628, 5.276260843232571, 5.563299091908886, 5.5325629598591135, 5.267671304245523, 5.5832030972491244, 5.586100280764808, 5.426977336220988, 5.674312227841135, 5.393521936774256, 5.6749323070855535, 5.635827331422341, 5.449944427045894, 5.512760450430925, 5.463169781863938, 5.5128885326018375, 5.599921887677296, 5.587100409690551, 5.666593072181344, 5.6469121955834805, 5.327522233093522, 5.388830674563442, 5.276218150385844, 5.197189945272474, 5.199829898322459, 5.350079914342533, 5.481681952175049, 5.497129126008398, 5.446203591561343, 5.314604203170045, 5.321743540021082, 5.438527844738484, 5.532433351254858, 5.1950335638155245, 5.509897103193271, 5.347928752852432, 5.382266293148476, 5.483792610473598, 5.242733891964493, 5.570792952638863, 5.25505960454335, 5.2514480686441685, 5.5801692647094825, 5.396149123778446, 5.270625037514883, 5.1562763569884424, 5.605400966863553, 5.404921621436608, 5.290528523917221, 5.537262089591636, 5.19869991143087, 5.349531762589759, 5.403208051382823, 5.328967394782881], "episode_lengths": [61, 69, 70, 75, 90, 49, 50, 57, 61, 63, 67, 79, 76, 50, 93, 54, 92, 121, 71, 69, 83, 81, 58, 59, 99, 86, 66, 63, 93, 91, 47, 89, 58, 70, 120, 82, 69, 106, 50, 69, 75, 64, 56, 46, 70, 49, 60, 81, 83, 52, 55, 63, 52, 65, 89, 59, 82, 68, 47, 70, 58, 66, 87, 114, 66, 79, 85, 55, 57, 50, 49, 58, 51, 86, 63, 65, 57, 56, 122, 80, 53, 49, 121, 75, 84, 97, 89, 63, 63, 83, 88, 101, 74, 86, 74, 51, 81, 64, 83, 59, 105, 57, 52, 106, 68, 67, 44, 49, 57, 94, 60, 91]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25709087699785826, "mean_inference_ms": 1.443111726677282, "mean_action_processing_ms": 0.13605785206020332, "mean_env_wait_ms": 2.664108203255117, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 551448, "agent_timesteps_total": 551448, "timers": {"sample_time_ms": 7720.572, "sample_throughput": 1035.156, "load_time_ms": 3.603, "load_throughput": 2217869.364, "learn_time_ms": 6564.485, "learn_throughput": 1217.46, "update_time_ms": 3.02}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0406477153301239, "policy_loss": -0.011611107736825943, "vf_loss": 0.050003163516521454, "vf_explained_var": 0.7841070294380188, "kl": 0.011278323829174042, "entropy": 1.254071593284607, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 551448, "num_agent_steps_sampled": 551448, "num_steps_trained": 551448, "num_agent_steps_trained": 551448}, "done": false, "episodes_total": 4515, "training_iteration": 69, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-49-50", "timestamp": 1716403790, "time_this_iter_s": 13.93290090560913, "time_total_s": 835.9016721248627, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 835.9016721248627, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 34.394999999999996, "ram_util_percent": 33.605000000000004}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.709597806218503, "episode_reward_min": 0.246600249022072, "episode_reward_mean": 5.3748177111742415, "episode_len_mean": 73.61682242990655, "episode_media": {}, "episodes_this_iter": 107, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9906542056074766, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.009345794392523364, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9813084112149535, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24766355140186916, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.247228926127512, "reward_component_totals/rejoin_dist_change_reward_min": 0.9182702314617424, "reward_component_totals/rejoin_dist_change_reward_max": 1.5155978062185034, "reward_component_totals/failure_reward_mean": -0.009345794392523364, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9079626168224295, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.9609999999999999, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.400135931048263, 5.457721850355945, 5.664599289747325, 5.114815087079491, 5.261274568325962, 5.444605101785234, 5.537643625529833, 5.335952431279949, 5.577828581507883, 5.4440237818520565, 5.519510473206376, 5.348525451292615, 5.332409143544803, 5.375587399623557, 5.495593306829454, 5.3999626758226515, 5.4066734120707345, 5.192068633227686, 5.563730081979999, 5.382638716119294, 5.420348448142269, 5.3026691067231475, 5.595147994957907, 5.517110899706777, 5.315917751928273, 5.351512281233541, 5.536394337115503, 5.6851696390224244, 5.41484517462138, 5.450515965710934, 5.159203536116566, 5.69391258746295, 5.398778335591797, 5.584885551057053, 5.574308136362126, 5.233407210355592, 5.50092895377677, 5.260407817733018, 5.53756834154432, 5.38371142789054, 5.406383035284539, 5.427478309355151, 5.241068232055223, 5.709597806218503, 5.24088428173064, 5.344568994123559, 5.570549339959917, 5.2715620661538996, 5.1990955708970725, 5.477224116403393, 5.294108937533563, 5.119270231461742, 5.537112144599474, 5.440185893359156, 5.531392602577151, 5.595598285008155, 5.377588902539163, 5.354548934301364, 5.413077879256482, 5.645195020217248, 5.446044600977611, 5.228709450087188, 5.5838927552962145, 5.322438723982411, 5.288380848667581, 5.574760779403749, 0.246600249022072, 5.506371036178562, 5.56118580142293, 5.199219679953666, 5.462800880234115, 5.536551884081716, 5.113486797620871, 5.624766267466385, 5.591434792458971, 5.517603250052379, 5.600139377622222, 5.428777802394285, 5.640325570343218, 5.540252909026281, 5.479273759412054, 5.265551771438744, 5.497507860560047, 5.521627272128968, 5.222318613230998, 5.668657486130312, 5.533542733696658, 5.433838763536032, 5.558490895713472, 5.496833313861511, 5.132585384567097, 5.539355256640558, 5.447715235748559, 5.381748336064464, 5.123892974553563, 5.551783960747114, 5.423917473032281, 5.2327429866913615, 5.3233536034752715, 5.571767466562781, 5.655972646032352, 5.346447043992824, 5.144256939795133, 5.252419817428156, 5.205684119484724, 5.586255702160134, 5.125676600348754], "episode_lengths": [62, 49, 57, 79, 53, 110, 78, 52, 105, 76, 100, 79, 55, 73, 56, 57, 56, 39, 105, 91, 44, 115, 48, 48, 82, 87, 58, 55, 84, 81, 118, 64, 69, 112, 82, 78, 49, 43, 80, 72, 70, 74, 107, 56, 41, 96, 66, 90, 60, 62, 122, 49, 78, 88, 44, 62, 79, 53, 57, 61, 90, 70, 79, 42, 110, 148, 29, 82, 96, 48, 62, 64, 104, 56, 91, 53, 56, 52, 55, 87, 159, 81, 97, 48, 71, 79, 99, 81, 53, 73, 72, 109, 73, 53, 49, 72, 71, 87, 49, 50, 59, 97, 112, 71, 69, 97, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.25775240058541377, "mean_inference_ms": 1.4468915896884997, "mean_action_processing_ms": 0.13642261321874957, "mean_env_wait_ms": 2.6710795401302074, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 559440, "agent_timesteps_total": 559440, "timers": {"sample_time_ms": 7594.41, "sample_throughput": 1052.353, "load_time_ms": 3.557, "load_throughput": 2247008.819, "learn_time_ms": 7017.203, "learn_throughput": 1138.915, "update_time_ms": 3.352}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0518643744289875, "policy_loss": -0.019739797338843346, "vf_loss": 0.06896798312664032, "vf_explained_var": 0.7625105977058411, "kl": 0.013180953450500965, "entropy": 1.2828251123428345, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 559440, "num_agent_steps_sampled": 559440, "num_steps_trained": 559440, "num_agent_steps_trained": 559440}, "done": false, "episodes_total": 4622, "training_iteration": 70, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-50-08", "timestamp": 1716403808, "time_this_iter_s": 18.376595497131348, "time_total_s": 854.278267621994, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 854.278267621994, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 42.43846153846154, "ram_util_percent": 33.92307692307692}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.709481914733146, "episode_reward_min": 5.1295148666432855, "episode_reward_mean": 5.441048934718347, "episode_len_mean": 76.93333333333334, "episode_media": {}, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2679822680516806, "reward_component_totals/rejoin_dist_change_reward_min": 0.9457806350992342, "reward_component_totals/rejoin_dist_change_reward_max": 1.5204819147331465, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9230666666666667, "reward_component_totals/success_reward_min": 1.838, "reward_component_totals/success_reward_max": 1.9569999999999999}, "hist_stats": {"episode_reward": [5.575147744617927, 5.526892541312408, 5.356937848103395, 5.344815477212007, 5.498602827526588, 5.147520454538313, 5.376688745738168, 5.4280084570688345, 5.502569131612715, 5.210441000246744, 5.315386652912073, 5.63532632180483, 5.6616187153233195, 5.639018528235086, 5.49772809687015, 5.314267012105704, 5.47634162664023, 5.309434016063508, 5.306313443735744, 5.47348208743815, 5.3108568086891434, 5.518752040596375, 5.277323740977566, 5.510572395476588, 5.471108238135981, 5.618434219366412, 5.468471495333921, 5.141780635099234, 5.3800120209929645, 5.600203430797112, 5.137279423358086, 5.441839030423459, 5.524807920289435, 5.582990955418476, 5.464677445595763, 5.1509697221140724, 5.251888713987821, 5.6014826869342045, 5.230030871225985, 5.323269040555097, 5.541940213989728, 5.4992862662915485, 5.315860681532412, 5.555858487161859, 5.576388023381504, 5.523084187251497, 5.534217574869416, 5.656843800090123, 5.385292858924865, 5.1295148666432855, 5.296749360609278, 5.619136836817745, 5.492586800849471, 5.675586391315246, 5.526234936629885, 5.335670272555339, 5.421009337550001, 5.3678707465924935, 5.428479131426509, 5.709481914733146, 5.317682860254944, 5.480020210009867, 5.3643589496239965, 5.2310031366714735, 5.573982628442204, 5.349118500564337, 5.529368942227698, 5.5945648469961675, 5.559474590481198, 5.368288216185478, 5.6541881530536, 5.685523686493772, 5.2012312297066785, 5.594196309518739, 5.438423717487301, 5.289302233914738, 5.555373187715251, 5.449874377089129, 5.573768024831486, 5.149460895091231, 5.315346737191181, 5.236378985563961, 5.249436477542536, 5.5603832018800805, 5.291350639690377, 5.502718106623967, 5.622214457626524, 5.524401097580375, 5.436525798027939, 5.571351153499002, 5.5765237607664115, 5.4816785179261664, 5.592463020252538, 5.3261145435666375, 5.575329060154262, 5.414490083293044, 5.519346710420539, 5.441816864114844, 5.131371441120889, 5.493903596742015, 5.236563046901969, 5.554794049278168, 5.585709738921588, 5.612515798860157, 5.303822307833059], "episode_lengths": [108, 63, 70, 53, 60, 51, 45, 91, 63, 56, 52, 52, 71, 53, 67, 79, 49, 78, 46, 130, 67, 59, 80, 66, 119, 54, 88, 54, 106, 63, 73, 58, 74, 80, 124, 95, 88, 162, 87, 66, 54, 70, 85, 78, 59, 140, 60, 94, 56, 104, 91, 57, 56, 85, 51, 56, 64, 141, 62, 61, 91, 96, 70, 62, 69, 101, 155, 79, 91, 53, 98, 53, 108, 87, 80, 85, 90, 83, 76, 97, 75, 43, 69, 68, 72, 75, 54, 102, 45, 77, 76, 85, 54, 78, 85, 61, 104, 126, 66, 78, 61, 51, 64, 70, 91]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.263276556750295, "mean_inference_ms": 1.4624710652533035, "mean_action_processing_ms": 0.1378234230835697, "mean_env_wait_ms": 2.696868590278373, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 567432, "agent_timesteps_total": 567432, "timers": {"sample_time_ms": 7927.931, "sample_throughput": 1008.081, "load_time_ms": 3.686, "load_throughput": 2168050.395, "learn_time_ms": 7602.754, "learn_throughput": 1051.198, "update_time_ms": 3.301}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.037173546850681305, "policy_loss": -0.013814927078783512, "vf_loss": 0.04893001914024353, "vf_explained_var": 0.8054762482643127, "kl": 0.01029230561107397, "entropy": 1.2980962991714478, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 567432, "num_agent_steps_sampled": 567432, "num_steps_trained": 567432, "num_agent_steps_trained": 567432}, "done": false, "episodes_total": 4727, "training_iteration": 71, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-50-31", "timestamp": 1716403831, "time_this_iter_s": 23.156478881835938, "time_total_s": 877.43474650383, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 877.43474650383, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 43.009090909090915, "ram_util_percent": 34.25454545454546}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.708981807595487, "episode_reward_min": 0.15583941429393344, "episode_reward_mean": 5.386675188536217, "episode_len_mean": 73.47272727272727, "episode_media": {}, "episodes_this_iter": 110, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.990909090909091, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.00909090909090909, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9818181818181821, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24772727272727274, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2576479158089449, "reward_component_totals/rejoin_dist_change_reward_min": 0.9198071622524817, "reward_component_totals/rejoin_dist_change_reward_max": 1.5098864459580588, "reward_component_totals/failure_reward_mean": -0.00909090909090909, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.908572727272727, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.9609999999999999, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.337018281227019, 5.6389086207163395, 5.516017829918513, 5.441597537140213, 5.518918596457382, 5.447323428013728, 5.615297738927527, 0.15583941429393344, 5.508877307585434, 5.542286887338978, 5.265817185664382, 5.245691362071311, 5.323050360945743, 5.3304417487054305, 5.392314492120769, 5.6436928630498855, 5.216391331403713, 5.5963390118280145, 5.332691724492516, 5.28196999616414, 5.646136136586325, 5.325331021362025, 5.316983350519406, 5.658870434873616, 5.683316387610791, 5.322533661048933, 5.168492680321178, 5.48529838522899, 5.551083048139615, 5.486489824068919, 5.366117580588747, 5.637607641779148, 5.297240268706259, 5.411905203687041, 5.386385323305203, 5.496434472159953, 5.55786197956748, 5.570181462073907, 5.2715676555382665, 5.294121149988452, 5.205792167055693, 5.514773418839329, 5.32514285634094, 5.6183364823343815, 5.25064567026513, 5.574039947550244, 5.562316376620705, 5.292472156817441, 5.352698655362927, 5.288781616577911, 5.584477268228823, 5.343506397983036, 5.5033142673875, 5.349015552687565, 5.572355961368155, 5.35235665482888, 5.6169929101710245, 5.6855584617388555, 5.373856803473734, 5.416475474985683, 5.5252454592312334, 5.511704556200939, 5.5525979064663575, 5.299931375435783, 5.261927277448858, 5.612536780007648, 5.325659867785516, 5.1178071622524826, 5.3637907588110565, 5.406381059219288, 5.507543057863185, 5.334820045355247, 5.660428689036024, 5.473655670900076, 5.57840811097769, 5.439081704178856, 5.290977630554529, 5.331175919932629, 5.355015581409138, 5.603526778442639, 5.606824635734057, 5.4818521884905, 5.45478770259069, 5.708981807595487, 5.241556871342511, 5.329130328681806, 5.191221899741382, 5.268343732656755, 5.55898376235554, 5.420082534297647, 5.4313141481480764, 5.60916797142856, 5.418730511619795, 5.401391063890064, 5.704886445958058, 5.239818426067434, 5.6569429471240955, 5.502619758532476, 5.458076532099633, 5.5166929755790814, 5.38035217702826, 5.566504437220615, 5.266992018149368, 5.289996865334167, 5.521674919758912, 5.568897226322909, 5.168586770410219, 5.322151165703309, 5.308361198160555, 5.319779839615597], "episode_lengths": [74, 67, 50, 146, 65, 84, 76, 25, 63, 81, 44, 91, 86, 118, 67, 60, 65, 107, 68, 39, 72, 53, 86, 66, 66, 65, 88, 125, 68, 65, 87, 63, 75, 118, 60, 55, 139, 97, 55, 137, 58, 104, 49, 54, 54, 122, 56, 69, 66, 69, 99, 53, 82, 60, 70, 65, 82, 62, 48, 73, 106, 53, 81, 70, 82, 56, 123, 52, 43, 86, 100, 93, 66, 75, 56, 60, 53, 131, 83, 99, 55, 75, 60, 47, 55, 52, 133, 53, 113, 100, 51, 49, 82, 51, 55, 60, 47, 76, 81, 59, 64, 84, 71, 43, 45, 57, 67, 72, 72, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26100335223600046, "mean_inference_ms": 1.4697423543027452, "mean_action_processing_ms": 0.13862689943701098, "mean_env_wait_ms": 2.7108582132925108, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 575424, "agent_timesteps_total": 575424, "timers": {"sample_time_ms": 8039.181, "sample_throughput": 994.131, "load_time_ms": 3.767, "load_throughput": 2121775.964, "learn_time_ms": 7829.325, "learn_throughput": 1020.778, "update_time_ms": 3.314}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0646597370505333, "policy_loss": -0.011398605071008205, "vf_loss": 0.07378767430782318, "vf_explained_var": 0.7593568563461304, "kl": 0.011353329755365849, "entropy": 1.2675859928131104, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 575424, "num_agent_steps_sampled": 575424, "num_steps_trained": 575424, "num_agent_steps_trained": 575424}, "done": false, "episodes_total": 4837, "training_iteration": 72, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-50-49", "timestamp": 1716403849, "time_this_iter_s": 17.614964485168457, "time_total_s": 895.0497109889984, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 895.0497109889984, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 43.267999999999994, "ram_util_percent": 33.964}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.71155862502353, "episode_reward_min": 5.149205080637039, "episode_reward_mean": 5.451262584666988, "episode_len_mean": 70.20353982300885, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2714661244899965, "reward_component_totals/rejoin_dist_change_reward_min": 0.9582050806370375, "reward_component_totals/rejoin_dist_change_reward_max": 1.5135586250235313, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9297964601769915, "reward_component_totals/success_reward_min": 1.854, "reward_component_totals/success_reward_max": 1.959}, "hist_stats": {"episode_reward": [5.374278176475565, 5.373402680530443, 5.2595565760716125, 5.349912885387638, 5.610596241739291, 5.284942589532715, 5.447741668620876, 5.206073887939601, 5.494990733969532, 5.560919516648793, 5.492633172584799, 5.687011163850137, 5.502286238836586, 5.236845821403348, 5.25790701044637, 5.542462631865071, 5.566145560935076, 5.401791348405201, 5.413675936332517, 5.589958390795319, 5.2820054924739015, 5.295320509855161, 5.530359595278442, 5.431901828547458, 5.625359884959142, 5.451621818541712, 5.387429193406972, 5.469776661245385, 5.208154326589643, 5.627572100295133, 5.459361169957573, 5.50716943677404, 5.336732345385292, 5.502156877016452, 5.3982424119549135, 5.51053636010823, 5.445356367515243, 5.3932275207049845, 5.239730788137629, 5.190934416050586, 5.427964858939285, 5.543264304441257, 5.182580203194528, 5.225167587742215, 5.244859718283664, 5.495009190001603, 5.579768500277531, 5.596513169394308, 5.422204551572909, 5.163127224398645, 5.226887785415151, 5.637383942371724, 5.496605129483235, 5.670161219372725, 5.519831365001105, 5.707627540403157, 5.4112454290166125, 5.688593091483991, 5.458075016066723, 5.373381879609408, 5.594509405110618, 5.501214371579928, 5.454187132129984, 5.465897697544628, 5.3939751381842225, 5.538158523398632, 5.57165145679282, 5.553322659429956, 5.209473505751898, 5.244733361307891, 5.680155237051904, 5.534143783765948, 5.71155862502353, 5.158302567288166, 5.666071302380503, 5.556162548452756, 5.302688032947906, 5.47303729729711, 5.149205080637039, 5.658719140587541, 5.346726149877917, 5.422109692642888, 5.576692465776848, 5.427026403005543, 5.479055637474073, 5.274429266375058, 5.598842693555765, 5.459813043482377, 5.25458260803407, 5.690731759574129, 5.386773154998085, 5.492072535991252, 5.465146499380238, 5.21032010019476, 5.424829252897123, 5.606546842215368, 5.649946808793823, 5.338139693064877, 5.5132338542211095, 5.453986882106162, 5.633346166356803, 5.677971435031818, 5.345292982694705, 5.679508834783855, 5.3418728810251235, 5.551649076918159, 5.502233672968322, 5.532428669918417, 5.314533393773115, 5.58904557859213, 5.368170528780122, 5.4570732173989445, 5.495040375165509], "episode_lengths": [140, 62, 50, 71, 82, 65, 104, 87, 68, 73, 58, 67, 43, 61, 60, 82, 50, 54, 58, 122, 56, 64, 49, 60, 54, 48, 73, 46, 54, 56, 66, 70, 88, 100, 87, 73, 43, 52, 81, 68, 84, 72, 89, 68, 54, 110, 75, 47, 83, 100, 53, 61, 146, 55, 67, 50, 93, 51, 67, 47, 105, 50, 45, 43, 41, 60, 57, 122, 52, 53, 71, 66, 52, 76, 67, 51, 48, 59, 59, 53, 54, 93, 61, 63, 86, 54, 57, 44, 75, 58, 146, 77, 76, 54, 97, 101, 79, 71, 111, 64, 45, 75, 100, 54, 50, 112, 111, 63, 63, 53, 57, 82, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2639870552264521, "mean_inference_ms": 1.479451272367374, "mean_action_processing_ms": 0.13936927711760802, "mean_env_wait_ms": 2.7270855151445015, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 583416, "agent_timesteps_total": 583416, "timers": {"sample_time_ms": 8183.976, "sample_throughput": 976.542, "load_time_ms": 3.834, "load_throughput": 2084437.246, "learn_time_ms": 7972.574, "learn_throughput": 1002.437, "update_time_ms": 3.306}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04109571501612663, "policy_loss": -0.011596892029047012, "vf_loss": 0.0502936951816082, "vf_explained_var": 0.8040906190872192, "kl": 0.011994577944278717, "entropy": 1.1828902959823608, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 583416, "num_agent_steps_sampled": 583416, "num_steps_trained": 583416, "num_agent_steps_trained": 583416}, "done": false, "episodes_total": 4950, "training_iteration": 73, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-51-06", "timestamp": 1716403866, "time_this_iter_s": 17.02863073348999, "time_total_s": 912.0783417224884, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 912.0783417224884, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 38.559999999999995, "ram_util_percent": 33.96}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.70649575523853, "episode_reward_min": 5.140400782542542, "episode_reward_mean": 5.457604763912442, "episode_len_mean": 74.91588785046729, "episode_media": {}, "episodes_this_iter": 107, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2825206517629082, "reward_component_totals/rejoin_dist_change_reward_min": 0.9681971590917842, "reward_component_totals/rejoin_dist_change_reward_max": 1.5224957552385294, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9250841121495326, "reward_component_totals/success_reward_min": 1.846, "reward_component_totals/success_reward_max": 1.9649999999999999}, "hist_stats": {"episode_reward": [5.513861113571018, 5.619462939257968, 5.531669823888017, 5.279700082461664, 5.538488936127832, 5.6326625648193644, 5.514324843515691, 5.325800478709546, 5.5655558699242205, 5.562359251805358, 5.615737807419416, 5.389526030018545, 5.6759267869901215, 5.392023151332214, 5.374884454515925, 5.263880995452051, 5.140447580862299, 5.169964643512073, 5.548927406303971, 5.43044241563733, 5.567220477347025, 5.534945749969617, 5.140400782542542, 5.549200935141334, 5.575552451836469, 5.412021121163761, 5.53947216060209, 5.177197159091785, 5.426803907093747, 5.616523140503241, 5.501857106260317, 5.302817816197237, 5.385860900446262, 5.550721244690395, 5.619814545841265, 5.343111543554796, 5.541449023916788, 5.2699496226984, 5.190407118637706, 5.243044330866413, 5.635354049859675, 5.633019044640142, 5.531286726933921, 5.340100770041742, 5.280222858803961, 5.651134104593201, 5.547252351026694, 5.619542937032239, 5.497848985374608, 5.281203583015673, 5.639252835231725, 5.392430800887633, 5.4745177119306145, 5.591938956696561, 5.3430383672849695, 5.359915523213409, 5.453327804744962, 5.48680075994289, 5.4066243142878925, 5.592368229343087, 5.327991901639111, 5.402616966138005, 5.405386775158393, 5.58867564321534, 5.35506403292686, 5.5105329539479255, 5.516315052246111, 5.399854290227897, 5.328278546234753, 5.618593132566049, 5.447147968114651, 5.291451899173008, 5.60317137384454, 5.379236342225939, 5.649398390516238, 5.70649575523853, 5.459159656424779, 5.361539936400412, 5.618637484780308, 5.376410344729859, 5.576186921464389, 5.557865325405451, 5.674970582258786, 5.6008085923268895, 5.37785457325931, 5.26189485948728, 5.420997269767774, 5.496650821387229, 5.564301017840901, 5.2459261356852105, 5.597543873970106, 5.343563534739152, 5.453778208606291, 5.261447055542499, 5.633616489088515, 5.516623339470463, 5.573137559215068, 5.427188014672534, 5.567798103992949, 5.305361841962266, 5.674589123364292, 5.184942059888376, 5.539425740952953, 5.224590234790924, 5.169369123720513, 5.577504243356538, 5.4586176172544025], "episode_lengths": [121, 79, 74, 80, 49, 57, 52, 140, 129, 66, 63, 104, 78, 69, 51, 52, 84, 61, 92, 77, 77, 57, 111, 65, 90, 77, 97, 41, 59, 98, 74, 44, 87, 154, 77, 65, 105, 82, 72, 61, 77, 73, 54, 45, 44, 76, 92, 64, 74, 97, 75, 125, 56, 50, 79, 121, 48, 45, 62, 61, 43, 65, 116, 57, 51, 119, 49, 55, 126, 68, 68, 75, 47, 64, 70, 66, 89, 79, 84, 67, 53, 63, 59, 106, 91, 52, 111, 79, 95, 91, 52, 64, 91, 66, 56, 42, 126, 40, 89, 82, 53, 35, 52, 111, 80, 83, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2647300202124598, "mean_inference_ms": 1.4827137413280929, "mean_action_processing_ms": 0.13974340860978413, "mean_env_wait_ms": 2.7341976098531586, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 591408, "agent_timesteps_total": 591408, "timers": {"sample_time_ms": 8184.112, "sample_throughput": 976.526, "load_time_ms": 3.786, "load_throughput": 2110660.544, "learn_time_ms": 7959.807, "learn_throughput": 1004.044, "update_time_ms": 3.301}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04101971909403801, "policy_loss": -0.01232569757848978, "vf_loss": 0.05118976905941963, "vf_explained_var": 0.8111501336097717, "kl": 0.010778249241411686, "entropy": 1.1680370569229126, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 591408, "num_agent_steps_sampled": 591408, "num_steps_trained": 591408, "num_agent_steps_trained": 591408}, "done": false, "episodes_total": 5057, "training_iteration": 74, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-51-20", "timestamp": 1716403880, "time_this_iter_s": 14.169631004333496, "time_total_s": 926.2479727268219, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 926.2479727268219, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 34.87, "ram_util_percent": 34.010000000000005}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.694416704469505, "episode_reward_min": 0.04225074917084337, "episode_reward_mean": 5.378199659935572, "episode_len_mean": 71.42477876106194, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9911504424778761, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.008849557522123894, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9823008849557524, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24778761061946902, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2459784209975189, "reward_component_totals/rejoin_dist_change_reward_min": 0.955437708997628, "reward_component_totals/rejoin_dist_change_reward_max": 1.512798732039304, "reward_component_totals/failure_reward_mean": -0.008849557522123894, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9109823008849558, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.958, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.527087681528, 5.129437708997629, 5.253367905580631, 5.259925143126734, 5.2000141004350695, 5.21646115301327, 5.242201126028775, 5.617104021858511, 5.422673065711807, 5.463209128656035, 5.276490220700228, 5.320096132475086, 5.19933121077291, 5.254254508419595, 5.2859813943487675, 5.679757419509061, 5.561629287422633, 5.606262708211758, 5.4567901091018, 5.598664258828773, 5.498064951432244, 5.172362131416508, 5.640093629396123, 5.298104514988492, 5.594842762763182, 5.337879277506975, 5.260912132673753, 5.4200288557681375, 5.624326274701872, 5.419122268030344, 5.187585662023208, 5.244530086175645, 5.533352341564683, 5.364735490975334, 5.149394116665374, 5.4055806674980715, 5.516364907155063, 5.2989572916878735, 5.655575690363407, 5.1942970766968095, 5.48967139891481, 5.428014621615512, 5.5254877028783635, 5.312088201326985, 5.5915609130741295, 5.448039738759884, 5.365970774076393, 5.430283719664926, 5.391022027739055, 5.305904003791294, 5.511248774378199, 5.645772773809334, 5.562405190098334, 5.5023753866131795, 5.469105813121596, 5.321632640348589, 5.487148520729763, 5.666635390349211, 5.218648857814638, 5.530142793383352, 5.579489938329154, 5.561425679569636, 5.3753895056231755, 5.266212255738722, 5.3341901923696495, 5.178690464232584, 5.581670302878323, 5.496751391153309, 5.443477438986015, 5.578567965550967, 5.389874973483664, 5.457474865464379, 5.553186343726363, 5.259260918355679, 5.24372637882264, 5.180240181694763, 5.587282445306165, 5.423583692083571, 5.379328548972348, 5.625234588380288, 5.5421024420846825, 5.580065721402502, 5.4502580911663125, 5.2808640333495065, 5.433641259156328, 5.602196903630981, 5.3442143609681185, 5.202363302325235, 5.5858263083387865, 5.300939337427025, 5.35942515680502, 5.511738070621684, 5.4279131466314645, 5.5178703533087585, 5.426161952982756, 5.591783575415003, 0.04225074917084337, 5.372221840872078, 5.6897987320393035, 5.320843146652744, 5.56319849697114, 5.25479375063683, 5.410371370088903, 5.215251331046893, 5.694416704469505, 5.4773435278839955, 5.6074403258333305, 5.315082798543498, 5.628991842853585, 5.393638038052915, 5.383330541593779, 5.6344309934879675, 5.490727639489066], "episode_lengths": [51, 76, 52, 61, 79, 61, 80, 72, 86, 111, 82, 45, 66, 43, 74, 76, 84, 62, 64, 76, 84, 57, 78, 63, 63, 68, 100, 63, 45, 76, 89, 82, 51, 49, 104, 59, 103, 58, 73, 66, 119, 52, 72, 65, 77, 89, 87, 103, 53, 82, 64, 56, 51, 85, 83, 53, 93, 57, 52, 82, 100, 58, 55, 68, 43, 51, 50, 112, 50, 127, 71, 68, 99, 43, 107, 73, 50, 75, 70, 63, 59, 62, 112, 67, 65, 60, 71, 101, 62, 92, 47, 82, 57, 67, 79, 64, 12, 87, 73, 83, 128, 61, 90, 42, 67, 47, 62, 82, 47, 96, 60, 70, 77]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26606877045079824, "mean_inference_ms": 1.4889804640099695, "mean_action_processing_ms": 0.1403295616475778, "mean_env_wait_ms": 2.745530105710824, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 599400, "agent_timesteps_total": 599400, "timers": {"sample_time_ms": 8292.931, "sample_throughput": 963.712, "load_time_ms": 3.907, "load_throughput": 2045352.776, "learn_time_ms": 8200.751, "learn_throughput": 974.545, "update_time_ms": 3.413}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.048580069094896317, "policy_loss": -0.013875107280910015, "vf_loss": 0.059878360480070114, "vf_explained_var": 0.7820493578910828, "kl": 0.012884099967777729, "entropy": 1.0752782821655273, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 599400, "num_agent_steps_sampled": 599400, "num_steps_trained": 599400, "num_agent_steps_trained": 599400}, "done": false, "episodes_total": 5170, "training_iteration": 75, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-51-37", "timestamp": 1716403897, "time_this_iter_s": 17.209333181381226, "time_total_s": 943.4573059082031, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 943.4573059082031, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 39.479166666666664, "ram_util_percent": 33.99166666666667}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.701024130813975, "episode_reward_min": 5.129214926599055, "episode_reward_mean": 5.442387675618939, "episode_len_mean": 73.69444444444444, "episode_media": {}, "episodes_this_iter": 108, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2660821200633843, "reward_component_totals/rejoin_dist_change_reward_min": 0.9565474782779269, "reward_component_totals/rejoin_dist_change_reward_max": 1.510024130813976, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9263055555555555, "reward_component_totals/success_reward_min": 1.841, "reward_component_totals/success_reward_max": 1.9609999999999999}, "hist_stats": {"episode_reward": [5.603577755431594, 5.542256101460101, 5.346038127928183, 5.701024130813975, 5.412116506871998, 5.455864926595332, 5.63044994093457, 5.638965611209064, 5.494087232849003, 5.607838825512797, 5.265845830391978, 5.542304120967083, 5.342335721554631, 5.48822621862885, 5.494781062034096, 5.157831712527246, 5.528136212957936, 5.498433688383312, 5.192415859776876, 5.52231426741547, 5.54709180072861, 5.384671543719051, 5.405167064204759, 5.440849196092401, 5.511959619200242, 5.477316183431297, 5.294600409003143, 5.377828722378048, 5.645134219103179, 5.526419789864217, 5.4247786996639356, 5.391689457945811, 5.562423272316732, 5.603670344349044, 5.348273168376546, 5.64059575106896, 5.594208772413159, 5.129214926599055, 5.294945857097874, 5.536924951005382, 5.431698072804225, 5.249556502900293, 5.516706417625961, 5.60718474941209, 5.169711242005029, 5.390491457142021, 5.559279734028388, 5.331544143864531, 5.433675431663168, 5.532412225537962, 5.343512801282069, 5.5160520367544885, 5.29222614367274, 5.270372267132922, 5.538995376392272, 5.328572906835877, 5.610739078667317, 5.657929381882681, 5.279267230967335, 5.2486320173966545, 5.31381721873576, 5.4731484923445795, 5.47188758109654, 5.381717250474875, 5.3878207354063585, 5.557536792209878, 5.2644291896133435, 5.358835869911369, 5.26047434329078, 5.584122539008972, 5.3702469576868275, 5.642092387173516, 5.365763625552534, 5.559208928859123, 5.368503217518138, 5.521315541973329, 5.305833344565691, 5.332395827253162, 5.41611551816302, 5.417325140675617, 5.468437549446168, 5.482450310606788, 5.2455947178660285, 5.4091336155142145, 5.164547478277926, 5.354152477760015, 5.522759057574078, 5.434532654711227, 5.383426547307406, 5.343776313962964, 5.339267220145865, 5.425738133292446, 5.596532251975955, 5.612591554961046, 5.250257162185181, 5.5249658904982635, 5.6825744716111615, 5.42743533470559, 5.548945912839201, 5.637201570693589, 5.314723181796422, 5.3689600161897255, 5.629972676026342, 5.500321929632372, 5.639111833493132, 5.539486049020889, 5.469655728640005, 5.1975600038244965], "episode_lengths": [54, 59, 65, 59, 64, 73, 76, 67, 102, 111, 113, 57, 71, 153, 128, 102, 54, 119, 72, 50, 49, 81, 62, 133, 106, 85, 74, 50, 51, 53, 76, 85, 114, 110, 54, 51, 94, 87, 70, 81, 55, 85, 50, 49, 77, 52, 53, 47, 76, 42, 86, 43, 43, 74, 54, 81, 52, 60, 80, 125, 69, 64, 72, 73, 159, 77, 79, 89, 63, 54, 51, 92, 75, 83, 65, 91, 62, 90, 50, 79, 93, 76, 97, 54, 42, 42, 46, 42, 88, 39, 42, 76, 97, 49, 63, 83, 48, 60, 130, 52, 52, 86, 79, 63, 75, 79, 98, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26670599271738055, "mean_inference_ms": 1.5005169935067206, "mean_action_processing_ms": 0.14137453247589069, "mean_env_wait_ms": 2.765968553380176, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 607392, "agent_timesteps_total": 607392, "timers": {"sample_time_ms": 8557.69, "sample_throughput": 933.897, "load_time_ms": 4.066, "load_throughput": 1965330.736, "learn_time_ms": 8507.677, "learn_throughput": 939.387, "update_time_ms": 3.424}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03842395171523094, "policy_loss": -0.013179867528378963, "vf_loss": 0.04942109063267708, "vf_explained_var": 0.8085195422172546, "kl": 0.010913660749793053, "entropy": 1.0955253839492798, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 607392, "num_agent_steps_sampled": 607392, "num_steps_trained": 607392, "num_agent_steps_trained": 607392}, "done": false, "episodes_total": 5278, "training_iteration": 76, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-51-57", "timestamp": 1716403917, "time_this_iter_s": 19.95287036895752, "time_total_s": 963.4101762771606, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 963.4101762771606, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 42.50344827586206, "ram_util_percent": 33.94137931034483}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.707094283784642, "episode_reward_min": 5.100533885593636, "episode_reward_mean": 5.427377986983587, "episode_len_mean": 75.71153846153847, "episode_media": {}, "episodes_this_iter": 104, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2530895254451266, "reward_component_totals/rejoin_dist_change_reward_min": 0.9150369291788927, "reward_component_totals/rejoin_dist_change_reward_max": 1.5197441387054271, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9242884615384612, "reward_component_totals/success_reward_min": 1.849, "reward_component_totals/success_reward_max": 1.958}, "hist_stats": {"episode_reward": [5.559555324149113, 5.240914865830215, 5.320613700315782, 5.210115733355673, 5.367249231599533, 5.4543447245966306, 5.576693299834794, 5.347654015787184, 5.447249630436936, 5.158334225271428, 5.410043844764124, 5.479787551718685, 5.610027324258298, 5.484273987459597, 5.181529451178754, 5.327959009772507, 5.406104140877558, 5.466564978246652, 5.3466143694599, 5.28930692695206, 5.167046227875015, 5.262286761042888, 5.265488749881142, 5.18163295458859, 5.707094283784642, 5.380582271805022, 5.613025730326908, 5.635633801777304, 5.299171729301703, 5.584621392590293, 5.234058210260141, 5.2667569560038725, 5.100533885593636, 5.460961627391189, 5.594298701703957, 5.299368563874541, 5.2569165049725335, 5.2550057052673145, 5.1717952997931835, 5.573101683534543, 5.288980733774874, 5.506415177510751, 5.50952420337071, 5.227253162086221, 5.6654586742935535, 5.385729650669424, 5.499482889699574, 5.630947147003953, 5.153199338739425, 5.372077220171207, 5.672075374250294, 5.407256911563986, 5.3520846407023015, 5.443786563399852, 5.580126359910267, 5.400350010605928, 5.420795128283093, 5.701744138705427, 5.260848189414154, 5.487503925664477, 5.322901780130002, 5.541131001251148, 5.547086648885609, 5.403329609842935, 5.247871098721349, 5.604922085327744, 5.321032967661603, 5.4556686051727885, 5.672013862872985, 5.292149322519752, 5.520460165544744, 5.172420622514096, 5.341041367712121, 5.363353833397329, 5.431458519284538, 5.63859672062357, 5.627345891691898, 5.513853089743528, 5.1140369291788925, 5.526399666877584, 5.5230728386191625, 5.554143894669048, 5.606392957850398, 5.583443619143534, 5.596270903126099, 5.2235298853763235, 5.465700246513949, 5.583215737770775, 5.372705834576428, 5.514065684264308, 5.40220695740258, 5.479323328174435, 5.5023370981078985, 5.171985757891742, 5.5017397782270905, 5.528584174389515, 5.586345721036725, 5.288092229094093, 5.632863546632091, 5.53257472897042, 5.572349432270145, 5.577094951439516, 5.489353684130242, 5.542887050609119], "episode_lengths": [53, 77, 50, 75, 105, 93, 112, 59, 46, 56, 50, 76, 114, 105, 46, 104, 65, 77, 55, 70, 45, 51, 84, 98, 49, 70, 65, 68, 44, 83, 89, 46, 88, 65, 78, 54, 58, 52, 115, 120, 100, 130, 69, 50, 65, 140, 111, 55, 58, 56, 57, 66, 57, 118, 77, 110, 59, 68, 73, 65, 110, 77, 118, 62, 77, 60, 64, 76, 78, 78, 107, 63, 83, 65, 59, 49, 56, 81, 51, 57, 56, 99, 52, 94, 71, 62, 64, 77, 59, 69, 76, 42, 86, 118, 51, 65, 136, 69, 65, 57, 79, 90, 121, 151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26987623174467434, "mean_inference_ms": 1.5107412302699998, "mean_action_processing_ms": 0.1422467735831499, "mean_env_wait_ms": 2.781631572988917, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 615384, "agent_timesteps_total": 615384, "timers": {"sample_time_ms": 8608.504, "sample_throughput": 928.384, "load_time_ms": 4.123, "load_throughput": 1938328.846, "learn_time_ms": 8720.216, "learn_throughput": 916.491, "update_time_ms": 3.439}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03500301390886307, "policy_loss": -0.0151679003611207, "vf_loss": 0.04735751077532768, "vf_explained_var": 0.8142120838165283, "kl": 0.0140670295804739, "entropy": 1.0253281593322754, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 615384, "num_agent_steps_sampled": 615384, "num_steps_trained": 615384, "num_agent_steps_trained": 615384}, "done": false, "episodes_total": 5382, "training_iteration": 77, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-52-16", "timestamp": 1716403936, "time_this_iter_s": 18.009263038635254, "time_total_s": 981.4194393157959, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 981.4194393157959, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 41.49999999999999, "ram_util_percent": 34.22307692307692}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.701316947546879, "episode_reward_min": 0.18682813669772935, "episode_reward_mean": 5.393357496559954, "episode_len_mean": 68.03389830508475, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9915254237288136, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.00847457627118644, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9830508474576274, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.2478813559322034, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.255721903339614, "reward_component_totals/rejoin_dist_change_reward_min": 0.9425910072997989, "reward_component_totals/rejoin_dist_change_reward_max": 1.5209269210521015, "reward_component_totals/failure_reward_mean": -0.00847457627118644, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.915177966101695, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.9649999999999999, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.543827009256885, 5.556584131640524, 5.3347248386576265, 5.3744246829121565, 5.431679757685902, 5.34398685255297, 5.387041619214408, 5.466381595701336, 5.397834151569121, 5.429310935777631, 5.445657419037581, 5.245638885698241, 5.556710819179052, 5.44591858238018, 5.536455901162121, 5.413998480185431, 5.424369542102779, 5.258379603079586, 5.236075319806465, 5.636338861588564, 5.232765772297901, 5.686760314800143, 5.3603478008586425, 5.417155054295163, 5.532787876162519, 5.683225685457113, 5.686827945342799, 5.459345315592994, 5.370779998872209, 5.243749385902634, 5.424301181353131, 5.44021360658855, 5.566747509983726, 5.173161863040124, 5.601801349068066, 5.394951367505924, 5.528417340653689, 5.614610801286549, 5.254921797928691, 5.345167129833021, 5.561871003410504, 5.56187719895977, 5.401982072254247, 5.385505552472056, 5.116099942547834, 5.388620009580805, 5.449126543548141, 5.682533997719593, 5.246243911021169, 5.560605030973145, 5.547994999787258, 5.457472967617774, 5.424840451806423, 5.373460877746162, 5.571574785503119, 5.34844802455925, 5.423050450722991, 5.495354912381245, 5.535771146241787, 5.318363075286131, 5.506959779329609, 5.436627807814576, 5.412732858989095, 5.21732502406616, 5.640636480350761, 5.518900788949691, 5.285394199825676, 5.354032958011642, 5.2925403141961915, 5.597194738562543, 5.371889082954381, 5.694926921052102, 5.445826076522124, 5.5550388665698796, 5.204378883832323, 5.4670076533264655, 5.537031307207963, 5.215314065742757, 5.1610231061951755, 5.58544747828614, 5.349593888394616, 5.55622359835492, 5.5144439471549305, 5.167952189709412, 5.548026425530505, 5.653601851350519, 5.2803264200515265, 5.701316947546879, 5.32122225476123, 5.178759423549942, 5.549530828967722, 5.495550739020276, 5.224053443883246, 5.186369747699585, 5.599290877964806, 5.578746737626249, 5.6544232956367075, 5.621460369107741, 5.228082407880805, 5.612150839937835, 5.22412526553468, 5.601028842365178, 5.307836412055114, 5.321880314128846, 5.403044919102941, 5.51686220519, 5.381635264760149, 5.556758000572934, 5.526831391188593, 5.655449632281576, 5.432485404621266, 0.18682813669772935, 5.610818048827591, 5.324091204565427, 5.3768072070824555, 5.540143240127998, 5.1225910072998, 5.4714384316059235], "episode_lengths": [89, 112, 44, 59, 68, 70, 63, 63, 46, 59, 45, 37, 81, 62, 52, 59, 88, 56, 38, 65, 44, 55, 80, 44, 93, 52, 67, 148, 50, 58, 41, 55, 54, 92, 78, 66, 51, 52, 63, 66, 85, 82, 85, 52, 106, 51, 68, 65, 54, 52, 77, 70, 70, 53, 71, 61, 102, 68, 61, 67, 88, 41, 82, 93, 55, 72, 81, 55, 83, 103, 44, 76, 54, 62, 81, 145, 100, 101, 98, 55, 52, 63, 48, 53, 80, 75, 48, 66, 35, 55, 49, 72, 68, 81, 114, 52, 61, 67, 56, 77, 57, 65, 41, 45, 97, 91, 66, 126, 67, 83, 90, 19, 76, 50, 52, 54, 70, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27321670070753795, "mean_inference_ms": 1.5160098750744448, "mean_action_processing_ms": 0.1427376482362984, "mean_env_wait_ms": 2.7929070620590157, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 623376, "agent_timesteps_total": 623376, "timers": {"sample_time_ms": 8713.557, "sample_throughput": 917.191, "load_time_ms": 4.154, "load_throughput": 1923877.819, "learn_time_ms": 9067.776, "learn_throughput": 881.363, "update_time_ms": 3.447}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05952669307589531, "policy_loss": -0.012622466310858727, "vf_loss": 0.06953388452529907, "vf_explained_var": 0.7641464471817017, "kl": 0.013076415285468102, "entropy": 0.9596025347709656, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 623376, "num_agent_steps_sampled": 623376, "num_steps_trained": 623376, "num_agent_steps_trained": 623376}, "done": false, "episodes_total": 5500, "training_iteration": 78, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-52-34", "timestamp": 1716403954, "time_this_iter_s": 18.623857975006104, "time_total_s": 1000.043297290802, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1000.043297290802, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 41.396153846153844, "ram_util_percent": 34.26153846153846}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.702767366642764, "episode_reward_min": 0.065322589159305, "episode_reward_mean": 5.362491263018777, "episode_len_mean": 71.990990990991, "episode_media": {}, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9819819819819819, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.018018018018018018, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.963963963963964, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24549549549549549, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2787975693250822, "reward_component_totals/rejoin_dist_change_reward_min": 0.9472656194946882, "reward_component_totals/rejoin_dist_change_reward_max": 1.5103377016512494, "reward_component_totals/failure_reward_mean": -0.018018018018018018, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.8922522522522522, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.964, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.281397380492713, 5.702767366642764, 5.260757372129848, 5.562536523403557, 5.1824696087777875, 5.369140112662036, 5.253476573023264, 5.528541052302581, 5.461621989672304, 5.565985125905538, 5.414619342550072, 5.5734972423392275, 5.684152613529878, 5.457349018762484, 5.559583510432162, 5.5656934324321234, 5.484610885431123, 5.325778085080023, 5.592414988682266, 5.652713275098032, 5.632268236671836, 0.3055634977283559, 5.205853907960391, 5.61713930620857, 5.3307865700911705, 5.376431287244945, 5.610159933855194, 5.570766486497574, 5.411541976992757, 0.065322589159305, 5.59555782384664, 5.660865256597674, 5.336814197703291, 5.621691022583416, 5.344268131978921, 5.363763819850007, 5.614862865257008, 5.657558601815964, 5.5974007326490955, 5.477074723453763, 5.5088901961942, 5.481177819611477, 5.2489435161892075, 5.379716907443272, 5.585983483842611, 5.2600897137881075, 5.587467659488139, 5.493786084896352, 5.24890096036224, 5.257892512682419, 5.221961455358107, 5.339078795532782, 5.487372586756996, 5.443839267444085, 5.4034538476435054, 5.4579608654038765, 5.514737299327678, 5.28942106337132, 5.238970462858738, 5.291307777859704, 5.492792824569314, 5.299637453936446, 5.3387767137095015, 5.654896973650635, 5.5228734987785195, 5.365488106376116, 5.562611778267474, 5.39631091918104, 5.594694940388639, 5.555291927865144, 5.380631878646537, 5.498877396343138, 5.622992986926588, 5.665337701651248, 5.31435895688885, 5.568034007237042, 5.581023933635016, 5.4715209214554985, 5.424121384082357, 5.4085647681331706, 5.553739447829638, 5.206510739276062, 5.50364769895169, 5.434172038962924, 5.520424618058992, 5.2901770350834045, 5.425691363784751, 5.367576374046369, 5.516288142140034, 5.505271882719534, 5.339595740266443, 5.366616507213334, 5.234783068852202, 5.161265619494689, 5.509160693702971, 5.379702144964347, 5.224121162342046, 5.513926082927751, 5.595552594099749, 5.643212162513813, 5.577164089055071, 5.299672316615762, 5.551353105338729, 5.484608210649027, 5.384580498908344, 5.623836307677707, 5.539231374438467, 5.575407216235438, 5.580028741725096, 5.4783033162605825, 5.5163220856764275], "episode_lengths": [69, 54, 81, 83, 41, 46, 75, 67, 79, 61, 68, 71, 62, 114, 89, 88, 54, 57, 56, 85, 78, 18, 90, 72, 87, 88, 62, 72, 82, 13, 92, 70, 93, 47, 50, 85, 56, 56, 53, 106, 68, 86, 69, 58, 88, 76, 56, 49, 63, 65, 50, 75, 64, 78, 56, 41, 54, 78, 70, 124, 82, 63, 68, 70, 44, 69, 72, 70, 71, 87, 107, 87, 101, 95, 77, 51, 98, 95, 58, 49, 122, 66, 54, 64, 62, 55, 73, 63, 64, 55, 70, 108, 96, 36, 82, 72, 76, 68, 55, 53, 101, 110, 150, 57, 44, 56, 91, 129, 52, 65, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27235353569162574, "mean_inference_ms": 1.5175967399018662, "mean_action_processing_ms": 0.14287761778381125, "mean_env_wait_ms": 2.796718544695081, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 631368, "agent_timesteps_total": 631368, "timers": {"sample_time_ms": 8690.992, "sample_throughput": 919.573, "load_time_ms": 4.165, "load_throughput": 1918998.71, "learn_time_ms": 9306.551, "learn_throughput": 858.75, "update_time_ms": 3.461}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.06873401254415512, "policy_loss": -0.008685925975441933, "vf_loss": 0.07437915354967117, "vf_explained_var": 0.750138521194458, "kl": 0.015203948132693768, "entropy": 0.9695426225662231, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 631368, "num_agent_steps_sampled": 631368, "num_steps_trained": 631368, "num_agent_steps_trained": 631368}, "done": false, "episodes_total": 5611, "training_iteration": 79, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-52-50", "timestamp": 1716403970, "time_this_iter_s": 16.095945835113525, "time_total_s": 1016.1392431259155, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1016.1392431259155, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 37.45652173913044, "ram_util_percent": 34.13913043478262}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.7183826865006155, "episode_reward_min": 0.03227865176302358, "episode_reward_mean": 5.376395958666319, "episode_len_mean": 69.73275862068965, "episode_media": {}, "episodes_this_iter": 116, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9827586206896551, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.017241379310344827, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9655172413793105, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24568965517241378, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2863873379766644, "reward_component_totals/rejoin_dist_change_reward_min": 0.994403991221154, "reward_component_totals/rejoin_dist_change_reward_max": 1.5243826865006167, "reward_component_totals/failure_reward_mean": -0.017241379310344827, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.8960431034482759, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.96, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.550485253115163, 5.602850636370487, 5.409641003559709, 5.543517056117507, 5.265262601886933, 5.338366489201089, 5.560605811491394, 5.531289914185161, 5.446507750929371, 5.494923748786046, 5.435058134479542, 5.290488495964036, 5.1986993504470345, 5.418630694203239, 5.65958774615412, 5.29263336985228, 5.336765080079868, 5.618447084584268, 0.10588994106768546, 0.03227865176302358, 5.201791528294958, 5.360023351184538, 5.323863469405508, 5.514389299381072, 5.375809248915751, 5.303105587688032, 5.65290296602657, 5.530578872237312, 5.413519403481903, 5.635894909282285, 5.585076378596712, 5.495050987221251, 5.399001655545177, 5.604811635059837, 5.2001435075896945, 5.648818173202342, 5.2437971204231655, 5.639762665928824, 5.7183826865006155, 5.374238855843816, 5.375662203038046, 5.299734894406516, 5.417648347333944, 5.387210640896643, 5.677692330523622, 5.688470264787886, 5.632691255432446, 5.640977563251633, 5.419904254407562, 5.238084377958287, 5.301932563713178, 5.460568428353437, 5.6150310291932515, 5.589578715303289, 5.516249358455147, 5.386905891228317, 5.493037710396633, 5.643555830998864, 5.551355335544941, 5.59302798381715, 5.593846223963903, 5.621644395237999, 5.450898536166091, 5.307653980614694, 5.349279485408342, 5.511657343034619, 5.683613884824265, 5.386045539305085, 5.493335924145066, 5.566875820175673, 5.396893061612827, 5.360158612844252, 5.604732320396044, 5.568775229374619, 5.436827057160677, 5.246331291001968, 5.576341523393481, 5.476625554240688, 5.457449083132943, 5.569486065230308, 5.57665221979736, 5.668926514828135, 5.680019210102366, 5.290828568409566, 5.580585309086015, 5.229961548996025, 5.656206347054825, 5.444482815180228, 5.608979679878655, 5.413183344874544, 5.316768969467012, 5.324431522417289, 5.521587938299435, 5.587386754296965, 5.300226831885778, 5.185451467076836, 5.314264263276954, 5.575402143900709, 5.420419557219875, 5.519352279874819, 5.437312757781234, 5.5742020905015845, 5.604848382299871, 5.614394383783517, 5.379534343859608, 5.659023259156221, 5.432621818536089, 5.176403991221154, 5.35639874659099, 5.432590407095496, 5.639558654511635, 5.316239735317739, 5.406428607300234, 5.397601002871921, 5.579966054381542, 5.499008657809166], "episode_lengths": [55, 96, 142, 54, 61, 126, 82, 57, 71, 54, 69, 52, 88, 45, 78, 51, 75, 85, 13, 17, 74, 99, 71, 49, 100, 60, 90, 91, 86, 53, 84, 100, 63, 54, 66, 54, 82, 61, 56, 62, 53, 80, 50, 88, 48, 65, 51, 69, 145, 74, 40, 84, 74, 91, 51, 48, 64, 58, 116, 67, 55, 94, 47, 42, 50, 71, 59, 56, 53, 66, 114, 43, 59, 118, 72, 67, 62, 105, 88, 69, 95, 63, 54, 45, 65, 106, 73, 42, 54, 62, 53, 63, 51, 79, 54, 83, 92, 66, 47, 101, 45, 92, 50, 78, 50, 65, 92, 68, 48, 71, 57, 41, 115, 72, 65, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2730562838454002, "mean_inference_ms": 1.5213072926484508, "mean_action_processing_ms": 0.1431999252173393, "mean_env_wait_ms": 2.8015716159439057, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 639360, "agent_timesteps_total": 639360, "timers": {"sample_time_ms": 8699.97, "sample_throughput": 918.624, "load_time_ms": 4.159, "load_throughput": 1921793.181, "learn_time_ms": 8865.595, "learn_throughput": 901.462, "update_time_ms": 3.148}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.06389170140028, "policy_loss": -0.012816003523766994, "vf_loss": 0.07409904897212982, "vf_explained_var": 0.7603554129600525, "kl": 0.013043290004134178, "entropy": 0.9506978392601013, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 639360, "num_agent_steps_sampled": 639360, "num_steps_trained": 639360, "num_agent_steps_trained": 639360}, "done": false, "episodes_total": 5727, "training_iteration": 80, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-53-04", "timestamp": 1716403984, "time_this_iter_s": 14.037293672561646, "time_total_s": 1030.1765367984772, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1030.1765367984772, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 34.15, "ram_util_percent": 34.23499999999999}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.698142073393706, "episode_reward_min": 0.05320122663970972, "episode_reward_mean": 5.342742022450902, "episode_len_mean": 67.67241379310344, "episode_media": {}, "episodes_this_iter": 116, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9827586206896551, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.017241379310344827, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9655172413793105, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24568965517241378, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.250664436244006, "reward_component_totals/rejoin_dist_change_reward_min": 0.9422095585199988, "reward_component_totals/rejoin_dist_change_reward_max": 1.5121420733937059, "reward_component_totals/failure_reward_mean": -0.017241379310344827, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.898112068965517, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.96, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.278242715141362, 5.412658502404567, 5.6474666850072115, 5.22692802423307, 5.495675779457481, 5.6291030499239145, 5.639174661327731, 5.394091875961706, 5.621260127813404, 5.447473968162735, 5.672297685973971, 5.288965189794645, 5.399347547157419, 5.385462488084768, 5.671302789198714, 5.302800672251628, 5.404352822563887, 5.63121390837488, 5.595238180722493, 5.176810940017136, 5.24382216704732, 5.255583596555168, 5.502186353404326, 5.6116300679976145, 5.408450392084802, 5.397861153531487, 5.5984877701702445, 5.603581488492527, 5.346431370540081, 5.593832293232202, 5.312143361048373, 5.332230300280457, 5.12820955852, 5.1890852796333204, 5.640223206025546, 5.440032193213329, 5.555737466702039, 5.367771014428767, 5.197513241572402, 5.611242968195709, 5.326136359212526, 5.538568620556482, 5.465721860342544, 5.438252557394627, 5.618775050403168, 5.506288304237462, 5.234778306047293, 5.6167787532710545, 5.452826962445021, 5.665092639465001, 5.584778103802674, 5.285811249172646, 5.261579687593732, 5.4614505804456925, 5.445251991141454, 5.359264675788337, 5.5424537076425215, 5.255322030727094, 5.340027973967845, 5.666336228602264, 5.406308350525945, 5.58647942729955, 5.452303089687645, 5.313575857387574, 5.420866360399733, 5.527735962577394, 5.270625263337691, 5.443978936572417, 5.264073730202848, 5.4818381712037585, 5.359646956914409, 5.2626141788808845, 5.500094429572168, 5.308926559525428, 5.275396331799065, 5.443293474510705, 5.463536129184715, 5.443434910500974, 5.265201053591231, 5.451507272103479, 5.622639787627028, 5.698142073393706, 5.345120179580155, 0.33090956325166854, 5.283642355948279, 5.389115069144198, 5.333083564016784, 5.296311826144256, 5.496763367408524, 5.217424139917977, 5.474854889893354, 5.450308201036954, 5.446839288348887, 5.632316093845717, 5.610689487349029, 5.649430237736395, 5.392840390307216, 5.445609006021485, 5.338359004433246, 0.05320122663970972, 5.271867123534302, 5.25118631701213, 5.482220622944936, 5.364598668668993, 5.275208310624639, 5.219085503381459, 5.518472447635869, 5.468888785623294, 5.336682590137661, 5.405646332596591, 5.512581196993883, 5.368971947735094, 5.5682676086124765, 5.545481679402798, 5.31550205148115, 5.6829587215893635], "episode_lengths": [87, 46, 55, 60, 54, 71, 55, 53, 65, 47, 53, 84, 64, 82, 69, 55, 69, 92, 84, 59, 92, 76, 42, 60, 40, 60, 91, 99, 74, 48, 93, 52, 64, 106, 71, 96, 98, 68, 67, 54, 63, 84, 44, 50, 109, 102, 46, 55, 81, 53, 63, 86, 50, 74, 75, 54, 60, 57, 78, 56, 83, 111, 74, 52, 77, 75, 62, 55, 55, 45, 63, 42, 103, 84, 65, 65, 67, 46, 68, 60, 66, 64, 86, 19, 64, 69, 62, 63, 80, 54, 57, 55, 103, 47, 54, 51, 103, 52, 81, 12, 64, 81, 47, 78, 56, 91, 67, 111, 97, 77, 45, 78, 86, 48, 88, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27361906127808444, "mean_inference_ms": 1.5232596366495146, "mean_action_processing_ms": 0.14341919985649076, "mean_env_wait_ms": 2.8064390869744784, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 647352, "agent_timesteps_total": 647352, "timers": {"sample_time_ms": 8403.487, "sample_throughput": 951.034, "load_time_ms": 4.008, "load_throughput": 1994257.591, "learn_time_ms": 8267.816, "learn_throughput": 966.64, "update_time_ms": 3.173}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05065343528985977, "policy_loss": -0.011824464425444603, "vf_loss": 0.0600283145904541, "vf_explained_var": 0.7961761355400085, "kl": 0.012247893959283829, "entropy": 0.9525507688522339, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 647352, "num_agent_steps_sampled": 647352, "num_steps_trained": 647352, "num_agent_steps_trained": 647352}, "done": false, "episodes_total": 5843, "training_iteration": 81, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-53-19", "timestamp": 1716403999, "time_this_iter_s": 14.214526414871216, "time_total_s": 1044.3910632133484, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1044.3910632133484, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 33.99047619047619, "ram_util_percent": 34.3142857142857}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.696853168296865, "episode_reward_min": 5.1362295665777395, "episode_reward_mean": 5.424233410710606, "episode_len_mean": 73.15315315315316, "episode_media": {}, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2473865638637582, "reward_component_totals/rejoin_dist_change_reward_min": 0.9400483969254361, "reward_component_totals/rejoin_dist_change_reward_max": 1.511853168296866, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9268468468468467, "reward_component_totals/success_reward_min": 1.8519999999999999, "reward_component_totals/success_reward_max": 1.96}, "hist_stats": {"episode_reward": [5.578905327746902, 5.403206946236324, 5.197443779249421, 5.630974686304571, 5.403716438688437, 5.400527556147162, 5.16684716559495, 5.579933406559572, 5.558634075438048, 5.5433363983304424, 5.599774597092391, 5.49754484136612, 5.2044081827852615, 5.1362295665777395, 5.351643931561895, 5.5379165116460705, 5.515420586245313, 5.509371223526137, 5.219146142594242, 5.52898480395929, 5.439115889684142, 5.202535666688517, 5.540239068897824, 5.637530023887505, 5.2470351103348065, 5.491746129184773, 5.517865602184469, 5.140951445320983, 5.25424313265845, 5.394745503073746, 5.66232467606369, 5.495979369771212, 5.535617261651204, 5.6417371796535605, 5.696853168296865, 5.30540837326674, 5.200718057292572, 5.546781836916218, 5.652588258675663, 5.33296478173552, 5.287850786742384, 5.62979462629619, 5.51620236446988, 5.327696655796668, 5.6933287319820645, 5.294626118286116, 5.573197321445614, 5.337522875337533, 5.186229615759428, 5.405387864343405, 5.3154346794687015, 5.646327480101205, 5.4707151987286595, 5.186969000970861, 5.51008949764333, 5.169400962709789, 5.435730478548862, 5.6728827067972025, 5.498187863670607, 5.433261425502276, 5.4204831984289035, 5.286699331207092, 5.395836001829931, 5.43804533706488, 5.354937356323249, 5.605489644302267, 5.272477765817876, 5.189391214184752, 5.492237403305278, 5.222267477511963, 5.2478379344047585, 5.2288413834262695, 5.589221957639483, 5.439624137908808, 5.391791675194025, 5.147048396925436, 5.229084873440971, 5.347551427024349, 5.631746752547091, 5.279365698131874, 5.571549129568778, 5.444007241342494, 5.309101277485793, 5.299842159114953, 5.309144787954553, 5.559166632353, 5.594392886190208, 5.388316258823897, 5.338506851151682, 5.344376129849348, 5.57466836192868, 5.277038086937224, 5.507417650956155, 5.273515013478856, 5.516395201300071, 5.453118133934204, 5.371337390788446, 5.558333515404887, 5.264573198180596, 5.415836362637213, 5.615993088591155, 5.552044283445397, 5.315263437834502, 5.338004037199951, 5.599514744454563, 5.597223208283813, 5.673753605318842, 5.38565982118387, 5.385694638347049, 5.588456439397904, 5.365903091330324], "episode_lengths": [130, 65, 102, 82, 49, 68, 63, 105, 49, 61, 147, 69, 92, 59, 84, 122, 90, 60, 108, 60, 64, 53, 69, 85, 48, 148, 72, 79, 82, 45, 58, 54, 86, 54, 65, 68, 40, 143, 70, 87, 56, 51, 49, 50, 61, 89, 80, 125, 45, 53, 111, 85, 113, 83, 117, 64, 57, 56, 58, 105, 54, 63, 52, 70, 83, 75, 106, 60, 122, 92, 55, 46, 56, 56, 93, 43, 85, 56, 56, 50, 55, 55, 45, 48, 59, 91, 56, 95, 114, 58, 101, 145, 65, 42, 61, 102, 42, 53, 55, 54, 85, 53, 57, 68, 84, 63, 61, 40, 50, 96, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2719254410618709, "mean_inference_ms": 1.526106567633582, "mean_action_processing_ms": 0.1438089529200314, "mean_env_wait_ms": 2.812857168601232, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 655344, "agent_timesteps_total": 655344, "timers": {"sample_time_ms": 8307.401, "sample_throughput": 962.034, "load_time_ms": 4.016, "load_throughput": 1989960.081, "learn_time_ms": 8363.366, "learn_throughput": 955.596, "update_time_ms": 3.283}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04036974906921387, "policy_loss": -0.012911111116409302, "vf_loss": 0.05004448443651199, "vf_explained_var": 0.8147270083427429, "kl": 0.016181902959942818, "entropy": 0.9261847138404846, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 655344, "num_agent_steps_sampled": 655344, "num_steps_trained": 655344, "num_agent_steps_trained": 655344}, "done": false, "episodes_total": 5954, "training_iteration": 82, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-53-36", "timestamp": 1716404016, "time_this_iter_s": 17.6165452003479, "time_total_s": 1062.0076084136963, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1062.0076084136963, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 38.96, "ram_util_percent": 34.384}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.711305409946548, "episode_reward_min": 5.142132981519051, "episode_reward_mean": 5.4377380265485495, "episode_len_mean": 74.43809523809524, "episode_media": {}, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2621761217866456, "reward_component_totals/rejoin_dist_change_reward_min": 0.9301329815190507, "reward_component_totals/rejoin_dist_change_reward_max": 1.5193054099465477, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.925561904761905, "reward_component_totals/success_reward_min": 1.8639999999999999, "reward_component_totals/success_reward_max": 1.962}, "hist_stats": {"episode_reward": [5.4943591135222345, 5.218405036684089, 5.476157190885645, 5.622981630008784, 5.2534583113484, 5.276842590875001, 5.663570389215087, 5.530006849932348, 5.396039927909805, 5.604795514079809, 5.568223847112063, 5.370764997864099, 5.6090481904285925, 5.323776331811336, 5.205140290879918, 5.171215686754046, 5.661766869789664, 5.292337426915233, 5.2646036912518674, 5.452073863293457, 5.374638029204679, 5.606149568297974, 5.292218981771587, 5.550110616840709, 5.3311027910350965, 5.50888491812851, 5.689865508815685, 5.439411518835692, 5.157215185266063, 5.525985350737384, 5.67645467388536, 5.192895348499572, 5.399472143927386, 5.60376708937039, 5.376144307715352, 5.4068565909323105, 5.395679298633549, 5.525073938819901, 5.376731110478264, 5.569098790613632, 5.435996168439475, 5.551555297605219, 5.156957747525054, 5.341162793594007, 5.711305409946548, 5.377511867567326, 5.597006715216822, 5.243362920716818, 5.344590031722333, 5.540799565349634, 5.30948077595597, 5.274380024742365, 5.652838762036572, 5.662755184748653, 5.523644896452333, 5.578921666481566, 5.417414592447644, 5.400145105704363, 5.238231048404442, 5.463485976167082, 5.416863863144211, 5.490938357021738, 5.504066977316866, 5.687138794012167, 5.383856035687191, 5.320884666420773, 5.147622456425257, 5.680578821044396, 5.693242784275279, 5.4699483642798645, 5.390926800617592, 5.142132981519051, 5.576841013702925, 5.276206642076209, 5.594644417409247, 5.613627546322116, 5.334530306007203, 5.420207045179901, 5.342613299724503, 5.365841084433816, 5.245848524061483, 5.4362190958114365, 5.320915202705004, 5.539409737617847, 5.457003409763398, 5.338735979851076, 5.4363443764119666, 5.51677454845246, 5.620383404008949, 5.260670717700462, 5.3669839274437825, 5.47778089632045, 5.427439091190355, 5.299618233943461, 5.237557732494709, 5.419946894510746, 5.681988224660227, 5.465054293448053, 5.571498452367539, 5.521203622580136, 5.223015717466458, 5.613379863805642, 5.476877610964234, 5.423375644043187, 5.456885266159633], "episode_lengths": [82, 43, 52, 68, 79, 59, 89, 61, 57, 72, 51, 79, 86, 136, 63, 98, 62, 94, 48, 87, 93, 72, 49, 131, 113, 63, 63, 82, 78, 50, 82, 75, 67, 96, 112, 65, 97, 62, 67, 69, 95, 65, 101, 41, 58, 47, 135, 83, 74, 126, 75, 39, 54, 72, 87, 111, 41, 52, 81, 49, 44, 83, 109, 70, 64, 103, 50, 48, 60, 86, 72, 38, 106, 62, 61, 66, 84, 88, 62, 86, 83, 55, 58, 92, 83, 43, 79, 101, 86, 48, 88, 68, 89, 70, 58, 60, 52, 127, 54, 106, 75, 69, 44, 78, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2768103923355631, "mean_inference_ms": 1.540116977485898, "mean_action_processing_ms": 0.1449642752640621, "mean_env_wait_ms": 2.8343243976076677, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 663336, "agent_timesteps_total": 663336, "timers": {"sample_time_ms": 8488.2, "sample_throughput": 941.542, "load_time_ms": 4.02, "load_throughput": 1988000.994, "learn_time_ms": 8328.017, "learn_throughput": 959.652, "update_time_ms": 3.243}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03168082609772682, "policy_loss": -0.014686004258692265, "vf_loss": 0.04420458897948265, "vf_explained_var": 0.8163951635360718, "kl": 0.010811184532940388, "entropy": 0.8916038870811462, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 663336, "num_agent_steps_sampled": 663336, "num_steps_trained": 663336, "num_agent_steps_trained": 663336}, "done": false, "episodes_total": 6059, "training_iteration": 83, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-53-55", "timestamp": 1716404035, "time_this_iter_s": 18.480220317840576, "time_total_s": 1080.4878287315369, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1080.4878287315369, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 43.723076923076924, "ram_util_percent": 34.349999999999994}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.69196804234582, "episode_reward_min": -0.10000859573698817, "episode_reward_mean": 5.354203766374043, "episode_len_mean": 74.90825688073394, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.981651376146789, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.01834862385321101, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9633027522935782, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24541284403669725, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2751487205024836, "reward_component_totals/rejoin_dist_change_reward_min": 0.8999914042630118, "reward_component_totals/rejoin_dist_change_reward_max": 1.5059680423458217, "reward_component_totals/failure_reward_mean": -0.01834862385321101, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.8886880733944953, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.96, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.655443610813371, 5.620019500399539, 5.437222222230284, 5.51317162361034, 5.479816477744145, 5.365155997651075, 5.625750014602925, 5.295896597607635, 5.2245619166900426, 5.498574780994076, 5.631853087678987, 5.481218400912882, 5.328231488494437, 5.34643351297794, 5.6062699813600085, 5.58613421103494, 5.626098698633982, -0.10000859573698817, 5.514556313170965, 5.574149002436002, 5.570641008340894, 5.325378147299744, 5.544220764846083, 5.439487038544995, 5.191850051921091, 5.142174616504009, 5.470958268815144, 5.648014909602246, 5.3545289974154, 5.481139211876454, 5.61455317787135, 5.4068361689390505, 5.5309771787509145, 5.410140737271687, 5.260077645648062, 5.658311363341914, 5.516655304615416, 5.107775375651361, 5.495093139081537, 5.633175048204543, 5.464264701239944, 5.58712691990274, 5.458013857642545, 5.306966649666462, 5.342794010694496, 5.455248818444451, 5.409670688555456, 5.548465081093987, 5.254529757739089, 5.652906541549294, 5.364798961368537, 5.658508524262784, 5.346383045374359, 5.581333337217464, 5.570177461698421, 5.335602507987539, 5.266784594094105, 5.600399829011628, 5.527651134149739, 5.088359084445669, 5.280394591990755, 5.2408884254836305, 5.587514814151765, 5.561493631790239, 5.455455178857319, 5.356929346215058, 5.5508546744896226, 5.48368328165498, 5.505167057937532, 5.597499287562309, 5.576863476761478, 5.280609844255428, 5.400290286679099, 5.2651992308323035, 5.362254086179, 5.104880868035423, 5.285677589058484, 5.6204713963716415, 5.112180828843382, 5.256754316796354, 5.429120995656071, 5.424673695119486, 5.665467871377844, 5.557573449410796, 5.103236676852286, 5.566696278283386, 5.390983431243897, 5.605182451269101, 5.439356962981243, 5.4333015758373016, 5.32322096423408, 5.346572507065716, 5.317898180764981, 5.498818925477044, 5.423245077804308, 5.392050286422137, 5.426125301136666, 5.561691878225157, 5.593136410018186, 5.601691318189067, 5.52671683788788, 5.583687496503826, 5.606584902490507, 5.578853792994439, 5.557150447272708, 5.44966201162218, 0.14413382932493923, 5.551824219026679, 5.69196804234582], "episode_lengths": [67, 86, 54, 88, 99, 45, 57, 47, 50, 55, 57, 99, 116, 59, 53, 46, 107, 13, 88, 126, 93, 94, 82, 96, 135, 56, 155, 97, 90, 157, 65, 109, 50, 94, 60, 66, 77, 98, 94, 94, 51, 65, 49, 75, 99, 65, 72, 104, 60, 66, 43, 58, 65, 101, 45, 40, 55, 54, 71, 87, 66, 109, 64, 113, 60, 93, 57, 111, 47, 48, 75, 55, 52, 62, 75, 67, 83, 54, 88, 61, 90, 95, 52, 63, 76, 90, 86, 98, 59, 54, 72, 85, 54, 73, 68, 47, 106, 99, 76, 51, 94, 111, 60, 68, 60, 96, 19, 60, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.277255475335005, "mean_inference_ms": 1.5404305802595095, "mean_action_processing_ms": 0.14494167020519674, "mean_env_wait_ms": 2.8350647097965194, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 671328, "agent_timesteps_total": 671328, "timers": {"sample_time_ms": 8392.176, "sample_throughput": 952.316, "load_time_ms": 4.022, "load_throughput": 1987058.233, "learn_time_ms": 8305.985, "learn_throughput": 962.198, "update_time_ms": 3.24}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05756867676973343, "policy_loss": -0.01337909884750843, "vf_loss": 0.06796716898679733, "vf_explained_var": 0.7848970293998718, "kl": 0.014903106726706028, "entropy": 0.8909508585929871, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 671328, "num_agent_steps_sampled": 671328, "num_steps_trained": 671328, "num_agent_steps_trained": 671328}, "done": false, "episodes_total": 6168, "training_iteration": 84, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-54-08", "timestamp": 1716404048, "time_this_iter_s": 12.988801717758179, "time_total_s": 1093.476630449295, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1093.476630449295, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 33.38421052631579, "ram_util_percent": 34.43684210526315}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.705107773364007, "episode_reward_min": 5.14679870207061, "episode_reward_mean": 5.430705649672659, "episode_len_mean": 68.88695652173914, "episode_media": {}, "episodes_this_iter": 115, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.249592606194399, "reward_component_totals/rejoin_dist_change_reward_min": 0.957266600291665, "reward_component_totals/rejoin_dist_change_reward_max": 1.513107773364008, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.931113043478261, "reward_component_totals/success_reward_min": 1.862, "reward_component_totals/success_reward_max": 1.96}, "hist_stats": {"episode_reward": [5.308611496999425, 5.370454005141201, 5.2781587670483425, 5.424699047837645, 5.457226113370316, 5.409441628564624, 5.611535766926716, 5.638006284482355, 5.335608994781438, 5.370939840608421, 5.167266600291665, 5.290471141924611, 5.552344537301055, 5.2355698813858735, 5.379687650500019, 5.218848706499644, 5.436092998493077, 5.525263254296684, 5.366374628947078, 5.646025979932855, 5.350894539047305, 5.387236979732927, 5.192026319063946, 5.205553221376787, 5.205992808424691, 5.293693304306303, 5.252846488375759, 5.152250395439254, 5.453709895798341, 5.526321524184421, 5.563320659007912, 5.291517562360285, 5.642414005377056, 5.431066675987703, 5.310159880118908, 5.6241983642025435, 5.47622437744179, 5.312075676978068, 5.594656668912842, 5.453386219473893, 5.321091833444891, 5.564338245483261, 5.55739473581314, 5.2089275639421135, 5.194156831275297, 5.475667944098838, 5.3614059036851325, 5.605816221906005, 5.552345448247726, 5.3723591657736005, 5.306128709408968, 5.257853324894487, 5.499977396236367, 5.58076798323788, 5.300025548009824, 5.531314318382851, 5.451530102329473, 5.321532256402729, 5.505770538752959, 5.469453880411084, 5.641903465280115, 5.643704615670376, 5.49971732983793, 5.226625715787199, 5.5547655830985665, 5.547091951041794, 5.5068703888758375, 5.29467319214616, 5.14679870207061, 5.317907822291893, 5.498746769177991, 5.6471840094392185, 5.454627554159144, 5.482426237000274, 5.388458609009218, 5.503893051397901, 5.641535374914421, 5.656727834482164, 5.158599901574259, 5.488558729295448, 5.362845236333291, 5.569914068646096, 5.417993849278466, 5.495269364857093, 5.599792551467007, 5.668488617148276, 5.670846178209851, 5.445123349091699, 5.354417752094709, 5.283431454008494, 5.221451763879616, 5.320005669211314, 5.362290562636143, 5.352567037970411, 5.164267702210637, 5.618999115309634, 5.621819919823001, 5.369316173071169, 5.574015841291456, 5.501549079389525, 5.5150145709797025, 5.348620619740219, 5.209158989126388, 5.254591616517571, 5.226573340592244, 5.673841785320672, 5.4691053222756345, 5.672882459529939, 5.507978173670416, 5.460318328593964, 5.642061985363531, 5.197951227131885, 5.670892794640815, 5.705107773364007, 5.521797760350088], "episode_lengths": [66, 78, 78, 57, 43, 71, 53, 75, 66, 42, 40, 43, 67, 101, 98, 90, 57, 75, 76, 60, 45, 50, 89, 55, 92, 49, 78, 92, 69, 97, 54, 90, 65, 64, 83, 54, 50, 82, 62, 84, 42, 59, 64, 76, 65, 80, 49, 102, 67, 69, 54, 49, 49, 49, 74, 99, 57, 81, 49, 56, 88, 75, 98, 60, 77, 103, 105, 61, 67, 56, 63, 55, 58, 138, 67, 76, 70, 60, 50, 131, 72, 48, 42, 89, 70, 64, 61, 56, 57, 43, 42, 49, 79, 96, 77, 82, 52, 84, 82, 97, 52, 71, 53, 66, 73, 59, 49, 55, 64, 135, 70, 54, 87, 58, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2777813678825412, "mean_inference_ms": 1.5408694519409585, "mean_action_processing_ms": 0.14505051562730198, "mean_env_wait_ms": 2.8384325683873874, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 679320, "agent_timesteps_total": 679320, "timers": {"sample_time_ms": 8302.727, "sample_throughput": 962.575, "load_time_ms": 3.99, "load_throughput": 2002932.473, "learn_time_ms": 8354.564, "learn_throughput": 956.603, "update_time_ms": 3.156}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04346773773431778, "policy_loss": -0.01321774534881115, "vf_loss": 0.05381264165043831, "vf_explained_var": 0.7758859395980835, "kl": 0.01436422485858202, "entropy": 0.8330342173576355, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 679320, "num_agent_steps_sampled": 679320, "num_steps_trained": 679320, "num_agent_steps_trained": 679320}, "done": false, "episodes_total": 6283, "training_iteration": 85, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-54-25", "timestamp": 1716404065, "time_this_iter_s": 16.78976273536682, "time_total_s": 1110.2663931846619, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1110.2663931846619, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 40.67083333333333, "ram_util_percent": 34.40416666666667}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.687835341940242, "episode_reward_min": 0.32625475582167596, "episode_reward_mean": 5.378904024085978, "episode_len_mean": 68.90517241379311, "episode_media": {}, "episodes_this_iter": 116, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9913793103448276, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.008620689655172414, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9827586206896555, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.2478448275862069, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2429126447756333, "reward_component_totals/rejoin_dist_change_reward_min": 0.9324519238044358, "reward_component_totals/rejoin_dist_change_reward_max": 1.510835341940242, "reward_component_totals/failure_reward_mean": -0.008620689655172414, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9140086206896552, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.964, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.459985522753332, 5.218645335401957, 5.617051257308319, 5.51631763414476, 5.507239693468019, 5.202464815433922, 5.369503799599503, 5.65465598639299, 5.209988089689956, 5.292417200662595, 5.574718468508772, 5.291445015037384, 5.392539952355483, 5.503861199345943, 5.590756481521733, 5.279932350258888, 5.404336903720084, 5.371181157564678, 5.403775865515049, 5.506427553522201, 5.322941894305535, 5.576655081389548, 5.327872576066408, 5.447778810238887, 5.449767279555627, 5.452293246467125, 5.359386781192914, 5.282399093953716, 5.596291090255953, 5.428943635347634, 5.287710066381475, 5.238280880144163, 5.525017752934069, 5.264653578115086, 5.486107523840178, 5.400495666075718, 5.392319401443801, 5.505499692302937, 5.569755061159803, 5.589323235193349, 5.48707272125084, 5.523442474152214, 5.530742346982441, 5.439941086264522, 5.5553059968573155, 5.542641259232398, 5.126142399553343, 5.56536555450448, 5.237488303257739, 5.388359916169918, 5.546065052479614, 5.240214136778761, 5.14949445122434, 5.561373592556599, 5.349448359401208, 5.535979979877508, 5.131451923804436, 5.383021476733776, 5.517163829767864, 5.25689811856674, 5.349264925765954, 5.455958847676861, 5.158349840535121, 5.570396760044726, 5.583495034233385, 5.266485792083055, 5.415551198836111, 5.469127108402308, 5.58121709264539, 5.493134059463583, 5.168239578762363, 5.570102405639732, 5.432166147158335, 5.260382444683261, 5.560376580123592, 5.369750955604112, 0.32625475582167596, 5.657796919317832, 5.461546586776917, 5.271167109735048, 5.1938302302137185, 5.456481478927346, 5.265751929382143, 5.36279468929637, 5.55445323263954, 5.452582042366283, 5.4427069262328365, 5.429024272589741, 5.6268439933375385, 5.526528756719454, 5.175609786369594, 5.515323147309299, 5.265888213794311, 5.587910033089151, 5.687835341940242, 5.257574136800093, 5.263969810605042, 5.532263988981156, 5.609669703399937, 5.319135740510276, 5.54182971132258, 5.431656194029154, 5.3789045375024624, 5.668014697525816, 5.233575096302054, 5.543196941878389, 5.149708058930829, 5.554394613343593, 5.5686818416679795, 5.596064292152882, 5.479066906135186, 5.415456808575678, 5.54911683180178, 5.304061378409057, 5.201587600528155, 5.452260078068928], "episode_lengths": [71, 90, 57, 91, 51, 36, 71, 55, 70, 68, 57, 60, 93, 55, 89, 55, 92, 50, 84, 54, 65, 65, 40, 62, 87, 106, 94, 66, 55, 56, 89, 46, 65, 55, 87, 60, 67, 51, 124, 79, 52, 67, 46, 68, 64, 130, 76, 81, 83, 47, 57, 70, 123, 120, 46, 71, 51, 89, 61, 57, 79, 101, 89, 89, 48, 37, 108, 65, 100, 49, 64, 85, 52, 58, 77, 47, 18, 74, 78, 53, 82, 89, 52, 48, 56, 72, 107, 65, 84, 68, 59, 51, 44, 97, 73, 66, 38, 42, 48, 55, 94, 94, 71, 59, 107, 72, 46, 46, 77, 71, 58, 65, 63, 54, 69, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27861332675962386, "mean_inference_ms": 1.5457858751081737, "mean_action_processing_ms": 0.14557642890081232, "mean_env_wait_ms": 2.8463814988792016, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 687312, "agent_timesteps_total": 687312, "timers": {"sample_time_ms": 8105.191, "sample_throughput": 986.035, "load_time_ms": 3.911, "load_throughput": 2043607.041, "learn_time_ms": 8335.694, "learn_throughput": 958.768, "update_time_ms": 3.257}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05118570849299431, "policy_loss": -0.010059013031423092, "vf_loss": 0.05898724123835564, "vf_explained_var": 0.7935336828231812, "kl": 0.01128739956766367, "entropy": 0.8220165371894836, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 687312, "num_agent_steps_sampled": 687312, "num_steps_trained": 687312, "num_agent_steps_trained": 687312}, "done": false, "episodes_total": 6399, "training_iteration": 86, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-54-43", "timestamp": 1716404083, "time_this_iter_s": 17.794538259506226, "time_total_s": 1128.060931444168, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1128.060931444168, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 43.748000000000005, "ram_util_percent": 34.38}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.7052968040356795, "episode_reward_min": -0.03081130541898236, "episode_reward_mean": 5.339984637953441, "episode_len_mean": 66.1900826446281, "episode_media": {}, "episodes_this_iter": 121, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9834710743801653, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.01652892561983471, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.966942148760331, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24586776859504134, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.242637530515424, "reward_component_totals/rejoin_dist_change_reward_min": 0.9288217619801649, "reward_component_totals/rejoin_dist_change_reward_max": 1.51829680403568, "reward_component_totals/failure_reward_mean": -0.01652892561983471, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9010661157024795, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.96, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.643234302412643, 5.46312873431514, 5.162984294307169, 5.552651302145385, 5.392014686306117, 5.309686675231755, 5.511586183410991, 5.487991123339629, 5.484225570723643, 5.282200170637108, 5.661340806733699, 5.498476259777588, 5.216694675166133, -0.03081130541898236, 5.6486836876762005, 5.521470266152844, 5.199493645872589, 5.376119109588581, 5.551219187208892, 5.529687892972984, 5.493183889716385, 5.217106265493798, 5.66665471169823, 0.17954354388951188, 5.468549480651621, 5.487186939846454, 5.199596937383467, 5.431548538790331, 5.56733116220256, 5.285680282436197, 5.155222122493102, 5.329604206748388, 5.264809917757685, 5.607697644844425, 5.34464419817061, 5.288456879704264, 5.592257296112869, 5.2254616098332525, 5.1707650956883455, 5.31953314605348, 5.489311537309464, 5.6123184386015845, 5.314818410222745, 5.249955550742852, 5.545600222032944, 5.220923836158703, 5.649807527291529, 5.491672644366229, 5.385216643222755, 5.4258039069831, 5.328027524839896, 5.222281072353867, 5.360925484137189, 5.671727977681055, 5.2724110558907595, 5.465326365685891, 5.320912401155502, 5.579671400276778, 5.2802215852829235, 5.5539885482726845, 5.403027543328612, 5.347008656849479, 5.540835709002987, 5.616817662809938, 5.495663145783739, 5.434633920869869, 5.3796764314102425, 5.188150604496789, 5.246309374172643, 5.545815256141708, 5.271732875896689, 5.447825678180628, 5.285825444000714, 5.676118461030994, 5.283120257323411, 5.594906605731447, 5.605480812293678, 5.653709032129993, 5.583748656806518, 5.575835399793501, 5.564954620451071, 5.201090812565381, 5.64379231430067, 5.547431213844106, 5.401589401059618, 5.33487920934071, 5.568266582732175, 5.246411321072076, 5.255443217894381, 5.259168690236248, 5.512676619570528, 5.18664544531339, 5.622645866855299, 5.326704451845344, 5.521988705932314, 5.469421156032601, 5.3369085602040265, 5.5175382008361655, 5.607492215639965, 5.383095092016957, 5.592570340319242, 5.431052082218622, 5.166388213450574, 5.588180778212342, 5.627903163249684, 5.513542171332796, 5.401983710624203, 5.626284274543408, 5.398336150445019, 5.496086562309454, 5.48750863456352, 5.563141379144442, 5.7052968040356795, 5.129821761980166, 5.481740339685417, 5.352653597716381, 5.279633392256185, 5.636177123740579, 5.177697356485118, 5.303374173503359, 5.296550686169976], "episode_lengths": [49, 57, 98, 94, 47, 64, 55, 45, 58, 56, 60, 61, 69, 16, 77, 54, 55, 58, 52, 53, 55, 53, 65, 22, 49, 92, 83, 77, 57, 80, 42, 47, 45, 80, 107, 61, 66, 46, 151, 61, 90, 65, 52, 78, 104, 60, 51, 59, 90, 49, 43, 93, 74, 61, 45, 70, 62, 74, 97, 77, 74, 60, 103, 60, 47, 52, 44, 86, 75, 78, 63, 63, 45, 57, 66, 59, 50, 84, 54, 63, 63, 61, 54, 49, 103, 85, 48, 72, 40, 64, 67, 90, 51, 57, 58, 54, 84, 100, 93, 72, 108, 68, 54, 65, 51, 77, 103, 91, 65, 81, 99, 56, 63, 49, 66, 60, 40, 59, 71, 75, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28287218888505394, "mean_inference_ms": 1.5560229538607804, "mean_action_processing_ms": 0.14638021747107666, "mean_env_wait_ms": 2.8629213018130217, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 695304, "agent_timesteps_total": 695304, "timers": {"sample_time_ms": 8157.491, "sample_throughput": 979.713, "load_time_ms": 3.873, "load_throughput": 2063420.04, "learn_time_ms": 8231.005, "learn_throughput": 970.963, "update_time_ms": 3.293}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.06338732689619064, "policy_loss": -0.013188246637582779, "vf_loss": 0.0742257609963417, "vf_explained_var": 0.7658764719963074, "kl": 0.011749009601771832, "entropy": 0.8536205887794495, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 695304, "num_agent_steps_sampled": 695304, "num_steps_trained": 695304, "num_agent_steps_trained": 695304}, "done": false, "episodes_total": 6520, "training_iteration": 87, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-55-00", "timestamp": 1716404100, "time_this_iter_s": 17.48856782913208, "time_total_s": 1145.5494992733002, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1145.5494992733002, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 44.184, "ram_util_percent": 34.24400000000001}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.719323857066033, "episode_reward_min": 0.3672650436071361, "episode_reward_mean": 5.434432085822138, "episode_len_mean": 72.4, "episode_media": {}, "episodes_this_iter": 110, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.990909090909091, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.00909090909090909, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9818181818181821, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24772727272727274, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.304359358549411, "reward_component_totals/rejoin_dist_change_reward_min": 0.9571818285779241, "reward_component_totals/rejoin_dist_change_reward_max": 1.5253238570660337, "reward_component_totals/failure_reward_mean": -0.00909090909090909, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.909618181818182, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.963, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.331152993083293, 5.442435939562722, 5.388021787657571, 5.417124879293468, 5.465667653580912, 5.711131503793936, 5.345998376133321, 5.478402841212066, 5.579279695442868, 5.6256184654701435, 5.620804793980077, 5.279578315603407, 5.5844191273942645, 5.680566526187694, 5.329486102544234, 5.262399918232589, 5.491535850164076, 0.3672650436071361, 5.166050588734207, 5.464164888022703, 5.396708876524574, 5.465755537185917, 5.399502478764748, 5.481341131667609, 5.583442528365124, 5.41089926455783, 5.405207556652889, 5.601362835957551, 5.384318475150216, 5.553921229372092, 5.3286032769435465, 5.49370239400391, 5.3006081166051535, 5.473432801140975, 5.676252799440464, 5.274374002113079, 5.267310351280129, 5.458691533404503, 5.616094892364556, 5.4661840220499975, 5.468750750401545, 5.616126388945478, 5.468378618142037, 5.495831612642617, 5.364561212348466, 5.3202150501215755, 5.589182140763491, 5.367135396486992, 5.589351473207094, 5.580784218826153, 5.68444394238478, 5.254309589531198, 5.493780247389806, 5.59809849240963, 5.657704781154227, 5.299999120999816, 5.47035829960849, 5.4713235332502395, 5.282795772647956, 5.645972742253727, 5.506875022489339, 5.530321397656989, 5.691951884344286, 5.5193567739118565, 5.398090755371107, 5.162181828577924, 5.530151702091011, 5.650068195894086, 5.356656726349486, 5.644662769184648, 5.639865875690319, 5.647976659006669, 5.492031463590814, 5.554454004721139, 5.3666815755148445, 5.719323857066033, 5.4721613230324255, 5.276958691935155, 5.660716581663458, 5.167063952670311, 5.41861983037872, 5.602234938058363, 5.239886340313907, 5.157938292969119, 5.647527202957713, 5.336593210565246, 5.614809744374231, 5.460077035886963, 5.615273770999527, 5.624216057134661, 5.637507659816476, 5.484861962483903, 5.615853746151014, 5.422662074280591, 5.496245845205866, 5.256318311977118, 5.674931254739781, 5.402732996836008, 5.618896558386279, 5.414588529904267, 5.3324155137731974, 5.46791636607591, 5.536789480081861, 5.667990606271332, 5.567455063676805, 5.532832121986165, 5.4839272839632685, 5.471794375110564, 5.618080050675579, 5.591079397878065], "episode_lengths": [72, 52, 76, 134, 91, 57, 74, 91, 53, 64, 67, 37, 111, 66, 80, 66, 53, 22, 51, 63, 44, 42, 60, 75, 50, 80, 120, 56, 51, 93, 50, 126, 77, 88, 63, 77, 74, 97, 119, 76, 88, 83, 60, 84, 75, 54, 51, 86, 70, 56, 53, 66, 69, 112, 67, 125, 94, 142, 38, 58, 59, 46, 63, 68, 67, 45, 77, 51, 65, 54, 48, 90, 57, 73, 70, 56, 96, 61, 56, 96, 74, 62, 88, 93, 101, 75, 55, 53, 87, 85, 80, 64, 51, 112, 73, 47, 65, 74, 66, 68, 67, 90, 76, 58, 102, 143, 51, 75, 53, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28028093751259464, "mean_inference_ms": 1.5574714043594609, "mean_action_processing_ms": 0.1465611009210869, "mean_env_wait_ms": 2.8670554483415325, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 703296, "agent_timesteps_total": 703296, "timers": {"sample_time_ms": 8067.282, "sample_throughput": 990.668, "load_time_ms": 3.863, "load_throughput": 2068806.861, "learn_time_ms": 7902.403, "learn_throughput": 1011.338, "update_time_ms": 3.285}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.059672825038433075, "policy_loss": -0.011045749299228191, "vf_loss": 0.06869132071733475, "vf_explained_var": 0.7752923369407654, "kl": 0.010136242024600506, "entropy": 0.9188995957374573, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 703296, "num_agent_steps_sampled": 703296, "num_steps_trained": 703296, "num_agent_steps_trained": 703296}, "done": false, "episodes_total": 6630, "training_iteration": 88, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-55-15", "timestamp": 1716404115, "time_this_iter_s": 14.435110092163086, "time_total_s": 1159.9846093654633, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1159.9846093654633, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 38.304761904761904, "ram_util_percent": 34.25238095238094}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.698535220345865, "episode_reward_min": 0.08723227283639323, "episode_reward_mean": 5.413118037224321, "episode_len_mean": 72.01818181818182, "episode_media": {}, "episodes_this_iter": 110, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.990909090909091, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.00909090909090909, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9818181818181821, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24772727272727274, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.282663491769776, "reward_component_totals/rejoin_dist_change_reward_min": 0.9615902988997671, "reward_component_totals/rejoin_dist_change_reward_max": 1.5220580877948944, "reward_component_totals/failure_reward_mean": -0.00909090909090909, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.91, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.96, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.479226176563046, 5.601449201735561, 5.410937578100903, 5.50925099687367, 5.6678829201586005, 5.430271680268831, 5.337170881046861, 5.216144421174592, 5.405016345120837, 5.6016486153278, 5.396885871556502, 5.488197511343977, 5.405036514322631, 5.624928088893165, 5.343834356910092, 5.386972974167229, 5.316582521973575, 5.48914510077279, 5.650987960031099, 5.345179634628422, 5.499988245208122, 5.60189933492734, 5.589120159183533, 5.690058087794894, 5.442421813506219, 5.333386139606237, 5.571498896319735, 5.558317175006333, 5.673833026571446, 5.612822464745668, 5.3811113572605676, 5.406891025757705, 5.178723399105412, 5.517375852957635, 5.216345018510303, 5.391527307946369, 5.495490212551856, 5.404827372666302, 5.3084801403769575, 5.562087231113414, 5.5207216571917455, 5.42238181692976, 5.599511047781241, 5.596021191754291, 5.544367063607469, 5.569773476491779, 5.435343576407796, 5.588382504018517, 5.339054800415218, 5.202575989577622, 5.450265246150666, 5.501368853015666, 5.176743562100728, 5.4713744178934345, 5.2105820094964255, 5.310986101026588, 5.450068677746691, 5.646822451741957, 5.577064595483669, 5.547511262205784, 5.34232272606522, 5.3712168139036125, 5.556061380763703, 5.244457650652481, 5.45183859223776, 5.526107088578299, 5.439630458938334, 5.195182085640463, 5.399967679468811, 5.401484045260273, 5.588995791617959, 5.6014923818102496, 5.343120445497476, 5.270874151505568, 5.378448332787409, 5.601054769387636, 5.4910721201842225, 5.629702553459138, 5.525955707840568, 5.471449945672894, 5.326510121435104, 5.448182038073357, 5.415658310398882, 5.604036243934885, 5.665938427301812, 5.582379300620841, 5.504995527346898, 5.623938112310503, 5.627495912451313, 5.185389188210209, 5.524689046005285, 5.419157754334865, 5.45896259722767, 5.664819511059129, 5.698535220345865, 5.44023054647822, 5.541382006095192, 5.263894269739201, 5.159590298899767, 5.592200178952544, 5.496350813978121, 5.6347546069911365, 5.524393504420494, 0.08723227283639323, 5.36629229254823, 5.305897464450358, 5.457208476185004, 5.448743778133247, 5.520609895412532, 5.319207744102934], "episode_lengths": [69, 57, 78, 59, 74, 91, 56, 59, 47, 64, 74, 140, 93, 57, 99, 76, 68, 45, 94, 62, 90, 100, 88, 82, 150, 63, 96, 97, 48, 69, 41, 93, 96, 134, 82, 78, 49, 52, 84, 90, 84, 48, 71, 64, 54, 67, 77, 69, 79, 41, 58, 87, 40, 117, 57, 65, 65, 47, 61, 59, 66, 60, 82, 50, 45, 48, 86, 63, 70, 53, 102, 59, 67, 55, 59, 113, 71, 67, 85, 91, 104, 55, 105, 101, 61, 62, 52, 64, 66, 43, 55, 67, 71, 58, 56, 59, 90, 105, 52, 85, 51, 54, 88, 22, 89, 54, 60, 50, 80, 117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28148618473842235, "mean_inference_ms": 1.5595036517140743, "mean_action_processing_ms": 0.14667349488167952, "mean_env_wait_ms": 2.8689397502506186, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 711288, "agent_timesteps_total": 711288, "timers": {"sample_time_ms": 8057.084, "sample_throughput": 991.922, "load_time_ms": 3.902, "load_throughput": 2048152.163, "learn_time_ms": 7847.876, "learn_throughput": 1018.365, "update_time_ms": 3.259}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.056590043008327484, "policy_loss": -0.01324543822556734, "vf_loss": 0.06730388104915619, "vf_explained_var": 0.779727041721344, "kl": 0.012657997198402882, "entropy": 0.8614258766174316, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 711288, "num_agent_steps_sampled": 711288, "num_steps_trained": 711288, "num_agent_steps_trained": 711288}, "done": false, "episodes_total": 6740, "training_iteration": 89, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-55-30", "timestamp": 1716404130, "time_this_iter_s": 15.447306632995605, "time_total_s": 1175.4319159984589, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1175.4319159984589, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 39.89545454545454, "ram_util_percent": 34.34545454545453}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.690977806258207, "episode_reward_min": 0.07057394038290987, "episode_reward_mean": 5.377303136895892, "episode_len_mean": 72.4090909090909, "episode_media": {}, "episodes_this_iter": 110, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.990909090909091, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.00909090909090909, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9818181818181821, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24772727272727274, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2473213187140741, "reward_component_totals/rejoin_dist_change_reward_min": 0.9281719652336315, "reward_component_totals/rejoin_dist_change_reward_max": 1.4979778062582065, "reward_component_totals/failure_reward_mean": -0.00909090909090909, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9095272727272727, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.962, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.222332510385971, 5.322752493496493, 5.6624277357380315, 5.483445096107111, 5.457116198800488, 5.4421445400135156, 5.614167396013368, 5.477146700436703, 5.351536300575399, 5.37460180745256, 5.472847508089718, 5.519305818061214, 5.348583656866851, 5.315801853626803, 5.403389054279605, 5.233594939089871, 5.534930733496333, 5.347344645481018, 5.545408056734013, 5.288851926486039, 5.25290820759744, 5.576100208897731, 5.193948861353372, 5.3566555351121785, 5.5082212023025185, 5.543054251382566, 5.331164842498535, 5.266053517654621, 5.210728709726656, 5.429607560297555, 5.589459839520547, 5.267398962555822, 5.407804322219305, 5.417546373770947, 5.5669678624286245, 5.59221851968924, 5.372889481307425, 5.1362372975501085, 5.460798111858835, 5.587465443677686, 5.443444847854899, 5.59627368635137, 5.497163419662857, 5.570834214444973, 5.253192799737211, 5.210115364437056, 5.6178565146026, 5.482491577069393, 5.59632466290797, 5.299078454531848, 5.596026994191703, 5.426068983365875, 5.291589162701996, 5.216483892349329, 5.313461588592751, 5.475785178572398, 5.449458109512699, 5.690977806258207, 5.398240748078402, 5.675176972016735, 5.255291790681596, 5.475350240971717, 5.378247308579953, 5.371403203934991, 5.311570291868841, 5.36102143072083, 5.474900569266961, 5.255174714461228, 5.174279486065826, 5.462732879515637, 5.669641113785735, 5.3212800447653406, 5.194138302178681, 5.208041863601418, 5.456645222044397, 5.281558902188897, 5.616433569211013, 5.444693993385315, 5.346783672933769, 5.50810888484053, 5.302712390271665, 5.561157260677143, 5.232144894242885, 5.530995706306176, 5.535696886216736, 5.485823944668881, 5.617603945133091, 5.60169297194811, 5.480278292063183, 5.434932424073469, 5.66915896545703, 5.242075169196394, 5.628490358522798, 5.438959788328797, 5.623444095714506, 5.371457901176544, 5.549276946738391, 5.598470710811517, 5.6677018182698795, 5.492250206147977, 5.383823137411591, 5.072171965233632, 5.1066449583951945, 5.436083565511236, 5.307011290630824, 5.363421942260118, 5.611074494766697, 5.619633802949997, 0.07057394038290987, 5.3162807401650145], "episode_lengths": [60, 59, 71, 60, 48, 59, 68, 59, 64, 59, 99, 77, 55, 86, 61, 55, 92, 89, 83, 83, 52, 50, 61, 81, 132, 48, 77, 76, 49, 103, 60, 99, 139, 83, 43, 136, 44, 71, 129, 114, 88, 96, 77, 47, 40, 70, 54, 90, 63, 87, 74, 49, 77, 95, 44, 63, 48, 57, 59, 63, 80, 77, 66, 53, 105, 66, 53, 77, 109, 51, 64, 43, 61, 78, 89, 43, 57, 112, 59, 57, 126, 104, 74, 111, 75, 88, 74, 91, 46, 124, 50, 74, 55, 68, 97, 76, 54, 66, 55, 88, 65, 106, 91, 51, 38, 54, 57, 70, 13, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28200388073858734, "mean_inference_ms": 1.5630008492026155, "mean_action_processing_ms": 0.1469093277123023, "mean_env_wait_ms": 2.873342082605088, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 719280, "agent_timesteps_total": 719280, "timers": {"sample_time_ms": 8104.617, "sample_throughput": 986.105, "load_time_ms": 3.969, "load_throughput": 2013761.801, "learn_time_ms": 8221.528, "learn_throughput": 972.082, "update_time_ms": 3.376}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.038925327360630035, "policy_loss": -0.017970411106944084, "vf_loss": 0.05429055541753769, "vf_explained_var": 0.811171293258667, "kl": 0.0130259208381176, "entropy": 0.9071189761161804, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 719280, "num_agent_steps_sampled": 719280, "num_steps_trained": 719280, "num_agent_steps_trained": 719280}, "done": false, "episodes_total": 6850, "training_iteration": 90, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-55-48", "timestamp": 1716404148, "time_this_iter_s": 18.25662326812744, "time_total_s": 1193.6885392665863, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1193.6885392665863, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 43.05384615384616, "ram_util_percent": 34.35384615384615}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.702196228622773, "episode_reward_min": 0.0636593089901818, "episode_reward_mean": 5.302584449744229, "episode_len_mean": 71.16666666666667, "episode_media": {}, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9736842105263158, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.02631578947368421, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9473684210526319, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24342105263157895, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.261452870796861, "reward_component_totals/rejoin_dist_change_reward_min": 0.9288552145845455, "reward_component_totals/rejoin_dist_change_reward_max": 1.5088686938242644, "reward_component_totals/failure_reward_mean": -0.02631578947368421, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.8766578947368422, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.962, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.567276379195494, 5.691823782162253, 5.6599051057264536, 5.544920824560572, 5.37196944597372, 5.625107984396548, 5.5887536410344865, 5.47342129293725, 5.484639326924971, 5.533002004683181, 5.350053242197253, 5.509470901339897, 5.4617311509258375, 5.317258315548832, 5.682548694342971, 5.39236210345899, 5.490955075764422, 5.5267648017238, 5.525426092352241, 5.497967967603067, 5.494616641469598, 5.491483929891885, 5.569901679397628, 5.15429603307591, 5.352873835767863, 5.149940487409744, 5.280754770612219, 5.641923875059369, 5.31911531397574, 5.585092015973482, 5.528832530647691, 5.702196228622773, 5.513065124058333, 5.524574382013884, 5.595153613659757, 5.52784044136566, 5.142349701947976, 5.649521210529909, 5.3574183984898, 5.185837294523186, 5.286016917296402, 5.3653949692846705, 5.276812590701651, 5.526107763674445, 5.3530746389826795, 5.330886516190674, 5.327149874716039, 5.128855214584545, 5.328030688809641, 5.083746741625004, 0.34402793538621634, 5.665554424514879, 5.261200597663025, 5.67777452865711, 5.538211519055718, 5.555938448575402, 5.530758657257545, 5.333153105299866, 5.490885678270802, 5.393554341687842, 5.582971909129384, 5.567293597891247, 5.131735568846393, 5.599797279580445, 5.4263273177079085, 5.397643327548307, 5.161136842836667, 5.455521405870089, 5.352533029669317, 5.3898017188791325, 5.621247591496914, 5.183065251351614, 5.523147953906893, 5.3638571557225205, 5.6250185232805805, 5.323668461999044, 5.480632413622039, 5.579535473094834, 5.499418665155854, 5.571894237017409, 5.618826481188778, 5.132431120853854, 5.383466804614212, 5.292393957506905, 5.61731906179774, 5.359672027993742, 5.670868693824264, 5.371801685535324, 5.67252482706912, 5.263292404033182, 5.660469174101779, 5.463856346297216, 5.506412033179334, 5.4963329783470805, 5.636635309904663, 0.0636593089901818, 5.395634509398647, 5.231965525637654, 5.31252809575833, 5.649108972825953, 5.329717844800301, 5.4811502038390945, 5.5322347535075265, 5.301369877817204, 5.254590676460474, 0.154783353552975, 5.410236247931339, 5.635696748519608, 5.356597008517111, 5.324881606655381, 5.251379616234097, 5.341331434627665, 5.409480332614923, 5.21644972872109], "episode_lengths": [92, 59, 57, 95, 47, 67, 51, 51, 107, 59, 84, 80, 41, 54, 54, 89, 59, 68, 106, 140, 55, 51, 53, 97, 48, 99, 50, 68, 82, 93, 50, 54, 70, 113, 75, 56, 104, 51, 51, 71, 68, 86, 38, 69, 85, 58, 44, 50, 107, 109, 18, 53, 79, 77, 84, 100, 48, 72, 118, 88, 85, 56, 83, 58, 75, 77, 104, 82, 45, 102, 83, 55, 93, 122, 59, 47, 51, 86, 58, 88, 95, 74, 48, 45, 69, 72, 88, 104, 56, 80, 57, 76, 110, 58, 101, 13, 58, 62, 49, 51, 48, 92, 110, 84, 65, 21, 49, 52, 65, 81, 94, 49, 69, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28256235474354174, "mean_inference_ms": 1.5673046791506164, "mean_action_processing_ms": 0.14734639989986995, "mean_env_wait_ms": 2.884230912581774, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 727272, "agent_timesteps_total": 727272, "timers": {"sample_time_ms": 8232.407, "sample_throughput": 970.797, "load_time_ms": 3.995, "load_throughput": 2000517.875, "learn_time_ms": 8660.731, "learn_throughput": 922.786, "update_time_ms": 3.572}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0665036216378212, "policy_loss": -0.013914785347878933, "vf_loss": 0.07797236740589142, "vf_explained_var": 0.7546915411949158, "kl": 0.012230214662849903, "entropy": 0.8870990872383118, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 727272, "num_agent_steps_sampled": 727272, "num_steps_trained": 727272, "num_agent_steps_trained": 727272}, "done": false, "episodes_total": 6964, "training_iteration": 91, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-56-08", "timestamp": 1716404168, "time_this_iter_s": 19.897841930389404, "time_total_s": 1213.5863811969757, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1213.5863811969757, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 43.43571428571429, "ram_util_percent": 34.51071428571429}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.713207646744076, "episode_reward_min": 0.060624175462786756, "episode_reward_mean": 5.365134597881585, "episode_len_mean": 71.87962962962963, "episode_media": {}, "episodes_this_iter": 108, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9814814814814815, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.018518518518518517, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9629629629629632, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24537037037037038, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2839308941778813, "reward_component_totals/rejoin_dist_change_reward_min": 0.9676597707152632, "reward_component_totals/rejoin_dist_change_reward_max": 1.5242076467440766, "reward_component_totals/failure_reward_mean": -0.018518518518518517, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.891388888888889, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.959, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.249567134998957, 5.24021402238666, 5.31966854284736, 5.542139187761004, 5.553506200317384, 5.273870585057294, 5.2653926215922535, 5.37415965236311, 5.3513594487051, 5.597910022050687, 5.384381817005622, 5.667920210904883, 5.403903238045707, 5.329233939410955, 5.477658129741885, 5.590410741970121, 0.3150185448884286, 5.432517587469103, 5.206396079995297, 5.55143493436294, 5.45714897446425, 5.504184302269163, 5.459935931580164, 5.238467005312069, 5.576916454721985, 5.4260107278125975, 5.271161014156929, 5.369257639167728, 5.293193850399687, 5.48537871549034, 5.651568778508894, 5.587344756681604, 5.557412296884632, 5.595698767682364, 5.389464336033342, 5.163659770715263, 5.484242062703284, 5.483750541579707, 5.674594148953929, 5.521973074513268, 5.396038863341034, 5.666873064867027, 5.563468169780489, 5.590816766475721, 5.375540675438854, 5.5575349634645335, 0.060624175462786756, 5.572988948440924, 5.2778392297211205, 5.485483286600555, 5.511290218550957, 5.57738323304127, 5.2028917369653325, 5.4569413851639945, 5.50968587209476, 5.602837402892488, 5.257446779043498, 5.574314480397399, 5.513436480498744, 5.454559102272574, 5.686152371009943, 5.679473870294254, 5.522373540434737, 5.487762513757371, 5.370164011079256, 5.416873077530109, 5.331349886772883, 5.343838590267406, 5.574067896162593, 5.395175043015168, 5.407415911087987, 5.6559103250246805, 5.713207646744076, 5.621682135992753, 5.626681404929427, 5.586890281764989, 5.49531490659069, 5.536135747091342, 5.342945844800051, 5.323270704216589, 5.4972884505446915, 5.5352386532286335, 5.34728510847916, 5.279757688667197, 5.32548028333302, 5.547610567029382, 5.491540449001402, 5.269647881199744, 5.3352952230047475, 5.6684333671424945, 5.416455148107771, 5.4889673078123975, 5.296229752705268, 5.539936295431811, 5.2749690437123204, 5.311333514621793, 5.194404473299048, 5.543784409259294, 5.472973522673174, 5.475951310850794, 5.5068020065362955, 5.51425612266091, 5.63552648085592, 5.669773212364653, 5.56181224097897, 5.674838104976468, 5.52859870952766, 5.38764090861988], "episode_lengths": [59, 47, 54, 85, 101, 85, 46, 65, 88, 52, 82, 63, 57, 71, 48, 91, 20, 92, 80, 97, 96, 55, 88, 70, 121, 102, 46, 64, 79, 80, 64, 50, 68, 71, 49, 54, 62, 141, 57, 98, 70, 55, 48, 98, 48, 94, 13, 55, 78, 86, 51, 61, 46, 92, 61, 86, 69, 53, 78, 98, 52, 56, 99, 73, 47, 81, 44, 111, 71, 63, 49, 59, 61, 62, 75, 60, 87, 90, 90, 138, 77, 56, 65, 71, 92, 62, 80, 60, 101, 63, 80, 159, 103, 58, 41, 90, 50, 95, 52, 102, 61, 92, 51, 72, 49, 60, 73, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2854495199966735, "mean_inference_ms": 1.5788326870795355, "mean_action_processing_ms": 0.1482490017892978, "mean_env_wait_ms": 2.9014065213655047, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 735264, "agent_timesteps_total": 735264, "timers": {"sample_time_ms": 8474.894, "sample_throughput": 943.021, "load_time_ms": 4.026, "load_throughput": 1985046.076, "learn_time_ms": 8432.488, "learn_throughput": 947.763, "update_time_ms": 3.453}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05259810388088226, "policy_loss": -0.015488650649785995, "vf_loss": 0.06596828997135162, "vf_explained_var": 0.7820625305175781, "kl": 0.0105922631919384, "entropy": 0.8671623468399048, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 735264, "num_agent_steps_sampled": 735264, "num_steps_trained": 735264, "num_agent_steps_trained": 735264}, "done": false, "episodes_total": 7072, "training_iteration": 92, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-56-26", "timestamp": 1716404186, "time_this_iter_s": 17.751466751098633, "time_total_s": 1231.3378479480743, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1231.3378479480743, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 41.85000000000001, "ram_util_percent": 34.51153846153846}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.702210485031535, "episode_reward_min": 5.118547756238353, "episode_reward_mean": 5.45711990257918, "episode_len_mean": 71.43859649122807, "episode_media": {}, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2785584990704075, "reward_component_totals/rejoin_dist_change_reward_min": 0.9335477562383532, "reward_component_totals/rejoin_dist_change_reward_max": 1.506210485031536, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9285614035087721, "reward_component_totals/success_reward_min": 1.843, "reward_component_totals/success_reward_max": 1.96}, "hist_stats": {"episode_reward": [5.4743878717957895, 5.472361843120926, 5.418169892917303, 5.373476080517873, 5.500403974765501, 5.516353231657787, 5.662434764016326, 5.302323419407521, 5.455138880364389, 5.373696893345563, 5.6251551845639405, 5.516531061807837, 5.376217919586441, 5.621214308466845, 5.495185720927563, 5.361507482385926, 5.1594431044794, 5.553979934523169, 5.319415929886188, 5.632615014610092, 5.539620514892802, 5.501028652048468, 5.478579174397874, 5.641784135671067, 5.169936050296696, 5.572318558222875, 5.388270286854592, 5.219538351365951, 5.311985560127885, 5.476514451459803, 5.148238536644193, 5.602139046767917, 5.276675245239689, 5.658263173560706, 5.2586503206239446, 5.618264019858497, 5.222091846946061, 5.251133107564463, 5.635994900447539, 5.373450495270207, 5.612236333078738, 5.517395963041191, 5.657846894415428, 5.618215837721892, 5.346679103709136, 5.488416153320533, 5.272842772783639, 5.651034183568229, 5.400489506537136, 5.41366394621498, 5.561502656059339, 5.371805939585912, 5.550482276851829, 5.659537699984998, 5.3166291245826836, 5.235864293219641, 5.6554783539137645, 5.568537442139126, 5.520113750557691, 5.285071060648795, 5.223995114646355, 5.235224218624538, 5.344718585933682, 5.503019555045222, 5.619471868984886, 5.52572926643783, 5.355589647469742, 5.265566946978225, 5.431615473486828, 5.702210485031535, 5.584933102354952, 5.465166059772501, 5.485407165296299, 5.519465819326928, 5.442894926056516, 5.615214937287501, 5.285215104683564, 5.319279764849659, 5.4594454610729075, 5.359119973989783, 5.464651984719212, 5.529011708753172, 5.137040649547171, 5.2942792685143925, 5.4142767103311105, 5.64303127126275, 5.41613318053234, 5.578252401048415, 5.441044952789012, 5.563707571914389, 5.118547756238353, 5.603083587178931, 5.58515634540229, 5.601369834421609, 5.593937573889402, 5.640223685134912, 5.230154551779632, 5.55719765961441, 5.367611566916388, 5.416121072123044, 5.513569463446421, 5.412415720888115, 5.481435085151583, 5.422895750280608, 5.26829885109734, 5.616140235141206, 5.528001101634716, 5.5689566742006225, 5.4428897848213875, 5.400827421139018, 5.634234441534327, 5.489739975082479, 5.5392287868782155, 5.596586559947708], "episode_lengths": [87, 67, 87, 62, 69, 50, 57, 61, 44, 74, 59, 47, 50, 90, 65, 61, 78, 64, 80, 60, 66, 140, 61, 63, 104, 67, 65, 87, 97, 60, 57, 54, 70, 69, 87, 60, 67, 68, 50, 50, 82, 105, 48, 112, 49, 52, 56, 60, 67, 93, 56, 98, 93, 54, 100, 61, 57, 63, 45, 89, 86, 64, 52, 64, 81, 127, 109, 99, 48, 54, 67, 57, 77, 51, 43, 56, 67, 85, 55, 70, 101, 62, 57, 88, 77, 60, 55, 77, 62, 64, 65, 57, 78, 84, 60, 99, 70, 79, 61, 52, 103, 66, 63, 40, 71, 53, 150, 157, 80, 48, 74, 84, 83, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2863617246732548, "mean_inference_ms": 1.5781819265846166, "mean_action_processing_ms": 0.14822636767838754, "mean_env_wait_ms": 2.9015152948099288, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 743256, "agent_timesteps_total": 743256, "timers": {"sample_time_ms": 8091.005, "sample_throughput": 987.764, "load_time_ms": 3.939, "load_throughput": 2029157.944, "learn_time_ms": 8300.64, "learn_throughput": 962.817, "update_time_ms": 3.465}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.033728502690792084, "policy_loss": -0.01842356286942959, "vf_loss": 0.04925242438912392, "vf_explained_var": 0.812969982624054, "kl": 0.014498185366392136, "entropy": 0.8396866917610168, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 743256, "num_agent_steps_sampled": 743256, "num_steps_trained": 743256, "num_agent_steps_trained": 743256}, "done": false, "episodes_total": 7186, "training_iteration": 93, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-56-40", "timestamp": 1716404200, "time_this_iter_s": 13.323326110839844, "time_total_s": 1244.6611740589142, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1244.6611740589142, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 33.636842105263156, "ram_util_percent": 34.50526315789474}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.705761908116447, "episode_reward_min": 5.153084453166318, "episode_reward_mean": 5.455537142716434, "episode_len_mean": 75.01851851851852, "episode_media": {}, "episodes_this_iter": 108, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.280555661234952, "reward_component_totals/rejoin_dist_change_reward_min": 0.9600844531663171, "reward_component_totals/rejoin_dist_change_reward_max": 1.513761908116447, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9249814814814814, "reward_component_totals/success_reward_min": 1.861, "reward_component_totals/success_reward_max": 1.96}, "hist_stats": {"episode_reward": [5.415812372229265, 5.455184604076946, 5.333346062093651, 5.656750288256022, 5.533772150708732, 5.670749173114979, 5.638113478225895, 5.570135502349244, 5.5211221625524285, 5.66131540980464, 5.232739791628493, 5.360501568790145, 5.571258744531069, 5.222162567072254, 5.532498884698365, 5.444646748942802, 5.388307425088612, 5.220744410453397, 5.441012532823546, 5.512537080606718, 5.551403414245426, 5.434643395281402, 5.452040640535032, 5.533853740241747, 5.646779339748196, 5.317762242002264, 5.610393462860424, 5.6364258785371195, 5.3017738981932805, 5.646652442776751, 5.351411447275836, 5.411148702667533, 5.60489616991959, 5.664589605933873, 5.242152250749639, 5.222493309899111, 5.570285427906263, 5.606647837642009, 5.530221030718842, 5.205774357820216, 5.613167425816475, 5.153084453166318, 5.507839367405493, 5.287390835578318, 5.523428297016675, 5.418860736225599, 5.621435062194621, 5.561690683853339, 5.4384749874864236, 5.475019999116849, 5.5269691123482545, 5.3520203141030755, 5.580925249609397, 5.518881018511255, 5.344628177255394, 5.413755833698106, 5.194835800624887, 5.416662911966643, 5.596788004806553, 5.705761908116447, 5.210436828738196, 5.386373526839634, 5.16919163653824, 5.512818146305051, 5.412641711674246, 5.317874174821336, 5.1826188649231675, 5.459630088974424, 5.6446150042469885, 5.235151663462306, 5.548745690662395, 5.498262072074804, 5.446525492447923, 5.530663581105398, 5.557980682294336, 5.557104692418891, 5.458689653845344, 5.494719869113865, 5.281059301718564, 5.480841555925554, 5.323647045275125, 5.310689978564486, 5.445913031313923, 5.525603659102134, 5.660609087576702, 5.411017857806645, 5.43172495944241, 5.467819260135844, 5.422463701726395, 5.565868006428671, 5.189069269334961, 5.50826674261302, 5.616078811828944, 5.175605924963199, 5.448550534364259, 5.650434226894926, 5.4147721447022965, 5.55103355763729, 5.566182025219831, 5.402163791980879, 5.438947232535762, 5.177207727556119, 5.601891615703142, 5.258776786076177, 5.348827920650583, 5.6909041684364166, 5.51472635345198, 5.517592022020159], "episode_lengths": [58, 43, 73, 63, 67, 69, 66, 102, 61, 76, 59, 60, 99, 83, 77, 56, 67, 47, 50, 66, 96, 102, 114, 91, 85, 109, 85, 98, 71, 86, 95, 139, 48, 62, 103, 70, 91, 86, 57, 48, 85, 57, 77, 72, 64, 76, 52, 53, 69, 77, 61, 48, 55, 71, 40, 67, 107, 57, 63, 58, 89, 87, 65, 53, 90, 78, 75, 101, 105, 76, 106, 56, 65, 69, 73, 102, 56, 69, 72, 44, 63, 59, 61, 119, 60, 132, 120, 90, 65, 111, 78, 60, 61, 43, 51, 65, 130, 82, 51, 115, 86, 104, 66, 53, 40, 56, 90, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28678173804314083, "mean_inference_ms": 1.5798992633449047, "mean_action_processing_ms": 0.14834733378017137, "mean_env_wait_ms": 2.9051313172599555, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 751248, "agent_timesteps_total": 751248, "timers": {"sample_time_ms": 8165.938, "sample_throughput": 978.7, "load_time_ms": 3.942, "load_throughput": 2027415.208, "learn_time_ms": 8326.124, "learn_throughput": 959.87, "update_time_ms": 3.464}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03422201797366142, "policy_loss": -0.008280261419713497, "vf_loss": 0.039721790701150894, "vf_explained_var": 0.8410714864730835, "kl": 0.013902463018894196, "entropy": 0.7729156017303467, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 751248, "num_agent_steps_sampled": 751248, "num_steps_trained": 751248, "num_agent_steps_trained": 751248}, "done": false, "episodes_total": 7294, "training_iteration": 94, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-56-54", "timestamp": 1716404214, "time_this_iter_s": 13.99356460571289, "time_total_s": 1258.654738664627, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1258.654738664627, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 35.165000000000006, "ram_util_percent": 34.30000000000001}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.711605183167823, "episode_reward_min": 0.14157552261647033, "episode_reward_mean": 5.394139118338471, "episode_len_mean": 77.3495145631068, "episode_media": {}, "episodes_this_iter": 103, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9902912621359223, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.009708737864077669, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.980582524271845, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24757281553398058, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.272168244552063, "reward_component_totals/rejoin_dist_change_reward_min": 0.9140710689305642, "reward_component_totals/rejoin_dist_change_reward_max": 1.5196051831678228, "reward_component_totals/failure_reward_mean": -0.009708737864077669, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9035242718446603, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.959, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.463839025372401, 5.441807577686043, 5.38866687560625, 5.519570052817256, 5.233852867836042, 5.516545270386773, 0.14157552261647033, 5.377326679019802, 5.515191970985958, 5.520179720558884, 5.559039952031797, 5.478770661638861, 5.236645728316179, 5.646426827395075, 5.269470703138485, 5.426535111201127, 5.312257617150729, 5.358102695522629, 5.232020637614351, 5.244444482547946, 5.259980366238649, 5.583548833203143, 5.370174124234836, 5.46907934572188, 5.505228578592783, 5.480200975608776, 5.5467839315528895, 5.282597689999201, 5.52073514096247, 5.568964283544338, 5.325739739640163, 5.218788079114585, 5.546795173025965, 5.476465051437596, 5.118071068930565, 5.467451065326791, 5.680765653875012, 5.1472628198864445, 5.181941496016624, 5.532826325208612, 5.695945703132906, 5.1561899475122415, 5.49656843333115, 5.669801166252233, 5.415380137601246, 5.556536098220561, 5.473726941554851, 5.567001951318215, 5.257146254864022, 5.551247344635753, 5.330689891356485, 5.573309463261595, 5.387310230244159, 5.536777797263276, 5.525376377693366, 5.637152216364358, 5.485918132012365, 5.413094105270398, 5.1957893941660425, 5.694119678811045, 5.4858639926950525, 5.25085500152922, 5.506923213177073, 5.123362228276181, 5.255029935700402, 5.6571441682275205, 5.567412722456235, 5.610519323959691, 5.285942211455605, 5.5527608783507105, 5.343136791284278, 5.489683323449421, 5.511399993070462, 5.408457308030597, 5.592101399917106, 5.651732523323142, 5.618582045309686, 5.467488747529064, 5.604074137623602, 5.605734447983513, 5.580893811682573, 5.541858797347424, 5.576442672266335, 5.494991563008386, 5.263057392942731, 5.711605183167823, 5.584142153324609, 5.553888003731734, 5.234471744881594, 5.5948047184556575, 5.42549127169991, 5.326346829779295, 5.38764639834376, 5.635830640495694, 5.172751841716099, 5.323640942724694, 5.316061607900663, 5.5647718610305175, 5.257392939178405, 5.380997697713669, 5.679648759381845, 5.179818151230993, 5.436818827078863], "episode_lengths": [104, 102, 71, 67, 67, 87, 30, 60, 50, 93, 107, 92, 48, 51, 56, 69, 71, 110, 73, 73, 80, 48, 78, 119, 105, 71, 83, 85, 47, 81, 41, 50, 66, 72, 46, 60, 71, 52, 100, 73, 63, 87, 90, 68, 76, 47, 47, 85, 82, 49, 76, 67, 112, 48, 77, 104, 53, 149, 79, 57, 120, 60, 154, 70, 86, 63, 117, 79, 61, 54, 70, 82, 59, 108, 52, 63, 89, 130, 56, 49, 97, 93, 73, 77, 85, 58, 82, 61, 128, 91, 83, 58, 101, 74, 102, 72, 60, 122, 59, 141, 59, 54, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28613720724844816, "mean_inference_ms": 1.5805872678645048, "mean_action_processing_ms": 0.14847714765330383, "mean_env_wait_ms": 2.908340150511617, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 759240, "agent_timesteps_total": 759240, "timers": {"sample_time_ms": 8166.588, "sample_throughput": 978.622, "load_time_ms": 3.882, "load_throughput": 2058731.111, "learn_time_ms": 8067.253, "learn_throughput": 990.672, "update_time_ms": 3.452}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05189812555909157, "policy_loss": -0.015822676941752434, "vf_loss": 0.06515440344810486, "vf_explained_var": 0.7782593369483948, "kl": 0.012831991538405418, "entropy": 0.8129149675369263, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 759240, "num_agent_steps_sampled": 759240, "num_steps_trained": 759240, "num_agent_steps_trained": 759240}, "done": false, "episodes_total": 7397, "training_iteration": 95, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-57-08", "timestamp": 1716404228, "time_this_iter_s": 14.2051522731781, "time_total_s": 1272.8598909378052, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1272.8598909378052, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 34.644999999999996, "ram_util_percent": 34.20000000000001}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.66348776123367, "episode_reward_min": 0.26207283606614573, "episode_reward_mean": 5.335426791605982, "episode_len_mean": 77.36893203883496, "episode_media": {}, "episodes_this_iter": 103, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9805825242718447, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.019417475728155338, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9611650485436896, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24514563106796117, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2641549469457865, "reward_component_totals/rejoin_dist_change_reward_min": 0.9339727544743037, "reward_component_totals/rejoin_dist_change_reward_max": 1.509487761233671, "reward_component_totals/failure_reward_mean": -0.019417475728155338, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.8843786407766991, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.963, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.41708711716754, 5.652041312665875, 5.600287324778322, 5.640496242781345, 5.556841133295336, 5.365005973837978, 5.66348776123367, 0.29198040339317766, 5.285185669222944, 5.465869252852816, 5.62055987466189, 5.606667964321202, 5.206473487830051, 5.299907827983288, 5.44284730893145, 5.484205806337449, 5.49929872655243, 5.641388145691197, 5.39787186630578, 5.562593771084007, 5.2870204569305495, 5.552330849588285, 5.278801278975655, 5.452729513347244, 5.357520477818081, 5.198038738961426, 5.185544296942439, 5.534226368829766, 5.575129403631339, 5.499130569804026, 5.218212044597793, 5.516795325917666, 5.29447923932857, 5.362824043394163, 5.65027176760714, 5.469157456826929, 5.199604682481329, 5.542225705001622, 5.312905193952456, 5.530198801962252, 5.23035570113426, 5.526044903062298, 5.179800907111612, 5.5267789305792725, 5.336720107416758, 0.26207283606614573, 5.347146025871917, 5.4776147914500175, 5.341987573926668, 5.292068446933043, 5.571646902869723, 5.567178765720559, 5.552876690914333, 5.2844045772231, 5.474103748227336, 5.330037571224876, 5.439205772071469, 5.546026536180898, 5.391750265215528, 5.503474664840261, 5.661695104922801, 5.435561925224199, 5.318412826098987, 5.608041346301883, 5.539943935520842, 5.561693416720277, 5.554031025144503, 5.494875559185294, 5.262974481205165, 5.278396302381652, 5.473194724399346, 5.443706380241746, 5.629130519626177, 5.610235916967678, 5.514406930840757, 5.550328411737857, 5.546215310611904, 5.3010019568445745, 5.46841625905474, 5.423061767261389, 5.336522542390433, 5.5212524657218776, 5.302927418359142, 5.184923219389532, 5.562311759376907, 5.336998242230154, 5.3273956663160025, 5.362934039908435, 5.41789030431858, 5.411246161289792, 5.321478138253944, 5.130972754474304, 5.488178379378314, 5.240956415934691, 5.6604838068908325, 5.309021836510183, 5.5301859951194094, 5.486178694794772, 5.439249280730072, 5.271458700882885, 5.628362862238362, 5.496545069219691, 5.207622776529362], "episode_lengths": [73, 54, 58, 110, 114, 59, 96, 31, 57, 52, 107, 101, 74, 76, 63, 46, 61, 54, 95, 48, 52, 127, 68, 116, 55, 64, 68, 79, 125, 57, 116, 55, 89, 134, 69, 104, 97, 86, 89, 61, 48, 54, 119, 126, 84, 29, 96, 76, 89, 96, 115, 49, 68, 79, 55, 73, 66, 55, 135, 117, 62, 98, 74, 50, 57, 88, 94, 121, 85, 68, 77, 56, 54, 78, 58, 87, 57, 91, 59, 53, 106, 115, 70, 76, 83, 112, 64, 55, 61, 55, 57, 53, 107, 74, 74, 37, 87, 93, 126, 41, 50, 77, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.286462826289064, "mean_inference_ms": 1.5828691578915974, "mean_action_processing_ms": 0.14880020426336532, "mean_env_wait_ms": 2.9111410056390654, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 767232, "agent_timesteps_total": 767232, "timers": {"sample_time_ms": 8092.834, "sample_throughput": 987.54, "load_time_ms": 3.834, "load_throughput": 2084502.056, "learn_time_ms": 7776.232, "learn_throughput": 1027.747, "update_time_ms": 3.35}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05918807536363602, "policy_loss": -0.01802002638578415, "vf_loss": 0.07430367171764374, "vf_explained_var": 0.7760653495788574, "kl": 0.014522077515721321, "entropy": 0.857130229473114, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 767232, "num_agent_steps_sampled": 767232, "num_steps_trained": 767232, "num_agent_steps_trained": 767232}, "done": false, "episodes_total": 7500, "training_iteration": 96, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-57-22", "timestamp": 1716404242, "time_this_iter_s": 14.13941216468811, "time_total_s": 1286.9993031024933, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1286.9993031024933, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 34.614999999999995, "ram_util_percent": 34.29999999999999}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.694134721414123, "episode_reward_min": 5.189310348131254, "episode_reward_mean": 5.4395198763703965, "episode_len_mean": 73.09174311926606, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2626116194896624, "reward_component_totals/rejoin_dist_change_reward_min": 0.9980582913965645, "reward_component_totals/rejoin_dist_change_reward_max": 1.4981347214141232, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9269082568807339, "reward_component_totals/success_reward_min": 1.874, "reward_component_totals/success_reward_max": 1.9609999999999999}, "hist_stats": {"episode_reward": [5.208413336933673, 5.329328013143609, 5.628553027485396, 5.589719952308141, 5.599977985007527, 5.645929624031899, 5.4955753844395705, 5.392458450612044, 5.581524986119379, 5.314240680028403, 5.537820358457198, 5.450387305043838, 5.277506757227818, 5.565708615118744, 5.642051671068481, 5.432519832180641, 5.464480701441065, 5.410634232753196, 5.319543737126672, 5.492736557754903, 5.589872329007115, 5.405098782950631, 5.599613124559398, 5.612157880053927, 5.416854827258797, 5.445841974188, 5.4819730935826225, 5.496345013340979, 5.206452497379748, 5.589398605801854, 5.292692461952571, 5.598403725922188, 5.4599945548605415, 5.286140523752798, 5.364979897474788, 5.620558615804453, 5.570191287190619, 5.544790518421362, 5.40665035153296, 5.383185407646046, 5.2665776718912936, 5.301083584343651, 5.426235559180679, 5.4134378965162515, 5.5043376560651005, 5.397035299702158, 5.305967638703395, 5.440685692048596, 5.349822325545465, 5.48018098070022, 5.526305040005864, 5.453680432658658, 5.2501842644474745, 5.251779877277144, 5.322440972060336, 5.615129024616076, 5.406932808693832, 5.492256985610798, 5.260777461243471, 5.274062892548955, 5.271899423926856, 5.508007196703071, 5.4503613231008945, 5.614434519552345, 5.283131402853407, 5.477169540843628, 5.529627593953482, 5.367678990727245, 5.227781527660497, 5.4464720305513, 5.480203413967761, 5.209058291396564, 5.667855272945422, 5.6083602061936535, 5.259966043993936, 5.4699451220638196, 5.309035151367167, 5.612465326140183, 5.636097317369323, 5.189310348131254, 5.570904246344405, 5.585270912916014, 5.303340711148272, 5.366262265163999, 5.287790957983404, 5.5050913047468, 5.274535872405885, 5.368521499448618, 5.341953258851701, 5.558121514873019, 5.344212231064681, 5.388578418200261, 5.362970849306187, 5.694134721414123, 5.359293347979447, 5.44940664166899, 5.226176412235823, 5.385188144899221, 5.598707848381663, 5.479050054049634, 5.469139517030973, 5.534904934029344, 5.479229523456231, 5.333190629895006, 5.573699037546229, 5.3006058646407475, 5.592147342655656, 5.6708838838280515, 5.396273789944023], "episode_lengths": [95, 80, 61, 64, 105, 54, 117, 114, 104, 51, 98, 46, 55, 73, 51, 61, 87, 56, 49, 78, 84, 61, 86, 88, 96, 83, 96, 56, 54, 48, 53, 106, 79, 86, 77, 50, 60, 79, 75, 68, 62, 65, 76, 63, 49, 103, 85, 40, 86, 41, 113, 55, 47, 55, 111, 105, 76, 42, 44, 72, 44, 91, 63, 70, 87, 61, 96, 66, 92, 94, 72, 39, 54, 55, 65, 63, 64, 101, 56, 71, 46, 97, 122, 69, 83, 85, 46, 58, 45, 84, 77, 67, 39, 54, 68, 74, 81, 82, 63, 93, 95, 71, 43, 103, 99, 82, 79, 58, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28607465406032817, "mean_inference_ms": 1.5850737157018313, "mean_action_processing_ms": 0.14891381731177963, "mean_env_wait_ms": 2.9167612535295064, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 775224, "agent_timesteps_total": 775224, "timers": {"sample_time_ms": 7903.851, "sample_throughput": 1011.153, "load_time_ms": 3.844, "load_throughput": 2079342.814, "learn_time_ms": 7714.626, "learn_throughput": 1035.954, "update_time_ms": 3.301}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03715476393699646, "policy_loss": -0.012122433632612228, "vf_loss": 0.046766169369220734, "vf_explained_var": 0.8067218661308289, "kl": 0.012555121444165707, "entropy": 0.7733278870582581, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 775224, "num_agent_steps_sampled": 775224, "num_steps_trained": 775224, "num_agent_steps_trained": 775224}, "done": false, "episodes_total": 7609, "training_iteration": 97, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-57-37", "timestamp": 1716404257, "time_this_iter_s": 14.979627847671509, "time_total_s": 1301.9789309501648, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1301.9789309501648, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 35.03181818181818, "ram_util_percent": 34.349999999999994}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.693587387972789, "episode_reward_min": 5.149244992432152, "episode_reward_mean": 5.455214185434936, "episode_len_mean": 74.09174311926606, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2793059285542014, "reward_component_totals/rejoin_dist_change_reward_min": 0.9612449924321513, "reward_component_totals/rejoin_dist_change_reward_max": 1.5165873879727887, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9259082568807337, "reward_component_totals/success_reward_min": 1.853, "reward_component_totals/success_reward_max": 1.9569999999999999}, "hist_stats": {"episode_reward": [5.621524368552593, 5.504869518871511, 5.256585556987519, 5.399169021441285, 5.371484041156226, 5.403613580537561, 5.610885891951355, 5.488368229073242, 5.406352879181762, 5.634903330653158, 5.407753300354704, 5.552633158105941, 5.291389125965564, 5.50708490648055, 5.554487477301354, 5.269180328191399, 5.204166472455844, 5.217513031855399, 5.6611451194316755, 5.581353692518178, 5.2688233200608785, 5.568446013457558, 5.292840571235251, 5.4212096738976125, 5.426667046754737, 5.693587387972789, 5.557820698899082, 5.546398446517923, 5.308604709942373, 5.569776163291499, 5.278312628192683, 5.620795570203631, 5.509544098062969, 5.67263074807375, 5.3291300894848455, 5.255426332583813, 5.2701283479769145, 5.60307762156024, 5.614599050650234, 5.218052329403426, 5.613988092687391, 5.502824502891884, 5.649583627734887, 5.440984850285511, 5.317803543232458, 5.538562495748476, 5.453980429418273, 5.53139310389428, 5.527376572547158, 5.416732467267456, 5.231655909906891, 5.208033483317461, 5.507403439461672, 5.570951582682351, 5.502747393278084, 5.421699132282617, 5.574771567818791, 5.362466972115673, 5.4526856285900935, 5.584463968715247, 5.314115661485506, 5.310670234302602, 5.187843076783462, 5.498913257083954, 5.197868985336337, 5.30607636310344, 5.424237529532654, 5.414121330449152, 5.617137557275641, 5.307319251474704, 5.384120371528226, 5.563830431778654, 5.335958337767314, 5.564529514635904, 5.656699370975698, 5.6625893335640844, 5.517797949249797, 5.55977643537274, 5.611846234625278, 5.322082387962117, 5.268186999781712, 5.149244992432152, 5.368022466724119, 5.305237902084888, 5.618271876588639, 5.388128737933146, 5.376163386947869, 5.546015432663409, 5.518783263763231, 5.573827280451102, 5.430256431138712, 5.624189334276253, 5.478059339428791, 5.505435075850241, 5.476210488341081, 5.284192471166085, 5.403061847766121, 5.483816850168509, 5.224677772984732, 5.643668399429417, 5.6837340305721025, 5.382296816152794, 5.263177847931169, 5.646754341353326, 5.557271193308707, 5.519803768005223, 5.643566199725017, 5.644293453511589, 5.474021954474901], "episode_lengths": [59, 62, 62, 66, 128, 46, 59, 61, 105, 62, 44, 50, 89, 48, 63, 92, 106, 94, 62, 70, 84, 56, 43, 56, 47, 73, 86, 129, 103, 59, 63, 93, 114, 63, 61, 88, 69, 72, 48, 65, 101, 55, 55, 82, 55, 95, 76, 146, 56, 71, 67, 58, 125, 71, 125, 59, 140, 46, 60, 122, 91, 81, 84, 82, 89, 46, 97, 68, 98, 63, 63, 102, 47, 84, 54, 84, 53, 95, 71, 70, 63, 62, 105, 47, 91, 45, 72, 53, 109, 62, 72, 51, 57, 48, 97, 53, 48, 61, 67, 58, 65, 91, 53, 63, 147, 60, 55, 60, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2872849476968165, "mean_inference_ms": 1.5863544092062523, "mean_action_processing_ms": 0.14914727178697282, "mean_env_wait_ms": 2.919363585920842, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 783216, "agent_timesteps_total": 783216, "timers": {"sample_time_ms": 7894.634, "sample_throughput": 1012.333, "load_time_ms": 3.829, "load_throughput": 2087149.768, "learn_time_ms": 7695.22, "learn_throughput": 1038.567, "update_time_ms": 3.31}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0337156318128109, "policy_loss": -0.014538860879838467, "vf_loss": 0.04577135294675827, "vf_explained_var": 0.8263933658599854, "kl": 0.012415697798132896, "entropy": 0.8031970858573914, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 783216, "num_agent_steps_sampled": 783216, "num_steps_trained": 783216, "num_agent_steps_trained": 783216}, "done": false, "episodes_total": 7718, "training_iteration": 98, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-57-51", "timestamp": 1716404271, "time_this_iter_s": 14.148648262023926, "time_total_s": 1316.1275792121887, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1316.1275792121887, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 35.190000000000005, "ram_util_percent": 34.235}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.669963336333634, "episode_reward_min": 0.03047642742236134, "episode_reward_mean": 5.342446928176935, "episode_len_mean": 72.44036697247707, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.981651376146789, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.01834862385321101, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9633027522935782, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24541284403669725, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.260878120837485, "reward_component_totals/rejoin_dist_change_reward_min": 0.9398417429876538, "reward_component_totals/rejoin_dist_change_reward_max": 1.5009633363336334, "reward_component_totals/failure_reward_mean": -0.01834862385321101, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.8912018348623851, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.9609999999999999, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.518172068576222, 5.228783745556434, 5.22827451667318, 5.476252796211231, 5.268253231392755, 5.360464097080447, 5.596831966622879, 5.669963336333634, 5.489546535036032, 5.668165539605992, 5.20943574372421, 5.319071662106529, 5.639957310404806, 5.319221620077544, 5.642785363972536, 5.386118488420688, 5.219293051808276, 5.48209342575344, 5.562569519440128, 5.251902309485396, 5.426834934338769, 5.5501533314588745, 5.602753760991988, 5.149637941378016, 5.567221103054788, 5.247726781895224, 5.273308133838979, 5.590244623342912, 5.628472748101419, 5.575407275839975, 5.473370801565717, 5.6453997200849555, 5.2533434364100104, 5.456862199106554, 5.345011135283562, 5.618552438898244, 5.618314156217012, 5.3244514502463804, 0.03047642742236134, 5.541896539634944, 5.183392458052749, 5.547945762759101, 5.321839202758561, 5.311937085977519, 5.507240250002692, 5.495697258685929, 5.218454703201388, 5.612769152397939, 5.293451300309766, 5.574117251153273, 5.346180863429611, 5.615356364147411, 5.594422613945001, 5.580692498517044, 5.139841742987654, 5.57835677378738, 5.654815562223859, 5.217049768154963, 5.319175026526061, 5.507861140059922, 5.50041189609867, 5.259751105761772, 5.402107733479996, 5.626731912815375, 5.55021038987385, 5.227431141390149, 5.4132539784786955, 5.558908537418954, 5.561234239730891, 5.386175943839794, 5.148776206594992, 5.612554234926232, 5.515910546561438, 5.262438828408319, 5.419334549710607, 5.459156934634604, 5.306591766182981, 5.376106184476454, 5.2526184510713705, 5.37758556582973, 5.483748830872003, 5.269968019989644, 5.529386113634162, 0.37815704994055777, 5.261634416939723, 5.336973624966943, 5.37841949432457, 5.587357837061805, 5.570793963588602, 5.160231747990309, 5.591304268357317, 5.4110977735610115, 5.567021616176922, 5.438922352251742, 5.587681524647264, 5.6030294487555485, 5.481391022248852, 5.283874828154749, 5.451186535473162, 5.549715153417463, 5.536981442867721, 5.386610496321517, 5.587540931244989, 5.498583144653953, 5.523795603286381, 5.450235381937914, 5.235862287402224, 5.406277319309006, 5.484450748154096], "episode_lengths": [53, 39, 72, 97, 40, 65, 70, 81, 76, 82, 84, 41, 80, 61, 55, 64, 91, 87, 51, 41, 69, 68, 80, 88, 59, 65, 55, 88, 67, 115, 52, 48, 62, 119, 45, 54, 91, 55, 19, 106, 71, 56, 62, 59, 48, 63, 94, 52, 74, 116, 66, 57, 56, 76, 50, 66, 55, 118, 60, 60, 64, 57, 149, 74, 74, 98, 116, 72, 124, 97, 52, 81, 56, 51, 52, 58, 67, 50, 63, 71, 77, 82, 99, 18, 91, 59, 97, 52, 79, 87, 99, 111, 103, 74, 95, 63, 49, 75, 70, 80, 75, 95, 72, 95, 68, 79, 40, 118, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28854004424289786, "mean_inference_ms": 1.5873205587578678, "mean_action_processing_ms": 0.14917091823413653, "mean_env_wait_ms": 2.922678804443175, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 791208, "agent_timesteps_total": 791208, "timers": {"sample_time_ms": 7931.226, "sample_throughput": 1007.663, "load_time_ms": 3.74, "load_throughput": 2136938.849, "learn_time_ms": 7509.912, "learn_throughput": 1064.194, "update_time_ms": 3.331}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.050413694232702255, "policy_loss": -0.016351325437426567, "vf_loss": 0.06402572989463806, "vf_explained_var": 0.7847057580947876, "kl": 0.01369641162455082, "entropy": 0.797985315322876, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 791208, "num_agent_steps_sampled": 791208, "num_steps_trained": 791208, "num_agent_steps_trained": 791208}, "done": false, "episodes_total": 7827, "training_iteration": 99, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-58-05", "timestamp": 1716404285, "time_this_iter_s": 13.95953106880188, "time_total_s": 1330.0871102809906, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1330.0871102809906, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 34.205, "ram_util_percent": 34.10000000000001}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.690874594120792, "episode_reward_min": 0.30088945077525553, "episode_reward_mean": 5.404568791141786, "episode_len_mean": 73.68518518518519, "episode_media": {}, "episodes_this_iter": 108, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9907407407407407, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.009259259259259259, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9814814814814818, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24768518518518517, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.276698420771416, "reward_component_totals/rejoin_dist_change_reward_min": 0.9640457859485039, "reward_component_totals/rejoin_dist_change_reward_max": 1.501874594120792, "reward_component_totals/failure_reward_mean": -0.009259259259259259, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9079629629629633, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.962, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.449869114182654, 5.2001268047611315, 5.630726489765621, 5.530312235609689, 5.146045785948505, 5.186554545692427, 5.206412383020579, 5.493672275231855, 5.618878865222842, 5.234031338267715, 5.269643491092928, 5.175136575295164, 5.663007671094091, 5.481904872950164, 5.324973083049057, 5.464744821360461, 5.336713529210955, 5.31449666158238, 5.1825337851212385, 5.363279682054554, 5.401653511361763, 5.584475860602822, 5.481510808007301, 5.401883301964141, 5.628055871173069, 5.67050440831335, 5.325063683137321, 5.247347643079902, 5.669735891252442, 5.580273917592862, 5.591040289721205, 5.222961813766042, 5.191267573389375, 5.406021604504616, 5.497335717795721, 5.604741097790139, 5.490469791055588, 5.515214563515436, 5.323869353486594, 5.405130351257936, 5.536056864065678, 5.3285924188613025, 5.580189122027803, 5.506701742361207, 5.278801067817025, 5.638096032536032, 5.575049069177399, 5.690874594120792, 5.461206214058796, 5.322086311847205, 5.476893806319093, 5.346112173157893, 5.485866002650914, 5.607279554557044, 5.577653643600366, 5.357328292195826, 5.4706816817047335, 5.5925777743697775, 5.51732899710319, 5.606926581487887, 5.394025500719034, 5.429489129991038, 5.365450450766955, 5.58152473849343, 5.255038883171478, 5.669460374439111, 5.623128739296137, 5.547732314444772, 5.328216771687752, 5.198630107546981, 5.599400388952029, 5.271898941458231, 5.541596229013284, 5.634241207986221, 5.547139276211954, 5.154770645955162, 0.30088945077525553, 5.573276629267165, 5.4551920930617674, 5.426238042284826, 5.287774812906225, 5.616426225754827, 5.5855926219233645, 5.350234956909988, 5.43432494471484, 5.374904064620403, 5.565744290558291, 5.576613284551469, 5.305248279903077, 5.673885057752738, 5.622939112601007, 5.49628399211384, 5.382972798392666, 5.470450527097204, 5.219207016461427, 5.664767625807206, 5.629352295089365, 5.342266512534559, 5.614613237571252, 5.636332767539402, 5.365147961659712, 5.312636214097401, 5.4910504761885575, 5.6487413705308995, 5.337289614106552, 5.611689959541574, 5.433607715123971, 5.278068784436907], "episode_lengths": [58, 47, 54, 107, 68, 98, 72, 86, 66, 58, 56, 114, 57, 46, 50, 73, 104, 71, 103, 82, 131, 127, 69, 86, 69, 64, 68, 38, 80, 77, 50, 84, 69, 55, 71, 62, 49, 79, 55, 83, 91, 72, 125, 49, 99, 75, 113, 61, 62, 62, 91, 94, 71, 62, 97, 80, 93, 59, 87, 88, 68, 56, 65, 64, 83, 52, 110, 107, 53, 74, 106, 65, 87, 52, 47, 72, 18, 73, 44, 92, 47, 95, 80, 84, 38, 61, 50, 59, 66, 69, 71, 131, 41, 66, 40, 62, 52, 50, 109, 67, 65, 69, 109, 79, 76, 59, 114, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28727142931276906, "mean_inference_ms": 1.5892521844258232, "mean_action_processing_ms": 0.14941075547961205, "mean_env_wait_ms": 2.9254679096686855, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 799200, "agent_timesteps_total": 799200, "timers": {"sample_time_ms": 7899.393, "sample_throughput": 1011.723, "load_time_ms": 3.687, "load_throughput": 2167559.721, "learn_time_ms": 7130.661, "learn_throughput": 1120.794, "update_time_ms": 3.176}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04379986971616745, "policy_loss": -0.012057041749358177, "vf_loss": 0.05357838422060013, "vf_explained_var": 0.8025206923484802, "kl": 0.01139259897172451, "entropy": 0.7748039960861206, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 799200, "num_agent_steps_sampled": 799200, "num_steps_trained": 799200, "num_agent_steps_trained": 799200}, "done": false, "episodes_total": 7935, "training_iteration": 100, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-58-19", "timestamp": 1716404299, "time_this_iter_s": 14.137180089950562, "time_total_s": 1344.2242903709412, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1344.2242903709412, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 34.76500000000001, "ram_util_percent": 34.180000000000014}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.695570800597897, "episode_reward_min": 5.133017307533079, "episode_reward_mean": 5.430268756913674, "episode_len_mean": 67.05, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2473187569136737, "reward_component_totals/rejoin_dist_change_reward_min": 0.9410173075330788, "reward_component_totals/rejoin_dist_change_reward_max": 1.5085708005978984, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9329500000000002, "reward_component_totals/success_reward_min": 1.867, "reward_component_totals/success_reward_max": 1.96}, "hist_stats": {"episode_reward": [5.520638195005018, 5.596080842636359, 5.457374187614415, 5.402536085521836, 5.247679807462017, 5.524738223170768, 5.515116804598542, 5.611859039205381, 5.544046561052647, 5.60598472408134, 5.298370604086262, 5.481295601101795, 5.1836217394761475, 5.5500266026799805, 5.367389926180465, 5.1828987984362715, 5.186718752676601, 5.6536422942804805, 5.603000165022947, 5.405909899127626, 5.330740436562182, 5.217367202845484, 5.306791724402096, 5.523987164698516, 5.463518495010293, 5.576778793583642, 5.521750896621797, 5.536671676576114, 5.471714759652205, 5.363494411337038, 5.239191720750348, 5.546471687681984, 5.554260642575926, 5.55627481599106, 5.326386423746967, 5.4194095629159165, 5.282641431373657, 5.213340376523691, 5.662433896444195, 5.144476729626709, 5.393407805864834, 5.134021088105266, 5.57534743941479, 5.626253562322498, 5.290008429499821, 5.242480543826854, 5.409912774643793, 5.2578756963791875, 5.4619044901313405, 5.53839446665917, 5.201525215878802, 5.362656090291081, 5.249676680708431, 5.220384713071464, 5.269768793653997, 5.364047103440203, 5.247411105415478, 5.541822299543655, 5.40174916866223, 5.610730135767899, 5.408647593035094, 5.494057040598251, 5.504410488172844, 5.371115229299484, 5.594932922110763, 5.533102118160551, 5.256807011036759, 5.533433147642599, 5.524611294073329, 5.3097813805398175, 5.37594654063603, 5.570364364491441, 5.570911016703999, 5.461780657069266, 5.610446076612901, 5.157089671782009, 5.663614577231652, 5.323272940393751, 5.528907646350726, 5.672057149859479, 5.472968218586284, 5.382719348051336, 5.133017307533079, 5.55059597766328, 5.1763548847876795, 5.2666797318677485, 5.314944845930144, 5.495912360374415, 5.2936193351915115, 5.307496020666623, 5.4363419678579685, 5.442697539922136, 5.291107370495218, 5.350621867947618, 5.675782492134399, 5.288593514181151, 5.580542888923853, 5.346255231042417, 5.695570800597897, 5.573858171687916, 5.2421507156821034, 5.501403959617106, 5.230312614257343, 5.656197635554665, 5.488737957198289, 5.4027554378586515, 5.529515763837452, 5.555434522436505, 5.431490426443247, 5.419859528626176, 5.522839708079859, 5.602764183893036, 5.615155688297802, 5.538407319124366, 5.404990568104479, 5.217946342593398, 5.5849372627523834, 5.507519583121262, 5.50015865053852, 5.542694914763228], "episode_lengths": [76, 56, 80, 47, 55, 57, 43, 59, 47, 88, 54, 58, 59, 50, 57, 67, 81, 54, 81, 73, 85, 81, 64, 62, 53, 50, 67, 58, 106, 44, 40, 53, 100, 73, 49, 58, 80, 46, 68, 75, 102, 76, 61, 50, 72, 74, 52, 68, 59, 71, 59, 124, 80, 100, 82, 48, 53, 77, 75, 61, 62, 133, 89, 55, 58, 61, 58, 53, 63, 57, 99, 66, 55, 73, 67, 41, 48, 40, 59, 79, 79, 42, 58, 110, 68, 48, 100, 84, 43, 45, 61, 46, 49, 76, 53, 45, 59, 59, 63, 81, 55, 99, 66, 57, 91, 52, 49, 87, 62, 56, 73, 82, 53, 82, 71, 120, 113, 57, 52, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2886791354973398, "mean_inference_ms": 1.5918055279765855, "mean_action_processing_ms": 0.1495401713325547, "mean_env_wait_ms": 2.9299643470559187, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 807192, "agent_timesteps_total": 807192, "timers": {"sample_time_ms": 7767.79, "sample_throughput": 1028.864, "load_time_ms": 3.731, "load_throughput": 2141826.995, "learn_time_ms": 6725.788, "learn_throughput": 1188.262, "update_time_ms": 2.962}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.035190824419260025, "policy_loss": -0.015090195462107658, "vf_loss": 0.04742133244872093, "vf_explained_var": 0.8129662871360779, "kl": 0.014298464171588421, "entropy": 0.7160729169845581, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 807192, "num_agent_steps_sampled": 807192, "num_steps_trained": 807192, "num_agent_steps_trained": 807192}, "done": false, "episodes_total": 8055, "training_iteration": 101, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-58-34", "timestamp": 1716404314, "time_this_iter_s": 14.521157264709473, "time_total_s": 1358.7454476356506, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1358.7454476356506, "timesteps_since_restore": 0, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 35.26190476190476, "ram_util_percent": 34.271428571428565}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.686299499319328, "episode_reward_min": 5.124196638320559, "episode_reward_mean": 5.436572746628501, "episode_len_mean": 67.78991596638656, "episode_media": {}, "episodes_this_iter": 119, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2543626625948858, "reward_component_totals/rejoin_dist_change_reward_min": 0.9239760497082832, "reward_component_totals/rejoin_dist_change_reward_max": 1.5053295043026858, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9322100840336136, "reward_component_totals/success_reward_min": 1.869, "reward_component_totals/success_reward_max": 1.9649999999999999}, "hist_stats": {"episode_reward": [5.2297266581501365, 5.527551968012702, 5.275117725845897, 5.388207830034342, 5.478685091718832, 5.471811458721998, 5.42920595018615, 5.615775873749211, 5.354243267661402, 5.4903183681338525, 5.575465318768164, 5.442283907644945, 5.185521169009665, 5.4459392113971905, 5.584806091167435, 5.271880866833337, 5.415601179188553, 5.406241517999932, 5.448585996855045, 5.340858654525945, 5.467298951774749, 5.559101171154374, 5.125976049708283, 5.484646798219183, 5.603445729546889, 5.230224495537926, 5.32741455045716, 5.396351203122869, 5.616081337073945, 5.450580174587465, 5.613414339171127, 5.453094883883405, 5.17263826553039, 5.206930486256638, 5.522402046544951, 5.594300434897202, 5.146340612623622, 5.563587253127421, 5.49385404651696, 5.635118373640179, 5.305098776763991, 5.394788715392346, 5.491954147223218, 5.620976497274066, 5.207236779395131, 5.57699375366143, 5.562150031638483, 5.633817562528781, 5.288883235633709, 5.338831068027137, 5.124196638320559, 5.45643927153027, 5.362870228674222, 5.243462830650241, 5.682329504302686, 5.466898491288939, 5.289150290660607, 5.467126240775389, 5.564803866865247, 5.353260545110683, 5.513252604500513, 5.571664759613142, 5.628622183261285, 5.516267890491208, 5.334449214657644, 5.473292035311411, 5.6428966073466755, 5.298978828643641, 5.371853413806093, 5.645379296481625, 5.397737511822832, 5.391030910827795, 5.2810782572524015, 5.3331155288135506, 5.258784356925961, 5.506973606082509, 5.665191615149257, 5.215473431749119, 5.578372565546763, 5.54129604218516, 5.686299499319328, 5.449532262147007, 5.236577338442559, 5.178960430074045, 5.373181435554235, 5.241011075564607, 5.36282327512437, 5.353014847543364, 5.275287026024775, 5.417524038148304, 5.535372468229325, 5.6375053851310675, 5.5468070073887095, 5.6739999548460895, 5.627772214764171, 5.600710344320751, 5.500800531064488, 5.527500828338768, 5.387116112511421, 5.386054860222804, 5.551810316619108, 5.164042180678493, 5.598776529579077, 5.373874864987296, 5.544539659602709, 5.550518055388274, 5.653084003613651, 5.645642116389727, 5.460127013455828, 5.2425320059023655, 5.302850710760165, 5.638929740386583, 5.231343857633842, 5.336743405266894, 5.142721096858908, 5.6216100028555624, 5.464800370706446, 5.586648893119969, 5.206102645061161], "episode_lengths": [70, 47, 65, 80, 92, 131, 91, 52, 43, 70, 52, 67, 84, 47, 57, 63, 54, 64, 69, 67, 46, 79, 48, 110, 64, 36, 81, 76, 51, 76, 65, 84, 91, 64, 73, 80, 66, 53, 77, 72, 60, 60, 54, 67, 35, 66, 131, 64, 43, 57, 70, 74, 48, 49, 73, 68, 55, 47, 67, 73, 102, 48, 50, 55, 58, 66, 82, 106, 50, 72, 77, 65, 39, 64, 51, 47, 54, 62, 56, 131, 61, 54, 94, 73, 62, 49, 87, 77, 105, 66, 99, 58, 44, 58, 66, 94, 54, 68, 54, 59, 87, 86, 94, 70, 66, 71, 66, 89, 93, 61, 68, 54, 57, 92, 52, 47, 60, 61, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2883649010232061, "mean_inference_ms": 1.5928312401468174, "mean_action_processing_ms": 0.1496762590441738, "mean_env_wait_ms": 2.9330176566996102, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 815184, "agent_timesteps_total": 815184, "timers": {"sample_time_ms": 7504.246, "sample_throughput": 1064.997, "load_time_ms": 3.642, "load_throughput": 2194133.698, "learn_time_ms": 6646.564, "learn_throughput": 1202.426, "update_time_ms": 2.965}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03436439111828804, "policy_loss": -0.011709623038768768, "vf_loss": 0.04347440227866173, "vf_explained_var": 0.8248741030693054, "kl": 0.012998066842556, "entropy": 0.7069389224052429, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 815184, "num_agent_steps_sampled": 815184, "num_steps_trained": 815184, "num_agent_steps_trained": 815184}, "done": false, "episodes_total": 8174, "training_iteration": 102, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-58-48", "timestamp": 1716404328, "time_this_iter_s": 14.324280977249146, "time_total_s": 1373.0697286128998, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1373.0697286128998, "timesteps_since_restore": 0, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 34.709999999999994, "ram_util_percent": 34.30999999999999}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.695663038452302, "episode_reward_min": 5.0965571941133465, "episode_reward_mean": 5.4329749990747365, "episode_len_mean": 77.25490196078431, "episode_media": {}, "episodes_this_iter": 102, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2602299010355205, "reward_component_totals/rejoin_dist_change_reward_min": 0.9545571941133464, "reward_component_totals/rejoin_dist_change_reward_max": 1.5000791767925281, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9227450980392156, "reward_component_totals/success_reward_min": 1.843, "reward_component_totals/success_reward_max": 1.964}, "hist_stats": {"episode_reward": [5.340487801296331, 5.373005082465946, 5.481365699046615, 5.407632401686667, 5.42315092786606, 5.545137272550157, 5.453883018486817, 5.626000288420278, 5.431862775934607, 5.0965571941133465, 5.580927753437928, 5.392302164475835, 5.350275512268534, 5.43558676262298, 5.265504404146778, 5.684186607514249, 5.504085021969384, 5.459667569173474, 5.694079176792528, 5.160246340831504, 5.619641805591928, 5.57826960321835, 5.569530107861257, 5.592691131254884, 5.5537972657840005, 5.338333504765842, 5.595633338815823, 5.270365146732782, 5.40511833135915, 5.4190250440102155, 5.254454931906138, 5.428761955849252, 5.275052874450131, 5.535063555399812, 5.471819985322837, 5.628581930490451, 5.120457824002827, 5.5422274480993705, 5.52684801770798, 5.164076514556784, 5.267497280553265, 5.35630707699563, 5.216349173309466, 5.233574464686671, 5.3125400107898555, 5.620832001984905, 5.695663038452302, 5.3635204517524535, 5.5275040175862795, 5.397624531394458, 5.452533910790399, 5.298352905637037, 5.143463028653752, 5.49783901748789, 5.568929129716878, 5.354042510754002, 5.49869057372104, 5.322013404897566, 5.283355362259671, 5.504068105241205, 5.180682410503219, 5.609130080341123, 5.49403294673514, 5.477149675633486, 5.53492463948696, 5.196471671243076, 5.534490051047635, 5.516158496444321, 5.498552978539284, 5.458426436937963, 5.336320427236517, 5.503851297794482, 5.667950103896547, 5.4938462460345034, 5.21941518529407, 5.335939692167402, 5.36193145930963, 5.362497487409222, 5.395728993105345, 5.5958045474877665, 5.551954154109239, 5.5286548255597525, 5.306434082020413, 5.520533811301268, 5.585282543020801, 5.538800006544708, 5.6088056504025765, 5.684126220947865, 5.489769231133575, 5.182626791525242, 5.193366374095854, 5.486457386300617, 5.562448120268064, 5.584798457682109, 5.347506641447145, 5.116284066068077, 5.611594045989161, 5.370276604244262, 5.634447269195187, 5.242871592402221, 5.160558800012654, 5.572154315760073], "episode_lengths": [74, 71, 156, 71, 79, 142, 47, 85, 98, 108, 56, 74, 55, 102, 75, 57, 84, 72, 56, 79, 65, 89, 101, 114, 89, 68, 63, 65, 51, 54, 53, 85, 52, 84, 70, 71, 94, 51, 107, 108, 59, 79, 67, 77, 64, 67, 54, 81, 84, 91, 57, 101, 68, 133, 53, 67, 82, 52, 87, 77, 64, 60, 49, 102, 66, 91, 139, 55, 62, 59, 50, 71, 59, 72, 42, 81, 122, 56, 80, 59, 88, 103, 57, 157, 75, 66, 79, 58, 77, 54, 61, 117, 49, 60, 72, 108, 88, 80, 61, 36, 113, 107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28756212301285444, "mean_inference_ms": 1.593808693353753, "mean_action_processing_ms": 0.1498711068976003, "mean_env_wait_ms": 2.936279149062743, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 823176, "agent_timesteps_total": 823176, "timers": {"sample_time_ms": 7586.274, "sample_throughput": 1053.482, "load_time_ms": 3.618, "load_throughput": 2208983.154, "learn_time_ms": 6665.7, "learn_throughput": 1198.974, "update_time_ms": 2.962}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03055214323103428, "policy_loss": -0.014926549978554249, "vf_loss": 0.042266394942998886, "vf_explained_var": 0.8389927744865417, "kl": 0.016061503440141678, "entropy": 0.7612127661705017, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 823176, "num_agent_steps_sampled": 823176, "num_steps_trained": 823176, "num_agent_steps_trained": 823176}, "done": false, "episodes_total": 8276, "training_iteration": 103, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-59-03", "timestamp": 1716404343, "time_this_iter_s": 14.333850145339966, "time_total_s": 1387.4035787582397, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1387.4035787582397, "timesteps_since_restore": 0, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 34.599999999999994, "ram_util_percent": 34.26666666666667}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.685930189773423, "episode_reward_min": 0.3270427577593207, "episode_reward_mean": 5.383015324919505, "episode_len_mean": 71.03539823008849, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9911504424778761, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.008849557522123894, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9823008849557524, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24778761061946902, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2502896612026912, "reward_component_totals/rejoin_dist_change_reward_min": 0.9483318712221458, "reward_component_totals/rejoin_dist_change_reward_max": 1.5014494817996693, "reward_component_totals/failure_reward_mean": -0.008849557522123894, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.911486725663717, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.964, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.194737310882823, 5.226394691443253, 5.509526297982643, 5.440518022834997, 5.685930189773423, 5.394139749804896, 5.233921121385824, 5.4914845595794635, 5.26209215059092, 5.214739411793557, 5.3457003663689235, 5.542674401161447, 5.418645229200923, 5.491816109905395, 5.198565742266474, 5.380835064415061, 5.380976569748913, 5.334725215620113, 5.3330138295831455, 5.31618491157319, 5.662090236063095, 5.585454833361474, 5.538345404285861, 5.458348984562752, 5.289960669060974, 5.641418161133627, 5.273916818090888, 5.165605379974258, 5.416399195797791, 5.465180613147145, 5.537424891469303, 5.5698223621405365, 5.682449481799669, 5.5193180357047655, 5.5845121404026195, 5.260108540683985, 5.289800493051194, 5.436059563661232, 5.60445682533272, 5.18851336767532, 5.387493218203357, 5.5714273518545365, 5.54448221577306, 5.238541984246311, 5.3553060861858, 5.261549556412977, 5.375183182562523, 5.462728267147219, 5.097452342498564, 5.316165827643745, 5.2715645981338985, 5.2043124282074285, 5.591021917097326, 5.6568366866112765, 5.582145923718063, 5.637655865753457, 5.295420946102766, 5.3221775072530475, 5.610321324482658, 5.5694716250446055, 5.5918004984234795, 5.544346997734607, 5.515134575149959, 5.574567578211708, 5.537905664402233, 5.623059892409394, 5.173695367190046, 5.468203105149099, 5.495429395063073, 5.622396248987105, 5.587218666456006, 5.147962434136323, 5.447297993660708, 5.468363024266547, 5.647687729570252, 5.509065267266399, 5.544012807469295, 5.585173686772835, 5.460327381130611, 5.579723980256319, 5.268942847256637, 5.246562821266597, 5.612416291537681, 5.628978219384594, 5.451229311122548, 5.4462256760247385, 5.430451063580357, 5.541647681978205, 5.58496639548938, 5.191134929266291, 5.230802294799583, 5.216609696485904, 5.471724726304187, 5.393341916162934, 5.108135715676775, 5.336991719675005, 5.588725480835695, 5.6209259814797825, 5.211450171746401, 5.297046349070621, 5.614989720044669, 5.1953758702431525, 5.366250366421017, 5.510853853213318, 5.4192445461117185, 5.3950807726568595, 0.3270427577593207, 5.415475605430412, 5.162331871222147, 5.615498672993401, 5.3191422223796785, 5.626260703969651, 5.394437372361609], "episode_lengths": [63, 69, 45, 84, 54, 65, 63, 127, 109, 78, 87, 66, 88, 103, 38, 55, 110, 88, 59, 127, 53, 87, 53, 78, 48, 49, 75, 49, 82, 58, 59, 56, 69, 52, 89, 44, 53, 61, 78, 94, 46, 116, 63, 59, 86, 73, 87, 81, 101, 71, 58, 46, 54, 58, 111, 50, 70, 83, 119, 117, 75, 68, 64, 66, 64, 58, 59, 81, 51, 73, 61, 82, 66, 58, 63, 71, 66, 80, 79, 75, 67, 54, 66, 44, 67, 66, 56, 51, 71, 55, 61, 49, 75, 63, 119, 47, 92, 76, 42, 57, 85, 73, 80, 136, 59, 64, 25, 92, 36, 80, 70, 97, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2872039687124559, "mean_inference_ms": 1.5948089358496553, "mean_action_processing_ms": 0.15000609008786506, "mean_env_wait_ms": 2.938923600211333, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 831168, "agent_timesteps_total": 831168, "timers": {"sample_time_ms": 7601.643, "sample_throughput": 1051.352, "load_time_ms": 3.626, "load_throughput": 2204262.267, "learn_time_ms": 6667.796, "learn_throughput": 1198.597, "update_time_ms": 2.981}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.054724376648664474, "policy_loss": -0.014108584262430668, "vf_loss": 0.06576977670192719, "vf_explained_var": 0.777411162853241, "kl": 0.015315922908484936, "entropy": 0.7009670734405518, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 831168, "num_agent_steps_sampled": 831168, "num_steps_trained": 831168, "num_agent_steps_trained": 831168}, "done": false, "episodes_total": 8389, "training_iteration": 104, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-59-17", "timestamp": 1716404357, "time_this_iter_s": 14.169265747070312, "time_total_s": 1401.57284450531, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1401.57284450531, "timesteps_since_restore": 0, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 34.394999999999996, "ram_util_percent": 34.20000000000001}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.687246207368264, "episode_reward_min": 5.134333761050972, "episode_reward_mean": 5.437352915748383, "episode_len_mean": 72.09821428571429, "episode_media": {}, "episodes_this_iter": 112, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2594511300340965, "reward_component_totals/rejoin_dist_change_reward_min": 0.9455077786832757, "reward_component_totals/rejoin_dist_change_reward_max": 1.5035609800739327, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9279017857142857, "reward_component_totals/success_reward_min": 1.853, "reward_component_totals/success_reward_max": 1.96}, "hist_stats": {"episode_reward": [5.38799151407969, 5.5158071706302305, 5.518085171973466, 5.31783004457408, 5.533312938902307, 5.497284191908459, 5.2905902580776205, 5.415513125407397, 5.327651273412791, 5.465034742815981, 5.155507778683276, 5.451802311485812, 5.301210523373026, 5.250671944310289, 5.2293965657352235, 5.374066760191022, 5.22416526975595, 5.491652259593863, 5.252464677899706, 5.325193005275132, 5.604503244851645, 5.266424804437511, 5.550837686189018, 5.40369430633863, 5.541315060048452, 5.453478547759543, 5.429285919712761, 5.301336063428007, 5.6266551692225235, 5.554497740933918, 5.378083260015682, 5.516443289155919, 5.561590679598764, 5.6845609800739325, 5.5621415743033715, 5.323513096074076, 5.560252637396046, 5.469841469456789, 5.6394939742545915, 5.1845606182721085, 5.6081063830228, 5.487763018744207, 5.378257687111779, 5.465729535844222, 5.547999988054313, 5.511565458072737, 5.299451381667756, 5.594696422869651, 5.401316952360467, 5.309871330546369, 5.220710122978245, 5.567758777505773, 5.474918862901502, 5.605613437881989, 5.6656272397751, 5.463308500881288, 5.494321653760425, 5.220680774923454, 5.517642538214101, 5.325918611517535, 5.374917270177459, 5.266058923570061, 5.2644432355587885, 5.609561731799785, 5.6142949538167155, 5.54781335378674, 5.186839455018855, 5.4675502741311, 5.606499138748629, 5.388205135232662, 5.362701686567435, 5.544704222917046, 5.3978866562524725, 5.306416310724181, 5.565301267616315, 5.300307012829853, 5.281878597096522, 5.271973870092353, 5.504313901599499, 5.444582096835148, 5.687246207368264, 5.526817702593037, 5.172147704759592, 5.258286277293527, 5.660690486189647, 5.534191501864865, 5.134333761050972, 5.666201151996888, 5.392140947965805, 5.309740953346022, 5.593472002235075, 5.476942763414389, 5.2957389865559215, 5.180425804251891, 5.4184579059527405, 5.462219064533141, 5.43133373685801, 5.547680405774616, 5.427556315167638, 5.663368269665531, 5.456674339987554, 5.375999651026012, 5.281152617767607, 5.61777739035827, 5.56271177602996, 5.600966332814092, 5.616418334063002, 5.496150347958686, 5.384842991491627, 5.457345185149218, 5.369075929883431, 5.520170295837849], "episode_lengths": [41, 71, 75, 88, 46, 65, 87, 67, 53, 122, 40, 51, 48, 60, 69, 110, 77, 72, 54, 57, 81, 109, 79, 64, 120, 62, 115, 53, 65, 54, 61, 94, 49, 69, 72, 98, 93, 147, 59, 85, 73, 93, 67, 110, 52, 78, 48, 128, 46, 90, 94, 52, 53, 77, 59, 57, 83, 75, 66, 68, 57, 53, 74, 51, 87, 131, 43, 65, 53, 45, 47, 97, 80, 75, 50, 62, 47, 56, 53, 110, 52, 85, 95, 70, 52, 78, 63, 54, 77, 74, 53, 61, 57, 102, 54, 89, 72, 81, 74, 86, 44, 67, 62, 69, 79, 46, 127, 52, 55, 90, 75, 93]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2903717315483122, "mean_inference_ms": 1.5984611356800862, "mean_action_processing_ms": 0.15021596469640902, "mean_env_wait_ms": 2.9426033785170835, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 839160, "agent_timesteps_total": 839160, "timers": {"sample_time_ms": 7603.666, "sample_throughput": 1051.072, "load_time_ms": 3.62, "load_throughput": 2207746.509, "learn_time_ms": 6658.714, "learn_throughput": 1200.232, "update_time_ms": 2.982}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0335296168923378, "policy_loss": -0.013287699781358242, "vf_loss": 0.04432949051260948, "vf_explained_var": 0.8154323101043701, "kl": 0.01243912149220705, "entropy": 0.687225878238678, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 839160, "num_agent_steps_sampled": 839160, "num_steps_trained": 839160, "num_agent_steps_trained": 839160}, "done": false, "episodes_total": 8501, "training_iteration": 105, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-59-31", "timestamp": 1716404371, "time_this_iter_s": 14.134111166000366, "time_total_s": 1415.7069556713104, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1415.7069556713104, "timesteps_since_restore": 0, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 34.765, "ram_util_percent": 34.29999999999999}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.715288610127407, "episode_reward_min": 5.097812634590815, "episode_reward_mean": 5.441478482088279, "episode_len_mean": 72.4862385321101, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2639647206203901, "reward_component_totals/rejoin_dist_change_reward_min": 0.9248126345908139, "reward_component_totals/rejoin_dist_change_reward_max": 1.5201288292589967, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.92751376146789, "reward_component_totals/success_reward_min": 1.863, "reward_component_totals/success_reward_max": 1.962}, "hist_stats": {"episode_reward": [5.2958532147524995, 5.186329174267601, 5.596003499113593, 5.4003129629185915, 5.1469729359883525, 5.544224067564624, 5.167571473185248, 5.485604836242064, 5.48708714067871, 5.2978682265035655, 5.196869803873201, 5.569487949936976, 5.510732554874881, 5.692065413011181, 5.123189848311448, 5.515529424626725, 5.508210844166221, 5.715288610127407, 5.611103681726015, 5.278925105130835, 5.269210835593427, 5.210223914145632, 5.318960191384912, 5.6461426038548765, 5.491657646997053, 5.111046827930242, 5.334217453678484, 5.4535563691829765, 5.470279566082691, 5.629514871192154, 5.345283545512526, 5.486766373931747, 5.376564922455603, 5.306055803805055, 5.4900304750397115, 5.273028023628041, 5.450254660079623, 5.633948266369593, 5.4753724935825705, 5.41489121567907, 5.554488336184785, 5.614163763160615, 5.158431926854355, 5.532707096082396, 5.613559821738005, 5.496542681129665, 5.448431446338972, 5.5394347375534885, 5.375108582081015, 5.359640427989083, 5.227676791246518, 5.475907244037974, 5.570195765555329, 5.437627368751762, 5.466210647115785, 5.152150594433458, 5.316324730473495, 5.56602050971938, 5.584703519327741, 5.6913905765224015, 5.413876061045042, 5.097812634590815, 5.64654223341709, 5.416046214153932, 5.536021620766588, 5.405551802217841, 5.288659618435693, 5.347259036424908, 5.46996498122416, 5.402790217109793, 5.347016315387469, 5.562386229584279, 5.44423643969748, 5.22692663118384, 5.535820911627596, 5.314404484851981, 5.432109891655072, 5.581355959836658, 5.533017662684918, 5.247392750608606, 5.571599881753931, 5.403523133724543, 5.371848344953687, 5.673254499500317, 5.371739532197036, 5.677128829258996, 5.414367772544624, 5.560353284959678, 5.594885392808348, 5.38379968554868, 5.435041638147425, 5.579757351272475, 5.363106938941082, 5.369035498087518, 5.656364457326024, 5.603183924335877, 5.633746207013883, 5.308340216127393, 5.48771951782491, 5.157316453179014, 5.428532021769106, 5.556814555057633, 5.674753166789578, 5.583902815477739, 5.498884184729875, 5.495176659885627, 5.604333665064315, 5.493749334555486, 5.2227504948619945], "episode_lengths": [61, 58, 58, 75, 117, 130, 122, 81, 77, 62, 38, 64, 93, 55, 89, 60, 46, 51, 64, 63, 83, 41, 94, 77, 82, 71, 59, 47, 72, 55, 79, 63, 55, 69, 47, 127, 55, 54, 53, 77, 125, 51, 63, 70, 112, 55, 54, 78, 51, 56, 75, 108, 73, 84, 77, 73, 73, 65, 64, 57, 84, 77, 47, 87, 93, 61, 44, 61, 51, 46, 55, 79, 81, 93, 45, 91, 79, 118, 87, 44, 131, 53, 49, 52, 93, 93, 71, 48, 51, 65, 95, 86, 91, 94, 57, 66, 62, 86, 62, 40, 137, 45, 65, 59, 47, 130, 76, 69, 117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2894875676952926, "mean_inference_ms": 1.5990947262770159, "mean_action_processing_ms": 0.15034939746085307, "mean_env_wait_ms": 2.9458026301962295, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 847152, "agent_timesteps_total": 847152, "timers": {"sample_time_ms": 7611.32, "sample_throughput": 1050.015, "load_time_ms": 3.593, "load_throughput": 2224034.976, "learn_time_ms": 6646.34, "learn_throughput": 1202.466, "update_time_ms": 2.967}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03608524426817894, "policy_loss": -0.012267300859093666, "vf_loss": 0.04494792968034744, "vf_explained_var": 0.8226491212844849, "kl": 0.017023086547851562, "entropy": 0.6935647130012512, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 847152, "num_agent_steps_sampled": 847152, "num_steps_trained": 847152, "num_agent_steps_trained": 847152}, "done": false, "episodes_total": 8610, "training_iteration": 106, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-59-45", "timestamp": 1716404385, "time_this_iter_s": 14.091177225112915, "time_total_s": 1429.7981328964233, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1429.7981328964233, "timesteps_since_restore": 0, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 35.07, "ram_util_percent": 34.28000000000001}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.711637663851629, "episode_reward_min": 5.121571490839235, "episode_reward_mean": 5.443866615489298, "episode_len_mean": 75.4766355140187, "episode_media": {}, "episodes_this_iter": 107, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2693432510033167, "reward_component_totals/rejoin_dist_change_reward_min": 0.923571490839235, "reward_component_totals/rejoin_dist_change_reward_max": 1.524637663851629, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9245233644859814, "reward_component_totals/success_reward_min": 1.838, "reward_component_totals/success_reward_max": 1.9609999999999999}, "hist_stats": {"episode_reward": [5.545447139888147, 5.455684474583496, 5.606141655619102, 5.619579994237694, 5.6665064231307785, 5.248753656347432, 5.546351065500254, 5.569887212212172, 5.486285244382836, 5.4439475772129455, 5.6160287069805666, 5.543533386330265, 5.4970728247549525, 5.417479332249963, 5.256645095675212, 5.480417839588862, 5.215824759941481, 5.356641208253121, 5.538091859921928, 5.278598703677812, 5.456331047215535, 5.651004977617261, 5.542364581950657, 5.395349126050247, 5.27789188798357, 5.342649211647533, 5.437952110559543, 5.336290614487344, 5.3353545888931375, 5.4405638826685845, 5.311124801208834, 5.427446517029596, 5.153399074543126, 5.711637663851629, 5.279009661780561, 5.583709901097498, 5.451724989729064, 5.354255160524657, 5.554211570767885, 5.44280233844487, 5.366448389072794, 5.40150836407299, 5.331961443299596, 5.6198605903197745, 5.2985463475145185, 5.325174866400225, 5.34606361789338, 5.582689548689778, 5.329361012201675, 5.508143406937934, 5.685999681860574, 5.436247495613523, 5.354551558721805, 5.542653458163698, 5.324992674517937, 5.30112818518048, 5.562275649636071, 5.510028358777217, 5.126968722993153, 5.30665515395725, 5.292591445868593, 5.2312975254808425, 5.536686058721786, 5.660088032772952, 5.390993752121549, 5.588615071323446, 5.251139458779647, 5.2466710973384405, 5.6963018878231075, 5.25243273954273, 5.563928905615844, 5.424807701844129, 5.454782445470313, 5.389874351074488, 5.517455524539187, 5.54618238664077, 5.54429022994952, 5.331985915069186, 5.455050901277262, 5.289746791995147, 5.651771453465569, 5.6632568935625, 5.540337522309406, 5.57723705816878, 5.496427465782497, 5.60645879266644, 5.565209635145148, 5.294869645823194, 5.378962579734794, 5.608116055125198, 5.291308796693238, 5.262226003595791, 5.121571490839235, 5.568595636496587, 5.414021052208998, 5.482452909912626, 5.2305789332955275, 5.5360689047630345, 5.465259130058721, 5.5089797565417875, 5.508928400700984, 5.598855405744384, 5.6551643313836655, 5.536858835781155, 5.621791608612785, 5.363255147939267, 5.144991793390057], "episode_lengths": [84, 101, 60, 57, 52, 79, 53, 133, 88, 52, 98, 105, 105, 67, 129, 55, 94, 52, 115, 54, 82, 96, 79, 66, 102, 74, 50, 82, 83, 52, 72, 103, 39, 63, 100, 63, 80, 73, 111, 57, 57, 107, 55, 46, 57, 52, 57, 56, 46, 64, 55, 54, 132, 91, 70, 56, 66, 104, 112, 88, 53, 76, 51, 65, 90, 51, 71, 91, 49, 68, 55, 62, 48, 57, 95, 73, 104, 91, 117, 96, 63, 65, 59, 124, 133, 51, 81, 50, 45, 94, 48, 72, 52, 59, 162, 74, 55, 85, 93, 76, 79, 102, 55, 58, 54, 73, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2879601161574265, "mean_inference_ms": 1.598255262617562, "mean_action_processing_ms": 0.15028630912293278, "mean_env_wait_ms": 2.9456537508373692, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 855144, "agent_timesteps_total": 855144, "timers": {"sample_time_ms": 7519.228, "sample_throughput": 1062.875, "load_time_ms": 3.519, "load_throughput": 2270831.39, "learn_time_ms": 6569.341, "learn_throughput": 1216.56, "update_time_ms": 2.976}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.032493989914655685, "policy_loss": -0.013500466011464596, "vf_loss": 0.043609969317913055, "vf_explained_var": 0.8361693620681763, "kl": 0.01192246749997139, "entropy": 0.7350956797599792, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 855144, "num_agent_steps_sampled": 855144, "num_steps_trained": 855144, "num_agent_steps_trained": 855144}, "done": false, "episodes_total": 8717, "training_iteration": 107, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_14-59-59", "timestamp": 1716404399, "time_this_iter_s": 13.28748893737793, "time_total_s": 1443.0856218338013, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1443.0856218338013, "timesteps_since_restore": 0, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 33.873684210526314, "ram_util_percent": 34.126315789473686}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.692513000190262, "episode_reward_min": 5.1324116994559175, "episode_reward_mean": 5.428579544317162, "episode_len_mean": 72.07339449541284, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2506529388125753, "reward_component_totals/rejoin_dist_change_reward_min": 0.9304116994559173, "reward_component_totals/rejoin_dist_change_reward_max": 1.5085130001902631, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9279266055045874, "reward_component_totals/success_reward_min": 1.8639999999999999, "reward_component_totals/success_reward_max": 1.963}, "hist_stats": {"episode_reward": [5.334907360627567, 5.555643080828683, 5.193213576889677, 5.229066770378473, 5.36661447758863, 5.667233689339452, 5.622526267969572, 5.423939894993952, 5.663926660721662, 5.50390663441685, 5.573473524149286, 5.356913221863159, 5.321832228543419, 5.368051567175435, 5.373625527910432, 5.555993486395807, 5.220303898792359, 5.460782104505451, 5.2443416037754815, 5.422027498359135, 5.480266689858039, 5.132938652832474, 5.571223381374912, 5.29448974007218, 5.546472849052845, 5.585823196666071, 5.4431462460301265, 5.467277800224711, 5.63186004706669, 5.2677971409120286, 5.431355386283332, 5.325231473007973, 5.575983363719299, 5.425972353844779, 5.134821878299819, 5.63730067152931, 5.51680545135432, 5.301559858405954, 5.39338970794405, 5.606857960510212, 5.61676900977871, 5.642317491014868, 5.3286625507708365, 5.343693308402862, 5.552021568617214, 5.291802818270014, 5.201701230435983, 5.493576565442272, 5.591635330723488, 5.555697015429858, 5.343542428127245, 5.5002178282665675, 5.149113108596199, 5.337688750753456, 5.339356591325742, 5.353626380881188, 5.260420811849709, 5.308052988897083, 5.526990672713033, 5.644976669896716, 5.224931053816778, 5.437447668757976, 5.1324116994559175, 5.1891107587474465, 5.585209269727345, 5.577012358161363, 5.2024317223546515, 5.522004500997065, 5.630382033667854, 5.496650497800319, 5.497160559355967, 5.206404821533981, 5.6222532071578755, 5.650528375986978, 5.230334429445522, 5.357276280291424, 5.374975302744458, 5.363645584726916, 5.4099696669157336, 5.692513000190262, 5.253627631571912, 5.245697217441347, 5.546875805290711, 5.294833145959952, 5.49788031604125, 5.667645626604828, 5.450398670804799, 5.362777056407101, 5.2646862131572005, 5.544673294806623, 5.617762123059553, 5.384677671058514, 5.31675829677825, 5.211908421590679, 5.514122708514016, 5.466758689496505, 5.477045272424276, 5.53828874048628, 5.384902022833475, 5.659680818352282, 5.536458506572805, 5.516493940549932, 5.53317030865095, 5.408150879935109, 5.481485953811333, 5.180016037406453, 5.368697882843106, 5.688960987862352, 5.287323254016635], "episode_lengths": [80, 54, 70, 74, 45, 57, 67, 85, 48, 64, 57, 54, 87, 60, 58, 106, 73, 126, 73, 82, 63, 60, 56, 54, 69, 103, 72, 112, 68, 62, 64, 49, 61, 57, 46, 69, 87, 45, 136, 74, 86, 65, 92, 121, 126, 86, 51, 72, 120, 102, 81, 44, 115, 74, 79, 59, 37, 69, 69, 53, 65, 42, 48, 81, 95, 77, 49, 80, 66, 56, 76, 127, 60, 71, 113, 78, 73, 82, 42, 66, 43, 56, 119, 112, 93, 55, 47, 63, 72, 59, 66, 40, 77, 55, 51, 69, 48, 68, 48, 57, 63, 84, 49, 84, 83, 84, 125, 63, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29033669245448707, "mean_inference_ms": 1.5992851514021278, "mean_action_processing_ms": 0.15047383684078788, "mean_env_wait_ms": 2.945493713321212, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 863136, "agent_timesteps_total": 863136, "timers": {"sample_time_ms": 7453.402, "sample_throughput": 1072.262, "load_time_ms": 3.464, "load_throughput": 2307090.923, "learn_time_ms": 6530.632, "learn_throughput": 1223.771, "update_time_ms": 2.972}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0353485643863678, "policy_loss": -0.012461390346288681, "vf_loss": 0.04529007524251938, "vf_explained_var": 0.8198804259300232, "kl": 0.012599390000104904, "entropy": 0.7032279968261719, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 863136, "num_agent_steps_sampled": 863136, "num_steps_trained": 863136, "num_agent_steps_trained": 863136}, "done": false, "episodes_total": 8826, "training_iteration": 108, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-00-12", "timestamp": 1716404412, "time_this_iter_s": 13.102035760879517, "time_total_s": 1456.1876575946808, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1456.1876575946808, "timesteps_since_restore": 0, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 34.14736842105263, "ram_util_percent": 34.021052631578954}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.692807184517293, "episode_reward_min": 0.17812410360637232, "episode_reward_mean": 5.402445482454016, "episode_len_mean": 73.34545454545454, "episode_media": {}, "episodes_this_iter": 110, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.990909090909091, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.00909090909090909, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9818181818181821, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24772727272727274, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.273372755181289, "reward_component_totals/rejoin_dist_change_reward_min": 0.9564936253312972, "reward_component_totals/rejoin_dist_change_reward_max": 1.493807184517293, "reward_component_totals/failure_reward_mean": -0.00909090909090909, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.908618181818182, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.9609999999999999, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.564109308879841, 5.249576593452099, 5.417625720237961, 5.310752367625989, 5.311192806619442, 5.321005939479952, 5.4759125434541005, 5.673609344811306, 5.544168414911219, 5.39705362549735, 5.515185697709668, 5.491147829676031, 5.641599696150694, 5.2166425805075916, 5.65863756852897, 5.543405570385486, 5.4269746719473755, 5.580959045247534, 5.617563909787168, 5.468269025191464, 5.323779928087047, 5.409808696730304, 5.461405412302979, 5.399600089986608, 5.576656640208849, 5.571091359236429, 5.3094326149786175, 5.613726102046647, 5.333948594493111, 5.3102940755734505, 5.586102569944949, 5.606142228462284, 5.609125619498858, 5.502116281638905, 5.3446812184663255, 5.255186443043099, 5.447521483477034, 5.511038316173865, 5.447539958077105, 5.6661532609631236, 5.196368816050089, 0.17812410360637232, 5.598161742775021, 5.246329816915485, 5.4155587319931175, 5.3894655536633325, 5.252434851984566, 5.625423554275118, 5.274445439572807, 5.513742535142722, 5.532920895435747, 5.22425174911493, 5.578642228738044, 5.358584520121494, 5.4927872703142855, 5.338233142562036, 5.366572718487711, 5.317957811860201, 5.620202558100173, 5.517320567958081, 5.349333161118118, 5.376075998849246, 5.540846363408621, 5.64225554886975, 5.32867566093968, 5.3132187906735115, 5.525514591639874, 5.446370522916514, 5.456482114225036, 5.398070521600551, 5.23112070667314, 5.596841558319898, 5.2011117163891925, 5.670348939864571, 5.4079921651973475, 5.1494936253312975, 5.315669146505748, 5.5955705640950955, 5.466366734588556, 5.586577260324758, 5.4742503026714, 5.350650666615599, 5.480690768273545, 5.634804844972569, 5.3993326088308535, 5.617697179591802, 5.61122414289568, 5.424065931719502, 5.692807184517293, 5.216491161003365, 5.583348945186728, 5.5848795638352495, 5.406272843576122, 5.649099910088928, 5.55401335870906, 5.5151565632473964, 5.404135591253699, 5.409023367788602, 5.45011670509788, 5.359980598625972, 5.306618109515579, 5.563072128551511, 5.521084761815544, 5.203831647574594, 5.3150936683704195, 5.328140889744991, 5.551819361260801, 5.4161422794716545, 5.627758914109252, 5.271191617333532], "episode_lengths": [88, 68, 71, 62, 100, 65, 95, 61, 50, 119, 122, 46, 94, 41, 63, 87, 45, 61, 111, 86, 67, 59, 43, 54, 68, 101, 102, 66, 58, 75, 52, 112, 56, 65, 70, 49, 106, 70, 127, 55, 50, 16, 66, 113, 54, 103, 62, 72, 53, 51, 94, 64, 111, 137, 65, 55, 53, 63, 50, 48, 49, 75, 77, 56, 76, 81, 64, 95, 73, 137, 64, 65, 49, 67, 60, 57, 59, 48, 55, 48, 55, 55, 85, 93, 107, 52, 121, 81, 51, 103, 76, 80, 62, 75, 50, 81, 92, 122, 44, 77, 57, 126, 138, 57, 45, 50, 100, 39, 83, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2892462333823625, "mean_inference_ms": 1.597986354480908, "mean_action_processing_ms": 0.15027175057927755, "mean_env_wait_ms": 2.9435649420681123, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 871128, "agent_timesteps_total": 871128, "timers": {"sample_time_ms": 7336.667, "sample_throughput": 1089.323, "load_time_ms": 3.483, "load_throughput": 2294536.078, "learn_time_ms": 6498.453, "learn_throughput": 1229.831, "update_time_ms": 2.948}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03708061948418617, "policy_loss": -0.011629131622612476, "vf_loss": 0.045831918716430664, "vf_explained_var": 0.8380877375602722, "kl": 0.01438910048455, "entropy": 0.6987532377243042, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 871128, "num_agent_steps_sampled": 871128, "num_steps_trained": 871128, "num_agent_steps_trained": 871128}, "done": false, "episodes_total": 8936, "training_iteration": 109, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-00-24", "timestamp": 1716404424, "time_this_iter_s": 12.4700767993927, "time_total_s": 1468.6577343940735, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1468.6577343940735, "timesteps_since_restore": 0, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 33.48888888888889, "ram_util_percent": 34.1}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.658237650612684, "episode_reward_min": 0.3284766358317375, "episode_reward_mean": 5.377709157957107, "episode_len_mean": 74.77570093457943, "episode_media": {}, "episodes_this_iter": 107, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9906542056074766, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.009345794392523364, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9813084112149535, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24766355140186916, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2513914009477611, "reward_component_totals/rejoin_dist_change_reward_min": 0.9433287549378293, "reward_component_totals/rejoin_dist_change_reward_max": 1.4962376506126855, "reward_component_totals/failure_reward_mean": -0.009345794392523364, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9066915887850469, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.9609999999999999, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.352626961929465, 5.35727591612735, 5.308006962425214, 5.51524916981024, 5.529096403497052, 5.534918580680538, 5.52247528679942, 5.273397406398603, 5.627983007792832, 5.33145382794279, 5.47129009900274, 5.421250345562287, 5.412940824656506, 5.442146733978898, 5.133328754937828, 5.260632556994551, 5.497156282380304, 5.598335438008238, 5.5849714765910505, 5.414814311348959, 5.4689786740794695, 5.55023356818433, 5.550172967717918, 5.439118740395555, 5.339898863036022, 5.407426033089771, 5.603731424828542, 5.407869963778694, 5.567112942178774, 5.543285937795467, 5.532747586402953, 5.3764799922397195, 5.411527011326518, 5.588273155473931, 5.22376891061819, 5.537794392958141, 5.594522625874445, 5.331856496194456, 5.4616294858993495, 5.43930292701071, 5.431089644386001, 5.599413701185302, 5.244813598757732, 5.242891006974149, 5.514772986061846, 5.214340681875655, 5.490373947811956, 5.374830896036537, 0.3284766358317375, 5.606058719432887, 5.319301071017083, 5.321389128434166, 5.4282382673244225, 5.4088640325858135, 5.285833646576757, 5.302762690041765, 5.484272319293201, 5.398183299994587, 5.39629385513927, 5.245483578795484, 5.262799187999187, 5.328606307061646, 5.445243935987834, 5.28224379334095, 5.537066471602653, 5.559390395429716, 5.203038163577798, 5.424151068213369, 5.305700008830568, 5.4074955933074165, 5.5128856613189345, 5.589070899467757, 5.524800203923783, 5.433866122842463, 5.3920294910124005, 5.538845890964186, 5.18279996984141, 5.606241025183563, 5.285906145350197, 5.561122104047972, 5.658237650612684, 5.507492757551747, 5.593017582551277, 5.339464622719294, 5.579655922123121, 5.222311544741652, 5.416857887674586, 5.55555938052054, 5.587279283302861, 5.219199740085058, 5.17085130608545, 5.377607718551282, 5.557047398149895, 5.28671756933006, 5.126155403787809, 5.459471507682539, 5.44435320284183, 5.331327112955874, 5.504323238949992, 5.43004929240187, 5.167536386056156, 5.539009311756319, 5.522579226273568, 5.390051166009479, 5.400475582781109, 5.5854833323057935, 5.456696580800651], "episode_lengths": [48, 106, 73, 96, 63, 107, 79, 57, 62, 56, 92, 80, 78, 70, 60, 61, 93, 63, 114, 93, 50, 53, 74, 63, 50, 70, 58, 43, 80, 92, 79, 95, 54, 129, 58, 83, 96, 68, 63, 87, 100, 96, 58, 56, 52, 92, 139, 136, 17, 101, 68, 90, 54, 111, 49, 94, 67, 73, 60, 84, 86, 88, 50, 64, 87, 72, 75, 50, 49, 78, 71, 113, 76, 115, 58, 77, 60, 76, 71, 95, 88, 70, 54, 63, 66, 93, 49, 75, 43, 58, 94, 50, 101, 57, 87, 46, 66, 111, 68, 73, 39, 95, 59, 49, 53, 129, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28941387903170235, "mean_inference_ms": 1.5961001363526919, "mean_action_processing_ms": 0.1501096666066116, "mean_env_wait_ms": 2.940436378385876, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 879120, "agent_timesteps_total": 879120, "timers": {"sample_time_ms": 7204.482, "sample_throughput": 1109.309, "load_time_ms": 3.452, "load_throughput": 2315473.449, "learn_time_ms": 6442.298, "learn_throughput": 1240.551, "update_time_ms": 2.951}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04170544818043709, "policy_loss": -0.012934694066643715, "vf_loss": 0.05201129987835884, "vf_explained_var": 0.8044527173042297, "kl": 0.01314421184360981, "entropy": 0.7350856065750122, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 879120, "num_agent_steps_sampled": 879120, "num_steps_trained": 879120, "num_agent_steps_trained": 879120}, "done": false, "episodes_total": 9043, "training_iteration": 110, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-00-36", "timestamp": 1716404436, "time_this_iter_s": 12.252440452575684, "time_total_s": 1480.9101748466492, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1480.9101748466492, "timesteps_since_restore": 0, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 32.76111111111112, "ram_util_percent": 34.183333333333344}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.6529914351415, "episode_reward_min": 0.29148409732068825, "episode_reward_mean": 5.371916306731476, "episode_len_mean": 71.45535714285714, "episode_media": {}, "episodes_this_iter": 112, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9910714285714286, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.008928571428571428, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9821428571428574, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24776785714285715, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2401038067314756, "reward_component_totals/rejoin_dist_change_reward_min": 0.9943583802585201, "reward_component_totals/rejoin_dist_change_reward_max": 1.4970823008840561, "reward_component_totals/failure_reward_mean": -0.008928571428571428, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.910830357142857, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.962, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.374761724727151, 5.427259821088594, 5.168551902285384, 5.567380924169392, 5.510992743439575, 5.271627469396487, 5.275934802104842, 5.530655447985794, 5.287365723059834, 5.377152430539876, 5.230317883684794, 5.253924576600268, 5.579170302157028, 5.514300742197154, 0.29148409732068825, 5.351891819762704, 5.251825949688998, 5.458215425378643, 5.503678131083996, 5.574249934390622, 5.550914549807683, 5.42441614411185, 5.528775873834956, 5.2275419654707065, 5.458507503788434, 5.494023507852619, 5.63376351460364, 5.447205177087071, 5.511136547447909, 5.277592076303733, 5.291834004467579, 5.309011354246465, 5.592790502807656, 5.239045409383198, 5.314464659178619, 5.5379484748176155, 5.299934130258194, 5.531052324385887, 5.249436044551987, 5.259978318584126, 5.404680598670865, 5.64887462538298, 5.20452713494436, 5.289209398336649, 5.242291401617338, 5.461490571738867, 5.450837003629623, 5.34158429917105, 5.5553852476376395, 5.523758976536595, 5.313191753577344, 5.263334629508398, 5.492791140099387, 5.392536749105306, 5.364579433758401, 5.359647810115591, 5.47991234617788, 5.270242038045916, 5.489960117641351, 5.594521599180758, 5.531871379557929, 5.45043401526202, 5.556346239665615, 5.44339421592686, 5.5664522327971, 5.369624471360253, 5.4913808576068295, 5.337155825551358, 5.279281996743155, 5.337440739075284, 5.648650928496602, 5.295543899393818, 5.285170865411361, 5.429517272894461, 5.243534906739779, 5.226961904164607, 5.3885635434511805, 5.507149958398422, 5.515860444270162, 5.432743761683074, 5.532884751882335, 5.434198652454288, 5.460780836815047, 5.244290525506927, 5.599883233082526, 5.6440823008840555, 5.6152051543549435, 5.5656240145486375, 5.327386902325709, 5.5548127153842195, 5.555384755961336, 5.309837499711703, 5.19235838025852, 5.164893803635083, 5.295845215332934, 5.478731728383144, 5.392636455092883, 5.437828279211215, 5.541129774835444, 5.471401045139244, 5.504027674686499, 5.562154159207228, 5.272654572087881, 5.597975692155166, 5.406391873282088, 5.418468209882006, 5.360215535273952, 5.428027062329991, 5.51003326656773, 5.6529914351415, 5.442996417601417, 5.218944163531722], "episode_lengths": [45, 73, 121, 54, 72, 50, 45, 55, 52, 54, 87, 61, 68, 78, 16, 72, 48, 48, 68, 70, 76, 44, 58, 74, 81, 56, 86, 70, 53, 65, 75, 100, 82, 38, 50, 81, 84, 64, 84, 89, 128, 62, 72, 55, 48, 46, 102, 74, 87, 56, 79, 62, 63, 47, 73, 71, 85, 43, 76, 65, 98, 101, 54, 81, 116, 96, 64, 41, 39, 42, 79, 96, 83, 104, 38, 138, 85, 95, 48, 58, 45, 63, 81, 57, 68, 103, 71, 91, 57, 74, 54, 87, 52, 93, 44, 122, 49, 120, 109, 75, 72, 78, 112, 73, 102, 100, 73, 48, 57, 52, 45, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2911627700000466, "mean_inference_ms": 1.595389201703739, "mean_action_processing_ms": 0.14996808904747277, "mean_env_wait_ms": 2.9395337804562827, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 887112, "agent_timesteps_total": 887112, "timers": {"sample_time_ms": 7095.506, "sample_throughput": 1126.347, "load_time_ms": 3.547, "load_throughput": 2253322.594, "learn_time_ms": 6370.257, "learn_throughput": 1254.58, "update_time_ms": 2.935}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04638383537530899, "policy_loss": -0.010429179295897484, "vf_loss": 0.05441649258136749, "vf_explained_var": 0.8026326298713684, "kl": 0.011982666328549385, "entropy": 0.697136402130127, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 887112, "num_agent_steps_sampled": 887112, "num_steps_trained": 887112, "num_agent_steps_trained": 887112}, "done": false, "episodes_total": 9155, "training_iteration": 111, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-00-49", "timestamp": 1716404449, "time_this_iter_s": 12.715664863586426, "time_total_s": 1493.6258397102356, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1493.6258397102356, "timesteps_since_restore": 0, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 33.605555555555554, "ram_util_percent": 34.20000000000001}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.696510660923488, "episode_reward_min": 0.21594323729152043, "episode_reward_mean": 5.371199338816649, "episode_len_mean": 75.21698113207547, "episode_media": {}, "episodes_this_iter": 106, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9905660377358491, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.009433962264150943, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9811320754716983, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24764150943396226, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2457653765524992, "reward_component_totals/rejoin_dist_change_reward_min": 0.9492722411969337, "reward_component_totals/rejoin_dist_change_reward_max": 1.5045106609234886, "reward_component_totals/failure_reward_mean": -0.009433962264150943, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9060943396226415, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.96, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.509650692037384, 5.454450932807683, 5.3721406655601776, 5.34874395290473, 5.251237635654576, 5.368037518856331, 5.670290373618531, 5.309020597678563, 5.542969207076795, 5.140276603303069, 5.551785132890669, 5.586648326190696, 5.579166051170078, 5.600446630917386, 5.448859796332295, 0.21594323729152043, 5.641524395822409, 5.328138506303976, 5.219932216143782, 5.28385796466612, 5.403713542618151, 5.622692568321646, 5.533445045481432, 5.315956208877152, 5.209436610431185, 5.263437243804905, 5.372538349983999, 5.617925578951244, 5.400590024837438, 5.453484521993115, 5.4225940452936445, 5.63858047538195, 5.492117024964939, 5.668966441592271, 5.584111386202314, 5.528256001825877, 5.45379398737956, 5.460402380795069, 5.569841606042527, 5.546929491030667, 5.552435154576157, 5.381350010867605, 5.567576828472125, 5.355493874069111, 5.557141455719722, 5.610858785531834, 5.44769683033962, 5.281202332115816, 5.382315878109018, 5.149272241196934, 5.494497407467222, 5.5536686875400925, 5.4752081413916205, 5.285224956918814, 5.360741610579888, 5.25424096162307, 5.451513746341214, 5.207570458943069, 5.1377320939091105, 5.696510660923488, 5.653137086376645, 5.533178869663105, 5.311195866282436, 5.300445688136156, 5.597508296725408, 5.1842809749130865, 5.619499869638316, 5.181018519887953, 5.421871750201868, 5.586041533736409, 5.383940267329427, 5.301141374060235, 5.554457931759204, 5.338037425776484, 5.400188838256355, 5.217438331176066, 5.637245156589195, 5.194012343401237, 5.47498967089589, 5.255781606155435, 5.393346789674217, 5.263803280907686, 5.258533693478842, 5.498959964343738, 5.3163117896011585, 5.663543801479613, 5.673264144908898, 5.211283568464319, 5.2861779941742935, 5.275075187714354, 5.229355768443705, 5.505622091609016, 5.292045860741174, 5.322579671101572, 5.43966816527746, 5.354532569190614, 5.3161386709629905, 5.486253177193772, 5.440529181266154, 5.462942191806475, 5.364069767023089, 5.493854829611409, 5.370547021217055, 5.219003870323867, 5.254503562673127, 5.625586810744036], "episode_lengths": [109, 73, 71, 47, 57, 44, 60, 61, 107, 92, 74, 88, 57, 91, 48, 19, 61, 86, 94, 102, 95, 62, 90, 57, 88, 58, 82, 89, 140, 84, 90, 58, 66, 69, 52, 54, 63, 46, 118, 151, 68, 130, 112, 49, 55, 66, 45, 77, 51, 50, 77, 60, 49, 80, 62, 71, 72, 56, 95, 58, 77, 76, 47, 51, 75, 75, 58, 120, 52, 87, 95, 77, 133, 76, 65, 58, 62, 48, 110, 110, 42, 57, 60, 74, 79, 88, 78, 97, 55, 73, 80, 103, 72, 40, 130, 65, 64, 93, 45, 97, 75, 101, 77, 51, 123, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29034160380525964, "mean_inference_ms": 1.5953623611155685, "mean_action_processing_ms": 0.14992277837312998, "mean_env_wait_ms": 2.938388162960003, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 895104, "agent_timesteps_total": 895104, "timers": {"sample_time_ms": 6982.722, "sample_throughput": 1144.539, "load_time_ms": 3.486, "load_throughput": 2292307.947, "learn_time_ms": 6305.285, "learn_throughput": 1267.508, "update_time_ms": 2.945}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04281873255968094, "policy_loss": -0.014223705045878887, "vf_loss": 0.054005734622478485, "vf_explained_var": 0.8075157403945923, "kl": 0.01518351398408413, "entropy": 0.7677452564239502, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 895104, "num_agent_steps_sampled": 895104, "num_steps_trained": 895104, "num_agent_steps_trained": 895104}, "done": false, "episodes_total": 9261, "training_iteration": 112, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-01-02", "timestamp": 1716404462, "time_this_iter_s": 12.543172121047974, "time_total_s": 1506.1690118312836, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1506.1690118312836, "timesteps_since_restore": 0, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 33.800000000000004, "ram_util_percent": 34.29999999999999}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.656331213461584, "episode_reward_min": 0.12392384311870286, "episode_reward_mean": 5.34965157382624, "episode_len_mean": 78.55445544554455, "episode_media": {}, "episodes_this_iter": 101, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9801980198019802, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.019801980198019802, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9603960396039606, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24504950495049505, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2818198906579228, "reward_component_totals/rejoin_dist_change_reward_min": 0.9800687334169538, "reward_component_totals/rejoin_dist_change_reward_max": 1.5003312134615847, "reward_component_totals/failure_reward_mean": -0.019801980198019802, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.882188118811881, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.9569999999999999, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.284391793263828, 5.507176114101638, 5.28728940103678, 5.573662005286554, 5.603567468102412, 5.378653561455483, 5.521972868202807, 5.494409966908329, 5.363588592024116, 5.472867053852639, 5.348697382900124, 5.1937412955925195, 5.486663566039155, 5.303304311298601, 5.302870884762618, 5.201290683665308, 5.606857846449211, 5.191592264862743, 5.314412023324678, 5.559534888555776, 5.6158767373819325, 0.12392384311870286, 5.438779768741289, 5.404042855414852, 5.570045270060774, 5.249646943186155, 5.281463410445317, 5.36125339407243, 5.285286792146277, 5.428230366410008, 5.617049139122981, 5.632932891383778, 5.276223575663458, 5.436372914860794, 5.626910521339408, 5.527678547720901, 5.49449169402114, 5.476559571270649, 5.495466173592343, 5.312791643889293, 5.5657072940109185, 5.552909026887012, 5.290018604463888, 5.358993814223357, 5.441402747768523, 5.545236385489979, 5.525509863367052, 5.593213069986123, 5.5414819890827705, 5.442395355949287, 5.64312752243629, 5.372492301013157, 5.390362574625293, 5.464965427223191, 5.609042418801044, 5.552358534995864, 5.5906205142426675, 0.3702220426159655, 5.218470672926089, 5.3101931241380615, 5.580944917682575, 5.566923704412471, 5.489198322501744, 5.257324850767832, 5.5832706146343565, 5.530008563763385, 5.631792367346078, 5.301316505624875, 5.6098052314716425, 5.4282802449924255, 5.5367087008047635, 5.279843084477894, 5.395941852003883, 5.509398215440055, 5.5298085951270455, 5.601758658000714, 5.546051353079717, 5.601671221664306, 5.176068733416955, 5.249605133566303, 5.561456945869624, 5.5121742000529546, 5.344191259520713, 5.479127887275014, 5.556981934037987, 5.4091722526902775, 5.619726522803835, 5.273840272783243, 5.412721501701724, 5.526612172254447, 5.310649338692171, 5.405871581878458, 5.481455529087201, 5.360296945875488, 5.489881076967066, 5.53012039387875, 5.2576145656701865, 5.656331213461584, 5.634802875757822, 5.538864396146598, 5.516901909491726], "episode_lengths": [101, 77, 94, 59, 91, 50, 83, 71, 62, 44, 46, 51, 130, 54, 99, 43, 57, 82, 79, 53, 80, 14, 119, 45, 54, 104, 74, 136, 126, 69, 81, 52, 96, 48, 64, 64, 124, 64, 89, 64, 102, 51, 54, 84, 49, 49, 62, 100, 145, 55, 79, 93, 55, 86, 100, 110, 105, 21, 44, 46, 116, 103, 53, 82, 83, 93, 76, 114, 97, 74, 64, 75, 68, 131, 94, 126, 115, 117, 54, 77, 111, 71, 79, 99, 59, 73, 53, 125, 104, 56, 69, 57, 68, 72, 65, 80, 59, 94, 91, 74, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2902119121364331, "mean_inference_ms": 1.594028892608335, "mean_action_processing_ms": 0.14995105234193032, "mean_env_wait_ms": 2.936712927130573, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 903096, "agent_timesteps_total": 903096, "timers": {"sample_time_ms": 6874.944, "sample_throughput": 1162.482, "load_time_ms": 3.479, "load_throughput": 2297366.703, "learn_time_ms": 6246.299, "learn_throughput": 1279.478, "update_time_ms": 2.939}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05530591681599617, "policy_loss": -0.014445092529058456, "vf_loss": 0.06692678481340408, "vf_explained_var": 0.7742892503738403, "kl": 0.014121088199317455, "entropy": 0.8636833429336548, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 903096, "num_agent_steps_sampled": 903096, "num_steps_trained": 903096, "num_agent_steps_trained": 903096}, "done": false, "episodes_total": 9362, "training_iteration": 113, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-01-15", "timestamp": 1716404475, "time_this_iter_s": 12.665893793106079, "time_total_s": 1518.8349056243896, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1518.8349056243896, "timesteps_since_restore": 0, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 33.86666666666667, "ram_util_percent": 34.32777777777777}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.70233907406526, "episode_reward_min": 5.125930498058922, "episode_reward_mean": 5.412076698855716, "episode_len_mean": 71.49557522123894, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2335722740769564, "reward_component_totals/rejoin_dist_change_reward_min": 0.9739858718667307, "reward_component_totals/rejoin_dist_change_reward_max": 1.5053390740652612, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.928504424778761, "reward_component_totals/success_reward_min": 1.866, "reward_component_totals/success_reward_max": 1.959}, "hist_stats": {"episode_reward": [5.125930498058922, 5.400315530943038, 5.214089813684235, 5.405700821689898, 5.4910455271850935, 5.4784310568537045, 5.510504823616645, 5.651752977058738, 5.298984727498162, 5.64296191092318, 5.459885595421833, 5.464142785273829, 5.48802381873338, 5.522611662779062, 5.459701165154703, 5.425384889539453, 5.570233138645789, 5.40016610124723, 5.440826873713945, 5.518178293524037, 5.460699305708916, 5.604812027465634, 5.454791610662161, 5.3225235521878, 5.444146552631635, 5.605010208425881, 5.686256542092297, 5.500620764490188, 5.209420261003656, 5.190498379072339, 5.261373399906796, 5.323245373105211, 5.131985871866731, 5.536003825528229, 5.3263881848711625, 5.284831500406325, 5.507718286794563, 5.418455372893741, 5.388904447621785, 5.496210445472655, 5.232531337721541, 5.302344275361502, 5.476763221958431, 5.5455499171615035, 5.203212512800283, 5.4445007133824745, 5.289515225467705, 5.152445799552574, 5.1894723582725275, 5.198566072988602, 5.361402493729568, 5.491049687342278, 5.438694765837223, 5.261729158819561, 5.278808444500305, 5.312413358419398, 5.256753500107673, 5.272482618624696, 5.564925157588054, 5.251146858712096, 5.576522351456118, 5.308059265360686, 5.366268780283564, 5.5073796047321295, 5.259754382302055, 5.204294547862963, 5.631530214779348, 5.337262721518846, 5.294417137837938, 5.515152867955605, 5.597992004747093, 5.346883629646002, 5.323067585741405, 5.323642823382828, 5.702230603556577, 5.208747911187361, 5.424404820484169, 5.306725752827097, 5.3194826749958, 5.381987083698849, 5.303582217628917, 5.5997034490796285, 5.55478797799197, 5.387382626864347, 5.582924666126197, 5.435521255498209, 5.398242352781772, 5.562324939574463, 5.516242637496247, 5.275200909243859, 5.595496304724896, 5.651202513687167, 5.578909145639254, 5.500667842274215, 5.206369796531583, 5.3885483782529064, 5.400064346363504, 5.429688476771092, 5.231590306776544, 5.478395406983951, 5.295256712278961, 5.70233907406526, 5.2940089514038755, 5.628544706468568, 5.468703930742698, 5.330838486846604, 5.615203999981368, 5.531468482269876, 5.472543830740362, 5.2756489311623085, 5.173862625891547, 5.463546569011141, 5.652972953085779], "episode_lengths": [100, 88, 61, 78, 104, 63, 98, 67, 52, 55, 55, 44, 60, 84, 73, 47, 69, 52, 97, 72, 47, 89, 47, 92, 103, 48, 57, 128, 53, 49, 83, 48, 92, 62, 52, 59, 70, 47, 63, 127, 65, 88, 64, 56, 66, 73, 59, 90, 90, 55, 69, 108, 94, 95, 67, 115, 56, 41, 54, 57, 59, 68, 45, 58, 77, 94, 81, 50, 84, 55, 73, 112, 53, 106, 52, 55, 73, 47, 67, 74, 43, 65, 50, 94, 90, 88, 94, 78, 70, 69, 64, 51, 111, 59, 43, 78, 88, 46, 45, 88, 53, 53, 74, 56, 42, 73, 89, 87, 54, 107, 82, 134, 81]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.289153459755082, "mean_inference_ms": 1.5930531634242198, "mean_action_processing_ms": 0.14980510049217155, "mean_env_wait_ms": 2.934601228735684, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 911088, "agent_timesteps_total": 911088, "timers": {"sample_time_ms": 6736.34, "sample_throughput": 1186.401, "load_time_ms": 3.485, "load_throughput": 2293374.399, "learn_time_ms": 6210.875, "learn_throughput": 1286.775, "update_time_ms": 2.931}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.029905881732702255, "policy_loss": -0.015288972295820713, "vf_loss": 0.042543381452560425, "vf_explained_var": 0.8274693489074707, "kl": 0.013257368467748165, "entropy": 0.8034825325012207, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 911088, "num_agent_steps_sampled": 911088, "num_steps_trained": 911088, "num_agent_steps_trained": 911088}, "done": false, "episodes_total": 9475, "training_iteration": 114, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-01-27", "timestamp": 1716404487, "time_this_iter_s": 12.428799152374268, "time_total_s": 1531.263704776764, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1531.263704776764, "timesteps_since_restore": 0, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 33.67777777777778, "ram_util_percent": 34.22777777777778}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.69120429561069, "episode_reward_min": 0.09957189255065657, "episode_reward_mean": 5.384756072230594, "episode_len_mean": 72.97247706422019, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9908256880733946, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.009174311926605505, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9816513761467893, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24770642201834864, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.255783595166375, "reward_component_totals/rejoin_dist_change_reward_min": 0.922087957121074, "reward_component_totals/rejoin_dist_change_reward_max": 1.4952042956106888, "reward_component_totals/failure_reward_mean": -0.009174311926605505, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9087889908256876, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.959, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.243780650960815, 5.355125563676472, 5.424795463127281, 5.273028435481477, 5.403043423787553, 5.377912892810216, 5.595785939291984, 5.524025057255394, 5.316492479861252, 5.399862417606528, 5.542809572922132, 5.573122416550811, 5.53449359608992, 5.511591138240073, 5.449159847842772, 5.418320624721739, 5.436624624782534, 5.340818141552411, 5.247160686593286, 5.56060878003926, 5.6637300605985, 5.69120429561069, 5.357202841280557, 5.304435715165764, 5.488527125794722, 5.479253812832642, 5.333606692884204, 5.503887649142479, 5.446749759932706, 5.640149990731098, 5.560136971832698, 5.63251766224225, 0.09957189255065657, 5.096087957121075, 5.521138807088924, 5.537451329322549, 5.362531030656154, 5.44777062714974, 5.595626457937027, 5.411671990067259, 5.479933675208828, 5.404695378443201, 5.3498709118988295, 5.647794777989594, 5.312064008851088, 5.309427786095624, 5.341801950060761, 5.559468928279211, 5.357477308053852, 5.519921046058055, 5.404663264840644, 5.559157418478421, 5.615653259724599, 5.648759410621459, 5.511663160442267, 5.435752303007926, 5.50099752149419, 5.428106165686893, 5.187467250119049, 5.328502540516055, 5.304236014324507, 5.579848435096233, 5.232353646408029, 5.37354692539021, 5.3594395972831705, 5.292225770184782, 5.681569419689676, 5.511219251021505, 5.160318819192252, 5.4405813016632685, 5.237475715150745, 5.392773213076024, 5.3389563394529445, 5.604577124070607, 5.447677196657256, 5.501587347029387, 5.435226937122453, 5.514253609573833, 5.297213812645456, 5.605961017919327, 5.41982701311257, 5.192176788837925, 5.533013240070041, 5.5243913476833955, 5.0875398319670655, 5.506466660628707, 5.6124286512345085, 5.637795816433696, 5.3829390606998775, 5.598314780363973, 5.543682199332231, 5.454644386181156, 5.180893820850291, 5.404994924364992, 5.281471599623092, 5.318235903546913, 5.348715538056124, 5.256562652609616, 5.2570683047903595, 5.5190164295956965, 5.532615706296118, 5.6650486920072325, 5.416569519058071, 5.302697348743926, 5.485011082120067, 5.50122669141563, 5.462345011248888, 5.28444492042469, 5.312239969880229], "episode_lengths": [90, 96, 104, 70, 91, 75, 129, 93, 103, 78, 116, 107, 70, 105, 41, 98, 73, 81, 74, 75, 51, 54, 60, 78, 59, 96, 93, 52, 97, 49, 51, 61, 12, 76, 92, 84, 53, 70, 72, 62, 52, 44, 59, 94, 52, 67, 71, 55, 120, 95, 73, 50, 67, 68, 92, 70, 72, 89, 47, 75, 77, 62, 84, 42, 53, 53, 56, 80, 53, 87, 42, 47, 71, 72, 90, 129, 50, 62, 68, 68, 75, 48, 79, 116, 92, 46, 54, 97, 48, 65, 88, 87, 53, 46, 90, 64, 60, 77, 79, 88, 60, 48, 76, 81, 115, 97, 52, 57, 67]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2851570185389493, "mean_inference_ms": 1.590895258456507, "mean_action_processing_ms": 0.1496450605741072, "mean_env_wait_ms": 2.93286121334112, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 919080, "agent_timesteps_total": 919080, "timers": {"sample_time_ms": 6624.333, "sample_throughput": 1206.461, "load_time_ms": 3.58, "load_throughput": 2232165.621, "learn_time_ms": 6146.295, "learn_throughput": 1300.295, "update_time_ms": 2.869}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03936109319329262, "policy_loss": -0.010636931285262108, "vf_loss": 0.04729052260518074, "vf_explained_var": 0.8112973570823669, "kl": 0.013537533581256866, "entropy": 0.7811885476112366, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 919080, "num_agent_steps_sampled": 919080, "num_steps_trained": 919080, "num_agent_steps_trained": 919080}, "done": false, "episodes_total": 9584, "training_iteration": 115, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-01-39", "timestamp": 1716404499, "time_this_iter_s": 12.366660118103027, "time_total_s": 1543.630364894867, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1543.630364894867, "timesteps_since_restore": 0, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 34.50588235294118, "ram_util_percent": 34.123529411764714}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.697335074518489, "episode_reward_min": 5.1115744371914955, "episode_reward_mean": 5.436107012653891, "episode_len_mean": 75.79047619047618, "episode_media": {}, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2618974888443666, "reward_component_totals/rejoin_dist_change_reward_min": 0.9145744371914957, "reward_component_totals/rejoin_dist_change_reward_max": 1.5143350745184896, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.924209523809524, "reward_component_totals/success_reward_min": 1.858, "reward_component_totals/success_reward_max": 1.9609999999999999}, "hist_stats": {"episode_reward": [5.489349821287279, 5.272156576391537, 5.463249082086207, 5.3221092600777835, 5.38748848654104, 5.325855619538355, 5.15455798208094, 5.494346259892319, 5.491344500422001, 5.5006931894684, 5.537381478761937, 5.1115744371914955, 5.609105045896439, 5.170831697612938, 5.621119918630164, 5.3787517302579575, 5.412555541314028, 5.425959296774225, 5.3838076758442455, 5.391061936333129, 5.218436401060677, 5.255889929022714, 5.516727560533598, 5.638949030035635, 5.532571626667714, 5.463078577183074, 5.403446587205027, 5.295828336947363, 5.4552887000079835, 5.242030440491156, 5.298417654869109, 5.356380063511244, 5.509117355124594, 5.697335074518489, 5.336059066229302, 5.579766609085757, 5.353109009698674, 5.395346112296561, 5.5092206482909205, 5.39786962830482, 5.402709828606801, 5.386827114570344, 5.359513369901288, 5.554764621267102, 5.3447786353875575, 5.458552978388568, 5.262277024750192, 5.435163951045298, 5.678235434866819, 5.493968746207971, 5.514893845956265, 5.552024686810739, 5.648525955549722, 5.147745002220082, 5.580194704538649, 5.177400471695136, 5.304467638884571, 5.513627384256304, 5.235548929795883, 5.524133520891997, 5.30029748977563, 5.521664552657642, 5.623187417964155, 5.689707739751101, 5.199870474085303, 5.482669476881492, 5.456031202348177, 5.635644408190363, 5.481500918735456, 5.30594416817952, 5.47994405832011, 5.642063678052647, 5.592799303873896, 5.269635574208452, 5.591741723860281, 5.285249747658174, 5.573523812822691, 5.531770538627896, 5.628630064813811, 5.394916389639839, 5.464025778754396, 5.597573257559937, 5.645674148188372, 5.38665131167882, 5.515301600113648, 5.521842906795603, 5.598519064466622, 5.43905624202331, 5.376026227085003, 5.6561738674518045, 5.305502034310621, 5.647639138292231, 5.1396365206716945, 5.502798070850407, 5.587897509278292, 5.592336761052676, 5.316535748188576, 5.607210849504175, 5.319732490380838, 5.557156255416561, 5.2724686470281314, 5.284434867747367, 5.41469049881046, 5.191410714043105, 5.190627285441067], "episode_lengths": [84, 68, 83, 79, 80, 59, 48, 100, 130, 44, 53, 53, 76, 53, 58, 69, 56, 80, 66, 39, 89, 69, 53, 107, 64, 116, 92, 71, 59, 77, 47, 59, 65, 67, 87, 88, 76, 90, 60, 68, 60, 73, 113, 69, 83, 115, 80, 47, 69, 59, 74, 101, 76, 48, 72, 56, 55, 65, 66, 69, 86, 91, 95, 68, 66, 52, 64, 106, 142, 124, 91, 72, 74, 72, 102, 86, 99, 51, 54, 65, 91, 91, 113, 62, 91, 54, 114, 106, 76, 65, 54, 92, 112, 109, 59, 63, 79, 58, 59, 54, 62, 81, 105, 70, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28971069213828077, "mean_inference_ms": 1.5886330031625262, "mean_action_processing_ms": 0.14943025302380816, "mean_env_wait_ms": 2.927395397700097, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 927072, "agent_timesteps_total": 927072, "timers": {"sample_time_ms": 6413.758, "sample_throughput": 1246.071, "load_time_ms": 3.505, "load_throughput": 2280455.914, "learn_time_ms": 6082.822, "learn_throughput": 1313.864, "update_time_ms": 2.867}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03389696776866913, "policy_loss": -0.01157800666987896, "vf_loss": 0.04302207753062248, "vf_explained_var": 0.8260935544967651, "kl": 0.0122644929215312, "entropy": 0.8066402077674866, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 927072, "num_agent_steps_sampled": 927072, "num_steps_trained": 927072, "num_agent_steps_trained": 927072}, "done": false, "episodes_total": 9689, "training_iteration": 116, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-01-51", "timestamp": 1716404511, "time_this_iter_s": 11.34849762916565, "time_total_s": 1554.9788625240326, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1554.9788625240326, "timesteps_since_restore": 0, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 32.46875, "ram_util_percent": 34.2}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.707827073672451, "episode_reward_min": -0.07446745909714125, "episode_reward_mean": 5.400259889625608, "episode_len_mean": 73.2072072072072, "episode_media": {}, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.990990990990991, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.009009009009009009, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9819819819819822, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24774774774774774, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.270674304040025, "reward_component_totals/rejoin_dist_change_reward_min": 0.9255325409028587, "reward_component_totals/rejoin_dist_change_reward_max": 1.5138270736724508, "reward_component_totals/failure_reward_mean": -0.009009009009009009, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.908864864864865, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.959, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.3611565576304745, 5.294629548261528, 5.330049583549386, 5.686940705720065, 5.548851259833784, 5.608745074213882, 5.5172450936125985, 5.536723039843606, 5.24270581755683, 5.49680114251551, 5.4834649508654465, 5.287788696826808, 5.203221376740172, 5.403568759194734, 5.447445522036153, 5.303957636198689, 5.587099894999152, 5.335928253571086, 5.544086908937729, 5.40002387222544, -0.07446745909714125, 5.612873380719845, 5.707827073672451, 5.231921418575464, 5.519840200414766, 5.586453564736042, 5.480433961856921, 5.574123188380874, 5.600123951551971, 5.203139582376632, 5.469574063654112, 5.577360733547586, 5.414655881631354, 5.285956738361609, 5.578689828022177, 5.274256772103624, 5.498755082164156, 5.467147264403202, 5.509488058209387, 5.344432376634677, 5.251882856612307, 5.552017010073788, 5.57586997920349, 5.644153524462965, 5.412890977889239, 5.404237567932712, 5.635159230436635, 5.374572155434142, 5.498824580321852, 5.367088469531543, 5.646992840279188, 5.502314641286285, 5.522071733039985, 5.550806336408563, 5.312399991241502, 5.3162903028780475, 5.467654324423814, 5.616273161475172, 5.561575509523697, 5.473726980858735, 5.1943686603139625, 5.504635401065777, 5.609637013459318, 5.568097329175764, 5.26087578619785, 5.616833791124854, 5.515992853847264, 5.5187738131665025, 5.413696155600303, 5.165237660311215, 5.667276965837816, 5.420359702225811, 5.5085671008415815, 5.648206282572457, 5.581738529742768, 5.305685364509162, 5.689062160966165, 5.357804998734354, 5.611927161941138, 5.566567417110599, 5.377617931870772, 5.315219371704504, 5.562726359211348, 5.475741699021276, 5.1656528192689795, 5.333590177267957, 5.5654619678578054, 5.466448903679403, 5.39237111210905, 5.549118428607245, 5.350353501788431, 5.36883875596417, 5.338023559186088, 5.517425693643402, 5.306579490105875, 5.505065186229194, 5.249797528142372, 5.417921785887867, 5.633406639422905, 5.298862523196457, 5.182230970644406, 5.239901898627119, 5.424993589046834, 5.464753745449431, 5.398574279520419, 5.293018317959003, 5.507377675163214, 5.580779450991041, 5.202490901872717, 5.520772610174536, 5.528565196517855], "episode_lengths": [42, 51, 125, 52, 51, 73, 41, 60, 74, 72, 89, 69, 92, 119, 48, 72, 55, 48, 99, 53, 10, 55, 56, 87, 63, 86, 74, 100, 66, 86, 75, 54, 48, 69, 112, 57, 78, 50, 47, 43, 50, 76, 93, 90, 64, 103, 68, 46, 77, 41, 71, 50, 95, 61, 85, 112, 64, 52, 74, 106, 59, 56, 80, 113, 61, 65, 56, 50, 83, 114, 88, 64, 61, 53, 114, 99, 54, 82, 75, 103, 51, 86, 70, 89, 114, 104, 86, 57, 66, 116, 123, 94, 83, 86, 54, 126, 107, 48, 54, 45, 45, 67, 92, 83, 46, 53, 54, 108, 96, 53, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2887242261467343, "mean_inference_ms": 1.587326556848, "mean_action_processing_ms": 0.14934373718612148, "mean_env_wait_ms": 2.925952575512464, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 935064, "agent_timesteps_total": 935064, "timers": {"sample_time_ms": 6365.644, "sample_throughput": 1255.49, "load_time_ms": 3.479, "load_throughput": 2297382.449, "learn_time_ms": 6056.128, "learn_throughput": 1319.655, "update_time_ms": 2.839}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0426945760846138, "policy_loss": -0.011802980676293373, "vf_loss": 0.05205424129962921, "vf_explained_var": 0.8088365197181702, "kl": 0.012216593138873577, "entropy": 0.799608588218689, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 935064, "num_agent_steps_sampled": 935064, "num_steps_trained": 935064, "num_agent_steps_trained": 935064}, "done": false, "episodes_total": 9800, "training_iteration": 117, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-02-03", "timestamp": 1716404523, "time_this_iter_s": 12.53871488571167, "time_total_s": 1567.5175774097443, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1567.5175774097443, "timesteps_since_restore": 0, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 33.33888888888889, "ram_util_percent": 34.22222222222222}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.700496933412364, "episode_reward_min": 5.112654516695487, "episode_reward_mean": 5.454663721558813, "episode_len_mean": 74.31481481481481, "episode_media": {}, "episodes_this_iter": 108, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2789785363736277, "reward_component_totals/rejoin_dist_change_reward_min": 0.9566545166954863, "reward_component_totals/rejoin_dist_change_reward_max": 1.516496933412364, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.925685185185185, "reward_component_totals/success_reward_min": 1.8439999999999999, "reward_component_totals/success_reward_max": 1.96}, "hist_stats": {"episode_reward": [5.437492379716463, 5.61119859891575, 5.679083973545534, 5.5271208370670335, 5.188183342337261, 5.619208338146263, 5.368388045983176, 5.366719164046588, 5.312462352386969, 5.2855727027630826, 5.3363321423970955, 5.655237738888488, 5.358210298716269, 5.38847133609972, 5.622402629176835, 5.529563399347215, 5.315777988453027, 5.375021673188005, 5.554791095707197, 5.225932167074491, 5.286650275047787, 5.421205139980356, 5.4047028687555105, 5.597255418640724, 5.678525101548366, 5.57732359108924, 5.492669244836389, 5.4945323577094936, 5.44836134701245, 5.190118571951628, 5.331860974235971, 5.236742029467024, 5.607045290916343, 5.558846533735264, 5.4734171336281, 5.580492917209747, 5.344901256030766, 5.540844905824002, 5.513880321358572, 5.495226846466686, 5.616992283188984, 5.700496933412364, 5.554470126670294, 5.582399256773074, 5.312194603274414, 5.634075726432662, 5.1993205387841135, 5.303220595722305, 5.255512616289422, 5.247390567091138, 5.340769570862926, 5.342978232163654, 5.417235742029557, 5.462264964183398, 5.265475884943028, 5.505485743541223, 5.52674926453551, 5.530294403160034, 5.605850644091605, 5.684686920142093, 5.502784132692261, 5.307138295673023, 5.553476849898782, 5.611547448130523, 5.640894602958461, 5.487259353438183, 5.221459950808888, 5.168730886467233, 5.489849626254131, 5.375117927704533, 5.112654516695487, 5.620571678535495, 5.562320127402607, 5.481109469533123, 5.456345974752704, 5.178892315945205, 5.297653558813114, 5.503584368399256, 5.4212737710588925, 5.512614774900891, 5.481486845827982, 5.3865329646947595, 5.168084310462289, 5.390049910085019, 5.690122320246568, 5.462665443004765, 5.5286791790202265, 5.521983185378879, 5.331655529461971, 5.67019066436406, 5.567339496712583, 5.644534212914919, 5.583133206844515, 5.306392584542541, 5.355608335326325, 5.610388786394083, 5.430597463171013, 5.33187356494811, 5.570995615272025, 5.526886171539136, 5.654816595875137, 5.5699349976949595, 5.385637690288914, 5.672210558782162, 5.374759519263627, 5.382247815780085, 5.567919946222322, 5.312038437477312], "episode_lengths": [44, 57, 70, 55, 70, 78, 93, 46, 76, 45, 74, 55, 59, 56, 80, 52, 55, 94, 86, 75, 40, 77, 75, 106, 65, 101, 86, 119, 61, 63, 53, 67, 110, 51, 119, 48, 51, 60, 52, 57, 102, 66, 156, 66, 81, 58, 80, 134, 56, 73, 61, 71, 103, 104, 123, 94, 51, 70, 63, 71, 83, 62, 53, 103, 89, 51, 52, 133, 66, 92, 94, 55, 128, 71, 48, 40, 50, 75, 94, 93, 44, 88, 55, 58, 74, 68, 46, 40, 58, 58, 50, 64, 97, 67, 155, 83, 48, 146, 101, 70, 79, 67, 110, 59, 52, 60, 62, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.290879057516475, "mean_inference_ms": 1.5889493946717446, "mean_action_processing_ms": 0.14932307326862962, "mean_env_wait_ms": 2.9258737528206527, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 943056, "agent_timesteps_total": 943056, "timers": {"sample_time_ms": 6360.402, "sample_throughput": 1256.524, "load_time_ms": 3.448, "load_throughput": 2317634.689, "learn_time_ms": 6051.264, "learn_throughput": 1320.716, "update_time_ms": 2.813}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03155377134680748, "policy_loss": -0.013971516862511635, "vf_loss": 0.04280749335885048, "vf_explained_var": 0.8399097919464111, "kl": 0.013588960282504559, "entropy": 0.7569237351417542, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 943056, "num_agent_steps_sampled": 943056, "num_steps_trained": 943056, "num_agent_steps_trained": 943056}, "done": false, "episodes_total": 9908, "training_iteration": 118, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-02-16", "timestamp": 1716404536, "time_this_iter_s": 13.000367641448975, "time_total_s": 1580.5179450511932, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1580.5179450511932, "timesteps_since_restore": 0, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 34.1, "ram_util_percent": 34.29999999999999}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.696332386904982, "episode_reward_min": 5.153923257363925, "episode_reward_mean": 5.458621475149946, "episode_len_mean": 72.0, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2806214751499467, "reward_component_totals/rejoin_dist_change_reward_min": 1.0135637121840446, "reward_component_totals/rejoin_dist_change_reward_max": 1.5103323869049823, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9280000000000002, "reward_component_totals/success_reward_min": 1.8639999999999999, "reward_component_totals/success_reward_max": 1.956}, "hist_stats": {"episode_reward": [5.210838460220293, 5.522539906386985, 5.566610683378033, 5.65636853463994, 5.38401617669723, 5.2743097897653595, 5.554628239208855, 5.5265916747412955, 5.657844313023048, 5.69364046626467, 5.622726563537876, 5.506597104024602, 5.455590221614258, 5.342676818721559, 5.603796639112945, 5.597552347821536, 5.375641596110249, 5.211073005245849, 5.567722263227906, 5.217596605477295, 5.445249263811183, 5.580212787795036, 5.422181901663832, 5.5064831346067855, 5.317105440692844, 5.368127304454708, 5.445561018037859, 5.241166245957448, 5.598827197093331, 5.416403211973223, 5.518202878545816, 5.355087525090894, 5.484796615319716, 5.462171030799757, 5.25679431958465, 5.274688967857613, 5.6092191920418415, 5.314358180793905, 5.472184757478486, 5.334675830952527, 5.542886421513412, 5.589176878511148, 5.431778306281514, 5.663797875890841, 5.379517564604431, 5.430723926987362, 5.413405198924883, 5.5838861734943706, 5.370492868014297, 5.217887562375562, 5.441801282059738, 5.31089233571452, 5.605610025434967, 5.382299941986322, 5.211563712184045, 5.631393607876197, 5.607988561134201, 5.696332386904982, 5.402122493739483, 5.509062608549276, 5.388495394546501, 5.529615807168387, 5.404888244293097, 5.613611038341931, 5.599271390487956, 5.405136761635287, 5.677376730361794, 5.351525381703494, 5.434356584864393, 5.153923257363925, 5.249503884687886, 5.493011798639445, 5.503052151145816, 5.517249671171292, 5.290983965509261, 5.448993573083135, 5.479829539969339, 5.474074692738949, 5.395677955137462, 5.238039570525057, 5.476131629221694, 5.631598115335946, 5.533967188473242, 5.597545532606738, 5.280529507498331, 5.242910185230476, 5.666312941372725, 5.461593381350546, 5.590285031107623, 5.579161407921948, 5.583575357950438, 5.435530499349352, 5.590478479419013, 5.555234484030656, 5.446576809771236, 5.5312742556522165, 5.568774398929779, 5.349748650440178, 5.347498903060898, 5.425800436715833, 5.198882472469233, 5.651826205279744, 5.3889237457755845, 5.254747520865022, 5.352032878947096, 5.671020272412514, 5.55873433522517, 5.563497127334504, 5.4124536982692995], "episode_lengths": [65, 88, 57, 60, 44, 92, 89, 126, 63, 63, 62, 136, 51, 45, 71, 89, 75, 56, 81, 57, 45, 85, 45, 108, 74, 68, 50, 85, 97, 88, 60, 45, 72, 66, 87, 60, 50, 80, 82, 48, 51, 87, 70, 51, 66, 68, 73, 56, 114, 76, 56, 96, 59, 71, 52, 53, 69, 64, 90, 80, 46, 67, 49, 82, 84, 65, 56, 61, 54, 132, 63, 65, 54, 93, 88, 54, 61, 48, 91, 72, 53, 49, 59, 49, 98, 71, 61, 107, 79, 70, 92, 66, 61, 92, 126, 112, 102, 92, 55, 58, 70, 68, 62, 49, 52, 88, 133, 71, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2882093654897544, "mean_inference_ms": 1.5887935879334714, "mean_action_processing_ms": 0.1493069693526807, "mean_env_wait_ms": 2.9268820859013425, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 951048, "agent_timesteps_total": 951048, "timers": {"sample_time_ms": 6432.422, "sample_throughput": 1242.456, "load_time_ms": 3.466, "load_throughput": 2305932.363, "learn_time_ms": 6072.587, "learn_throughput": 1316.078, "update_time_ms": 2.82}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03440232574939728, "policy_loss": -0.010035037063062191, "vf_loss": 0.04197396710515022, "vf_explained_var": 0.8327199220657349, "kl": 0.012316937558352947, "entropy": 0.7807384729385376, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 951048, "num_agent_steps_sampled": 951048, "num_steps_trained": 951048, "num_agent_steps_trained": 951048}, "done": false, "episodes_total": 10017, "training_iteration": 119, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-02-30", "timestamp": 1716404550, "time_this_iter_s": 13.40376901626587, "time_total_s": 1593.921714067459, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1593.921714067459, "timesteps_since_restore": 0, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 34.73157894736841, "ram_util_percent": 34.131578947368425}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.688008440281548, "episode_reward_min": 5.1547697326135395, "episode_reward_mean": 5.433045808643959, "episode_len_mean": 78.93069306930693, "episode_media": {}, "episodes_this_iter": 101, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2619765017132634, "reward_component_totals/rejoin_dist_change_reward_min": 0.9467697326135394, "reward_component_totals/rejoin_dist_change_reward_max": 1.508008440281548, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.921069306930693, "reward_component_totals/success_reward_min": 1.8359999999999999, "reward_component_totals/success_reward_max": 1.962}, "hist_stats": {"episode_reward": [5.497569082070697, 5.432772119531359, 5.62524720938987, 5.628935584823487, 5.340119711054065, 5.406051873063863, 5.392029948939429, 5.298129150406265, 5.5431448034949495, 5.281208051459144, 5.383687113562372, 5.540459614270489, 5.422165741986664, 5.303357463920834, 5.492788374304607, 5.5723798455163, 5.234890341010073, 5.626182155682922, 5.615172177236138, 5.179715705478734, 5.381341711460135, 5.1547697326135395, 5.408017873367984, 5.594390322213234, 5.624941173728599, 5.307514272619252, 5.518324089752507, 5.308400705287964, 5.529728095269972, 5.603179065131826, 5.296616170319437, 5.3344944343455865, 5.513114305890962, 5.272375000366646, 5.373321645751206, 5.164701702468525, 5.365661773684822, 5.561513890917666, 5.643187958464367, 5.6545422119885895, 5.244336039059974, 5.604694482457473, 5.498741906456349, 5.501957681921278, 5.341283031457948, 5.2390136150521975, 5.341945761799899, 5.350889137722974, 5.350894417684977, 5.540286968076581, 5.572236443894399, 5.546638450086789, 5.4840761627878365, 5.4531257231607775, 5.240465822576029, 5.237777452048883, 5.504929761228418, 5.400780533759747, 5.566606309840868, 5.218257642497317, 5.595838404231568, 5.289176465383559, 5.531316725338991, 5.43658156346268, 5.27464548992419, 5.656641296544388, 5.566708943192906, 5.61504190369721, 5.688008440281548, 5.601637419625163, 5.251783013530149, 5.457681806058462, 5.156429877168765, 5.589094241350394, 5.311612131431106, 5.2899781090877624, 5.5116575301025525, 5.529495889562687, 5.26510005007038, 5.532366211263095, 5.563017888575294, 5.269695866015586, 5.506062874466873, 5.207948369107891, 5.3100843852334165, 5.375889084319702, 5.555449612411699, 5.266749861985296, 5.463329662648958, 5.426590834964344, 5.661261837329251, 5.474621032751587, 5.194726745554463, 5.627773661294878, 5.388800323904855, 5.355475922913581, 5.560382467245585, 5.540901153190857, 5.265005720698188, 5.375084285428775, 5.532900025275186], "episode_lengths": [81, 51, 80, 46, 80, 91, 98, 46, 103, 74, 65, 91, 59, 66, 84, 82, 61, 100, 70, 89, 76, 42, 54, 56, 52, 135, 86, 59, 121, 91, 55, 80, 84, 98, 41, 61, 95, 92, 71, 48, 49, 102, 109, 84, 98, 38, 96, 58, 79, 164, 87, 55, 152, 113, 50, 88, 87, 73, 141, 77, 64, 103, 109, 79, 81, 55, 81, 52, 70, 49, 55, 48, 41, 97, 49, 61, 152, 92, 57, 82, 95, 58, 104, 77, 66, 117, 64, 98, 52, 39, 71, 47, 126, 87, 56, 76, 152, 76, 74, 90, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2885327983431518, "mean_inference_ms": 1.5879038859398096, "mean_action_processing_ms": 0.14939649576245356, "mean_env_wait_ms": 2.927032770942327, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 959040, "agent_timesteps_total": 959040, "timers": {"sample_time_ms": 6527.162, "sample_throughput": 1224.422, "load_time_ms": 3.463, "load_throughput": 2308107.606, "learn_time_ms": 6093.167, "learn_throughput": 1311.633, "update_time_ms": 2.847}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.02979917824268341, "policy_loss": -0.014084450900554657, "vf_loss": 0.04143355414271355, "vf_explained_var": 0.8443446159362793, "kl": 0.012250388972461224, "entropy": 0.7383513450622559, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 959040, "num_agent_steps_sampled": 959040, "num_steps_trained": 959040, "num_agent_steps_trained": 959040}, "done": false, "episodes_total": 10118, "training_iteration": 120, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-02-43", "timestamp": 1716404563, "time_this_iter_s": 13.405833721160889, "time_total_s": 1607.32754778862, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1607.32754778862, "timesteps_since_restore": 0, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 34.036842105263155, "ram_util_percent": 34.13157894736843}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.70006697677188, "episode_reward_min": 0.21573132372207993, "episode_reward_mean": 5.411565100545404, "episode_len_mean": 72.85714285714286, "episode_media": {}, "episodes_this_iter": 112, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9910714285714286, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.008928571428571428, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9821428571428574, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24776785714285715, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2811454576882624, "reward_component_totals/rejoin_dist_change_reward_min": 0.965035007752814, "reward_component_totals/rejoin_dist_change_reward_max": 1.51106697677188, "reward_component_totals/failure_reward_mean": -0.008928571428571428, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9094375000000003, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.96, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.3298019725029535, 5.172373735942972, 5.5285812295661225, 5.67601742826378, 5.312045972154099, 5.348539668978322, 5.3398923004261905, 5.468370130039364, 5.388656367017896, 5.272389768657736, 5.387165738932022, 5.525503767744386, 5.586363002953186, 5.5745092168976695, 5.2509201728019, 5.470673034580221, 5.314070950438726, 5.598378193544766, 5.70006697677188, 5.253262907350464, 5.529146613473307, 5.391814500268554, 5.491249598806705, 5.472859638284273, 5.446849484909046, 5.442222912512365, 5.429346719629516, 5.448282870214883, 5.43377546564499, 5.558460173702205, 5.536196334459131, 5.618011499345255, 5.251677079352679, 5.136459114710394, 5.474435545381529, 5.59355204034286, 5.547664959883682, 5.624522195725866, 5.259509398918151, 5.464061145517792, 5.49242971009744, 5.63021446621174, 5.631969927375108, 5.517336890596926, 5.318933991982456, 5.4480887690926965, 5.626659708992066, 5.193258160068219, 5.441547380638356, 5.534581663911209, 5.293781541612374, 5.606745574326832, 5.610606460363783, 5.620226275366646, 5.40907957067405, 5.659825340636342, 5.407053528151314, 5.3866617643991255, 5.446746805518827, 5.6271521893102605, 5.487816061581717, 5.649859814256976, 5.348010404566564, 5.459259802800023, 5.375935726670983, 5.3550154858019505, 5.377389973921057, 5.289611565395787, 5.466459109968881, 5.607841319380146, 5.652251313618032, 5.541941739590179, 5.555299701977812, 5.572560228436863, 5.5444069132799285, 5.496119967040006, 5.597763221167842, 5.300735451967352, 5.456563453869593, 5.576119133723623, 5.345392693537981, 5.4844417120805105, 5.440840645116047, 5.4782822772632205, 5.629967818912578, 5.6214908011401015, 0.21573132372207993, 5.498131935316952, 5.399042314679718, 5.4844256919960515, 5.3310801422543665, 5.646134615815343, 5.64405775229392, 5.657070029799035, 5.4247032233402965, 5.446407511619865, 5.612857868359903, 5.325876639169719, 5.441602975310726, 5.282631860178141, 5.203761785025444, 5.120035007752814, 5.628300111895133, 5.459234915952003, 5.501685140187941, 5.404062205182811, 5.573853853475076, 5.239162123329605, 5.166608036629761, 5.437748482192606, 5.381473590931113, 5.307656241635607], "episode_lengths": [113, 56, 60, 58, 76, 83, 78, 131, 65, 71, 77, 94, 51, 92, 75, 75, 65, 73, 61, 78, 107, 116, 75, 62, 81, 63, 52, 54, 59, 100, 78, 52, 41, 93, 107, 52, 55, 55, 43, 81, 54, 95, 57, 90, 52, 134, 62, 79, 86, 78, 40, 58, 93, 84, 62, 48, 68, 82, 67, 45, 87, 82, 77, 124, 55, 57, 47, 66, 48, 118, 67, 63, 99, 78, 61, 54, 98, 72, 61, 76, 61, 117, 67, 51, 55, 54, 17, 91, 71, 74, 106, 61, 79, 53, 97, 57, 60, 45, 79, 49, 64, 95, 75, 87, 78, 77, 45, 65, 127, 72, 101, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28786757124362927, "mean_inference_ms": 1.5887364187468036, "mean_action_processing_ms": 0.1494151845049198, "mean_env_wait_ms": 2.9275407526916615, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 967032, "agent_timesteps_total": 967032, "timers": {"sample_time_ms": 6552.992, "sample_throughput": 1219.596, "load_time_ms": 3.317, "load_throughput": 2409095.504, "learn_time_ms": 6117.314, "learn_throughput": 1306.456, "update_time_ms": 2.889}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04016789421439171, "policy_loss": -0.012510799802839756, "vf_loss": 0.04994691163301468, "vf_explained_var": 0.8074253797531128, "kl": 0.013658891431987286, "entropy": 0.6543834209442139, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 967032, "num_agent_steps_sampled": 967032, "num_steps_trained": 967032, "num_agent_steps_trained": 967032}, "done": false, "episodes_total": 10230, "training_iteration": 121, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-02-57", "timestamp": 1716404577, "time_this_iter_s": 13.208760499954224, "time_total_s": 1620.5363082885742, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1620.5363082885742, "timesteps_since_restore": 0, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 34.015789473684215, "ram_util_percent": 34.20000000000001}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.704738274949351, "episode_reward_min": 0.18264126881623333, "episode_reward_mean": 5.377560509957934, "episode_len_mean": 68.88695652173914, "episode_media": {}, "episodes_this_iter": 115, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9826086956521739, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.017391304347826087, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.965217391304348, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24565217391304348, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2873605099579348, "reward_component_totals/rejoin_dist_change_reward_min": 0.9301330272151305, "reward_component_totals/rejoin_dist_change_reward_max": 1.5057382749493515, "reward_component_totals/failure_reward_mean": -0.017391304347826087, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.8967217391304345, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.962, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.621948942514491, 5.322394584549574, 5.53226929967839, 5.540753642664429, 5.507322067222738, 5.276875123471159, 5.4369203315811205, 5.439363247445975, 5.58165833218812, 5.566321177093639, 5.650477160836785, 0.18264126881623333, 5.576950628227688, 5.119133027215131, 5.556212772075682, 5.184688153047499, 5.2705215736136335, 5.371081916446137, 5.6191808222532345, 5.524578312461612, 5.314677785560312, 5.630071614669376, 5.704738274949351, 5.638911657743035, 5.464916656941022, 5.475668467893103, 5.403119879585708, 5.280303956724298, 5.339597041938871, 5.404742066061935, 5.180720877278315, 5.671011986561737, 5.36261050252374, 5.535578082392775, 0.24417717215037982, 5.643579689004061, 5.23529170679331, 5.586479707213101, 5.591558432165089, 5.217185320957247, 5.664868943820674, 5.573509790933569, 5.601884275834834, 5.66081999858918, 5.336000388087266, 5.570722938660133, 5.388826186425838, 5.497233839481858, 5.387599749882467, 5.587352599659571, 5.579625746015884, 5.236895962091653, 5.615352547585197, 5.35600745520799, 5.48378662024254, 5.408347012604365, 5.517100254011897, 5.524119571141291, 5.4220195846596955, 5.337937077151544, 5.589836588345569, 5.160356316553232, 5.557603771452653, 5.302576583337901, 5.557217490841374, 5.605991526253668, 5.308985217538094, 5.391986570229259, 5.624399075454553, 5.603214515797022, 5.575231146551166, 5.365136337508941, 5.390222928210292, 5.487162340981689, 5.4710647992920505, 5.646111551571249, 5.578335295461056, 5.278736454486454, 5.308768990457473, 5.60467233903003, 5.198519675391813, 5.519241574497454, 5.452141039039423, 5.298440342776631, 5.453354440991127, 5.616589652479835, 5.570847003153569, 5.41885796405392, 5.467703358357125, 5.527590009174271, 5.686389418405485, 5.465937814362817, 5.540630117636631, 5.385477027595103, 5.675472866545292, 5.495553803015638, 5.5351895808323075, 5.647225736733043, 5.492277187052087, 5.273330020450418, 5.179818204949295, 5.204725171835639, 5.698261580332497, 5.5956823725837435, 5.290004890834475, 5.566782823472161, 5.509607836821925, 5.151999681117983, 5.606134276854718, 5.643453095028116, 5.612464662541688, 5.257546032885536, 5.52831159958558, 5.557662602225871, 5.33238153759811], "episode_lengths": [66, 59, 84, 57, 72, 64, 54, 80, 53, 108, 64, 22, 120, 61, 93, 59, 62, 46, 50, 51, 92, 64, 51, 55, 92, 68, 52, 40, 97, 49, 51, 49, 71, 60, 23, 47, 82, 101, 106, 51, 55, 95, 59, 56, 61, 77, 80, 80, 57, 84, 48, 72, 111, 51, 97, 77, 59, 62, 50, 68, 126, 48, 120, 95, 42, 51, 75, 80, 51, 73, 56, 63, 45, 67, 99, 50, 79, 66, 67, 105, 56, 45, 83, 53, 77, 85, 137, 75, 74, 68, 52, 80, 93, 74, 62, 69, 99, 75, 59, 48, 48, 80, 57, 92, 38, 50, 53, 47, 55, 57, 74, 129, 74, 61, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.288394520083829, "mean_inference_ms": 1.5882134832574177, "mean_action_processing_ms": 0.14945496549259604, "mean_env_wait_ms": 2.9281634011247193, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 975024, "agent_timesteps_total": 975024, "timers": {"sample_time_ms": 6605.156, "sample_throughput": 1209.964, "load_time_ms": 3.333, "load_throughput": 2397516.545, "learn_time_ms": 6160.491, "learn_throughput": 1297.299, "update_time_ms": 2.919}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05753021687269211, "policy_loss": -0.017325783148407936, "vf_loss": 0.07217381149530411, "vf_explained_var": 0.7802414298057556, "kl": 0.013410890474915504, "entropy": 0.631960391998291, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 975024, "num_agent_steps_sampled": 975024, "num_steps_trained": 975024, "num_agent_steps_trained": 975024}, "done": false, "episodes_total": 10345, "training_iteration": 122, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-03-10", "timestamp": 1716404590, "time_this_iter_s": 13.505385875701904, "time_total_s": 1634.0416941642761, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1634.0416941642761, "timesteps_since_restore": 0, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 34.1, "ram_util_percent": 34.125000000000014}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.706735266847402, "episode_reward_min": 5.145808939122494, "episode_reward_mean": 5.46386417711425, "episode_len_mean": 73.77777777777777, "episode_media": {}, "episodes_this_iter": 108, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2876419548920268, "reward_component_totals/rejoin_dist_change_reward_min": 0.9348089391224945, "reward_component_totals/rejoin_dist_change_reward_max": 1.515735266847403, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.926222222222222, "reward_component_totals/success_reward_min": 1.8559999999999999, "reward_component_totals/success_reward_max": 1.9609999999999999}, "hist_stats": {"episode_reward": [5.488602005237928, 5.383446423483926, 5.573238024496955, 5.254704784843743, 5.565647876102597, 5.398043765230744, 5.593591851044935, 5.580342791007686, 5.335812658752239, 5.400087134735588, 5.629051774350463, 5.504094790868022, 5.248048811435938, 5.371121347151675, 5.426928672721991, 5.437624628504289, 5.5033500368584, 5.517051348981253, 5.331903104291262, 5.581269990571073, 5.480307402947697, 5.4498356489097395, 5.371003571559298, 5.4039673667075885, 5.386122704918392, 5.145808939122494, 5.65480376640224, 5.679578094690706, 5.468285742380195, 5.458892668414464, 5.4464384953029485, 5.555244666324601, 5.575475450887771, 5.48426283701461, 5.332145819522367, 5.404661823110053, 5.335709188652693, 5.517887156622366, 5.419329947165897, 5.256574749732443, 5.481318629046855, 5.413847067354159, 5.5885022297085065, 5.2915946526616855, 5.597238166581542, 5.678867679646846, 5.499858907340531, 5.3977319501908605, 5.48110761560104, 5.384254721280833, 5.623065174214176, 5.646275092982452, 5.485225028099688, 5.549447897467154, 5.551922369289134, 5.495120163622768, 5.471946467199054, 5.450578677773569, 5.441356737980145, 5.171518402163084, 5.44834849511264, 5.227950564216263, 5.31307857573082, 5.355533010740428, 5.483539107052346, 5.284209259632477, 5.67677313056222, 5.491412792427439, 5.543761725489277, 5.540092514811906, 5.666414243039812, 5.4575711445425465, 5.545152251939642, 5.509060593719116, 5.367905194294226, 5.178956605917201, 5.450500982967334, 5.3963604461661685, 5.584798960367535, 5.706735266847402, 5.5270077746547095, 5.663522916289968, 5.444305143158009, 5.329924915086683, 5.654260691108062, 5.549317078053216, 5.285265522105666, 5.291330311447892, 5.539616455707143, 5.226565565339078, 5.176240557968782, 5.270130201426304, 5.648355522146199, 5.525581319737199, 5.6183967262960675, 5.350092810932588, 5.327303567976723, 5.487859177531158, 5.61681127035531, 5.6090504974555895, 5.702638598119379, 5.640481837178181, 5.3247591375464305, 5.267319404450042, 5.637401009478056, 5.523430671009773, 5.363845872246488, 5.6172862166940565], "episode_lengths": [86, 78, 49, 49, 79, 108, 60, 58, 46, 54, 83, 93, 79, 61, 84, 78, 76, 85, 67, 86, 42, 82, 78, 82, 119, 39, 62, 73, 80, 60, 87, 82, 70, 65, 66, 103, 51, 52, 114, 67, 58, 55, 102, 58, 72, 66, 60, 84, 75, 52, 48, 71, 73, 78, 99, 74, 74, 91, 59, 92, 48, 88, 53, 63, 71, 49, 49, 103, 133, 80, 66, 100, 47, 58, 62, 118, 63, 56, 72, 59, 58, 56, 71, 126, 80, 95, 43, 94, 75, 56, 95, 70, 66, 111, 66, 144, 39, 62, 49, 54, 53, 99, 111, 42, 80, 108, 88, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.289588579669555, "mean_inference_ms": 1.5900391542427306, "mean_action_processing_ms": 0.14949790513128822, "mean_env_wait_ms": 2.929976090836564, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 983016, "agent_timesteps_total": 983016, "timers": {"sample_time_ms": 6669.267, "sample_throughput": 1198.333, "load_time_ms": 3.332, "load_throughput": 2398254.126, "learn_time_ms": 6178.642, "learn_throughput": 1293.488, "update_time_ms": 2.958}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.02640235796570778, "policy_loss": -0.01823737844824791, "vf_loss": 0.04134456813335419, "vf_explained_var": 0.8290004134178162, "kl": 0.016475846990942955, "entropy": 0.643296480178833, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 983016, "num_agent_steps_sampled": 983016, "num_steps_trained": 983016, "num_agent_steps_trained": 983016}, "done": false, "episodes_total": 10453, "training_iteration": 123, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-03-24", "timestamp": 1716404604, "time_this_iter_s": 13.490762948989868, "time_total_s": 1647.532457113266, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1647.532457113266, "timesteps_since_restore": 0, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 34.599999999999994, "ram_util_percent": 34.2}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.684462509808476, "episode_reward_min": 5.102396626193972, "episode_reward_mean": 5.4578091466750545, "episode_len_mean": 70.88392857142857, "episode_media": {}, "episodes_this_iter": 112, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2786930752464838, "reward_component_totals/rejoin_dist_change_reward_min": 0.9253966261939719, "reward_component_totals/rejoin_dist_change_reward_max": 1.5134625098084775, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9291160714285713, "reward_component_totals/success_reward_min": 1.87, "reward_component_totals/success_reward_max": 1.959}, "hist_stats": {"episode_reward": [5.625297772657682, 5.455693540257092, 5.232333877861053, 5.456670053935408, 5.355878938555741, 5.472543542103351, 5.413230402949514, 5.459210554116506, 5.644831162702478, 5.276787548544366, 5.217975957037048, 5.192296662685722, 5.6198526795410615, 5.610858930419437, 5.3484634144467975, 5.274671365215551, 5.64962194561012, 5.31164638968966, 5.477563087520074, 5.291204761742663, 5.53754296849128, 5.240873313060992, 5.593440267369166, 5.280095342237084, 5.519416394704899, 5.5682471184897935, 5.648550363414033, 5.5941087253502175, 5.20926312558173, 5.263882765813904, 5.635282574839917, 5.228045449545814, 5.64455776954415, 5.496340557172559, 5.6353166360492875, 5.465816657849913, 5.58614772172135, 5.567301192137217, 5.5802242071317085, 5.308887801683322, 5.567702757692857, 5.176827570295778, 5.465333330849296, 5.608828569310152, 5.377270496690263, 5.500820433830097, 5.522551268400862, 5.603680151140848, 5.162913798432603, 5.591952100746163, 5.319047010537121, 5.32731060490658, 5.615510468527129, 5.307901536581214, 5.589154872605666, 5.684462509808476, 5.196063165513691, 5.293893176518853, 5.618042427018129, 5.626641925412425, 5.449026517658638, 5.424021670482725, 5.427263690463729, 5.679018488355135, 5.180020657880377, 5.33649616775938, 5.572703518979089, 5.37208809950545, 5.55987498260867, 5.3731644913506305, 5.611873240031949, 5.3492179060620515, 5.555495026920993, 5.573171387383292, 5.669968673967606, 5.589419117144205, 5.6404784110477575, 5.539033579599596, 5.432951168369421, 5.252287742271777, 5.383436547998453, 5.671255662760615, 5.5043525417701815, 5.419723224851916, 5.577834906222412, 5.41160384890177, 5.4774429710897525, 5.500598105064937, 5.593606205525244, 5.4386510357192694, 5.347244869231928, 5.288758817096781, 5.450098874486761, 5.546448925784649, 5.633637753694131, 5.162827353930055, 5.599332637946858, 5.509613234076461, 5.453447293116463, 5.337825351471992, 5.293207711479476, 5.513068988016252, 5.261744921520243, 5.5670642967512585, 5.102396626193972, 5.2900124002881, 5.645990733078451, 5.460610869725908, 5.418434120019816, 5.548502036298048, 5.680083288294623, 5.452312022759067], "episode_lengths": [59, 89, 106, 53, 62, 51, 61, 118, 56, 45, 48, 42, 52, 58, 52, 91, 59, 61, 61, 92, 56, 92, 122, 45, 91, 55, 51, 56, 63, 63, 55, 56, 50, 55, 65, 44, 59, 55, 84, 59, 58, 80, 58, 61, 58, 92, 68, 67, 76, 68, 100, 84, 93, 51, 64, 79, 92, 45, 70, 64, 74, 66, 129, 55, 72, 71, 54, 68, 87, 69, 78, 58, 52, 54, 86, 84, 67, 103, 58, 53, 78, 57, 65, 73, 61, 80, 66, 130, 64, 61, 108, 114, 88, 59, 67, 41, 69, 90, 79, 91, 91, 118, 67, 63, 73, 68, 82, 114, 57, 65, 53, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2900828144303597, "mean_inference_ms": 1.5903122050961647, "mean_action_processing_ms": 0.1495565790399635, "mean_env_wait_ms": 2.9320289555094954, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 991008, "agent_timesteps_total": 991008, "timers": {"sample_time_ms": 6788.176, "sample_throughput": 1177.341, "load_time_ms": 3.308, "load_throughput": 2416180.313, "learn_time_ms": 6215.183, "learn_throughput": 1285.883, "update_time_ms": 2.943}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03770678490400314, "policy_loss": -0.01115893293172121, "vf_loss": 0.04570494964718819, "vf_explained_var": 0.8190471529960632, "kl": 0.015803875401616096, "entropy": 0.6159785985946655, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 991008, "num_agent_steps_sampled": 991008, "num_steps_trained": 991008, "num_agent_steps_trained": 991008}, "done": false, "episodes_total": 10565, "training_iteration": 124, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-03-38", "timestamp": 1716404618, "time_this_iter_s": 13.981635332107544, "time_total_s": 1661.5140924453735, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1661.5140924453735, "timesteps_since_restore": 0, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 34.105000000000004, "ram_util_percent": 34.135000000000005}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.701800732644239, "episode_reward_min": -0.04230134896386872, "episode_reward_mean": 5.3435554136504075, "episode_len_mean": 72.9, "episode_media": {}, "episodes_this_iter": 110, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9818181818181818, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.01818181818181818, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9636363636363638, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24545454545454545, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.261628140923136, "reward_component_totals/rejoin_dist_change_reward_min": 0.95699727604043, "reward_component_totals/rejoin_dist_change_reward_max": 1.519478612900272, "reward_component_totals/failure_reward_mean": -0.01818181818181818, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.891018181818182, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.959, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.175564631547067, 5.379744101109731, 5.553362236309312, 5.463029593882553, 5.668060763374441, 5.353586534344496, 5.351173317504581, 5.494966160062393, 5.639101173500375, 5.3521242885351965, 5.5626246481891926, 5.560938224998219, 5.484251748989133, 5.3745550678085205, 5.408041060731726, 5.577859409062382, 5.405012622916232, 5.324374034483158, 5.500381854841844, 5.57865243620758, 5.281431035660464, 5.458820660371394, 5.3464886208441555, 5.701800732644239, 5.413071770855055, 5.3164031478123155, 5.659728328944684, 5.421861951933774, 5.620218941287466, -0.04230134896386872, 5.594340247186695, 5.183220586926753, 5.509778842766916, 5.568649889238275, 5.288791154962896, 5.429954497129721, 5.694478612900273, 5.401000430864713, 5.352119875763625, 5.57842135175901, 5.575059631650089, 5.566010676405591, 5.307892069130039, 5.475216130946101, 5.515279205416714, 5.52185614393, 5.549324627243024, 5.293934806667396, 5.626570485407058, 5.209141804485948, 5.548559727889868, 5.558411132769459, 5.4409165796896986, 5.538012563317199, 5.276874285385997, 5.4167484548394755, 5.526580608156374, 5.515936436538141, 5.499463951423973, 5.196291867557255, 5.2381597668040945, 5.333596417017612, 5.503191320482761, 5.50450913645173, 5.536955680097982, 5.15699727604043, 5.605102195395841, 5.404225756081702, 5.219399342519223, 5.411972003658251, 5.307098060509972, 5.562613505871971, 5.369883241539586, 5.187725730414552, 5.318607804540821, 5.359480156499474, 5.28604880353175, 5.402896696765236, 5.558904821728298, 5.607021026274072, 5.513337767060552, 5.521862654365468, 5.431998530644961, 0.32667897061830686, 5.180540882013186, 5.597616234391248, 5.625482731828273, 5.648776330090896, 5.283382094189683, 5.607565658649861, 5.318310297981622, 5.415612086949308, 5.498887944439783, 5.3507882644874165, 5.40457070531118, 5.441299899054872, 5.516820144925734, 5.350945144655348, 5.3828887018986045, 5.369860823076937, 5.500438354454432, 5.536466025235396, 5.512197515373521, 5.261662613913234, 5.360268902393959, 5.177784033225228, 5.529221569419844, 5.3385883381408625, 5.47357564115393, 5.295513471239859], "episode_lengths": [100, 103, 103, 70, 54, 41, 100, 105, 62, 48, 50, 53, 62, 87, 62, 66, 47, 41, 82, 46, 62, 80, 92, 52, 58, 88, 58, 47, 69, 11, 74, 67, 60, 83, 116, 51, 75, 69, 46, 91, 56, 125, 64, 87, 52, 102, 80, 71, 66, 85, 115, 98, 66, 100, 82, 131, 74, 58, 79, 69, 63, 77, 75, 76, 68, 50, 53, 69, 46, 79, 71, 86, 91, 69, 41, 62, 80, 49, 110, 81, 60, 76, 52, 20, 53, 134, 61, 52, 54, 50, 72, 53, 46, 88, 99, 67, 130, 59, 53, 71, 54, 83, 107, 138, 54, 108, 99, 107, 71, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28978912647446553, "mean_inference_ms": 1.5922210283759366, "mean_action_processing_ms": 0.14972512512826625, "mean_env_wait_ms": 2.9345961412091275, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 999000, "agent_timesteps_total": 999000, "timers": {"sample_time_ms": 6913.964, "sample_throughput": 1155.921, "load_time_ms": 3.189, "load_throughput": 2505915.328, "learn_time_ms": 6250.522, "learn_throughput": 1278.613, "update_time_ms": 2.971}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04589997977018356, "policy_loss": -0.013965467922389507, "vf_loss": 0.057043302804231644, "vf_explained_var": 0.8024658560752869, "kl": 0.014110763557255268, "entropy": 0.6243132948875427, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 999000, "num_agent_steps_sampled": 999000, "num_steps_trained": 999000, "num_agent_steps_trained": 999000}, "done": false, "episodes_total": 10675, "training_iteration": 125, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-03-52", "timestamp": 1716404632, "time_this_iter_s": 13.978687524795532, "time_total_s": 1675.492779970169, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1675.492779970169, "timesteps_since_restore": 0, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 34.709999999999994, "ram_util_percent": 34.20000000000001}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.69245896577622, "episode_reward_min": 0.015285658589594742, "episode_reward_mean": 5.349701645686582, "episode_len_mean": 67.31932773109244, "episode_media": {}, "episodes_this_iter": 119, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9831932773109243, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.01680672268907563, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.966386554621849, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24579831932773108, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.254861309552129, "reward_component_totals/rejoin_dist_change_reward_min": 0.9377667597604398, "reward_component_totals/rejoin_dist_change_reward_max": 1.506458965776221, "reward_component_totals/failure_reward_mean": -0.01680672268907563, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.89946218487395, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.964, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.536750759124532, 5.616960762480336, 5.305189271284439, 5.402689898077004, 5.469075426957447, 5.674959893311247, 5.589353181336958, 5.260538986746539, 5.559101805464765, 5.401765403019182, 5.377911588741653, 5.1999591066689685, 5.6178498261475, 5.428747112230752, 5.437758843944929, 5.16449904148371, 5.638478703943507, 5.648385913421528, 5.165910536831248, 5.617552113377055, 5.4013461548976025, 5.266726698755548, 5.629655622616415, 5.104152646737573, 5.176090764202503, 5.455975568538334, 5.475299983328695, 5.384894903940758, 5.253299380368771, 5.553586594159709, 5.357127139058097, 5.579879624082643, 5.611652727357204, 5.167523719300802, 5.615922812364582, 5.4576305460928065, 5.324100772081083, 5.445823924503047, 5.433159172609064, 5.495271050985426, 5.465384565332657, 5.263592761346052, 5.467632468311662, 5.632065284598212, 5.666786202398668, 5.676252592541363, 5.532849687812304, 5.5464749514836384, 5.230685520556403, 5.504910397705595, 5.42550114899522, 5.566408520791363, 5.614629986300124, 5.3283508335704335, 5.543329682991702, 5.155960772810167, 5.220713741578187, 5.50633296844323, 5.508177519388374, 5.1485808308464875, 5.4348170359085, 5.1928833197272475, 5.566794650196025, 5.69245896577622, 5.367628956979619, 5.474009493021388, 5.357780919840408, 5.14776675976044, 5.18858877828584, 5.27427375147888, 5.278062067552894, 5.2911311307850655, 5.618200143295322, 5.560026083895887, 0.09205262504821365, 5.6013660153253895, 5.339772014778203, 5.243667455183745, 5.483244526239258, 5.143885349527737, 5.459177033493306, 5.547486210039137, 5.564252419895732, 5.375160963072528, 5.253302551296342, 5.428557497335708, 5.621002325687157, 5.553758243542599, 5.524390360962574, 5.613871055724907, 5.392970848500698, 5.643291101359477, 5.639916692391138, 5.636660514234309, 5.541333560674307, 5.236608549855308, 5.172199775309151, 5.26319971496263, 5.3994277282623235, 5.363911024105317, 5.4208147733460486, 5.6118778505248965, 5.457003573345098, 5.433556795333308, 5.338678900198331, 5.637868091316886, 5.453684861013505, 5.316447497301008, 5.577074371497066, 5.616218426561317, 5.49586105115789, 5.468238141444213, 5.623079418043481, 5.447385784814109, 5.167774444177438, 5.441975536471, 5.614859211692582, 5.590744818188834, 0.015285658589594742], "episode_lengths": [61, 68, 50, 77, 61, 64, 119, 129, 100, 68, 51, 68, 75, 58, 71, 40, 85, 65, 36, 50, 68, 57, 64, 121, 44, 72, 74, 56, 43, 93, 52, 85, 88, 94, 81, 87, 64, 46, 45, 44, 71, 39, 72, 48, 58, 72, 61, 60, 98, 97, 51, 49, 51, 64, 83, 83, 54, 100, 83, 68, 96, 38, 81, 64, 59, 44, 73, 40, 61, 68, 68, 49, 56, 54, 27, 55, 104, 51, 143, 48, 109, 54, 76, 54, 45, 75, 50, 84, 58, 81, 107, 53, 65, 72, 67, 85, 38, 69, 55, 63, 72, 63, 76, 51, 88, 72, 73, 57, 56, 93, 54, 49, 78, 83, 65, 59, 53, 74, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2886362220398713, "mean_inference_ms": 1.5923290421551484, "mean_action_processing_ms": 0.1497943394539301, "mean_env_wait_ms": 2.9349505817591677, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1006992, "agent_timesteps_total": 1006992, "timers": {"sample_time_ms": 7058.891, "sample_throughput": 1132.189, "load_time_ms": 3.259, "load_throughput": 2452005.557, "learn_time_ms": 6327.227, "learn_throughput": 1263.113, "update_time_ms": 2.98}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.050635118037462234, "policy_loss": -0.01733693853020668, "vf_loss": 0.06518382579088211, "vf_explained_var": 0.798978865146637, "kl": 0.013941152021288872, "entropy": 0.6061629056930542, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1006992, "num_agent_steps_sampled": 1006992, "num_steps_trained": 1006992, "num_agent_steps_trained": 1006992}, "done": false, "episodes_total": 10794, "training_iteration": 126, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-04-05", "timestamp": 1716404645, "time_this_iter_s": 13.568006038665771, "time_total_s": 1689.0607860088348, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1689.0607860088348, "timesteps_since_restore": 0, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 34.199999999999996, "ram_util_percent": 34.20000000000001}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.70672696340829, "episode_reward_min": 0.18790188908309524, "episode_reward_mean": 5.361552021420127, "episode_len_mean": 72.2, "episode_media": {}, "episodes_this_iter": 110, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9818181818181818, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.01818181818181818, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9636363636363638, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24545454545454545, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2788611123292182, "reward_component_totals/rejoin_dist_change_reward_min": 0.9528327585119656, "reward_component_totals/rejoin_dist_change_reward_max": 1.519726963408289, "reward_component_totals/failure_reward_mean": -0.01818181818181818, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.8917818181818182, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.963, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.248639932518272, 5.296538896134716, 5.595022881735765, 5.29248103551846, 5.603967583496911, 5.658158743505096, 5.5900027612126255, 5.602724491756904, 5.598765451165001, 5.3944886460026815, 5.202191776315734, 5.342557071320188, 5.412807802184744, 5.218960793732008, 5.540877081439232, 5.381545721179341, 5.621142845216982, 5.444760052152866, 5.549591137007134, 5.652732658231216, 5.666436359959613, 5.547626835468202, 5.604713957251089, 5.601621655746443, 5.593286045560831, 5.6070046886937455, 5.533280521403105, 5.612679931573175, 5.408258607251371, 5.523447454745852, 5.70672696340829, 5.434014080384353, 5.432405144560377, 5.298213394340149, 5.482176660753814, 5.329415755578772, 5.571402352989773, 5.2468869620596825, 5.644654151821831, 5.560561831267628, 5.558284367253208, 5.63114164245135, 5.428917075647407, 5.35949066123187, 5.567490634702116, 5.503111495895574, 5.573056149870483, 5.2427827597149035, 5.233982192273045, 5.491321362913769, 5.392165369749875, 5.209173771091576, 5.2691918113159915, 5.35779184574906, 0.18790188908309524, 5.391922594737365, 5.578169799048497, 5.270274029612578, 5.318349241447194, 5.557893194007333, 5.537319935529173, 5.534839529231762, 5.697991137939386, 5.471413518295739, 0.3412571018266384, 5.565991529766617, 5.231375084106936, 5.515972356153554, 5.54431462327798, 5.472715237608639, 5.596949828623192, 5.5857493887135075, 5.6149743326542065, 5.6395739450748446, 5.432699616283465, 5.306946264585456, 5.23479482723124, 5.2417048180946555, 5.245976155659194, 5.482602458761436, 5.585103151807504, 5.181559620063119, 5.502378663256662, 5.585189163486142, 5.572763966603116, 5.557046481688936, 5.529204980811036, 5.286650922768472, 5.585868931301728, 5.161984414579555, 5.495995700630506, 5.38514714686216, 5.2190668522057715, 5.259738261548869, 5.3640144999802, 5.588983227152098, 5.401861781854848, 5.186392962264481, 5.122832758511967, 5.285096879249859, 5.566491672581723, 5.353740218029376, 5.576868492402726, 5.558065790248251, 5.251528008436956, 5.617549629243664, 5.457537338678738, 5.619966209164662, 5.3895700517705665, 5.452180285172457], "episode_lengths": [114, 79, 104, 37, 58, 51, 49, 86, 73, 67, 76, 41, 123, 112, 87, 98, 72, 91, 51, 85, 46, 84, 62, 56, 79, 79, 149, 103, 60, 59, 63, 78, 77, 70, 67, 93, 62, 80, 64, 114, 116, 50, 110, 45, 92, 44, 53, 43, 84, 81, 59, 86, 44, 119, 15, 46, 61, 40, 99, 73, 101, 63, 71, 49, 23, 72, 81, 83, 80, 49, 79, 81, 81, 107, 54, 94, 65, 100, 62, 68, 67, 48, 73, 65, 84, 65, 73, 50, 93, 68, 52, 43, 83, 69, 76, 54, 77, 87, 80, 80, 60, 45, 68, 54, 103, 57, 63, 54, 55, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2883184825704628, "mean_inference_ms": 1.5928792627154575, "mean_action_processing_ms": 0.14985797801555514, "mean_env_wait_ms": 2.936450129172379, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1014984, "agent_timesteps_total": 1014984, "timers": {"sample_time_ms": 7140.021, "sample_throughput": 1119.324, "load_time_ms": 3.319, "load_throughput": 2407659.314, "learn_time_ms": 6369.079, "learn_throughput": 1254.812, "update_time_ms": 3.047}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05921170487999916, "policy_loss": -0.016142548993229866, "vf_loss": 0.07236241549253464, "vf_explained_var": 0.7648585438728333, "kl": 0.014959190040826797, "entropy": 0.6403809785842896, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1014984, "num_agent_steps_sampled": 1014984, "num_steps_trained": 1014984, "num_agent_steps_trained": 1014984}, "done": false, "episodes_total": 10904, "training_iteration": 127, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-04-19", "timestamp": 1716404659, "time_this_iter_s": 13.770440340042114, "time_total_s": 1702.831226348877, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1702.831226348877, "timesteps_since_restore": 0, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 34.964999999999996, "ram_util_percent": 34.29999999999999}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.694646848492965, "episode_reward_min": 0.008034503083205857, "episode_reward_mean": 5.392100266694698, "episode_len_mean": 68.68695652173913, "episode_media": {}, "episodes_this_iter": 115, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.991304347826087, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.008695652173913044, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9826086956521742, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24782608695652175, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2563263536512195, "reward_component_totals/rejoin_dist_change_reward_min": 0.9395879016981752, "reward_component_totals/rejoin_dist_change_reward_max": 1.5103857059541135, "reward_component_totals/failure_reward_mean": -0.008695652173913044, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9140347826086954, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.962, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.500136663299484, 5.557596700201378, 5.514178283299085, 5.2777098265958715, 5.4151376821514265, 5.433995666628126, 5.51730508563703, 5.256900860757549, 5.206836194797426, 5.606828551129087, 5.500985146095704, 5.463630456759962, 5.275629790031702, 5.396552935845781, 5.581427541222121, 5.538369072722073, 5.556598886334239, 5.4926133817483915, 5.324796502132006, 5.494111344574412, 5.345402147056234, 5.2211997133509165, 5.2324223694090435, 5.545754924907353, 5.583813898674347, 5.367725076954175, 5.221154004458246, 5.458846036776151, 5.479648287023826, 5.312747192824195, 5.452583956819074, 5.51341919497923, 5.688385705954113, 5.1642958237061105, 5.575296130153909, 5.4052011266798505, 5.506686899198234, 5.082812958999265, 5.542144653198651, 5.324990046844964, 5.52480798082475, 5.367535225656234, 5.395575192889574, 5.577020654921121, 5.462862153181192, 5.553934023745363, 5.624750564503859, 5.57540774466853, 5.387809086842104, 5.6312971870395145, 5.361278118006798, 5.507133362970251, 5.299017762306172, 5.2792858986916595, 5.589241520071759, 5.488161689262418, 5.359757480926152, 5.65993497818801, 5.181176475398781, 5.659117604861443, 5.4552027743038725, 5.1345879016981755, 5.399783603731445, 5.501141845620788, 5.344020998522543, 5.429189241855236, 5.488178905913755, 5.65903921435331, 5.682821521247759, 5.487367718630616, 5.549179368137947, 5.6567446011303195, 5.51023358812833, 5.242830251585807, 5.466905781587718, 5.623540969620743, 5.224560643446267, 5.267598864993868, 5.458929673374804, 5.4313964271217126, 5.272551166222831, 5.570319275123361, 5.338238185987052, 5.41190997524972, 5.304094066027244, 5.37393302889266, 5.226380808781965, 5.568536978437519, 5.354702122903202, 5.293168444056157, 5.5012722545048565, 5.393581098202613, 5.190587041853506, 5.587968175216589, 5.6083965841145265, 5.447786810590338, 5.453796674008684, 5.449421545655568, 5.650226079346863, 5.490377703706926, 5.279530149540508, 5.518221551617415, 5.414322740091717, 5.3507579449663965, 5.506821470719729, 5.56036811350013, 5.309723919284043, 5.479145978303475, 0.008034503083205857, 5.500877867417781, 5.516115344934377, 5.342179037054967, 5.417945805104029, 5.694646848492965, 5.271362057005834], "episode_lengths": [47, 60, 55, 64, 78, 115, 48, 72, 72, 72, 80, 42, 50, 41, 112, 78, 88, 62, 44, 59, 46, 65, 40, 74, 96, 41, 119, 88, 46, 55, 46, 71, 72, 97, 54, 56, 90, 109, 48, 74, 84, 60, 44, 85, 54, 51, 50, 56, 49, 65, 57, 63, 59, 66, 61, 89, 49, 50, 96, 76, 140, 55, 45, 75, 51, 55, 72, 66, 56, 83, 58, 90, 65, 98, 116, 100, 49, 75, 75, 65, 73, 73, 96, 58, 73, 79, 104, 64, 112, 45, 51, 68, 57, 117, 89, 96, 66, 63, 54, 43, 79, 62, 38, 44, 79, 59, 57, 45, 13, 60, 99, 60, 90, 56, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2903323718036427, "mean_inference_ms": 1.5927764245694667, "mean_action_processing_ms": 0.149899108677559, "mean_env_wait_ms": 2.938317131286372, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1022976, "agent_timesteps_total": 1022976, "timers": {"sample_time_ms": 7185.59, "sample_throughput": 1112.226, "load_time_ms": 3.38, "load_throughput": 2364755.176, "learn_time_ms": 6397.722, "learn_throughput": 1249.195, "update_time_ms": 3.044}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03493655100464821, "policy_loss": -0.01579015888273716, "vf_loss": 0.048080090433359146, "vf_explained_var": 0.8238979578018188, "kl": 0.013233095407485962, "entropy": 0.59146648645401, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1022976, "num_agent_steps_sampled": 1022976, "num_steps_trained": 1022976, "num_agent_steps_trained": 1022976}, "done": false, "episodes_total": 11019, "training_iteration": 128, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-04-33", "timestamp": 1716404673, "time_this_iter_s": 13.743910551071167, "time_total_s": 1716.5751368999481, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1716.5751368999481, "timesteps_since_restore": 0, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 34.36, "ram_util_percent": 34.150000000000006}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.702537667249539, "episode_reward_min": 5.130827927264088, "episode_reward_mean": 5.44331662968856, "episode_len_mean": 73.10810810810811, "episode_media": {}, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.26642473779667, "reward_component_totals/rejoin_dist_change_reward_min": 0.9378279272640875, "reward_component_totals/rejoin_dist_change_reward_max": 1.5080775523827474, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.926891891891892, "reward_component_totals/success_reward_min": 1.8519999999999999, "reward_component_totals/success_reward_max": 1.963}, "hist_stats": {"episode_reward": [5.29779417375852, 5.2289581270863925, 5.504294358500733, 5.163633186316087, 5.463347581837467, 5.632365316929937, 5.420691459438684, 5.576623764118255, 5.560468440998177, 5.1436385834523985, 5.501221740399415, 5.318329320749326, 5.5683562132323505, 5.506655047162816, 5.463295754342442, 5.28409525148235, 5.496601642659519, 5.450494186432169, 5.230777407675101, 5.221448638522098, 5.5436425299140755, 5.322420391087327, 5.3033092931932035, 5.5965355306531706, 5.130827927264088, 5.370838441171481, 5.595590989387091, 5.381753225592272, 5.273148611210508, 5.603585987116755, 5.58306152930235, 5.210777206453791, 5.14922927331436, 5.489161006001762, 5.486734306356862, 5.327797413805509, 5.594562489640455, 5.210459370272915, 5.194272234499829, 5.356450952194477, 5.584261956278144, 5.506311689678967, 5.4617649550139, 5.590229019524328, 5.470920899890865, 5.490074124505828, 5.574116163242644, 5.3718801613959455, 5.702537667249539, 5.492352748151975, 5.549370821999906, 5.255562567403484, 5.611108641311002, 5.5994248221049405, 5.451167526920715, 5.302465506697264, 5.637869096109817, 5.136803588395596, 5.460696381297401, 5.232569701099998, 5.492568064146244, 5.670077552382747, 5.631204691074832, 5.683111640000085, 5.410314033984893, 5.438590705995341, 5.407283296022582, 5.48762796490623, 5.677061987398268, 5.51254000724442, 5.59668150731504, 5.571464550412434, 5.259511181195291, 5.659887256696484, 5.210516526387904, 5.350986726009192, 5.593061511298635, 5.6300021082368765, 5.561495982572643, 5.636857437544176, 5.6183541498626965, 5.586560114226709, 5.277654640063407, 5.6681503600859, 5.4998521425636, 5.201931961141767, 5.472442352992363, 5.4567024541514275, 5.1845312925152935, 5.272979045811516, 5.570862241789175, 5.604826905798905, 5.563712278387304, 5.14995957235684, 5.282107599340404, 5.571517530439104, 5.646316727414648, 5.2914680420081535, 5.548441624323793, 5.423554575137341, 5.600335444373167, 5.371655637310221, 5.628807246059752, 5.299470520730394, 5.58792801836629, 5.3654778042658915, 5.3473569097623805, 5.369712810444678, 5.435058371542645, 5.271238251640902, 5.319597597900609], "episode_lengths": [99, 66, 107, 120, 42, 51, 49, 58, 69, 74, 67, 65, 116, 66, 52, 50, 70, 65, 61, 48, 66, 60, 109, 88, 57, 90, 84, 51, 58, 58, 60, 37, 70, 88, 51, 55, 65, 96, 66, 54, 79, 61, 72, 117, 83, 103, 81, 77, 49, 104, 81, 59, 72, 62, 50, 45, 64, 126, 56, 87, 51, 88, 67, 73, 46, 102, 94, 73, 52, 50, 54, 60, 44, 56, 78, 123, 103, 83, 134, 57, 71, 53, 74, 64, 50, 103, 42, 72, 98, 49, 114, 81, 50, 108, 84, 56, 51, 98, 48, 57, 99, 123, 51, 87, 83, 42, 148, 89, 87, 47, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28950288090367177, "mean_inference_ms": 1.5941727783865844, "mean_action_processing_ms": 0.149936277369123, "mean_env_wait_ms": 2.940026051547031, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1030968, "agent_timesteps_total": 1030968, "timers": {"sample_time_ms": 7201.373, "sample_throughput": 1109.788, "load_time_ms": 3.374, "load_throughput": 2368866.166, "learn_time_ms": 6411.246, "learn_throughput": 1246.56, "update_time_ms": 3.034}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.033740557730197906, "policy_loss": -0.014361926354467869, "vf_loss": 0.04467909410595894, "vf_explained_var": 0.8346784114837646, "kl": 0.0171169675886631, "entropy": 0.5807113647460938, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1030968, "num_agent_steps_sampled": 1030968, "num_steps_trained": 1030968, "num_agent_steps_trained": 1030968}, "done": false, "episodes_total": 11130, "training_iteration": 129, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-04-47", "timestamp": 1716404687, "time_this_iter_s": 13.69750165939331, "time_total_s": 1730.2726385593414, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1730.2726385593414, "timesteps_since_restore": 0, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 34.52105263157895, "ram_util_percent": 34.1}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.68790392274145, "episode_reward_min": 5.154925001886118, "episode_reward_mean": 5.449318443276487, "episode_len_mean": 74.66037735849056, "episode_media": {}, "episodes_this_iter": 106, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2739788206349782, "reward_component_totals/rejoin_dist_change_reward_min": 1.0131691599484962, "reward_component_totals/rejoin_dist_change_reward_max": 1.5067504351135435, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9253396226415096, "reward_component_totals/success_reward_min": 1.8599999999999999, "reward_component_totals/success_reward_max": 1.959}, "hist_stats": {"episode_reward": [5.452922668728216, 5.492896428726166, 5.633233109369714, 5.501906379121641, 5.556231791945238, 5.548015663378411, 5.6737504351135435, 5.623879692894869, 5.452698464899458, 5.382747153698507, 5.402169752775818, 5.53787851477642, 5.287603641917414, 5.403386741679616, 5.286551486097784, 5.488616930012417, 5.326570101180053, 5.154925001886118, 5.346832213340836, 5.424534833719546, 5.281897999981992, 5.441349974005819, 5.310410831737482, 5.460019927629976, 5.337435031075208, 5.600294110976259, 5.539266155983577, 5.5309604843714135, 5.559628523388498, 5.516201740712294, 5.480386391011574, 5.637099386571304, 5.20806508503536, 5.349434723057387, 5.661292356973975, 5.601738955780619, 5.2769086297724925, 5.4786585059360995, 5.252028899836612, 5.468297644771613, 5.453979588513677, 5.529102428267116, 5.3938098601335795, 5.519801781178386, 5.325868796395771, 5.564368756732007, 5.45832434920237, 5.613885216778485, 5.341583676213887, 5.5702988012974135, 5.242254957511272, 5.341075497532837, 5.289287403202956, 5.4612189824198545, 5.430435669308693, 5.669188093923701, 5.5178409935666926, 5.681240099306784, 5.43413028625322, 5.68790392274145, 5.358065786964794, 5.489613814745711, 5.455999199821888, 5.380638313849299, 5.428079234378691, 5.600622067018593, 5.605092979812387, 5.421554512716141, 5.5609476282032535, 5.519120622056198, 5.582035065090459, 5.572033841956017, 5.519453304290172, 5.639746775928181, 5.626453631985532, 5.606562393963925, 5.484107558632978, 5.536487966547476, 5.649086247691594, 5.222656502680303, 5.290859136866878, 5.304333493410029, 5.588805928311995, 5.5048878363625375, 5.199169159948497, 5.408739545942143, 5.664431882846179, 5.27110017334615, 5.409376295698948, 5.570093028842962, 5.613599995560394, 5.4494569876440675, 5.309260479651793, 5.485620781551086, 5.206426732299173, 5.334471651879175, 5.442072633219029, 5.223631094681412, 5.4910726086967365, 5.270066373661664, 5.263900426949579, 5.220407251644454, 5.599297471628672, 5.336297673194766, 5.203855866861213, 5.21383750392309], "episode_lengths": [80, 80, 44, 47, 139, 81, 83, 105, 114, 53, 128, 67, 74, 65, 60, 83, 97, 110, 65, 104, 97, 88, 63, 125, 76, 56, 85, 77, 57, 90, 107, 58, 81, 43, 61, 60, 70, 140, 85, 79, 104, 55, 70, 130, 66, 102, 51, 47, 102, 120, 75, 65, 49, 44, 46, 52, 123, 51, 94, 50, 61, 68, 56, 82, 68, 125, 44, 91, 59, 70, 64, 78, 88, 68, 46, 66, 72, 64, 52, 50, 49, 68, 54, 101, 64, 79, 78, 50, 58, 56, 60, 91, 41, 92, 62, 59, 64, 68, 92, 46, 54, 89, 117, 44, 82, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2883702201524208, "mean_inference_ms": 1.5948488308274134, "mean_action_processing_ms": 0.15008672939703746, "mean_env_wait_ms": 2.940180412157253, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1038960, "agent_timesteps_total": 1038960, "timers": {"sample_time_ms": 7204.822, "sample_throughput": 1109.257, "load_time_ms": 3.387, "load_throughput": 2359877.332, "learn_time_ms": 6440.724, "learn_throughput": 1240.854, "update_time_ms": 3.043}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0265701562166214, "policy_loss": -0.01539363618940115, "vf_loss": 0.03933112323284149, "vf_explained_var": 0.8453745245933533, "kl": 0.013163345865905285, "entropy": 0.644712507724762, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1038960, "num_agent_steps_sampled": 1038960, "num_steps_trained": 1038960, "num_agent_steps_trained": 1038960}, "done": false, "episodes_total": 11236, "training_iteration": 130, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-05-00", "timestamp": 1716404700, "time_this_iter_s": 13.73796796798706, "time_total_s": 1744.0106065273285, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1744.0106065273285, "timesteps_since_restore": 0, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 34.09499999999999, "ram_util_percent": 34.125000000000014}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.676481793076732, "episode_reward_min": 5.11479723103724, "episode_reward_mean": 5.4397373593325735, "episode_len_mean": 76.18867924528301, "episode_media": {}, "episodes_this_iter": 106, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2659260385778566, "reward_component_totals/rejoin_dist_change_reward_min": 0.9327972310372394, "reward_component_totals/rejoin_dist_change_reward_max": 1.5001391094506873, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.923811320754717, "reward_component_totals/success_reward_min": 1.849, "reward_component_totals/success_reward_max": 1.96}, "hist_stats": {"episode_reward": [5.5667641454786425, 5.619254097051536, 5.416347693494581, 5.618594573489418, 5.240027468379093, 5.415537429041402, 5.595188374341509, 5.390991428712221, 5.214821533073209, 5.354683555477128, 5.5423778050238806, 5.3205168314623466, 5.598433580435926, 5.591298421135391, 5.6481289752197705, 5.406923338416984, 5.452820929233143, 5.4502786051690695, 5.5504993757299435, 5.428071817523124, 5.517731553613237, 5.437036773908329, 5.146446009630005, 5.360930073254637, 5.277943875823783, 5.596271138661506, 5.668219964435115, 5.621141238285416, 5.552886388484237, 5.352694583779192, 5.534379365536115, 5.62023598243032, 5.59071277044524, 5.316548508285459, 5.435230892863885, 5.174017871083093, 5.4359286146532515, 5.590284790239806, 5.622423535855816, 5.271033501342499, 5.644102979857513, 5.623891462816349, 5.411541266857011, 5.503906547282774, 5.561848886529359, 5.542522342222897, 5.4060603038984265, 5.172075195810974, 5.570294448299391, 5.258095417433191, 5.38979250462549, 5.447013806173493, 5.207744840593003, 5.214982256789272, 5.431372809403037, 5.226492832355239, 5.326345938032922, 5.2653006615324, 5.370889530410871, 5.42652878485643, 5.4878371053535595, 5.223431639158892, 5.2465806783864135, 5.408696289765647, 5.332421828397252, 5.390391287103347, 5.576021658200178, 5.596544350146431, 5.57965218319919, 5.483403678047543, 5.413363942518663, 5.11479723103724, 5.633219576200401, 5.541620368124954, 5.34192798863223, 5.676481793076732, 5.472150997638266, 5.283158624094416, 5.521510866491108, 5.472283733743794, 5.318537619710984, 5.5652959824827555, 5.536938865071002, 5.219948982159044, 5.521677110177185, 5.446269382704786, 5.647139109450686, 5.562861307297319, 5.435050994119937, 5.659096137409287, 5.3472691936708685, 5.307270032820834, 5.309800176904766, 5.456979033636834, 5.642251804162491, 5.275427609985312, 5.643218303479248, 5.354751298042672, 5.490421724558312, 5.224468763757102, 5.320323987305117, 5.2960475594141805, 5.294912854697124, 5.334194014840252, 5.587525656279031, 5.474526539520107], "episode_lengths": [125, 116, 61, 63, 106, 100, 89, 61, 62, 67, 51, 64, 143, 104, 45, 77, 44, 95, 50, 56, 70, 123, 109, 65, 45, 84, 61, 66, 88, 41, 151, 60, 75, 43, 71, 95, 44, 56, 51, 64, 84, 56, 66, 112, 86, 74, 75, 65, 63, 100, 56, 79, 88, 84, 117, 96, 65, 70, 50, 52, 53, 67, 72, 74, 72, 114, 86, 50, 77, 89, 71, 68, 90, 127, 94, 54, 43, 47, 77, 126, 86, 62, 67, 82, 56, 86, 103, 79, 93, 72, 40, 71, 94, 62, 55, 94, 91, 63, 120, 81, 63, 59, 53, 41, 111, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2897676153765262, "mean_inference_ms": 1.5959739496734262, "mean_action_processing_ms": 0.15017155625917292, "mean_env_wait_ms": 2.9438518246094834, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1046952, "agent_timesteps_total": 1046952, "timers": {"sample_time_ms": 7298.617, "sample_throughput": 1095.002, "load_time_ms": 3.393, "load_throughput": 2355168.488, "learn_time_ms": 6457.662, "learn_throughput": 1237.6, "update_time_ms": 3.013}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.037176091223955154, "policy_loss": -0.010136064141988754, "vf_loss": 0.04495764896273613, "vf_explained_var": 0.8255950212478638, "kl": 0.011772572062909603, "entropy": 0.5987790822982788, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1046952, "num_agent_steps_sampled": 1046952, "num_steps_trained": 1046952, "num_agent_steps_trained": 1046952}, "done": false, "episodes_total": 11342, "training_iteration": 131, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-05-15", "timestamp": 1716404715, "time_this_iter_s": 14.31450867652893, "time_total_s": 1758.3251152038574, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1758.3251152038574, "timesteps_since_restore": 0, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 34.565, "ram_util_percent": 34.21999999999999}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.676556108904217, "episode_reward_min": 0.08187551971358109, "episode_reward_mean": 5.303888182164243, "episode_len_mean": 68.67521367521367, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9743589743589743, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.02564102564102564, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.948717948717949, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24358974358974358, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2565804898565498, "reward_component_totals/rejoin_dist_change_reward_min": 0.931035339105597, "reward_component_totals/rejoin_dist_change_reward_max": 1.4910005897513205, "reward_component_totals/failure_reward_mean": -0.02564102564102564, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.8806410256410253, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.963, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.595467211645013, 5.224953601056399, 5.613428731672545, 5.479075774104822, 5.448341585825455, 5.483878301873332, 5.589767417445643, 5.512817516445082, 5.6110361757645, 5.675951365458727, 5.152249818586441, 0.24687226483859748, 5.361952117494501, 5.571482878412394, 5.176812975397706, 5.633000589751322, 5.416744471279085, 5.46194447897755, 5.580893707964413, 5.317137814781592, 5.4189807324569355, 5.294273584671601, 5.34920592052249, 5.396633780222457, 5.317155022396223, 5.411955213592492, 5.1440353391055975, 5.623451561957527, 5.5202107009744275, 5.112105468537228, 5.2940485178786485, 5.3700352520489325, 5.466515774293191, 5.381914149779789, 5.6181406939617045, 5.244571137217004, 5.588735586696586, 5.607347624144651, 5.319583608880283, 5.581885605044873, 5.598236559889484, 5.6071514666984665, 5.193399054252294, 5.2939151952684425, 5.255544615389789, 5.353536360140138, 5.644266379066824, 5.235926958470184, 5.349308226289489, 5.538511983805549, 5.382634373770724, 5.642298632875603, 5.38257313402517, 5.375863769052113, 5.597612022896985, 5.4373102536685485, 5.406274501631901, 5.320726584348817, 5.263125955635807, 5.433121034515734, 5.307017482067065, 5.53535611561124, 5.6587448208765245, 5.387983315285445, 5.545201661118762, 5.576136552507545, 5.6156990058641725, 5.528768883977612, 5.398166114923129, 5.457853984972907, 5.462545183225429, 5.208559411596029, 5.619532923416834, 5.418673996339821, 5.526018149230071, 5.634727083893077, 5.478587999201445, 5.58889004310238, 5.381784744143243, 5.341877337667427, 5.495143015422967, 5.5374421929952575, 5.661657618301552, 5.371347258479347, 5.540762128680843, 5.656421374117205, 5.592783165259257, 5.285203300809943, 5.544427490988591, 5.2610775024409495, 5.308921165866261, 5.4156091903932095, 5.236131345057828, 5.382073752140929, 5.244550241765575, 5.55535983970445, 0.34027029192391045, 5.354229390644788, 5.399745722024562, 5.366490060357541, 5.239049266319224, 0.08187551971358109, 5.554056579662631, 5.596460457960853, 5.27030835437943, 5.383574296371258, 5.537014625744536, 5.676556108904217, 5.51011766127759, 5.152335520281198, 5.234974407205295, 5.552873741870998, 5.440941709376213, 5.156665353827471, 5.52914320092273, 5.365862605333321, 5.525405912820878], "episode_lengths": [97, 65, 51, 61, 55, 104, 123, 71, 49, 58, 78, 17, 66, 119, 45, 108, 133, 75, 77, 64, 51, 119, 74, 89, 102, 49, 37, 74, 58, 107, 59, 51, 59, 50, 57, 37, 54, 88, 64, 58, 61, 53, 93, 51, 72, 106, 70, 111, 65, 107, 70, 57, 88, 70, 49, 49, 44, 45, 78, 38, 56, 89, 67, 76, 42, 69, 75, 55, 51, 47, 56, 78, 65, 77, 78, 84, 57, 98, 59, 72, 106, 52, 50, 74, 62, 80, 44, 95, 47, 63, 52, 79, 50, 64, 64, 73, 29, 73, 45, 92, 71, 24, 67, 56, 73, 64, 46, 56, 53, 37, 39, 81, 104, 88, 134, 85, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2885329820900283, "mean_inference_ms": 1.5967043792855307, "mean_action_processing_ms": 0.15026215348065375, "mean_env_wait_ms": 2.9451056460321534, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1054944, "agent_timesteps_total": 1054944, "timers": {"sample_time_ms": 7331.991, "sample_throughput": 1090.018, "load_time_ms": 3.449, "load_throughput": 2316977.886, "learn_time_ms": 6485.119, "learn_throughput": 1232.36, "update_time_ms": 2.953}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.08133578300476074, "policy_loss": -0.01843285746872425, "vf_loss": 0.09689024090766907, "vf_explained_var": 0.7321482300758362, "kl": 0.014391924254596233, "entropy": 0.5846449136734009, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1054944, "num_agent_steps_sampled": 1054944, "num_steps_trained": 1054944, "num_agent_steps_trained": 1054944}, "done": false, "episodes_total": 11459, "training_iteration": 132, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-05-29", "timestamp": 1716404729, "time_this_iter_s": 14.107996940612793, "time_total_s": 1772.4331121444702, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1772.4331121444702, "timesteps_since_restore": 0, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 34.19500000000001, "ram_util_percent": 34.269999999999996}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.70427470765071, "episode_reward_min": 5.145103974346365, "episode_reward_mean": 5.448359717012902, "episode_len_mean": 71.23893805309734, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.269598655066, "reward_component_totals/rejoin_dist_change_reward_min": 0.9578669686133119, "reward_component_totals/rejoin_dist_change_reward_max": 1.5233009069793066, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9287610619469029, "reward_component_totals/success_reward_min": 1.857, "reward_component_totals/success_reward_max": 1.964}, "hist_stats": {"episode_reward": [5.28962668419231, 5.683285998209941, 5.31194613169799, 5.2170125135221745, 5.490968603205515, 5.5927511960265095, 5.66944044042186, 5.251080254798154, 5.3431111023048645, 5.702300906979307, 5.484739300751896, 5.60331421920831, 5.231256508697047, 5.160866968613311, 5.6258849564533, 5.63131287770341, 5.58219878075117, 5.63137854634715, 5.571894860376543, 5.1714529305714, 5.2680258415523245, 5.3029162369986675, 5.391835615557131, 5.405513114212253, 5.329139913669886, 5.619811733956249, 5.3388894115412855, 5.468197897754756, 5.459092203453079, 5.570892903260688, 5.320662525593382, 5.366045224502633, 5.219236080094957, 5.425061132609175, 5.70427470765071, 5.540531495592694, 5.5192970705975295, 5.323887818105843, 5.43095434221385, 5.558849608493462, 5.372519652379344, 5.57378255488779, 5.442363260825508, 5.63594973448833, 5.509793911624322, 5.51200144384261, 5.495857263836971, 5.310552761658007, 5.389469817936684, 5.626456105561847, 5.264663110649558, 5.498272769835214, 5.594183750313798, 5.286964429117562, 5.401097723983589, 5.185076301415992, 5.541940670364301, 5.425384444543807, 5.6899544958649875, 5.468440760642064, 5.50167103286932, 5.495911534318152, 5.337449037901324, 5.360739766143716, 5.375830850623032, 5.579633202833609, 5.475729503551465, 5.439807987667352, 5.403115828030733, 5.3085302837213, 5.483014744798501, 5.548339487503589, 5.452110842299393, 5.506184833355341, 5.590388916665351, 5.145103974346365, 5.615826816648712, 5.679713418113948, 5.5343774266601695, 5.2249997881871835, 5.545118187770813, 5.24041383817112, 5.534192275150661, 5.232281016274099, 5.570363150314346, 5.637646388586357, 5.585021741475785, 5.272025931497028, 5.339624889242993, 5.255987594812771, 5.311954923286648, 5.539106410752636, 5.246129386284191, 5.315547462497122, 5.332550727808714, 5.482162427832669, 5.355017415852264, 5.480836626282131, 5.210408675565398, 5.5509712325556855, 5.414120518046845, 5.6570436441818845, 5.482852111958202, 5.4504897585764365, 5.5349347668072255, 5.285074480294346, 5.373325159568802, 5.500511871949695, 5.597331465660843, 5.486686502148345, 5.546475795146386, 5.684820226645616, 5.521478521206377], "episode_lengths": [107, 67, 65, 58, 65, 98, 76, 36, 64, 71, 96, 76, 56, 47, 81, 114, 86, 61, 48, 37, 72, 65, 66, 56, 92, 59, 80, 79, 99, 66, 42, 87, 93, 52, 50, 86, 61, 81, 91, 94, 48, 72, 113, 49, 67, 93, 83, 74, 68, 96, 41, 143, 62, 42, 57, 39, 47, 53, 65, 77, 94, 69, 45, 39, 82, 53, 46, 73, 86, 63, 74, 73, 72, 91, 67, 78, 70, 70, 50, 61, 69, 61, 54, 54, 110, 55, 54, 57, 68, 54, 78, 47, 82, 86, 83, 86, 86, 49, 106, 57, 123, 54, 84, 89, 107, 59, 84, 55, 93, 69, 48, 64, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2919640778173243, "mean_inference_ms": 1.5992447955508724, "mean_action_processing_ms": 0.1503667386966902, "mean_env_wait_ms": 2.9485448224861184, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1062936, "agent_timesteps_total": 1062936, "timers": {"sample_time_ms": 7375.596, "sample_throughput": 1083.573, "load_time_ms": 3.485, "load_throughput": 2293343.019, "learn_time_ms": 6563.97, "learn_throughput": 1217.556, "update_time_ms": 2.953}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.027954792603850365, "policy_loss": -0.01438190694898367, "vf_loss": 0.039614949375391006, "vf_explained_var": 0.8354310393333435, "kl": 0.013608723878860474, "entropy": 0.5600536465644836, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1062936, "num_agent_steps_sampled": 1062936, "num_steps_trained": 1062936, "num_agent_steps_trained": 1062936}, "done": false, "episodes_total": 11572, "training_iteration": 133, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-05-44", "timestamp": 1716404744, "time_this_iter_s": 14.714985847473145, "time_total_s": 1787.1480979919434, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1787.1480979919434, "timesteps_since_restore": 0, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 34.99523809523809, "ram_util_percent": 34.2904761904762}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.683212426316462, "episode_reward_min": 5.11888400713285, "episode_reward_mean": 5.429600626634029, "episode_len_mean": 73.3425925925926, "episode_media": {}, "episodes_this_iter": 108, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2529432192266226, "reward_component_totals/rejoin_dist_change_reward_min": 0.9609734148662314, "reward_component_totals/rejoin_dist_change_reward_max": 1.4995077921559445, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9266574074074077, "reward_component_totals/success_reward_min": 1.8319999999999999, "reward_component_totals/success_reward_max": 1.958}, "hist_stats": {"episode_reward": [5.469990256147939, 5.625251932948595, 5.4589443496109435, 5.4514394264205315, 5.276065395650855, 5.509466166055288, 5.531374611926403, 5.315540524201952, 5.47881265508869, 5.5509015873612535, 5.670302988231992, 5.325939154535725, 5.331482139916243, 5.314978630026896, 5.370076339471502, 5.490229935212096, 5.483173264543117, 5.544857594993827, 5.558306007783616, 5.354061784299238, 5.348189046154008, 5.56125013425397, 5.602917004011543, 5.4918096649406, 5.506101551325662, 5.357305490359252, 5.331469625241017, 5.338321240802067, 5.611970928150864, 5.425779406596275, 5.227615996622296, 5.165973414866231, 5.662087748222358, 5.26083847167852, 5.493767341313106, 5.425239423567671, 5.529401522274962, 5.635274958915293, 5.352551841219713, 5.400757410968513, 5.326305131955094, 5.27971145628476, 5.526998469916755, 5.5969028661580635, 5.603918799172072, 5.66649587082239, 5.11888400713285, 5.6223645234543405, 5.233015890989993, 5.28842563927874, 5.149642713127121, 5.321414800038545, 5.383778455845567, 5.219267106205198, 5.600413864106738, 5.227179124372778, 5.316779962827969, 5.618693354989005, 5.282960202387972, 5.431252592217994, 5.284259241717418, 5.6729076984445275, 5.451008699526215, 5.387014462623402, 5.182098235664993, 5.49449456169313, 5.648843359822062, 5.679507792155945, 5.518798496909475, 5.6313345751969575, 5.6160982982187715, 5.3592887866759735, 5.5612325494642, 5.29469427388916, 5.3669174041993974, 5.502011674714127, 5.294496326615607, 5.344725894132468, 5.3271679727808525, 5.553251409779564, 5.445597072341899, 5.683212426316462, 5.6820006837804025, 5.311659994778821, 5.6115127677176, 5.216550063798913, 5.2895772804107075, 5.362407812753741, 5.249248336585822, 5.544723388274047, 5.577363784313162, 5.472540672563916, 5.475152196532493, 5.406613035506311, 5.5979073717174535, 5.20414122116238, 5.567337972110716, 5.2427536364828775, 5.28005846845023, 5.2584888559715885, 5.230823636529507, 5.463496632328174, 5.155872605279718, 5.474530289144518, 5.454846114821104, 5.447742878399584, 5.417258873605082, 5.449076093379215], "episode_lengths": [48, 63, 87, 102, 85, 49, 72, 47, 81, 127, 76, 43, 49, 54, 100, 81, 122, 46, 69, 59, 42, 66, 48, 98, 44, 88, 53, 63, 90, 77, 74, 45, 55, 63, 57, 66, 77, 53, 64, 97, 168, 78, 53, 56, 85, 61, 104, 65, 87, 59, 65, 76, 50, 82, 52, 57, 80, 106, 52, 67, 42, 67, 58, 77, 106, 44, 77, 70, 65, 78, 59, 63, 145, 58, 65, 59, 50, 130, 47, 60, 74, 55, 66, 93, 95, 78, 96, 73, 74, 79, 101, 83, 107, 89, 72, 76, 57, 81, 100, 113, 78, 86, 57, 55, 48, 73, 114, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2911732012964157, "mean_inference_ms": 1.5987072719356075, "mean_action_processing_ms": 0.1504640283908725, "mean_env_wait_ms": 2.95026883939451, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1070928, "agent_timesteps_total": 1070928, "timers": {"sample_time_ms": 7372.704, "sample_throughput": 1083.999, "load_time_ms": 3.517, "load_throughput": 2272586.462, "learn_time_ms": 6571.85, "learn_throughput": 1216.096, "update_time_ms": 2.976}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03091045282781124, "policy_loss": -0.011501430533826351, "vf_loss": 0.0404239185154438, "vf_explained_var": 0.8416221141815186, "kl": 0.009939851239323616, "entropy": 0.5937939286231995, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1070928, "num_agent_steps_sampled": 1070928, "num_steps_trained": 1070928, "num_agent_steps_trained": 1070928}, "done": false, "episodes_total": 11680, "training_iteration": 134, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-05-58", "timestamp": 1716404758, "time_this_iter_s": 14.032854795455933, "time_total_s": 1801.1809527873993, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1801.1809527873993, "timesteps_since_restore": 0, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 34.964999999999996, "ram_util_percent": 34.125000000000014}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.684115420239468, "episode_reward_min": 5.063166780215624, "episode_reward_mean": 5.417447792155266, "episode_len_mean": 71.95495495495496, "episode_media": {}, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2394027471102202, "reward_component_totals/rejoin_dist_change_reward_min": 0.9194210945087602, "reward_component_totals/rejoin_dist_change_reward_max": 1.5131154202394677, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9280450450450448, "reward_component_totals/success_reward_min": 1.833, "reward_component_totals/success_reward_max": 1.9609999999999999}, "hist_stats": {"episode_reward": [5.248660326352086, 5.207046514718991, 5.3279094911904945, 5.539697461099632, 5.451998284421677, 5.373690676872108, 5.09542109450876, 5.601154185103202, 5.4254731306731205, 5.214660990463963, 5.472058615386793, 5.258407585653975, 5.283747322746645, 5.342168011195285, 5.261634291017941, 5.527936362530657, 5.535211229700278, 5.26648524994526, 5.351837469227407, 5.520026952569054, 5.416113178346734, 5.343462559897733, 5.600908742075859, 5.394226227474512, 5.279315594571914, 5.404443179254444, 5.5372647733459655, 5.241946449071177, 5.186544609575934, 5.389716934737979, 5.666449890552586, 5.511798163689706, 5.324273383351102, 5.542749408756265, 5.293503611067905, 5.517642628958198, 5.605116835784125, 5.131878075456039, 5.633971302508534, 5.62579871589416, 5.44275006710401, 5.630819040229328, 5.439163487398627, 5.39219417836685, 5.3117171448771066, 5.600339934625746, 5.110622865223338, 5.454373532399936, 5.487770212316683, 5.439020984204746, 5.182362495367643, 5.234609389976531, 5.606033364613952, 5.513903219830701, 5.38920261897993, 5.592857957151006, 5.338046652564159, 5.581708579573926, 5.438292671826552, 5.530475608609469, 5.532704733599712, 5.310580009681118, 5.55379454642499, 5.472982494956767, 5.56897993009719, 5.249261290728832, 5.26135654770701, 5.481680814314827, 5.248972165574097, 5.529614310691199, 5.600517961194241, 5.362816057630713, 5.201980822305789, 5.3114063442000585, 5.063166780215624, 5.3590753933795074, 5.495386753301858, 5.553726828252421, 5.649522096496253, 5.258113348765807, 5.520076364320479, 5.608536438747331, 5.3547927793536, 5.596912859209086, 5.4156268068113675, 5.3439076767697475, 5.502694689128495, 5.6571700272169645, 5.379077195693, 5.649510970799421, 5.343214447719953, 5.51379334419579, 5.178961941685513, 5.2413273753030705, 5.46153583793106, 5.558074744000038, 5.307858094158346, 5.26554922578792, 5.243794545288538, 5.490671377987997, 5.408172561978377, 5.661115457470054, 5.253273592828795, 5.48808760806693, 5.671042375654531, 5.367850386656639, 5.389954737440212, 5.261360873092118, 5.684115420239468, 5.149851939133888, 5.634540490059262], "episode_lengths": [51, 89, 81, 45, 39, 50, 74, 87, 113, 60, 167, 52, 76, 62, 100, 58, 85, 57, 54, 74, 143, 76, 55, 67, 41, 67, 137, 120, 76, 58, 48, 94, 66, 89, 90, 117, 89, 57, 60, 51, 55, 43, 42, 92, 52, 80, 62, 45, 110, 86, 48, 61, 97, 60, 66, 55, 43, 55, 59, 51, 68, 47, 105, 62, 51, 83, 66, 67, 60, 95, 104, 51, 104, 77, 127, 65, 85, 49, 63, 65, 52, 42, 40, 52, 73, 57, 54, 60, 91, 84, 69, 92, 55, 72, 50, 67, 107, 72, 107, 122, 59, 73, 56, 82, 56, 72, 78, 64, 79, 65, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29087825676517526, "mean_inference_ms": 1.6009721760128186, "mean_action_processing_ms": 0.15055122432888016, "mean_env_wait_ms": 2.952345841266441, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1078920, "agent_timesteps_total": 1078920, "timers": {"sample_time_ms": 7351.337, "sample_throughput": 1087.149, "load_time_ms": 3.558, "load_throughput": 2246496.815, "learn_time_ms": 6582.69, "learn_throughput": 1214.093, "update_time_ms": 2.97}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.026895327493548393, "policy_loss": -0.014375670813024044, "vf_loss": 0.03811665251851082, "vf_explained_var": 0.8605775237083435, "kl": 0.01577170006930828, "entropy": 0.48909443616867065, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1078920, "num_agent_steps_sampled": 1078920, "num_steps_trained": 1078920, "num_agent_steps_trained": 1078920}, "done": false, "episodes_total": 11791, "training_iteration": 135, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-06-12", "timestamp": 1716404772, "time_this_iter_s": 13.873104095458984, "time_total_s": 1815.0540568828583, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1815.0540568828583, "timesteps_since_restore": 0, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 34.975, "ram_util_percent": 34.105000000000004}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.691853890551607, "episode_reward_min": 5.093434166383394, "episode_reward_mean": 5.419701967456237, "episode_len_mean": 73.29357798165138, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2429955454378876, "reward_component_totals/rejoin_dist_change_reward_min": 0.9254341663833945, "reward_component_totals/rejoin_dist_change_reward_max": 1.499004025080705, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9267064220183485, "reward_component_totals/success_reward_min": 1.842, "reward_component_totals/success_reward_max": 1.96}, "hist_stats": {"episode_reward": [5.257683647573611, 5.562707043276584, 5.578096092314606, 5.277580225878908, 5.532387269984771, 5.641394762981384, 5.312226530438327, 5.141157553243339, 5.5574395298566355, 5.3620319835756565, 5.174679314183976, 5.375659623574706, 5.582959789461013, 5.452726034425783, 5.505283117179777, 5.4546163642341, 5.403327441754659, 5.48271859068846, 5.396177669433426, 5.093434166383394, 5.513633020219064, 5.259924334713892, 5.599318942565597, 5.471566141080171, 5.50445000802877, 5.467992142776081, 5.5622767836923845, 5.18633242086936, 5.133662077294815, 5.384284061178455, 5.458425701785197, 5.354007533101706, 5.680004025080706, 5.3406111755819845, 5.371671494673015, 5.314904756473818, 5.352190598364122, 5.616759144128214, 5.580424581733283, 5.186961226181046, 5.4228661461221535, 5.603073438615405, 5.620985606907407, 5.343131997797633, 5.444301663391666, 5.392764361324944, 5.470801953145466, 5.483654647145935, 5.601043392795894, 5.26854553748014, 5.459799009345508, 5.290959871582183, 5.51385641725252, 5.266207080548782, 5.41212193353024, 5.627902958950174, 5.317468074997989, 5.258794981381183, 5.421255371649586, 5.546992712371651, 5.417174681069721, 5.521178451859815, 5.430950546246922, 5.656399764463477, 5.401772343125245, 5.614213020643243, 5.609746093811334, 5.361919780935674, 5.3616728746894395, 5.2022709790099135, 5.597246706395115, 5.5215519366983425, 5.333186301130973, 5.531970987816157, 5.552256765685238, 5.381353679889461, 5.209358925621239, 5.39802272543778, 5.259496179763774, 5.317940798225666, 5.606544216736452, 5.250563795181098, 5.213261051813966, 5.358046722443714, 5.5829523353385415, 5.557520373227135, 5.338914070048142, 5.471156522282051, 5.303607907671861, 5.13316937788179, 5.650880829623855, 5.5249582547776095, 5.396621373448735, 5.536740505887759, 5.691853890551607, 5.255548042944513, 5.362301405803416, 5.213488514335931, 5.216414012826972, 5.628147738189833, 5.259892480067089, 5.485411188430863, 5.581035713120635, 5.38034352984989, 5.246629195647357, 5.662848040731607, 5.211370398445412, 5.381282172625949, 5.316113173976208], "episode_lengths": [48, 101, 80, 60, 104, 55, 47, 90, 58, 51, 49, 59, 82, 76, 140, 79, 72, 61, 111, 82, 84, 53, 93, 46, 101, 88, 87, 74, 78, 76, 71, 63, 69, 98, 73, 56, 68, 79, 70, 77, 49, 52, 49, 61, 51, 46, 41, 44, 102, 82, 72, 61, 136, 72, 97, 61, 49, 76, 50, 50, 106, 88, 90, 57, 70, 58, 96, 92, 54, 126, 48, 158, 82, 88, 51, 64, 67, 107, 49, 44, 61, 72, 100, 50, 57, 80, 51, 48, 91, 85, 87, 57, 40, 74, 57, 80, 94, 125, 44, 76, 98, 106, 96, 43, 55, 77, 64, 61, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2911886563335372, "mean_inference_ms": 1.5994999835415207, "mean_action_processing_ms": 0.15047346863989178, "mean_env_wait_ms": 2.9518508143447684, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1086912, "agent_timesteps_total": 1086912, "timers": {"sample_time_ms": 7331.855, "sample_throughput": 1090.038, "load_time_ms": 3.563, "load_throughput": 2243174.462, "learn_time_ms": 6537.023, "learn_throughput": 1222.575, "update_time_ms": 2.929}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.026184698566794395, "policy_loss": -0.013678296469151974, "vf_loss": 0.03741461783647537, "vf_explained_var": 0.8545804023742676, "kl": 0.012241880409419537, "entropy": 0.4757116436958313, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1086912, "num_agent_steps_sampled": 1086912, "num_steps_trained": 1086912, "num_agent_steps_trained": 1086912}, "done": false, "episodes_total": 11900, "training_iteration": 136, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-06-25", "timestamp": 1716404785, "time_this_iter_s": 12.91321611404419, "time_total_s": 1827.9672729969025, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1827.9672729969025, "timesteps_since_restore": 0, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 34.888888888888886, "ram_util_percent": 34.116666666666674}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.649654760585008, "episode_reward_min": 0.18710925886861074, "episode_reward_mean": 5.32604777747315, "episode_len_mean": 69.80869565217391, "episode_media": {}, "episodes_this_iter": 115, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9826086956521739, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.017391304347826087, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.965217391304348, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24565217391304348, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2368042992122805, "reward_component_totals/rejoin_dist_change_reward_min": 0.9746751361818675, "reward_component_totals/rejoin_dist_change_reward_max": 1.4536547605850085, "reward_component_totals/failure_reward_mean": -0.017391304347826087, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.8957652173913044, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.96, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.190908153483914, 5.441221870562221, 5.518232202438133, 5.429290814040242, 5.5091399531568825, 5.284314309246479, 5.244606357034545, 5.319957359162105, 5.344349786862863, 5.602642281818959, 5.5240225930876115, 5.492476692713832, 5.392439242316907, 5.3225245302045865, 5.497126701062357, 5.3712781796148, 5.52308188615613, 5.497932520375325, 5.633609113450636, 5.439818024985105, 5.173577485827719, 5.418971130331436, 5.279507947304522, 5.509832635171035, 5.535006217463454, 5.512498940890619, 5.356097250152036, 5.312519873829709, 5.497153008125199, 5.588473861227012, 5.557569398536874, 5.647156154442758, 5.4135018109091115, 5.552763622689673, 5.414802058455608, 5.250509986783664, 5.59287683790652, 5.301325869370658, 5.208588069864888, 5.265166120035773, 5.296625040864344, 5.278841795141323, 5.589522840634121, 5.57539951754232, 5.448408182211127, 5.493444859573511, 5.430104746940195, 5.431012320055114, 5.460996203903104, 5.314822482159961, 5.388855199409042, 5.623222859213772, 5.649654760585008, 5.379983299195331, 5.608582358419662, 5.640117996798027, 5.5747321760911905, 5.6070954872532255, 5.215952453542, 5.536454421057922, 5.20227900533228, 5.468027362139148, 5.2458929727963834, 5.267469630899542, 5.559383748662315, 5.321226241542201, 5.618057857141276, 5.242855218429353, 5.602908062740835, 5.339554198272253, 5.472775289081344, 5.4342650677720306, 5.274179322806395, 5.360193695641637, 5.571001488793907, 5.350268047409115, 5.3393885729507655, 5.3871793571969295, 5.556477687816216, 5.565087668945895, 5.332390110795726, 5.133675136181868, 5.475857250671661, 5.432946936267351, 5.260213999392288, 5.496477672646444, 5.1676165223502775, 5.176204122702991, 5.551676685074959, 5.361299989555233, 5.371009907377639, 5.5307720876200825, 5.302281988574293, 5.30258688496064, 5.442888714596641, 5.430783851818235, 5.2613085857273525, 5.18736477895399, 5.309308409694893, 5.20834668478677, 5.3744686882984585, 5.189204053203655, 0.24672841770451237, 5.183058603075207, 5.567049440601085, 5.45408514292772, 5.450215456252362, 5.429767608364287, 5.310587941896303, 5.600889020966029, 0.18710925886861074, 5.5677780492361695, 5.600880707050298, 5.3234832001224, 5.586008153043792], "episode_lengths": [53, 57, 60, 61, 55, 67, 64, 93, 127, 48, 123, 64, 57, 69, 89, 47, 64, 102, 50, 90, 77, 54, 54, 99, 44, 137, 95, 66, 52, 60, 59, 51, 72, 80, 68, 41, 95, 91, 63, 84, 72, 40, 49, 71, 76, 78, 67, 61, 76, 62, 72, 57, 54, 74, 84, 56, 82, 56, 46, 69, 77, 82, 73, 55, 75, 73, 71, 95, 66, 70, 76, 87, 103, 56, 93, 62, 52, 48, 72, 61, 55, 91, 130, 109, 60, 59, 79, 50, 94, 77, 49, 80, 66, 50, 53, 51, 70, 68, 57, 93, 54, 98, 24, 45, 79, 77, 86, 54, 52, 48, 17, 102, 91, 57, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2911798098623346, "mean_inference_ms": 1.5986814135248357, "mean_action_processing_ms": 0.15050426136195083, "mean_env_wait_ms": 2.9509628715086103, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1094904, "agent_timesteps_total": 1094904, "timers": {"sample_time_ms": 7269.596, "sample_throughput": 1099.373, "load_time_ms": 3.548, "load_throughput": 2252822.848, "learn_time_ms": 6526.589, "learn_throughput": 1224.529, "update_time_ms": 2.893}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.051298126578330994, "policy_loss": -0.012168684042990208, "vf_loss": 0.06105281785130501, "vf_explained_var": 0.7967385649681091, "kl": 0.0120700029656291, "entropy": 0.49117767810821533, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1094904, "num_agent_steps_sampled": 1094904, "num_steps_trained": 1094904, "num_agent_steps_trained": 1094904}, "done": false, "episodes_total": 12015, "training_iteration": 137, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-06-38", "timestamp": 1716404798, "time_this_iter_s": 13.042823553085327, "time_total_s": 1841.0100965499878, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1841.0100965499878, "timesteps_since_restore": 0, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 34.40526315789474, "ram_util_percent": 34.26842105263158}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.687802653050427, "episode_reward_min": 5.149162149270356, "episode_reward_mean": 5.4442871590924025, "episode_len_mean": 71.10810810810811, "episode_media": {}, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2653952672005104, "reward_component_totals/rejoin_dist_change_reward_min": 0.9880042776536453, "reward_component_totals/rejoin_dist_change_reward_max": 1.488802653050427, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9288918918918914, "reward_component_totals/success_reward_min": 1.816, "reward_component_totals/success_reward_max": 1.964}, "hist_stats": {"episode_reward": [5.398155306599192, 5.269568912218357, 5.289741186467747, 5.428496777478921, 5.471422273362793, 5.508825010773977, 5.339479420979727, 5.594713139462786, 5.442949421948949, 5.367744131423283, 5.530312083341254, 5.365767615209986, 5.464368885163789, 5.501735594373395, 5.592437945260537, 5.304432722918411, 5.45751463942841, 5.334998094061806, 5.2053173116477, 5.529604948917509, 5.575581621434038, 5.518740899272034, 5.367059127626295, 5.294407585488668, 5.386010206966834, 5.482629859167788, 5.511394579283206, 5.614267269038466, 5.664483757697068, 5.598599539915764, 5.595788528750882, 5.327276985188401, 5.387946397686337, 5.312896603247559, 5.316393349347964, 5.494866785940326, 5.610960294947333, 5.654014227711299, 5.486092594653398, 5.149162149270356, 5.394679644256603, 5.324671287764339, 5.1940042776536455, 5.479285379172476, 5.453966439963643, 5.323070246882711, 5.670695913989263, 5.582458420305453, 5.527949256429407, 5.213041974025564, 5.573252656548236, 5.409877131754299, 5.583263306945655, 5.557250096114395, 5.316605009853598, 5.604348079333251, 5.516015932798949, 5.300417344346476, 5.3355045098966825, 5.267378366899716, 5.608425824672821, 5.460346866620757, 5.602327740872276, 5.236730280722434, 5.416501991184971, 5.464742097606551, 5.577646417829512, 5.619121876654452, 5.341494116074692, 5.50113223952096, 5.329743005805919, 5.440286405275232, 5.3810105156219, 5.434632376732998, 5.533525601015695, 5.461066926162126, 5.344607303395019, 5.475729835895657, 5.283407475441319, 5.687802653050427, 5.176060774200426, 5.521022082272259, 5.213027861558073, 5.451268636394621, 5.5565959654307875, 5.535185563966184, 5.549722941921107, 5.646020146224681, 5.497255307600124, 5.2740157500241, 5.286490565472818, 5.527504436394197, 5.284897631952704, 5.196918454730925, 5.630244119551158, 5.437298335113118, 5.343649452705428, 5.511873153845539, 5.6320713348812035, 5.62784755517327, 5.225122964201887, 5.663967324236899, 5.526694938878378, 5.580167631849012, 5.348433041249994, 5.448255677215535, 5.423859061232258, 5.2264557184971245, 5.451606374036823, 5.334773788200464, 5.613393461482943], "episode_lengths": [77, 64, 56, 90, 46, 80, 52, 55, 133, 76, 111, 39, 130, 55, 53, 46, 86, 42, 51, 71, 72, 59, 134, 77, 57, 163, 50, 82, 62, 65, 56, 93, 44, 86, 44, 88, 81, 50, 49, 99, 86, 56, 44, 65, 57, 57, 62, 51, 121, 36, 68, 96, 62, 113, 48, 55, 68, 69, 57, 65, 65, 42, 90, 84, 144, 72, 51, 55, 57, 88, 83, 77, 102, 96, 56, 45, 81, 50, 49, 51, 80, 184, 69, 76, 59, 62, 42, 63, 49, 57, 58, 66, 73, 56, 58, 74, 41, 68, 60, 55, 62, 74, 113, 79, 104, 86, 73, 66, 46, 82, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29094704349690476, "mean_inference_ms": 1.5993669841225613, "mean_action_processing_ms": 0.15047398958964375, "mean_env_wait_ms": 2.9515640122620375, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1102896, "agent_timesteps_total": 1102896, "timers": {"sample_time_ms": 7233.986, "sample_throughput": 1104.785, "load_time_ms": 3.535, "load_throughput": 2260601.523, "learn_time_ms": 6518.418, "learn_throughput": 1226.064, "update_time_ms": 2.927}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03295969218015671, "policy_loss": -0.015904592350125313, "vf_loss": 0.045454367995262146, "vf_explained_var": 0.8455866575241089, "kl": 0.017049573361873627, "entropy": 0.48771488666534424, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1102896, "num_agent_steps_sampled": 1102896, "num_steps_trained": 1102896, "num_agent_steps_trained": 1102896}, "done": false, "episodes_total": 12126, "training_iteration": 138, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-06-51", "timestamp": 1716404811, "time_this_iter_s": 13.306406736373901, "time_total_s": 1854.3165032863617, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1854.3165032863617, "timesteps_since_restore": 0, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 34.76842105263158, "ram_util_percent": 34.20000000000001}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.6775752017532, "episode_reward_min": 5.13506878859363, "episode_reward_mean": 5.435157948584848, "episode_len_mean": 70.43362831858407, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2555915769034325, "reward_component_totals/rejoin_dist_change_reward_min": 0.9410687885936289, "reward_component_totals/rejoin_dist_change_reward_max": 1.4924238553567606, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.929566371681416, "reward_component_totals/success_reward_min": 1.871, "reward_component_totals/success_reward_max": 1.9609999999999999}, "hist_stats": {"episode_reward": [5.424314513039973, 5.562148376498925, 5.362068661167558, 5.638291937847331, 5.563403150193967, 5.244091567868837, 5.378367259090469, 5.396474169232498, 5.200201627884321, 5.538042985978272, 5.177939876880238, 5.642891653315619, 5.431664774930674, 5.443614043621334, 5.310938468108125, 5.398578010974058, 5.314512649113064, 5.37602941281655, 5.556228349068275, 5.5562250314166395, 5.523303769767524, 5.281394789130943, 5.654506761868806, 5.1940099594348474, 5.33966485539154, 5.49639522456025, 5.620080509723314, 5.460079112001978, 5.336447282743036, 5.345290134089746, 5.540571632680546, 5.330282618958714, 5.542355542109464, 5.56108964558832, 5.241799817148333, 5.6222749112963815, 5.192850333490265, 5.4252131151922285, 5.505548773781644, 5.484074128938152, 5.478466139237531, 5.225896851240773, 5.39495961936045, 5.512550032053664, 5.582732387814501, 5.568201314095166, 5.251543834842548, 5.507554554259464, 5.34819189198458, 5.498908727332987, 5.598309753469417, 5.282953191454136, 5.2515626528435995, 5.359041460604477, 5.438780909521409, 5.538207500569827, 5.253213598892631, 5.4686176124718795, 5.286796876502169, 5.396055044427281, 5.463851117776513, 5.335891031891386, 5.5661014699462426, 5.296363058203924, 5.649804387385037, 5.401362785190808, 5.292321319393067, 5.638066599386351, 5.600723441261467, 5.46738623795131, 5.660406054114924, 5.398247621399317, 5.6775752017532, 5.484432640735599, 5.599661161079585, 5.54512559768555, 5.553596678342622, 5.479497070709176, 5.435638167081882, 5.660961235679527, 5.585707909063856, 5.661216870222522, 5.18803353154879, 5.295708136388228, 5.299204935575351, 5.521456451362889, 5.250776446998353, 5.63777863127049, 5.469774675753781, 5.306857031935641, 5.306336412388047, 5.422558676731848, 5.240895971539532, 5.430191259489634, 5.240376526664493, 5.319006584965792, 5.523739871355309, 5.197256183180523, 5.642891310510409, 5.544618077409539, 5.432246541944357, 5.191887170951995, 5.553905080849481, 5.299443375198605, 5.19228564973925, 5.489983345247032, 5.13506878859363, 5.482624652341316, 5.3253124294739695, 5.510259577902902, 5.64447323649534, 5.502732724749482, 5.66542385535676], "episode_lengths": [110, 94, 61, 42, 83, 61, 103, 67, 55, 74, 42, 56, 83, 50, 68, 59, 67, 70, 63, 42, 92, 68, 76, 90, 66, 107, 71, 120, 66, 92, 83, 64, 129, 107, 84, 57, 68, 46, 85, 76, 106, 81, 102, 49, 62, 64, 72, 78, 73, 103, 72, 39, 71, 75, 75, 53, 74, 55, 91, 50, 69, 67, 53, 63, 53, 70, 50, 53, 99, 49, 54, 70, 57, 62, 57, 83, 67, 72, 59, 56, 78, 47, 55, 105, 57, 45, 48, 65, 83, 65, 74, 46, 80, 96, 73, 93, 45, 73, 92, 68, 80, 63, 55, 79, 66, 56, 56, 119, 46, 57, 56, 56, 77]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2923709349870076, "mean_inference_ms": 1.6004640429842938, "mean_action_processing_ms": 0.15054871844165046, "mean_env_wait_ms": 2.950923038252992, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1110888, "agent_timesteps_total": 1110888, "timers": {"sample_time_ms": 7182.219, "sample_throughput": 1112.748, "load_time_ms": 3.514, "load_throughput": 2274236.235, "learn_time_ms": 6501.238, "learn_throughput": 1229.304, "update_time_ms": 2.935}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03732927143573761, "policy_loss": -0.010196339339017868, "vf_loss": 0.0443708561360836, "vf_explained_var": 0.8115976452827454, "kl": 0.01577378436923027, "entropy": 0.5091300010681152, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1110888, "num_agent_steps_sampled": 1110888, "num_steps_trained": 1110888, "num_agent_steps_trained": 1110888}, "done": false, "episodes_total": 12239, "training_iteration": 139, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-07-04", "timestamp": 1716404824, "time_this_iter_s": 13.010002136230469, "time_total_s": 1867.3265054225922, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1867.3265054225922, "timesteps_since_restore": 0, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 33.93684210526316, "ram_util_percent": 34.10526315789474}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.692203951326183, "episode_reward_min": -0.04245072654765791, "episode_reward_mean": 5.354642494561591, "episode_len_mean": 73.80733944954129, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.981651376146789, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.01834862385321101, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9633027522935782, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24541284403669725, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2745232285065449, "reward_component_totals/rejoin_dist_change_reward_min": 0.9297100138183547, "reward_component_totals/rejoin_dist_change_reward_max": 1.5212039513261846, "reward_component_totals/failure_reward_mean": -0.01834862385321101, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.8897522935779814, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.964, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.380857973561469, 5.496909652487586, 5.11966651236105, 0.12893659821211534, 5.376901546624376, 5.488424088984012, 5.532667279139188, 5.335906040846302, 5.5389989349156785, 5.195320495389874, 5.457096970736393, 5.521726421728362, 5.263517458332895, 5.33209140945436, 5.5917886751334756, 5.692203951326183, 5.3388055518662485, 5.579042924765021, 5.297254486633102, 5.504233374270778, 5.607625674956896, 5.642669669023396, 5.502895567957966, 5.482886994098832, 5.237901800710512, 5.675440355450911, 5.479783087725693, 5.556116667585279, 5.584029529023544, 5.539854206137553, 5.531054299895166, 5.370354906775152, 5.480600385389883, 5.265114331836111, 5.280527261910974, 5.5287193830556465, 5.559287524069907, 5.591434813543582, 5.420419830096235, 5.606859964362082, 5.506556443244462, 5.462040150473065, 5.4225565516344965, 5.300037711223129, 5.361197400798982, 5.466155263059655, 5.553014484557914, 5.652473084849328, 5.613087558857938, 5.2633711784817745, 5.607885156202712, 5.682409256849731, 5.578977105338948, 5.582391834161586, 5.422229806538491, 5.323870895608875, 5.553963118683911, 5.567496166540202, 5.552010043785272, 5.563668369101831, 5.183450465100477, 5.135710013818355, 5.617028157401796, 5.514170574692784, 5.40484105654225, 5.556673842199424, 5.362841701235344, 5.346206348392371, 5.346142020298437, 5.304752191956917, 5.424222695847119, 5.271098217526578, 5.507745875931002, 5.382965586111304, 5.631395566784004, 5.595637350349781, 5.562540214384939, 5.43904564790959, 5.373917643512804, 5.607303823013625, 5.580885375612368, 5.515652094718764, 5.137881070551492, 5.363327761357383, 5.245089468836277, 5.324024877670988, 5.265203201878327, 5.3474131826331215, 5.2411412039555625, 5.249331238283846, 5.444009275526364, 5.452466669249436, 5.410760667289228, 5.606810257752651, -0.04245072654765791, 5.591345979985179, 5.521959688775064, 5.57658510937909, 5.574762144022074, 5.621757223128331, 5.240222569825843, 5.313416189729064, 5.557641536620386, 5.6463263446914045, 5.579295311990071, 5.593443443686851, 5.2542419639014, 5.523354237877255, 5.201127371458186], "episode_lengths": [50, 100, 83, 17, 77, 68, 98, 40, 78, 61, 63, 70, 59, 138, 62, 79, 47, 111, 59, 83, 112, 70, 58, 73, 70, 56, 41, 82, 83, 59, 99, 86, 65, 72, 66, 77, 88, 94, 67, 72, 99, 87, 90, 111, 53, 81, 125, 67, 74, 89, 65, 54, 76, 115, 79, 58, 96, 58, 72, 48, 100, 44, 75, 85, 105, 74, 118, 76, 40, 141, 66, 80, 82, 68, 94, 103, 65, 89, 65, 71, 50, 51, 87, 45, 56, 54, 73, 53, 36, 37, 48, 53, 99, 79, 11, 94, 98, 71, 57, 60, 90, 43, 59, 100, 77, 48, 87, 93, 65]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2921199930662698, "mean_inference_ms": 1.5998039241798545, "mean_action_processing_ms": 0.15052452601315255, "mean_env_wait_ms": 2.9516853112528043, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1118880, "agent_timesteps_total": 1118880, "timers": {"sample_time_ms": 7189.156, "sample_throughput": 1111.674, "load_time_ms": 3.587, "load_throughput": 2228159.528, "learn_time_ms": 6598.579, "learn_throughput": 1211.17, "update_time_ms": 2.903}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.037227731198072433, "policy_loss": -0.01598219759762287, "vf_loss": 0.04968215525150299, "vf_explained_var": 0.819024920463562, "kl": 0.01763886772096157, "entropy": 0.5471627116203308, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1118880, "num_agent_steps_sampled": 1118880, "num_steps_trained": 1118880, "num_agent_steps_trained": 1118880}, "done": false, "episodes_total": 12348, "training_iteration": 140, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-07-19", "timestamp": 1716404839, "time_this_iter_s": 14.779781818389893, "time_total_s": 1882.106287240982, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1882.106287240982, "timesteps_since_restore": 0, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 38.457142857142856, "ram_util_percent": 34.242857142857154}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.704512827074314, "episode_reward_min": 5.116695148413825, "episode_reward_mean": 5.4447310323251505, "episode_len_mean": 70.39823008849558, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.265129262413646, "reward_component_totals/rejoin_dist_change_reward_min": 0.9540127226460229, "reward_component_totals/rejoin_dist_change_reward_max": 1.5115128270743154, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.929601769911505, "reward_component_totals/success_reward_min": 1.877, "reward_component_totals/success_reward_max": 1.9609999999999999}, "hist_stats": {"episode_reward": [5.285717721379175, 5.307358895103681, 5.559891621199029, 5.505665725706203, 5.157012722646023, 5.645344419765307, 5.675278816846225, 5.614560808237693, 5.246611208200799, 5.53509814700487, 5.597152199745839, 5.340715869662762, 5.5158993756402666, 5.371233702385052, 5.472709564335416, 5.592294015089407, 5.485287962608618, 5.147225460095072, 5.641109296316912, 5.374817691876317, 5.61685802704576, 5.320871244400615, 5.644956225179801, 5.533126651741748, 5.489790857337267, 5.5940167453802605, 5.644896774915189, 5.330089105968103, 5.58008290002937, 5.293856052076668, 5.175377475740934, 5.419591034952953, 5.333278476228088, 5.677042044233804, 5.266890741657864, 5.220261418584813, 5.326873220963865, 5.57124515824617, 5.618254446183748, 5.58346280253601, 5.315453297364305, 5.512007227153393, 5.530043453240463, 5.338075398275514, 5.457719040931541, 5.471404740359876, 5.625149955931581, 5.1739838595669045, 5.348217416356711, 5.202178281486931, 5.361140337061154, 5.556672557195519, 5.500183116620498, 5.368448763996542, 5.337240753523227, 5.488816740586342, 5.6672266343616675, 5.299204594176475, 5.586502290258919, 5.593412663556752, 5.365073799822138, 5.543726033075486, 5.620136348968707, 5.143915754293856, 5.359076053036473, 5.535925975039413, 5.41213769535621, 5.681918862586871, 5.211418888902374, 5.292669020759404, 5.316054243048923, 5.594566935495115, 5.500400905138214, 5.428533499699098, 5.170984353411988, 5.480859587226256, 5.162511146480712, 5.519416693591868, 5.348380186609982, 5.372766105821901, 5.605524307741346, 5.416257205986109, 5.704512827074314, 5.566373863960685, 5.540529671739394, 5.672278821981374, 5.6146620165094685, 5.60464611321474, 5.508760241596327, 5.38387969135078, 5.622281999735398, 5.151685818195503, 5.160539626560189, 5.520685478064, 5.572991303444599, 5.608748181296937, 5.468916568949417, 5.670675552096037, 5.650531201078409, 5.520723888854247, 5.25703800594385, 5.692012274332303, 5.688048345342669, 5.257925924759837, 5.268377551002609, 5.2327826616011395, 5.397282544692779, 5.262156716901182, 5.41455853883228, 5.116695148413825, 5.156713360460365, 5.290563297642009, 5.549888065770899], "episode_lengths": [83, 61, 66, 86, 47, 48, 53, 86, 61, 108, 100, 107, 121, 56, 58, 101, 44, 117, 88, 44, 76, 54, 98, 80, 72, 55, 82, 60, 51, 49, 52, 83, 66, 47, 64, 64, 123, 64, 47, 113, 59, 64, 58, 67, 92, 54, 49, 39, 75, 105, 57, 66, 88, 56, 89, 92, 64, 58, 122, 63, 73, 105, 89, 87, 88, 61, 54, 74, 72, 74, 53, 58, 63, 80, 70, 45, 60, 61, 54, 70, 75, 58, 57, 46, 54, 83, 62, 62, 68, 66, 61, 66, 55, 53, 68, 44, 108, 59, 54, 77, 64, 49, 69, 73, 85, 79, 47, 56, 94, 104, 64, 95, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.289586978271125, "mean_inference_ms": 1.5971572538346357, "mean_action_processing_ms": 0.15035723776403748, "mean_env_wait_ms": 2.9481163575008167, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1126872, "agent_timesteps_total": 1126872, "timers": {"sample_time_ms": 7012.333, "sample_throughput": 1139.706, "load_time_ms": 3.563, "load_throughput": 2242739.226, "learn_time_ms": 6571.912, "learn_throughput": 1216.084, "update_time_ms": 2.886}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.028983334079384804, "policy_loss": -0.013236073777079582, "vf_loss": 0.03920544311404228, "vf_explained_var": 0.8415539860725403, "kl": 0.015069816261529922, "entropy": 0.4774143695831299, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1126872, "num_agent_steps_sampled": 1126872, "num_steps_trained": 1126872, "num_agent_steps_trained": 1126872}, "done": false, "episodes_total": 12461, "training_iteration": 141, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-07-31", "timestamp": 1716404851, "time_this_iter_s": 12.279337406158447, "time_total_s": 1894.3856246471405, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1894.3856246471405, "timesteps_since_restore": 0, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 33.48823529411765, "ram_util_percent": 34.088235294117645}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.695134851956895, "episode_reward_min": 5.131846334343265, "episode_reward_mean": 5.45624583463448, "episode_len_mean": 72.92792792792793, "episode_media": {}, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2791737625624084, "reward_component_totals/rejoin_dist_change_reward_min": 0.9448463343432654, "reward_component_totals/rejoin_dist_change_reward_max": 1.505134851956896, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9270720720720715, "reward_component_totals/success_reward_min": 1.861, "reward_component_totals/success_reward_max": 1.963}, "hist_stats": {"episode_reward": [5.195622472060835, 5.574984550745004, 5.67530431824808, 5.609997943781138, 5.433900467638976, 5.396819919611023, 5.444395411487671, 5.681713568721635, 5.23131651431628, 5.583738607450394, 5.205928446155749, 5.249444920617931, 5.591918630020911, 5.160391784646739, 5.437324406192084, 5.436932734238217, 5.265238703977401, 5.5605729413781795, 5.382630208424661, 5.660983312719344, 5.333344540015404, 5.480635933158578, 5.524781814397846, 5.57766714265861, 5.672091262973299, 5.3607297937689795, 5.379219514414795, 5.600720757834894, 5.638463446859269, 5.433976215457067, 5.540623504132077, 5.333340460496791, 5.543674529308949, 5.333646816300428, 5.49357462336433, 5.615484230790346, 5.599284399607271, 5.570909344063618, 5.486375394281293, 5.489568167296806, 5.5049138103959425, 5.2219355548760955, 5.670117673944629, 5.3470864758114995, 5.131846334343265, 5.215479776662999, 5.681597401944156, 5.594959290513994, 5.381915217545362, 5.262518133396245, 5.242010932219275, 5.46384367246993, 5.421831000079903, 5.284240367891153, 5.575853186135458, 5.5229458542216845, 5.509183202163518, 5.5751452503165835, 5.238186553207053, 5.552576899413576, 5.491365804578926, 5.251468543381005, 5.368302500052103, 5.371045820070037, 5.180983009006962, 5.537139124153201, 5.655002136411695, 5.276575432856317, 5.433743034613592, 5.360374223954916, 5.576851341172657, 5.582384411549677, 5.621564089415452, 5.44046090966614, 5.515574365855118, 5.532857388468751, 5.362809840499095, 5.4994674098221505, 5.35516079149175, 5.559097605262741, 5.668910544825222, 5.362458263169938, 5.695134851956895, 5.43335521889899, 5.487070703128328, 5.5813214961189255, 5.400454395861887, 5.4180044796677045, 5.579756680817033, 5.608359540709447, 5.591628996298553, 5.32999078906907, 5.213881762571905, 5.648874987357555, 5.2716225994866015, 5.5366773595285395, 5.468726409017648, 5.3839185154645826, 5.352745936460071, 5.431987068443986, 5.418364995134244, 5.355743447324141, 5.575075045244194, 5.450184306108731, 5.428016443759105, 5.615338661427507, 5.257974605690984, 5.601941338105787, 5.571483146206351, 5.295370257000094, 5.451228676125858], "episode_lengths": [58, 89, 79, 61, 71, 76, 53, 65, 92, 54, 76, 139, 68, 65, 55, 50, 41, 81, 68, 71, 42, 62, 55, 52, 61, 66, 62, 93, 107, 92, 61, 98, 96, 109, 90, 71, 51, 101, 98, 73, 66, 66, 67, 68, 63, 79, 51, 52, 93, 63, 75, 52, 58, 96, 117, 87, 110, 111, 113, 91, 82, 37, 63, 79, 41, 68, 53, 47, 65, 41, 78, 99, 61, 73, 79, 52, 64, 48, 87, 108, 60, 46, 60, 69, 69, 112, 74, 94, 110, 51, 98, 63, 61, 65, 53, 87, 64, 93, 44, 82, 91, 70, 102, 51, 59, 55, 60, 103, 79, 59, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2915710934335395, "mean_inference_ms": 1.597199992248687, "mean_action_processing_ms": 0.15030561331986828, "mean_env_wait_ms": 2.94735453371734, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1134864, "agent_timesteps_total": 1134864, "timers": {"sample_time_ms": 6922.846, "sample_throughput": 1154.439, "load_time_ms": 3.502, "load_throughput": 2282210.361, "learn_time_ms": 6501.815, "learn_throughput": 1229.195, "update_time_ms": 2.885}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.02938617579638958, "policy_loss": -0.012181523256003857, "vf_loss": 0.03907328471541405, "vf_explained_var": 0.8405410647392273, "kl": 0.012472100555896759, "entropy": 0.4723975956439972, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1134864, "num_agent_steps_sampled": 1134864, "num_steps_trained": 1134864, "num_agent_steps_trained": 1134864}, "done": false, "episodes_total": 12572, "training_iteration": 142, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-07-44", "timestamp": 1716404864, "time_this_iter_s": 12.509218215942383, "time_total_s": 1906.8948428630829, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1906.8948428630829, "timesteps_since_restore": 0, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 33.89444444444444, "ram_util_percent": 34.0}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.687897320139012, "episode_reward_min": 0.09856221511499519, "episode_reward_mean": 5.3254056534022105, "episode_len_mean": 73.33944954128441, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.981651376146789, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.01834862385321101, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9633027522935782, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24541284403669725, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2447909745031285, "reward_component_totals/rejoin_dist_change_reward_min": 0.9283658942807609, "reward_component_totals/rejoin_dist_change_reward_max": 1.5001120947483433, "reward_component_totals/failure_reward_mean": -0.01834862385321101, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.8902477064220182, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.958, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.298357417984712, 5.29524422805868, 5.450886459752545, 5.551247702799257, 5.485564995393263, 5.398451458037034, 5.491265615655687, 5.420159565234094, 5.279853872526701, 5.5578389900267835, 5.362715694222828, 5.5156288429643885, 5.512865246462767, 5.5039150107217605, 5.465558820888708, 5.393748046765515, 0.25307893060591136, 5.444462372841473, 5.467887724854245, 0.09856221511499519, 5.597799826728442, 5.269746399585536, 5.2295428804169966, 5.224088728863906, 5.194560261691805, 5.4327974019293785, 5.517341270881072, 5.333939592539734, 5.2929571722224225, 5.5519286467427555, 5.434078451996419, 5.3388036520209585, 5.1945727281439, 5.219331969411094, 5.407999836848392, 5.160742242988125, 5.150221847705323, 5.477247829044631, 5.49097598617095, 5.537681406390681, 5.558709174403159, 5.186603827786087, 5.492301858787352, 5.323569708693439, 5.306357636784634, 5.499768119969043, 5.275778403432905, 5.430455498344077, 5.643856504275268, 5.193670663265056, 5.331235961620706, 5.373651322346504, 5.57109539640158, 5.324164238767407, 5.598946867260761, 5.623435602299838, 5.5055529275466055, 5.389049340764975, 5.650991281766693, 5.504074926599646, 5.609728488540679, 5.155985555350616, 5.232882248489445, 5.4736650856739075, 5.5860432435615595, 5.638055551187232, 5.542706783445489, 5.578983164590175, 5.406124235260418, 5.415324431628453, 5.580236888139757, 5.270630464432347, 5.216340495536534, 5.666132948809006, 5.336964816860596, 5.379689052118103, 5.578616338885404, 5.412117707908487, 5.476855219954134, 5.581307569777832, 5.437713617008583, 5.579915093818495, 5.511406456429477, 5.455835731552311, 5.541996488082902, 5.647112094748343, 5.5175583365683565, 5.317466561995836, 5.555971637795235, 5.386049972576064, 5.395011684501698, 5.184985771435171, 5.549255668238704, 5.368200200538167, 5.296829794338432, 5.500415880757759, 5.281211978663611, 5.48654951905171, 5.107365894280761, 5.22163241310901, 5.1366665528979905, 5.462171723329016, 5.687897320139012, 5.326068678433567, 5.299026477761766, 5.286856195652541, 5.583508669328669, 5.53428742634053, 5.5849374869675295], "episode_lengths": [81, 55, 73, 82, 75, 48, 93, 75, 71, 53, 64, 51, 120, 47, 61, 89, 17, 42, 133, 14, 54, 58, 56, 98, 58, 78, 158, 85, 120, 66, 106, 67, 61, 87, 85, 90, 71, 110, 63, 78, 53, 75, 92, 52, 62, 120, 79, 71, 56, 51, 68, 57, 103, 48, 100, 55, 93, 71, 54, 134, 54, 44, 44, 55, 137, 60, 103, 62, 52, 52, 67, 88, 136, 51, 50, 42, 65, 45, 46, 44, 71, 87, 154, 65, 92, 103, 101, 44, 74, 58, 56, 71, 57, 74, 84, 99, 87, 49, 71, 91, 81, 43, 59, 76, 63, 86, 74, 56, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2926960957393084, "mean_inference_ms": 1.5977884091926744, "mean_action_processing_ms": 0.15032231770367546, "mean_env_wait_ms": 2.9463562825341114, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1142856, "agent_timesteps_total": 1142856, "timers": {"sample_time_ms": 6805.742, "sample_throughput": 1174.302, "load_time_ms": 3.465, "load_throughput": 2306678.152, "learn_time_ms": 6400.763, "learn_throughput": 1248.601, "update_time_ms": 2.849}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.035790685564279556, "policy_loss": -0.018447289243340492, "vf_loss": 0.051520660519599915, "vf_explained_var": 0.8297638893127441, "kl": 0.01358659379184246, "entropy": 0.49547797441482544, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1142856, "num_agent_steps_sampled": 1142856, "num_steps_trained": 1142856, "num_agent_steps_trained": 1142856}, "done": false, "episodes_total": 12681, "training_iteration": 143, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-07-56", "timestamp": 1716404876, "time_this_iter_s": 12.531795740127563, "time_total_s": 1919.4266386032104, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1919.4266386032104, "timesteps_since_restore": 0, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 34.2, "ram_util_percent": 33.916666666666664}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.678894180000322, "episode_reward_min": -0.033796977164625375, "episode_reward_mean": 5.3856780201342245, "episode_len_mean": 71.45045045045045, "episode_media": {}, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.990990990990991, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.009009009009009009, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9819819819819822, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24774774774774774, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2543356777918828, "reward_component_totals/rejoin_dist_change_reward_min": 0.9531897226311394, "reward_component_totals/rejoin_dist_change_reward_max": 1.4935947456456116, "reward_component_totals/failure_reward_mean": -0.009009009009009009, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9106216216216214, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.962, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.42778320170974, 5.492302100814612, 5.324380134956455, 5.514508654091337, 5.250094224031894, 5.560639988967489, 5.503892559770226, 5.415652636458416, 5.323979553264613, 5.482043781944326, 5.351679379059064, 5.574473091859088, 5.306429088151895, 5.5656094021492795, 5.2383642788058395, 5.4668332239087345, 5.245323644008532, 5.249728452364466, 5.569817281823294, 5.267096930129867, 5.14118972263114, 5.203119971088057, 5.605568532366307, 5.361838031195202, 5.5364023171976005, 5.521064884571356, 5.240944091644824, 5.621520751097629, 5.435794936196828, 5.243847550824489, 5.470014295239524, 5.134512082715355, 5.46154231917685, 5.59064547852779, 5.4686553157564735, 5.66319170282327, 5.631399832060443, 5.349359294066249, 5.565546417752948, 5.462528963026299, 5.278670691213701, 5.246625909409582, 5.479788794983447, 5.495893047911537, -0.033796977164625375, 5.298206065853461, 5.589333766012993, 5.455427036878858, 5.562223985355148, 5.3047295140255315, 5.589201978871403, 5.543220917368162, 5.516303796886495, 5.165333767115262, 5.587687210839683, 5.2844415202066095, 5.227567739991077, 5.494982858310429, 5.525212201264379, 5.27847216824445, 5.678594745645611, 5.443915035923888, 5.323490297576372, 5.6014011791213925, 5.637159911028023, 5.420630969058038, 5.636851377310706, 5.597528355586597, 5.461363952684215, 5.537227222097703, 5.678894180000322, 5.356295418371738, 5.568574912623434, 5.451525063518009, 5.351229087747246, 5.3122938434209, 5.202358418312679, 5.583329410260264, 5.60204528305992, 5.466920016430017, 5.205722709288892, 5.498998188065008, 5.527256997764943, 5.383927558068622, 5.270266837687995, 5.289320956529873, 5.572946072584781, 5.4067231076068945, 5.360901837555897, 5.337380808788751, 5.428327421219125, 5.516811167873069, 5.2669375730801375, 5.587055329009971, 5.302443711042955, 5.275434227054775, 5.265421957503814, 5.598646446991923, 5.193608712917891, 5.509333199250337, 5.404638006565332, 5.508815329205681, 5.356361067533365, 5.475407478742243, 5.452104083707807, 5.5450867386656455, 5.574269344792559, 5.6011226597701285, 5.563449893734312, 5.568382089742362, 5.322685950971435], "episode_lengths": [59, 70, 47, 57, 45, 98, 51, 57, 48, 149, 97, 132, 104, 79, 60, 62, 60, 120, 130, 72, 62, 55, 51, 48, 66, 113, 61, 94, 96, 109, 70, 96, 68, 89, 89, 47, 74, 42, 90, 49, 46, 70, 77, 72, 10, 87, 67, 115, 78, 61, 53, 53, 53, 38, 49, 63, 70, 63, 73, 70, 65, 48, 92, 99, 75, 69, 49, 50, 52, 60, 56, 61, 122, 95, 77, 58, 86, 63, 55, 63, 70, 68, 79, 58, 53, 47, 67, 49, 47, 87, 62, 93, 59, 76, 55, 65, 85, 103, 64, 138, 83, 71, 69, 84, 43, 64, 60, 74, 61, 56, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2894714283819455, "mean_inference_ms": 1.595373367790243, "mean_action_processing_ms": 0.1499862361681257, "mean_env_wait_ms": 2.943598830444249, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1150848, "agent_timesteps_total": 1150848, "timers": {"sample_time_ms": 6652.017, "sample_throughput": 1201.44, "load_time_ms": 3.428, "load_throughput": 2331660.052, "learn_time_ms": 6346.306, "learn_throughput": 1259.315, "update_time_ms": 2.827}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04104375094175339, "policy_loss": -0.015001507475972176, "vf_loss": 0.052891556173563004, "vf_explained_var": 0.8127776384353638, "kl": 0.015768563374876976, "entropy": 0.4690227508544922, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1150848, "num_agent_steps_sampled": 1150848, "num_steps_trained": 1150848, "num_agent_steps_trained": 1150848}, "done": false, "episodes_total": 12792, "training_iteration": 144, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-08-08", "timestamp": 1716404888, "time_this_iter_s": 11.949912309646606, "time_total_s": 1931.376550912857, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1931.376550912857, "timesteps_since_restore": 0, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 33.48235294117647, "ram_util_percent": 33.923529411764704}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.69881309367366, "episode_reward_min": 5.142766181564394, "episode_reward_mean": 5.457802069910764, "episode_len_mean": 71.9090909090909, "episode_media": {}, "episodes_this_iter": 110, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2797111608198555, "reward_component_totals/rejoin_dist_change_reward_min": 0.9500710191981017, "reward_component_totals/rejoin_dist_change_reward_max": 1.5158130936736596, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.928090909090909, "reward_component_totals/success_reward_min": 1.865, "reward_component_totals/success_reward_max": 1.96}, "hist_stats": {"episode_reward": [5.326948983281154, 5.638282234450393, 5.265120395816916, 5.669829231877588, 5.463616332196963, 5.47301917261203, 5.531302924036172, 5.60078044665638, 5.447941668687257, 5.310458758654402, 5.543461445117018, 5.200922675613459, 5.502099573115582, 5.626941110764953, 5.525096236298484, 5.471126053451337, 5.466074707249065, 5.249416318564473, 5.625943762701224, 5.3681951236119865, 5.645022755610828, 5.452039355726459, 5.40763663121113, 5.62870683959288, 5.4462709341554705, 5.607853154750092, 5.146071019198102, 5.384622186403542, 5.283036535430259, 5.63924850216363, 5.4703055660920406, 5.642985855981188, 5.56123778051087, 5.596502253302262, 5.323684874894266, 5.64379334283006, 5.565963660491773, 5.580480787181019, 5.612005323765487, 5.263128460641397, 5.640674273766328, 5.241146597775007, 5.278195555600105, 5.469177583934562, 5.230104808873025, 5.337164287270589, 5.514254831443851, 5.286719246891199, 5.509370221257667, 5.244584348546073, 5.432295405796389, 5.5320309880381355, 5.331932726313779, 5.275450316839617, 5.654901774891108, 5.3390361125618435, 5.416188453108267, 5.2775026871343105, 5.593054607340088, 5.540097930692779, 5.441507681634215, 5.4392726600937085, 5.450493254903646, 5.4287403604077635, 5.580123012019122, 5.60119555735451, 5.53682011264514, 5.398022073279215, 5.578823430574287, 5.33132700299001, 5.308083541937788, 5.453267036656733, 5.436242695486394, 5.6692441097799975, 5.53434214461608, 5.630887554943827, 5.4941236239627145, 5.649225796162796, 5.61104557848499, 5.562537784219074, 5.207024120124533, 5.498668958694255, 5.69881309367366, 5.360925951648049, 5.6050710260556045, 5.45824188043882, 5.550782272508435, 5.323420783135214, 5.488215826444732, 5.376744207107945, 5.537197026855158, 5.418889856947587, 5.40450263752931, 5.508666810354875, 5.536276613185043, 5.421226938167914, 5.142766181564394, 5.444515292450848, 5.187514598315678, 5.51062888733853, 5.252954113368263, 5.540253881790849, 5.5754711912982415, 5.323799095149202, 5.4682497770776095, 5.210383273031067, 5.545189539986964, 5.497555285422099, 5.359044501564668, 5.418853324038255], "episode_lengths": [96, 69, 122, 59, 77, 91, 55, 49, 57, 46, 77, 111, 49, 73, 54, 62, 107, 57, 74, 59, 77, 49, 95, 72, 111, 69, 54, 61, 53, 55, 66, 66, 64, 98, 75, 63, 69, 67, 63, 62, 70, 46, 77, 95, 70, 87, 65, 52, 70, 43, 64, 67, 82, 77, 56, 114, 61, 89, 71, 87, 59, 76, 46, 90, 86, 109, 135, 68, 74, 69, 75, 40, 50, 56, 62, 64, 60, 60, 84, 56, 64, 51, 67, 50, 73, 50, 56, 109, 104, 71, 47, 61, 112, 101, 70, 58, 75, 83, 44, 45, 45, 125, 60, 93, 89, 56, 117, 44, 72, 123]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29027067190783784, "mean_inference_ms": 1.5933860749041378, "mean_action_processing_ms": 0.14990866646163029, "mean_env_wait_ms": 2.9408736946349543, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1158840, "agent_timesteps_total": 1158840, "timers": {"sample_time_ms": 6514.301, "sample_throughput": 1226.839, "load_time_ms": 3.409, "load_throughput": 2344723.989, "learn_time_ms": 6307.197, "learn_throughput": 1267.124, "update_time_ms": 2.815}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.030422795563936234, "policy_loss": -0.01403448823839426, "vf_loss": 0.04153338447213173, "vf_explained_var": 0.8418924808502197, "kl": 0.014619487337768078, "entropy": 0.3948003649711609, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1158840, "num_agent_steps_sampled": 1158840, "num_steps_trained": 1158840, "num_agent_steps_trained": 1158840}, "done": false, "episodes_total": 12902, "training_iteration": 145, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-08-20", "timestamp": 1716404900, "time_this_iter_s": 12.104752540588379, "time_total_s": 1943.4813034534454, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1943.4813034534454, "timesteps_since_restore": 0, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 33.45, "ram_util_percent": 33.83333333333332}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.704137761133174, "episode_reward_min": 5.125054374343009, "episode_reward_mean": 5.424658846222903, "episode_len_mean": 72.2090909090909, "episode_media": {}, "episodes_this_iter": 110, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2468679371319928, "reward_component_totals/rejoin_dist_change_reward_min": 0.9440543743430079, "reward_component_totals/rejoin_dist_change_reward_max": 1.5121377611331739, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9277909090909089, "reward_component_totals/success_reward_min": 1.826, "reward_component_totals/success_reward_max": 1.959}, "hist_stats": {"episode_reward": [5.4724313868455985, 5.352538763192918, 5.441559160292143, 5.4882982026276, 5.6147878002555505, 5.348013562967543, 5.669611477352445, 5.540644284220065, 5.284448629079877, 5.545715091499236, 5.583672354626925, 5.356815946383597, 5.619597062806063, 5.394279076872534, 5.4464339327218765, 5.480987144883108, 5.380247123628736, 5.479187158524141, 5.353195421525465, 5.666254621892962, 5.176741466917575, 5.246424307871329, 5.313813411183398, 5.350601353216348, 5.314757580898947, 5.603092405487638, 5.566699847646497, 5.291782437346203, 5.495464439129597, 5.607864332230247, 5.188258704287909, 5.441725053594981, 5.44205006957101, 5.4908006576343915, 5.457959395987286, 5.563799620572569, 5.378629314118211, 5.485086821911504, 5.520535663085254, 5.557146143804866, 5.337741066781312, 5.366342095734122, 5.28107033958307, 5.556092343355379, 5.52470288204979, 5.292114302150696, 5.704137761133174, 5.287866046868258, 5.375898059032077, 5.483622996326893, 5.482153273613736, 5.583646412725835, 5.578313750702036, 5.504207344520435, 5.2628800409232905, 5.476071799925183, 5.461564332816293, 5.201638172310661, 5.6952255949924435, 5.590084657875144, 5.542300455157344, 5.165080645588583, 5.343683047807552, 5.559306312619883, 5.456527074154905, 5.266792478486742, 5.282513904602062, 5.457475454606342, 5.505965383331325, 5.1682525482322745, 5.5150932819576015, 5.36036608956227, 5.273290800559723, 5.559830584896853, 5.42902853727726, 5.5495733630217625, 5.48586609708952, 5.3258100901192265, 5.589235147865573, 5.204784087971092, 5.129820230933177, 5.670179023609349, 5.334661582139686, 5.2737991545605905, 5.524731498670354, 5.518725060951042, 5.315255286857589, 5.393387411262257, 5.258905440249813, 5.542522660638164, 5.4556835530875265, 5.561067020989677, 5.17315490582481, 5.175036862382408, 5.26179262944726, 5.473427898769785, 5.382599303705451, 5.383605367211913, 5.212538379171028, 5.470553429682458, 5.19532415619908, 5.647985950021543, 5.618519299668683, 5.351986664334626, 5.636534878477727, 5.429309062408414, 5.372809455122537, 5.493511414562066, 5.125054374343009, 5.231891242215344], "episode_lengths": [106, 70, 70, 88, 75, 88, 73, 60, 45, 112, 47, 50, 101, 111, 53, 53, 70, 72, 70, 63, 42, 44, 70, 80, 88, 89, 104, 66, 80, 51, 41, 75, 48, 63, 96, 62, 79, 82, 106, 126, 121, 48, 98, 60, 123, 53, 58, 69, 68, 50, 61, 52, 74, 112, 52, 50, 49, 68, 56, 47, 98, 100, 48, 57, 43, 92, 42, 91, 100, 75, 49, 90, 72, 57, 74, 77, 52, 57, 51, 85, 97, 76, 87, 80, 52, 112, 71, 54, 48, 117, 60, 144, 56, 50, 56, 174, 51, 66, 65, 97, 63, 68, 51, 43, 46, 70, 43, 67, 69, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2912175413218674, "mean_inference_ms": 1.5942314130881892, "mean_action_processing_ms": 0.1500454843591372, "mean_env_wait_ms": 2.940106640901783, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1166832, "agent_timesteps_total": 1166832, "timers": {"sample_time_ms": 6497.678, "sample_throughput": 1229.978, "load_time_ms": 3.341, "load_throughput": 2392024.717, "learn_time_ms": 6295.02, "learn_throughput": 1269.575, "update_time_ms": 2.859}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03306034579873085, "policy_loss": -0.011772352270781994, "vf_loss": 0.042129501700401306, "vf_explained_var": 0.8404730558395386, "kl": 0.0135159557685256, "entropy": 0.42253825068473816, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1166832, "num_agent_steps_sampled": 1166832, "num_steps_trained": 1166832, "num_agent_steps_trained": 1166832}, "done": false, "episodes_total": 13012, "training_iteration": 146, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-08-33", "timestamp": 1716404913, "time_this_iter_s": 12.625613689422607, "time_total_s": 1956.106917142868, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1956.106917142868, "timesteps_since_restore": 0, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 35.12777777777778, "ram_util_percent": 33.83333333333332}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.715217367021936, "episode_reward_min": 5.1429477114861015, "episode_reward_mean": 5.467298742742955, "episode_len_mean": 70.14782608695653, "episode_media": {}, "episodes_this_iter": 115, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2874465688299128, "reward_component_totals/rejoin_dist_change_reward_min": 0.9689477114861014, "reward_component_totals/rejoin_dist_change_reward_max": 1.5179925338054467, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9298521739130436, "reward_component_totals/success_reward_min": 1.849, "reward_component_totals/success_reward_max": 1.956}, "hist_stats": {"episode_reward": [5.395174387880044, 5.2760235234667405, 5.312446238733296, 5.528197166103588, 5.367458456829877, 5.417082429698218, 5.680093346415449, 5.654433548719169, 5.519153477883676, 5.49104833230807, 5.253512102520014, 5.519429506265389, 5.549443444000544, 5.184350640523016, 5.581398481269799, 5.646775131012847, 5.331581099664683, 5.670733294388244, 5.503668701894616, 5.26843898932189, 5.55902513337382, 5.5099655305987065, 5.554730173090913, 5.327433493758286, 5.595906047482981, 5.257483864175344, 5.4804630358534565, 5.247529153831806, 5.403880445525713, 5.53016675070924, 5.6909760702011045, 5.615715698584793, 5.581963625977002, 5.612154987025966, 5.635912450368296, 5.390012950768744, 5.692498233703633, 5.401716236217482, 5.2391758139639055, 5.617671038441188, 5.535039780220177, 5.288456025168214, 5.28400661036674, 5.636884026911064, 5.537665553756986, 5.537143217768829, 5.421002115599482, 5.2336910411514985, 5.533207222939616, 5.303380962852634, 5.522958491350799, 5.5934200044636535, 5.462552153494551, 5.278436399523439, 5.568744499545243, 5.510647144539777, 5.670992533805447, 5.5422613872680335, 5.501933995022776, 5.280306356315128, 5.627990036447711, 5.281836587834334, 5.4921030435080755, 5.5736355242108715, 5.669219681045023, 5.1429477114861015, 5.53858053530234, 5.612574389549533, 5.265216626340214, 5.381527145752267, 5.555524434861327, 5.715217367021936, 5.217554913143603, 5.409291975252213, 5.575849779054199, 5.2903762979187565, 5.58976309780066, 5.307691777741217, 5.681308117058685, 5.595632101262611, 5.697873846538138, 5.284881800042939, 5.457467550697901, 5.620201397142724, 5.199812890375066, 5.186047687085033, 5.537924805832581, 5.578850811286775, 5.22449192619821, 5.5061232976504675, 5.422605392875815, 5.38461484321733, 5.28540374184699, 5.603739738166118, 5.405090606040536, 5.479444309393106, 5.256055050603367, 5.501809284529874, 5.281973174121644, 5.658431386032411, 5.597424961108944, 5.14917806795518, 5.609101676670983, 5.314315900219617, 5.713427416767447, 5.369752811774283, 5.443838886929543, 5.4222880320457545, 5.613683396978582, 5.207110292243308, 5.640463916549363, 5.650127271265175, 5.374572817274428, 5.627474683127531, 5.572358047645508], "episode_lengths": [113, 51, 44, 100, 48, 44, 53, 64, 56, 76, 67, 67, 151, 55, 83, 50, 76, 61, 56, 50, 75, 52, 53, 50, 64, 66, 73, 68, 60, 52, 72, 91, 52, 69, 54, 105, 58, 88, 89, 67, 73, 55, 59, 54, 77, 95, 63, 65, 82, 66, 55, 90, 69, 68, 93, 61, 97, 52, 82, 66, 61, 87, 66, 89, 81, 76, 62, 44, 52, 54, 45, 46, 76, 87, 96, 51, 100, 119, 76, 67, 49, 107, 73, 54, 83, 79, 48, 74, 56, 63, 80, 67, 52, 63, 51, 107, 99, 99, 65, 55, 105, 84, 67, 58, 53, 45, 110, 81, 75, 68, 57, 85, 59, 69, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29030097011045425, "mean_inference_ms": 1.5929064265412973, "mean_action_processing_ms": 0.14986369419995874, "mean_env_wait_ms": 2.938265998023751, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1174824, "agent_timesteps_total": 1174824, "timers": {"sample_time_ms": 6461.585, "sample_throughput": 1236.848, "load_time_ms": 3.291, "load_throughput": 2428362.823, "learn_time_ms": 6249.351, "learn_throughput": 1278.853, "update_time_ms": 2.808}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.02770058438181877, "policy_loss": -0.015922514721751213, "vf_loss": 0.040796808898448944, "vf_explained_var": 0.8405900597572327, "kl": 0.014131440781056881, "entropy": 0.35919633507728577, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1174824, "num_agent_steps_sampled": 1174824, "num_steps_trained": 1174824, "num_agent_steps_trained": 1174824}, "done": false, "episodes_total": 13127, "training_iteration": 147, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-08-45", "timestamp": 1716404925, "time_this_iter_s": 12.222891330718994, "time_total_s": 1968.329808473587, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1968.329808473587, "timesteps_since_restore": 0, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 34.57058823529412, "ram_util_percent": 33.8}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.713702952858486, "episode_reward_min": 0.20228743615627032, "episode_reward_mean": 5.415028094789328, "episode_len_mean": 74.26851851851852, "episode_media": {}, "episodes_this_iter": 108, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9907407407407407, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.009259259259259259, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9814814814814818, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24768518518518517, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.287713279974513, "reward_component_totals/rejoin_dist_change_reward_min": 0.9264883194362332, "reward_component_totals/rejoin_dist_change_reward_max": 1.524702952858486, "reward_component_totals/failure_reward_mean": -0.009259259259259259, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9074074074074074, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.959, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.689131158240528, 5.542643694725423, 5.6109528630793815, 5.397999560098777, 5.433002209792371, 5.68427120422278, 5.490382477397738, 5.471983021306139, 5.6281738065199285, 5.477843123845316, 5.546898764844356, 5.4084135679211585, 5.499124688375729, 5.469925638235776, 5.475892427256632, 5.228160325404612, 5.608046265005312, 5.426799748689097, 5.486120953334959, 5.41130106712113, 5.521280420345461, 5.574523148447615, 5.624374436729398, 5.545295265051209, 0.20228743615627032, 5.588092725909765, 5.557188435627774, 5.364774032355148, 5.534793285855027, 5.077488319436235, 5.480744032380358, 5.444563116266825, 5.251513061554936, 5.556853656558977, 5.61246448120847, 5.677166836735047, 5.603883973365144, 5.618879576865777, 5.577736326817524, 5.482743334495306, 5.5329943244652355, 5.340048006754623, 5.20196816757643, 5.649223895378801, 5.6294399507702995, 5.515107559796513, 5.469597243759884, 5.581518991352079, 5.259901475206728, 5.497012840825711, 5.596147108348661, 5.324160252232835, 5.713702952858486, 5.635010831848414, 5.366047945629717, 5.280940483110227, 5.269316817828953, 5.382619201153188, 5.676823363182303, 5.521162200107495, 5.57558802748606, 5.362416093163217, 5.409216508178185, 5.549112686164914, 5.336363785869885, 5.459036921740077, 5.212742136736471, 5.439947663547477, 5.424475120110783, 5.363275518377833, 5.627970765564566, 5.285919484362406, 5.265710629693718, 5.3893172509528595, 5.479639567710841, 5.469514482592155, 5.226039938218502, 5.350424529644411, 5.5984482147749794, 5.347595642027306, 5.164591793593949, 5.566395847577986, 5.475399210196926, 5.289376181385441, 5.109700404318533, 5.492806224468827, 5.647096354537132, 5.597831266905826, 5.58144713527577, 5.290011705952458, 5.456276310801768, 5.583792263492697, 5.550804944345301, 5.506926247181355, 5.55144537068635, 5.249879313409572, 5.3044143861381094, 5.480872905098773, 5.465007337134987, 5.224127472925586, 5.160053490524474, 5.422377732614534, 5.592423310904842, 5.7010468457191195, 5.644175406343461, 5.5405889770935435, 5.394532151423329, 5.2804226005141786], "episode_lengths": [63, 43, 66, 52, 41, 60, 141, 73, 57, 87, 74, 62, 87, 58, 85, 65, 93, 57, 75, 123, 110, 138, 73, 114, 21, 55, 57, 55, 58, 99, 123, 58, 87, 140, 61, 49, 103, 70, 70, 73, 100, 59, 90, 70, 60, 61, 76, 72, 74, 56, 50, 46, 61, 80, 74, 87, 110, 78, 79, 74, 132, 41, 85, 139, 58, 100, 52, 65, 80, 83, 85, 63, 65, 105, 78, 68, 51, 95, 95, 61, 48, 91, 56, 84, 76, 98, 77, 62, 68, 49, 43, 59, 85, 84, 79, 49, 46, 80, 52, 50, 78, 48, 52, 58, 57, 81, 74, 103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29119578758982984, "mean_inference_ms": 1.5920124071125952, "mean_action_processing_ms": 0.14989125030016462, "mean_env_wait_ms": 2.938393352904808, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1182816, "agent_timesteps_total": 1182816, "timers": {"sample_time_ms": 6481.612, "sample_throughput": 1233.027, "load_time_ms": 3.262, "load_throughput": 2449783.499, "learn_time_ms": 6223.095, "learn_throughput": 1284.248, "update_time_ms": 2.783}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03865765780210495, "policy_loss": -0.016160326078534126, "vf_loss": 0.051575034856796265, "vf_explained_var": 0.8205263614654541, "kl": 0.016214728355407715, "entropy": 0.39119529724121094, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1182816, "num_agent_steps_sampled": 1182816, "num_steps_trained": 1182816, "num_agent_steps_trained": 1182816}, "done": false, "episodes_total": 13235, "training_iteration": 148, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-08-59", "timestamp": 1716404939, "time_this_iter_s": 13.242162704467773, "time_total_s": 1981.5719711780548, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1981.5719711780548, "timesteps_since_restore": 0, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 36.06315789473684, "ram_util_percent": 33.8157894736842}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.709716753202966, "episode_reward_min": 5.116171872367403, "episode_reward_mean": 5.443457492944105, "episode_len_mean": 69.72566371681415, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2631831566609186, "reward_component_totals/rejoin_dist_change_reward_min": 0.9501718723674024, "reward_component_totals/rejoin_dist_change_reward_max": 1.5177167532029656, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.930274336283186, "reward_component_totals/success_reward_min": 1.87, "reward_component_totals/success_reward_max": 1.958}, "hist_stats": {"episode_reward": [5.47272601611327, 5.161238201042213, 5.325113900050344, 5.382152867432956, 5.662903493050482, 5.661169548375144, 5.496685599612725, 5.533268873201381, 5.391919243533512, 5.272262273930544, 5.155040928604759, 5.460544793780819, 5.183777366481278, 5.6638094572877575, 5.559916395301066, 5.41746143838072, 5.283035045264727, 5.472756700531205, 5.306581954882215, 5.5105507764637585, 5.499293661031033, 5.540144551652769, 5.522835907613327, 5.435426877713724, 5.542179768614723, 5.443477138144487, 5.297547270938837, 5.527940440333792, 5.13863068840997, 5.482914622331192, 5.676952679241672, 5.6071047884342144, 5.626717925967412, 5.209359001638741, 5.540876727165431, 5.640754392340444, 5.400006916081764, 5.27439639771976, 5.162643190634641, 5.617917065899219, 5.627378822831128, 5.55560591116563, 5.383938420410622, 5.36919214253728, 5.383821346189874, 5.577217258770361, 5.120357973821362, 5.44276240027797, 5.2746787789372105, 5.532027949439577, 5.420780965182619, 5.274061237281462, 5.51790874119866, 5.477223511878314, 5.238560720075281, 5.558361283374341, 5.21661918788403, 5.352723094230798, 5.56401859528636, 5.609006157653898, 5.5708352398221574, 5.619765889203846, 5.343609258627535, 5.2572777452428054, 5.349699803836368, 5.602791544289129, 5.627009730709016, 5.312644728453273, 5.406155169935019, 5.376705289441626, 5.181830690102712, 5.212113769954923, 5.709716753202966, 5.310074769423747, 5.32454164771956, 5.126398729086976, 5.693660700887742, 5.332179070913819, 5.116171872367403, 5.366454763789509, 5.361308231904285, 5.618809824273537, 5.63571875895264, 5.603208956750711, 5.263371424486829, 5.251902286096105, 5.500376726750986, 5.407811863934062, 5.342782329298508, 5.664633990443694, 5.696877724852563, 5.555933477340024, 5.490035562901644, 5.675628612124598, 5.46994707428008, 5.648121689153893, 5.2294718005939735, 5.568751585394697, 5.660102747867433, 5.249414483502134, 5.48985214942301, 5.512272899693356, 5.444031143279792, 5.680138361811855, 5.57241670650173, 5.603741020409583, 5.2570878223396384, 5.648346486311685, 5.248400281804278, 5.447586448976661, 5.530335647750297, 5.508839971352913, 5.377522061461674], "episode_lengths": [88, 85, 130, 81, 61, 65, 96, 62, 47, 56, 54, 85, 67, 61, 60, 51, 43, 75, 45, 107, 84, 68, 89, 70, 65, 61, 56, 75, 75, 52, 72, 87, 63, 92, 98, 50, 43, 45, 58, 78, 79, 109, 48, 48, 51, 49, 100, 79, 74, 51, 97, 47, 45, 57, 45, 130, 85, 77, 79, 104, 96, 77, 117, 71, 72, 74, 68, 59, 74, 81, 60, 76, 58, 88, 81, 88, 73, 46, 84, 52, 76, 87, 54, 86, 53, 92, 44, 52, 56, 84, 60, 57, 42, 55, 76, 53, 59, 60, 51, 57, 49, 86, 64, 54, 59, 64, 60, 56, 69, 51, 91, 105, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2904117363300414, "mean_inference_ms": 1.5914086445121414, "mean_action_processing_ms": 0.14978555396984922, "mean_env_wait_ms": 2.936781951152618, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1190808, "agent_timesteps_total": 1190808, "timers": {"sample_time_ms": 6433.393, "sample_throughput": 1242.268, "load_time_ms": 3.264, "load_throughput": 2448405.698, "learn_time_ms": 6209.926, "learn_throughput": 1286.972, "update_time_ms": 2.797}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.030922047793865204, "policy_loss": -0.017536407336592674, "vf_loss": 0.04540882259607315, "vf_explained_var": 0.8177005648612976, "kl": 0.015248165465891361, "entropy": 0.3062714636325836, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1190808, "num_agent_steps_sampled": 1190808, "num_steps_trained": 1190808, "num_agent_steps_trained": 1190808}, "done": false, "episodes_total": 13348, "training_iteration": 149, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-09-11", "timestamp": 1716404951, "time_this_iter_s": 12.39436936378479, "time_total_s": 1993.9663405418396, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1993.9663405418396, "timesteps_since_restore": 0, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 32.99444444444445, "ram_util_percent": 33.79999999999999}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.6938400174032715, "episode_reward_min": 0.062238238255145184, "episode_reward_mean": 5.392997340812759, "episode_len_mean": 69.90677966101696, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9915254237288136, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.00847457627118644, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9830508474576274, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.2478813559322034, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2572685272534365, "reward_component_totals/rejoin_dist_change_reward_min": 0.9739024320747847, "reward_component_totals/rejoin_dist_change_reward_max": 1.506487444853234, "reward_component_totals/failure_reward_mean": -0.00847457627118644, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9132711864406777, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.964, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.501844639934469, 5.503737708241326, 5.4209162030164935, 5.335078885877877, 5.6891782235544195, 5.287289912578698, 5.576010267929348, 5.350417755560373, 5.475647844530997, 5.512245494284789, 5.388413913588797, 5.244432825316763, 5.172175394529392, 5.43560678574004, 5.5534864768664844, 5.620639003843218, 5.306140778095859, 5.573519509170786, 5.558349732102521, 5.395845031632863, 5.144501213281012, 5.198827697765667, 5.641628728243354, 5.456758590241351, 5.498985726470179, 5.231265807235367, 5.2168561781130895, 5.5224596722363835, 5.543881072749546, 5.482817680675584, 5.433596258802584, 5.390715032543701, 5.341362423956991, 5.435765192541853, 5.208313698208869, 5.29558462984268, 5.4932996485419, 5.689487444853235, 5.365068332364599, 5.434256217990841, 5.6938400174032715, 5.322955748625194, 5.651300144102805, 5.609324338668414, 5.515239151153442, 5.396950617033951, 5.278584017391074, 5.35806658880563, 5.433256593668098, 5.489406257083658, 5.406812807063375, 5.645631011883207, 5.514287232444671, 5.637850282446513, 0.062238238255145184, 5.336361844667045, 5.62984368891486, 5.603241790817314, 5.231799865165575, 5.638777452582698, 5.4025403182805, 5.187624019218459, 5.4596593846238965, 5.272297962999981, 5.5850804024648575, 5.262150649139459, 5.648762156276179, 5.674667358426214, 5.641757127552335, 5.24965965066965, 5.57180899226578, 5.434405260211738, 5.176379352613827, 5.315753083492472, 5.640103448530876, 5.583406882231383, 5.284298015626435, 5.315195017101075, 5.195678935780405, 5.6061871949873945, 5.513082128008243, 5.456437215264479, 5.646335002641793, 5.671967662028623, 5.547591279965616, 5.58200186111357, 5.221888555750333, 5.644128386242478, 5.526716766927802, 5.684487602726409, 5.302113832121357, 5.567157379170245, 5.404783849484732, 5.4290538460779, 5.187902432074785, 5.195839549199738, 5.312915476573814, 5.534699245128434, 5.549151854570446, 5.423853572578704, 5.2947295014180025, 5.198273051861211, 5.526805269336404, 5.205967937706911, 5.4232484761967665, 5.663358433997207, 5.614604269180823, 5.5175900059313845, 5.422294422938929, 5.233298486986527, 5.546854518786255, 5.582160747979596, 5.2082310075120395, 5.357295523657579, 5.39934915126187, 5.2343603366931735, 5.2512957406779215, 5.402271302410269], "episode_lengths": [68, 86, 64, 62, 54, 52, 48, 122, 76, 49, 50, 55, 53, 116, 147, 46, 54, 52, 64, 63, 122, 104, 47, 49, 103, 72, 56, 59, 48, 68, 88, 63, 46, 46, 69, 42, 59, 67, 77, 66, 49, 80, 68, 77, 79, 57, 61, 62, 53, 54, 84, 47, 85, 58, 15, 75, 62, 85, 94, 81, 51, 47, 108, 86, 85, 50, 59, 72, 95, 49, 63, 48, 78, 107, 53, 51, 71, 91, 110, 53, 62, 87, 80, 63, 113, 82, 55, 77, 71, 65, 58, 161, 76, 61, 36, 58, 73, 47, 48, 80, 71, 121, 48, 42, 57, 50, 46, 60, 42, 85, 119, 56, 101, 55, 126, 87, 79, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2905648486978579, "mean_inference_ms": 1.5904695852604505, "mean_action_processing_ms": 0.149647405326385, "mean_env_wait_ms": 2.9353755868830387, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1198800, "agent_timesteps_total": 1198800, "timers": {"sample_time_ms": 6334.474, "sample_throughput": 1261.668, "load_time_ms": 3.176, "load_throughput": 2516299.033, "learn_time_ms": 6082.777, "learn_throughput": 1313.874, "update_time_ms": 2.836}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.040474627166986465, "policy_loss": -0.01303540263324976, "vf_loss": 0.050773318856954575, "vf_explained_var": 0.8273340463638306, "kl": 0.01368349976837635, "entropy": 0.2551794648170471, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1198800, "num_agent_steps_sampled": 1198800, "num_steps_trained": 1198800, "num_agent_steps_trained": 1198800}, "done": false, "episodes_total": 13466, "training_iteration": 150, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-09-24", "timestamp": 1716404964, "time_this_iter_s": 12.518868923187256, "time_total_s": 2006.4852094650269, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2006.4852094650269, "timesteps_since_restore": 0, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 33.45555555555555, "ram_util_percent": 33.9}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.676126450707967, "episode_reward_min": 5.113849691652616, "episode_reward_mean": 5.430596332907824, "episode_len_mean": 70.82882882882883, "episode_media": {}, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.251425161736653, "reward_component_totals/rejoin_dist_change_reward_min": 0.9318496916526149, "reward_component_totals/rejoin_dist_change_reward_max": 1.485206119042406, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9291711711711708, "reward_component_totals/success_reward_min": 1.8599999999999999, "reward_component_totals/success_reward_max": 1.96}, "hist_stats": {"episode_reward": [5.473570796178839, 5.656910671996019, 5.222103173632576, 5.597427531222231, 5.248353549892267, 5.270762877970653, 5.577158086726891, 5.334455204394779, 5.457474734645076, 5.417543894803346, 5.439727976078453, 5.264362474268685, 5.312840816323963, 5.273362327745594, 5.405868582859656, 5.646989941342751, 5.542896601110796, 5.298420696425736, 5.2459016299943055, 5.362801810936778, 5.494395427232189, 5.479129414098559, 5.607007768484193, 5.296289727272992, 5.573354996824378, 5.2490399155863585, 5.428948880496393, 5.419702743189415, 5.510211108428328, 5.4235709989072, 5.50877932338304, 5.557719980025569, 5.401591967983938, 5.4769472779893045, 5.2792886710564995, 5.528187093362364, 5.600257980443059, 5.138699362365692, 5.4237238600782085, 5.340724617708847, 5.639134582872698, 5.545335289570868, 5.3091128788534485, 5.343927695338257, 5.443757871562941, 5.54583885496563, 5.592048763857902, 5.5433844067310005, 5.113849691652616, 5.650959758655743, 5.249556114235332, 5.36606421278376, 5.546191044562714, 5.559849310334331, 5.523253154835923, 5.631806509775798, 5.238431495883212, 5.531249544030195, 5.43202913400747, 5.379487274142793, 5.392640404045384, 5.438599267717502, 5.514396724613314, 5.319656407592802, 5.610887065191935, 5.411835738819096, 5.274098680109773, 5.463792943445065, 5.535879505210483, 5.283993633229214, 5.606395243279257, 5.268510639336628, 5.6204941802595645, 5.552411106630123, 5.639206119042406, 5.26832626650951, 5.350715264614397, 5.676126450707967, 5.387778752846129, 5.447399157811195, 5.557383357345046, 5.643336630995474, 5.591489829481798, 5.57343473200841, 5.160844498422944, 5.491526432265847, 5.121796279159849, 5.156283161909781, 5.407895685769857, 5.294056795519311, 5.369763275047771, 5.474251591968164, 5.420685653381149, 5.550260620134479, 5.276202922272768, 5.330042673267263, 5.586147568822435, 5.440030681325647, 5.576865812661106, 5.406370864801498, 5.662749168604408, 5.425241612151782, 5.386467053891664, 5.328392774116674, 5.246067409424926, 5.263210013391824, 5.4818026187789215, 5.2330200375442715, 5.583472733129192, 5.318986533530633, 5.403198298513323], "episode_lengths": [88, 70, 40, 63, 47, 65, 91, 106, 86, 47, 85, 66, 65, 81, 71, 55, 76, 43, 51, 54, 95, 87, 51, 49, 89, 59, 68, 64, 105, 63, 140, 55, 45, 46, 55, 73, 49, 64, 49, 61, 59, 58, 102, 85, 116, 112, 57, 49, 68, 75, 52, 68, 103, 86, 72, 56, 68, 79, 43, 82, 82, 72, 80, 45, 78, 58, 49, 76, 52, 54, 69, 45, 114, 74, 96, 71, 54, 54, 56, 67, 55, 51, 49, 62, 122, 68, 93, 57, 103, 79, 53, 56, 72, 81, 51, 61, 86, 82, 114, 74, 60, 81, 57, 72, 59, 82, 53, 66, 86, 132, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2907731050790499, "mean_inference_ms": 1.5911163271307658, "mean_action_processing_ms": 0.14964265239743646, "mean_env_wait_ms": 2.935271360959364, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1206792, "agent_timesteps_total": 1206792, "timers": {"sample_time_ms": 6406.293, "sample_throughput": 1247.523, "load_time_ms": 3.171, "load_throughput": 2520347.784, "learn_time_ms": 6081.671, "learn_throughput": 1314.112, "update_time_ms": 2.863}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03277415409684181, "policy_loss": -0.014516917057335377, "vf_loss": 0.04422866925597191, "vf_explained_var": 0.8213979005813599, "kl": 0.015311985276639462, "entropy": 0.30883994698524475, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1206792, "num_agent_steps_sampled": 1206792, "num_steps_trained": 1206792, "num_agent_steps_trained": 1206792}, "done": false, "episodes_total": 13577, "training_iteration": 151, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-09-37", "timestamp": 1716404977, "time_this_iter_s": 12.988210439682007, "time_total_s": 2019.4734199047089, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2019.4734199047089, "timesteps_since_restore": 0, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 34.305555555555564, "ram_util_percent": 33.861111111111114}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.713879742751336, "episode_reward_min": 5.134450860854809, "episode_reward_mean": 5.438244703168456, "episode_len_mean": 68.94017094017094, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2571848741086273, "reward_component_totals/rejoin_dist_change_reward_min": 0.940792380287544, "reward_component_totals/rejoin_dist_change_reward_max": 1.523879742751337, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.931059829059829, "reward_component_totals/success_reward_min": 1.863, "reward_component_totals/success_reward_max": 1.962}, "hist_stats": {"episode_reward": [5.461948408178902, 5.343147273072651, 5.713879742751336, 5.397170449659674, 5.688436421564695, 5.521477156486391, 5.306489284703288, 5.590438397842502, 5.533102002102542, 5.64564459896918, 5.4867820993067555, 5.336556816122529, 5.651819868704432, 5.38020089071439, 5.629701910547432, 5.576769815019219, 5.535821209505491, 5.446840753421793, 5.559265991018945, 5.706757325325184, 5.664871480616577, 5.621254617900034, 5.2140053509087885, 5.435270160756758, 5.594387696325474, 5.45850000988411, 5.282787276249526, 5.344649814098131, 5.584160999751033, 5.206923530956301, 5.38276985914006, 5.583007276176901, 5.648803328293802, 5.139694389651795, 5.5144685604021575, 5.593486388226916, 5.335837141235659, 5.311923788331271, 5.187932204098061, 5.403428687176865, 5.628376253728825, 5.310684733544478, 5.484566602614625, 5.498172887891192, 5.143792380287544, 5.25258440452518, 5.487942819207287, 5.2816047355169315, 5.273701520280197, 5.6400437548214075, 5.134450860854809, 5.476715276012686, 5.436616525555198, 5.262187771356413, 5.1831767684337935, 5.277143558669822, 5.399031176541527, 5.366479203490808, 5.408067577597487, 5.659422183918215, 5.625814897992165, 5.433049335481465, 5.662136251203437, 5.217927737711895, 5.624153550321288, 5.280533346365611, 5.237735926595029, 5.712920732198551, 5.4804688197787375, 5.403337377070265, 5.372336021215363, 5.2218260512841015, 5.460619353869957, 5.4424520743378935, 5.478306062297781, 5.613622891361934, 5.2973869059523935, 5.328235775283307, 5.3689790377404805, 5.442124878996803, 5.608295169728374, 5.566384781905526, 5.316460734040452, 5.3444752166126, 5.473356294894874, 5.51706632398934, 5.346254881467616, 5.376666766998815, 5.45351802583256, 5.187666197597681, 5.239736700951667, 5.701386913254333, 5.27157204625477, 5.200716149425732, 5.533263296068556, 5.689264108334019, 5.388759988704196, 5.632920454687085, 5.498368180038989, 5.378880987046948, 5.6424005427666994, 5.306067771357856, 5.4809279772542965, 5.206547130541066, 5.338318998565491, 5.496181061964496, 5.289376392015759, 5.3162562393226, 5.645959402533466, 5.231333829944824, 5.438505082222167, 5.696878853548821, 5.652121800160616, 5.391590985907259, 5.459135588636105, 5.467131665349505, 5.16174273367983], "episode_lengths": [67, 59, 60, 46, 62, 90, 77, 66, 46, 65, 62, 47, 63, 108, 57, 49, 73, 48, 89, 58, 58, 88, 42, 90, 96, 53, 68, 56, 50, 38, 60, 84, 85, 95, 64, 82, 45, 62, 69, 66, 103, 106, 75, 74, 47, 61, 89, 68, 47, 49, 79, 48, 40, 56, 84, 63, 66, 64, 54, 57, 62, 125, 75, 96, 65, 109, 64, 59, 49, 66, 58, 82, 137, 111, 110, 83, 85, 83, 66, 50, 58, 72, 49, 53, 81, 46, 93, 49, 61, 53, 69, 47, 47, 65, 77, 55, 67, 50, 124, 54, 52, 82, 73, 84, 73, 47, 61, 70, 82, 63, 54, 69, 97, 58, 80, 67, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29144554829497077, "mean_inference_ms": 1.590292045056802, "mean_action_processing_ms": 0.14963158651943276, "mean_env_wait_ms": 2.9351689206566336, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1214784, "agent_timesteps_total": 1214784, "timers": {"sample_time_ms": 6455.418, "sample_throughput": 1238.03, "load_time_ms": 3.189, "load_throughput": 2505840.396, "learn_time_ms": 6113.301, "learn_throughput": 1307.313, "update_time_ms": 2.87}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.034633900970220566, "policy_loss": -0.011183170601725578, "vf_loss": 0.043357085436582565, "vf_explained_var": 0.8338784575462341, "kl": 0.0122999781742692, "entropy": 0.28961190581321716, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1214784, "num_agent_steps_sampled": 1214784, "num_steps_trained": 1214784, "num_agent_steps_trained": 1214784}, "done": false, "episodes_total": 13694, "training_iteration": 152, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-09-50", "timestamp": 1716404990, "time_this_iter_s": 13.317822933197021, "time_total_s": 2032.7912428379059, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2032.7912428379059, "timesteps_since_restore": 0, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 34.484210526315785, "ram_util_percent": 33.9}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.698772782752076, "episode_reward_min": 5.089811151388361, "episode_reward_mean": 5.4397533657107005, "episode_len_mean": 70.09734513274336, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2598507108434431, "reward_component_totals/rejoin_dist_change_reward_min": 0.9168111513883597, "reward_component_totals/rejoin_dist_change_reward_max": 1.514772782752076, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9299026548672567, "reward_component_totals/success_reward_min": 1.859, "reward_component_totals/success_reward_max": 1.9609999999999999}, "hist_stats": {"episode_reward": [5.198973221253059, 5.200511585055384, 5.345935026091318, 5.468958154586826, 5.593053842507283, 5.237990612651437, 5.386994537026425, 5.614306541655255, 5.408035325488758, 5.567590144929593, 5.466362128222778, 5.260540701687177, 5.513263018928411, 5.536431210539934, 5.262540358615345, 5.553871185880755, 5.616395691453228, 5.5050198258056735, 5.3556025149833015, 5.441778453225749, 5.431395623529899, 5.449895317062752, 5.322754416670365, 5.338103606639315, 5.322856438083974, 5.625043374888367, 5.572861247358139, 5.678529110307149, 5.633011303349439, 5.197761014653989, 5.425689261236412, 5.326887772982438, 5.458467434118062, 5.693914980356862, 5.671752961149702, 5.510367743057093, 5.344649697823011, 5.583905772325107, 5.671377267734094, 5.319279139863691, 5.474839711188087, 5.537845468299995, 5.456457560078327, 5.385527183992971, 5.577349370749413, 5.425079810481275, 5.503781871363287, 5.225992284069056, 5.301111533343809, 5.482322320599827, 5.584821683491571, 5.674851763324387, 5.435625617349064, 5.634219670982155, 5.33817061869281, 5.569939138501432, 5.440862124904576, 5.505489736584396, 5.521979811975178, 5.3940042274490185, 5.305607282180455, 5.6439963524127865, 5.416863485005308, 5.582898612758738, 5.466226422764537, 5.260716750084298, 5.551441381952442, 5.210526035994361, 5.089811151388361, 5.4805656012044786, 5.627251424306396, 5.62469190895866, 5.469861593016213, 5.404820790473186, 5.379641239036555, 5.200948691919734, 5.314098406618165, 5.590960074938435, 5.5517574927948345, 5.482449827829929, 5.242338928656686, 5.368046551729159, 5.361349662251179, 5.698772782752076, 5.5994308034170235, 5.258210479306326, 5.447120913216552, 5.296633938568288, 5.498210237989537, 5.3755163270932425, 5.140308918966188, 5.305648652274439, 5.545471337213497, 5.311504212589751, 5.463025856679721, 5.635884038444275, 5.390253708229224, 5.321904051602745, 5.547303638388376, 5.263865365193161, 5.241943520921479, 5.41418650789584, 5.50955371715473, 5.31387458953364, 5.340515014977903, 5.380712581532487, 5.4614467958341075, 5.382572275670203, 5.422972928405017, 5.585708589720945, 5.1428490370335, 5.547751376501687, 5.639179388730042], "episode_lengths": [59, 81, 47, 80, 76, 42, 48, 81, 40, 103, 85, 78, 76, 63, 44, 86, 96, 141, 61, 70, 79, 75, 86, 64, 57, 71, 53, 70, 100, 49, 75, 43, 48, 60, 55, 103, 99, 65, 80, 48, 63, 65, 39, 78, 58, 86, 56, 46, 74, 68, 117, 49, 48, 94, 56, 44, 101, 136, 92, 77, 47, 64, 79, 83, 80, 72, 63, 52, 77, 57, 53, 54, 58, 131, 51, 64, 76, 59, 125, 48, 113, 70, 78, 66, 55, 72, 95, 60, 80, 42, 52, 85, 49, 52, 46, 51, 103, 63, 54, 52, 73, 102, 97, 48, 73, 87, 54, 49, 65, 66, 47, 51, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.289654800267307, "mean_inference_ms": 1.5902882634390099, "mean_action_processing_ms": 0.14970538318425713, "mean_env_wait_ms": 2.93590983068376, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1222776, "agent_timesteps_total": 1222776, "timers": {"sample_time_ms": 6519.584, "sample_throughput": 1225.845, "load_time_ms": 3.208, "load_throughput": 2491628.701, "learn_time_ms": 6153.383, "learn_throughput": 1298.798, "update_time_ms": 2.896}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.029802197590470314, "policy_loss": -0.011562693864107132, "vf_loss": 0.038678184151649475, "vf_explained_var": 0.8439952731132507, "kl": 0.013433558866381645, "entropy": 0.2409951388835907, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1222776, "num_agent_steps_sampled": 1222776, "num_steps_trained": 1222776, "num_agent_steps_trained": 1222776}, "done": false, "episodes_total": 13807, "training_iteration": 153, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-10-04", "timestamp": 1716405004, "time_this_iter_s": 13.576228380203247, "time_total_s": 2046.3674712181091, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2046.3674712181091, "timesteps_since_restore": 0, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 34.36, "ram_util_percent": 33.89999999999999}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.685463272316004, "episode_reward_min": 0.08337636773908974, "episode_reward_mean": 5.4125397655682335, "episode_len_mean": 71.02702702702703, "episode_media": {}, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.990990990990991, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.009009009009009009, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9819819819819822, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24774774774774774, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2807559817844492, "reward_component_totals/rejoin_dist_change_reward_min": 0.9678641131814993, "reward_component_totals/rejoin_dist_change_reward_max": 1.4947802616242647, "reward_component_totals/failure_reward_mean": -0.009009009009009009, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9110630630630632, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.959, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.481349190943641, 5.538144885158996, 5.337456857708558, 5.492303101112343, 5.2741351603991165, 5.534361454560273, 5.52547736277018, 5.457039990848509, 5.660565438486799, 5.311759618267105, 5.670372621507101, 5.617817764827766, 5.486653200866892, 5.43338745183234, 5.306733437428621, 5.438205530221001, 5.58483045120019, 5.571945443566465, 5.247480395299853, 5.521078130668677, 5.638367308899925, 5.685463272316004, 5.655780261624265, 5.592290392433252, 5.479933430019567, 5.347596005280691, 5.270715404469191, 5.572401786989538, 5.597868839055115, 5.444976023872647, 5.56023691441067, 5.265536631559917, 5.610278670849345, 5.6377267483523035, 5.585528338130221, 5.636795711749041, 5.470957183076804, 5.524042419657176, 5.306730768930719, 5.605454990693589, 5.5884386329351745, 5.604429811996022, 5.226750763243304, 5.302648713221249, 5.5206704501975, 5.24892669477784, 5.249720011057121, 5.375054284587446, 5.375503008420079, 5.374590034717344, 5.221684322627062, 5.539140250815917, 5.4991641101905255, 5.271265436671008, 5.335246633546069, 5.292565180275325, 5.4228968531758746, 5.437152515699516, 5.484404296808595, 5.252336285115125, 5.401667406946778, 5.516586738508838, 5.389512903526703, 5.439700175225754, 5.599471611210842, 5.413915751643366, 5.369028464470695, 5.386762140188201, 5.421285382252879, 5.365625729027549, 5.53279982721385, 5.1098641131815, 5.423090948353397, 5.495974632311311, 5.348866401246713, 5.38734915218051, 5.49194379965989, 5.624630734681205, 5.148581955540907, 5.4276951061016225, 5.664483239547309, 5.539977960066107, 5.580553041282687, 5.221730558286747, 5.235969921119271, 5.555751365363464, 5.563121932114356, 5.588238961296785, 5.459551543810001, 5.564852433562466, 5.513723005644508, 5.406049343500168, 5.581031220306225, 5.585435384999475, 5.2916583015730385, 5.590053011390518, 5.497817201243013, 5.41839502678834, 5.528041822980674, 5.539075549091778, 5.419178968796467, 5.2629441479345065, 5.684019153723316, 5.632826279856689, 5.263459515785481, 5.58084830635358, 5.623444643474673, 5.58413145991789, 5.554363112550666, 5.281091344379583, 0.08337636773908974], "episode_lengths": [122, 85, 66, 75, 65, 61, 65, 83, 58, 62, 53, 50, 133, 64, 58, 71, 45, 86, 90, 66, 97, 56, 89, 85, 67, 79, 83, 67, 75, 96, 82, 61, 85, 72, 53, 48, 62, 52, 44, 87, 69, 74, 54, 94, 79, 99, 88, 47, 72, 44, 69, 61, 53, 52, 76, 86, 56, 56, 76, 60, 67, 66, 75, 53, 82, 87, 90, 75, 66, 51, 48, 108, 105, 47, 56, 69, 126, 112, 94, 56, 46, 72, 91, 44, 78, 71, 54, 53, 55, 105, 47, 44, 53, 79, 64, 70, 112, 92, 99, 82, 41, 49, 53, 61, 45, 50, 54, 128, 129, 55, 12]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2902407425742536, "mean_inference_ms": 1.5925225113851802, "mean_action_processing_ms": 0.1498066085523668, "mean_env_wait_ms": 2.938016489280512, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1230768, "agent_timesteps_total": 1230768, "timers": {"sample_time_ms": 6659.087, "sample_throughput": 1200.164, "load_time_ms": 3.265, "load_throughput": 2447458.242, "learn_time_ms": 6193.67, "learn_throughput": 1290.35, "update_time_ms": 2.914}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04013042896986008, "policy_loss": -0.01062063965946436, "vf_loss": 0.04768596217036247, "vf_explained_var": 0.8291376233100891, "kl": 0.015325560234487057, "entropy": 0.24309766292572021, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1230768, "num_agent_steps_sampled": 1230768, "num_steps_trained": 1230768, "num_agent_steps_trained": 1230768}, "done": false, "episodes_total": 13918, "training_iteration": 154, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-10-17", "timestamp": 1716405017, "time_this_iter_s": 13.749606847763062, "time_total_s": 2060.117078065872, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2060.117078065872, "timesteps_since_restore": 0, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 35.44736842105263, "ram_util_percent": 33.836842105263145}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.705219195928745, "episode_reward_min": 0.33032486988824283, "episode_reward_mean": 5.383294372919199, "episode_len_mean": 71.33333333333333, "episode_media": {}, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9912280701754386, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.008771929824561403, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9824561403508774, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24780701754385964, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2505312150244616, "reward_component_totals/rejoin_dist_change_reward_min": 0.9345675201835055, "reward_component_totals/rejoin_dist_change_reward_max": 1.5172191959287444, "reward_component_totals/failure_reward_mean": -0.008771929824561403, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9112719298245615, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.9649999999999999, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.656315861705096, 5.333963902868749, 5.379560637849281, 5.407033213110677, 5.2849078666569245, 5.386435966407697, 5.419547809735182, 5.352892581504634, 5.119567520183506, 5.5601630538062246, 5.116785817709908, 5.209649356808021, 5.422677778648748, 5.289357161445663, 5.643146708056378, 5.195092754460813, 5.596737052968672, 5.3344576852477825, 5.1689070747394315, 0.33032486988824283, 5.19151422051295, 5.642566229501803, 5.388756507172544, 5.528954869389928, 5.31228497761939, 5.5859310543580385, 5.586643226032317, 5.685873979832337, 5.310064366908168, 5.573906517005764, 5.597986895213662, 5.531587698652933, 5.203118534955287, 5.44516757470011, 5.396070989189519, 5.454957830510434, 5.705219195928745, 5.644241688316177, 5.563817470517331, 5.177182221286679, 5.573715099438149, 5.585805245802341, 5.175473526467149, 5.279171520571113, 5.5193179426521315, 5.4230120679095, 5.387308307627819, 5.315448297090432, 5.67180232974247, 5.153446631330196, 5.250558866197675, 5.389860098480929, 5.46403738221464, 5.397521726373979, 5.458090290719781, 5.4488119893913005, 5.161865300630715, 5.557997291479051, 5.633991792265176, 5.351067753456519, 5.654935785811707, 5.568426216635136, 5.666915771991972, 5.195786992367369, 5.365430417050879, 5.378036919321023, 5.450916802911191, 5.425409333642909, 5.580981990397493, 5.350416381984287, 5.438302861497707, 5.331343630166198, 5.493009448055297, 5.383841538518051, 5.163274420988483, 5.474160300486992, 5.310057738088849, 5.318662995970042, 5.520952934504363, 5.25014317411075, 5.251659876606412, 5.608909971856978, 5.591585227386416, 5.539503345410475, 5.3702906389403156, 5.55003593385409, 5.6145556662371545, 5.335756928578519, 5.4003953240628135, 5.476010587981846, 5.363553608917425, 5.627949812995661, 5.340621791113955, 5.490572128510881, 5.629750527106262, 5.521380429883365, 5.556086328960764, 5.60101730413815, 5.323207472575039, 5.431424338925536, 5.5425357756936195, 5.576251428867506, 5.461340953915764, 5.576321121254592, 5.372421687762252, 5.248389233806191, 5.467266112808185, 5.5373121142110175, 5.529397266411225, 5.194062866293155, 5.29512842524737, 5.6213393781115535, 5.262676216187418, 5.134168852429216], "episode_lengths": [70, 51, 84, 78, 45, 51, 63, 61, 65, 50, 88, 57, 101, 53, 51, 67, 115, 56, 52, 17, 59, 59, 132, 82, 75, 64, 60, 71, 107, 49, 52, 50, 70, 127, 53, 88, 62, 53, 67, 71, 107, 64, 60, 81, 72, 55, 45, 69, 51, 35, 82, 78, 74, 45, 59, 50, 66, 64, 73, 60, 50, 115, 61, 45, 69, 66, 49, 87, 124, 55, 103, 53, 78, 100, 45, 79, 57, 60, 125, 82, 104, 111, 47, 98, 83, 78, 92, 52, 66, 51, 69, 80, 79, 104, 46, 45, 135, 100, 65, 59, 78, 64, 114, 78, 77, 58, 101, 89, 62, 38, 52, 86, 81, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2924755446894829, "mean_inference_ms": 1.5926910100648155, "mean_action_processing_ms": 0.14979059173621528, "mean_env_wait_ms": 2.9392560107904027, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1238760, "agent_timesteps_total": 1238760, "timers": {"sample_time_ms": 6780.857, "sample_throughput": 1178.612, "load_time_ms": 3.245, "load_throughput": 2462941.313, "learn_time_ms": 6227.185, "learn_throughput": 1283.405, "update_time_ms": 2.985}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03456409275531769, "policy_loss": -0.016022665426135063, "vf_loss": 0.048170629888772964, "vf_explained_var": 0.8251042366027832, "kl": 0.012080651707947254, "entropy": 0.22498378157615662, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1238760, "num_agent_steps_sampled": 1238760, "num_steps_trained": 1238760, "num_agent_steps_trained": 1238760}, "done": false, "episodes_total": 14032, "training_iteration": 155, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-10-31", "timestamp": 1716405031, "time_this_iter_s": 13.657817363739014, "time_total_s": 2073.774895429611, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2073.774895429611, "timesteps_since_restore": 0, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 34.215, "ram_util_percent": 33.819999999999986}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.7235787888948515, "episode_reward_min": 5.118638386297774, "episode_reward_mean": 5.446236784144802, "episode_len_mean": 67.39830508474576, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2636350892295465, "reward_component_totals/rejoin_dist_change_reward_min": 0.9546383862977736, "reward_component_totals/rejoin_dist_change_reward_max": 1.5205787888948514, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9326016949152542, "reward_component_totals/success_reward_min": 1.8559999999999999, "reward_component_totals/success_reward_max": 1.962}, "hist_stats": {"episode_reward": [5.503239766145491, 5.456473469890932, 5.345176794893919, 5.7235787888948515, 5.222439679355112, 5.568688804655908, 5.151723859034102, 5.434980523504267, 5.347785580888886, 5.394659243035731, 5.3550250118845675, 5.2836195283707195, 5.595727351883685, 5.310445060909522, 5.2607322206534874, 5.575218897203163, 5.63156794030674, 5.246609569497368, 5.260720300149265, 5.617359889083627, 5.49621791732522, 5.607436918099637, 5.274351161251586, 5.2215644628362, 5.150180180685609, 5.612460097340052, 5.450416133997722, 5.341439647218964, 5.531241652366958, 5.639090605416399, 5.323410896253826, 5.602648539117833, 5.375850698776952, 5.260607907577533, 5.570968183460746, 5.166125134903849, 5.63673511522569, 5.244899558339482, 5.626703315807098, 5.6473780732319545, 5.650244512387308, 5.3250646310860805, 5.559127570113719, 5.307536409186126, 5.431672492853691, 5.595746886331689, 5.383851697078948, 5.522807499849815, 5.592032189990082, 5.548565405005135, 5.471983214127585, 5.652816022453042, 5.510616822888998, 5.618469730986499, 5.332732707471454, 5.184318313936657, 5.360717859335312, 5.579105076931757, 5.606249140686311, 5.37532311241171, 5.193251219198039, 5.118638386297774, 5.534019417225126, 5.646805004590214, 5.4904457728918326, 5.551251970914219, 5.236136526913715, 5.267908557095765, 5.507266024487769, 5.658903840884528, 5.4263313863001414, 5.491948964532957, 5.675485189093563, 5.3763784579255, 5.34410705977664, 5.537725563691296, 5.573924205870414, 5.392701192371526, 5.570854949656674, 5.300235991844108, 5.393614173009478, 5.49258814488061, 5.5832436967916355, 5.337635955103638, 5.2189294596450555, 5.317903849039339, 5.545274862834692, 5.279734755251913, 5.1963819257482, 5.511766652240594, 5.624998146145531, 5.394430786568908, 5.580538553238272, 5.550874707228022, 5.229352893911058, 5.409292957153285, 5.503142308911556, 5.4871272615039395, 5.630669332592371, 5.4132836956516535, 5.497922051428824, 5.553966730793105, 5.5578226618294035, 5.621905697755441, 5.629684240919342, 5.52208236834072, 5.344467476809662, 5.418991100648606, 5.595289404577981, 5.585068336055959, 5.289099147087818, 5.535033533128788, 5.282611359172854, 5.441083948109, 5.240018229614302, 5.250192636062127, 5.670486365451272, 5.35063166770315], "episode_lengths": [144, 63, 38, 47, 59, 49, 80, 70, 70, 74, 41, 106, 99, 41, 70, 47, 55, 64, 53, 63, 93, 77, 54, 50, 61, 53, 74, 48, 91, 54, 40, 108, 55, 60, 54, 112, 56, 67, 52, 62, 54, 82, 88, 70, 45, 48, 56, 133, 83, 78, 58, 59, 87, 49, 58, 38, 65, 49, 67, 49, 42, 86, 91, 71, 61, 114, 58, 48, 84, 69, 71, 94, 65, 64, 40, 116, 50, 51, 87, 85, 48, 46, 113, 45, 50, 119, 72, 68, 121, 77, 58, 50, 52, 63, 50, 95, 87, 63, 59, 48, 113, 49, 77, 81, 57, 81, 41, 62, 51, 48, 79, 54, 62, 48, 48, 86, 63, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2911868594109441, "mean_inference_ms": 1.5922955356596513, "mean_action_processing_ms": 0.1499349098194305, "mean_env_wait_ms": 2.9401864710609, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1246752, "agent_timesteps_total": 1246752, "timers": {"sample_time_ms": 6859.002, "sample_throughput": 1165.184, "load_time_ms": 3.291, "load_throughput": 2428081.386, "learn_time_ms": 6259.372, "learn_throughput": 1276.805, "update_time_ms": 2.976}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03354811295866966, "policy_loss": -0.0170552060008049, "vf_loss": 0.0469493605196476, "vf_explained_var": 0.8208576440811157, "kl": 0.018269823864102364, "entropy": 0.11088476330041885, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1246752, "num_agent_steps_sampled": 1246752, "num_steps_trained": 1246752, "num_agent_steps_trained": 1246752}, "done": false, "episodes_total": 14150, "training_iteration": 156, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-10-45", "timestamp": 1716405045, "time_this_iter_s": 13.732275247573853, "time_total_s": 2087.507170677185, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2087.507170677185, "timesteps_since_restore": 0, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 35.126315789473686, "ram_util_percent": 33.9}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.7039138014632655, "episode_reward_min": 5.100351059202744, "episode_reward_mean": 5.454349682561837, "episode_len_mean": 72.92792792792793, "episode_media": {}, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2772776104897654, "reward_component_totals/rejoin_dist_change_reward_min": 0.919351059202743, "reward_component_totals/rejoin_dist_change_reward_max": 1.5058585779537588, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9270720720720724, "reward_component_totals/success_reward_min": 1.857, "reward_component_totals/success_reward_max": 1.96}, "hist_stats": {"episode_reward": [5.596098072425333, 5.144625617247091, 5.145183981170261, 5.59078683941796, 5.447350610617427, 5.643335640273067, 5.7039138014632655, 5.588548322463989, 5.588737547896537, 5.647992584403117, 5.182746916970827, 5.390276277852754, 5.454360332398547, 5.238301699528165, 5.276386339601706, 5.194087006341446, 5.2815672813130305, 5.388900913585953, 5.243269677486143, 5.552407031077146, 5.3128485068586775, 5.36671312253775, 5.534507163928135, 5.381195757195913, 5.285890167438719, 5.282565476042585, 5.459873401681545, 5.630858295177632, 5.291454115301828, 5.397879488303056, 5.468232428771891, 5.643466550386817, 5.638238581222296, 5.4848685617148885, 5.268525042354043, 5.3528927244567726, 5.555925009201081, 5.57354606428118, 5.448042011581987, 5.401803278894676, 5.449743729782853, 5.612858827477977, 5.531891850116403, 5.568855320660676, 5.529065896325289, 5.483030106097592, 5.614288423819474, 5.542523305248412, 5.675858577953758, 5.338583704486769, 5.541617027778812, 5.667217655688936, 5.366045487157207, 5.332193932929583, 5.223428661428521, 5.599562419038647, 5.3795964913398775, 5.571050968985409, 5.235117884947828, 5.32763915303973, 5.342965206740407, 5.631713101762849, 5.478246154111789, 5.231978857144561, 5.494886469110844, 5.648887597509429, 5.535095700002245, 5.301994970801899, 5.268627033176921, 5.357686836599193, 5.456113315657694, 5.528813308194769, 5.575732768539142, 5.5255045277713, 5.608063776274677, 5.503389522071506, 5.6699494057642035, 5.425450847607005, 5.641681005431954, 5.493703341155422, 5.608570581094986, 5.224341092022507, 5.576710746155415, 5.541659903903218, 5.544227867349983, 5.430826715685066, 5.609367782897403, 5.6119441859385155, 5.596440538358618, 5.375025808527319, 5.544912953510524, 5.226044653571535, 5.167409070316614, 5.640588969665635, 5.272346007294141, 5.370437595700318, 5.629137369992661, 5.232214321559683, 5.632310153860859, 5.33840040994412, 5.380329509311924, 5.389891877486545, 5.5729629165867305, 5.594387665532086, 5.374840538077811, 5.365543888486236, 5.595964888912613, 5.560242509745525, 5.662581727865369, 5.100351059202744, 5.273946045210434], "episode_lengths": [123, 100, 134, 119, 136, 70, 46, 58, 63, 69, 40, 95, 61, 64, 64, 65, 58, 92, 53, 87, 92, 66, 87, 103, 53, 46, 84, 62, 48, 41, 111, 68, 46, 64, 65, 70, 79, 42, 59, 54, 77, 43, 73, 139, 122, 42, 55, 74, 80, 76, 51, 49, 90, 84, 69, 103, 75, 68, 69, 52, 57, 58, 54, 57, 48, 94, 51, 111, 112, 56, 63, 80, 143, 47, 45, 54, 60, 73, 83, 66, 60, 91, 54, 101, 112, 49, 75, 70, 108, 64, 74, 63, 56, 57, 54, 56, 58, 66, 64, 78, 60, 66, 109, 101, 52, 61, 73, 96, 53, 69, 105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2897498748180788, "mean_inference_ms": 1.5934024032827194, "mean_action_processing_ms": 0.15000003489456956, "mean_env_wait_ms": 2.9420477470354034, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1254744, "agent_timesteps_total": 1254744, "timers": {"sample_time_ms": 6980.601, "sample_throughput": 1144.887, "load_time_ms": 3.316, "load_throughput": 2409961.505, "learn_time_ms": 6309.843, "learn_throughput": 1266.593, "update_time_ms": 3.006}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.027471372857689857, "policy_loss": -0.017482934519648552, "vf_loss": 0.041647981852293015, "vf_explained_var": 0.8451351523399353, "kl": 0.01653163693845272, "entropy": 0.19023847579956055, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1254744, "num_agent_steps_sampled": 1254744, "num_steps_trained": 1254744, "num_agent_steps_trained": 1254744}, "done": false, "episodes_total": 14261, "training_iteration": 157, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-10-59", "timestamp": 1716405059, "time_this_iter_s": 13.94454574584961, "time_total_s": 2101.4517164230347, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2101.4517164230347, "timesteps_since_restore": 0, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 34.285000000000004, "ram_util_percent": 33.89999999999999}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.719532197884162, "episode_reward_min": 0.28437326003909, "episode_reward_mean": 5.38859058642367, "episode_len_mean": 72.75925925925925, "episode_media": {}, "episodes_this_iter": 108, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9907407407407407, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.009259259259259259, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9814814814814818, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24768518518518517, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.259803549386632, "reward_component_totals/rejoin_dist_change_reward_min": 0.9180904947230248, "reward_component_totals/rejoin_dist_change_reward_max": 1.520532197884161, "reward_component_totals/failure_reward_mean": -0.009259259259259259, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.90887962962963, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.9569999999999999, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.514462996919859, 5.516146965627493, 5.57649996636553, 5.674714358453434, 5.379224207088134, 5.6082905563232215, 5.474076995968529, 5.288544406099861, 5.3822670607067415, 5.719532197884162, 5.143187561954984, 5.531848414846481, 5.602569120047455, 5.619183907664244, 5.57055639785594, 5.6727580964778355, 5.6237123487513685, 5.478429134645189, 5.364528877223576, 5.325230339587873, 5.229288149903084, 5.394637178541632, 5.256130976791242, 5.205408855718285, 5.549040359010323, 5.560794852909526, 5.230675455573273, 5.43858035666096, 5.583253772526135, 5.50918227856063, 5.551027834641278, 5.143508189878391, 5.641954598774362, 5.472787711078729, 5.122090494723025, 5.452057419859604, 5.617386518247901, 5.333046626339332, 5.240639479288459, 5.236875285353864, 5.5078832696125986, 5.622763770309157, 5.415923561515838, 5.5760724188130135, 5.453631605760577, 5.59851649622798, 5.141955789322435, 5.397289475741409, 5.599620454936735, 5.347607319694344, 5.401232052201621, 5.567859602503082, 5.553671762278382, 5.468394629960512, 5.263494590461603, 5.411247350454715, 5.3550073800846665, 5.57846390372323, 5.625439755936069, 5.335196251360122, 5.418047094049628, 5.383220385425503, 5.565387644474109, 5.343263369440518, 5.4151209333341646, 0.28437326003909, 5.597281373145631, 5.281364046876175, 5.376246230606581, 5.359627127173872, 5.337340079632826, 5.689627148811111, 5.5575012349321185, 5.646266516010603, 5.206796339741226, 5.6536016505528774, 5.594543483939743, 5.419485028168783, 5.207679740710439, 5.316020613239656, 5.503558348030262, 5.269412473732974, 5.212832769668591, 5.343343718509721, 5.542507447792424, 5.452493042001397, 5.41590880508001, 5.364178766565649, 5.51463444152629, 5.3696785827310185, 5.597984257567005, 5.677641783728243, 5.18031607471864, 5.299710802544105, 5.404619409731689, 5.2769093771132, 5.5661443284723715, 5.271358066901961, 5.413457998787558, 5.413754262767816, 5.488868964531534, 5.64552378428322, 5.311755933398624, 5.6190743319582825, 5.574087273553808, 5.111141303751293, 5.124768884124048, 5.293923054109843], "episode_lengths": [96, 64, 115, 69, 72, 77, 60, 45, 55, 51, 85, 61, 88, 68, 109, 46, 56, 86, 57, 136, 79, 65, 96, 59, 57, 97, 54, 103, 60, 51, 88, 124, 84, 80, 46, 78, 62, 96, 69, 59, 106, 54, 63, 73, 57, 132, 81, 67, 51, 51, 63, 102, 77, 64, 60, 62, 48, 110, 56, 47, 67, 99, 91, 99, 60, 17, 74, 85, 87, 73, 71, 53, 89, 113, 83, 71, 101, 43, 58, 134, 77, 57, 58, 72, 69, 105, 59, 59, 73, 43, 63, 73, 59, 64, 49, 85, 56, 96, 75, 53, 50, 47, 51, 74, 64, 75, 82, 75]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29127606479212403, "mean_inference_ms": 1.5956027341764525, "mean_action_processing_ms": 0.15019483243254253, "mean_env_wait_ms": 2.9445979340827186, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1262736, "agent_timesteps_total": 1262736, "timers": {"sample_time_ms": 7036.339, "sample_throughput": 1135.818, "load_time_ms": 3.354, "load_throughput": 2382707.171, "learn_time_ms": 6349.234, "learn_throughput": 1258.735, "update_time_ms": 3.042}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04022553190588951, "policy_loss": -0.014056750573217869, "vf_loss": 0.05106672644615173, "vf_explained_var": 0.8111985921859741, "kl": 0.016077769920229912, "entropy": 0.2335256189107895, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1262736, "num_agent_steps_sampled": 1262736, "num_steps_trained": 1262736, "num_agent_steps_trained": 1262736}, "done": false, "episodes_total": 14369, "training_iteration": 158, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-11-13", "timestamp": 1716405073, "time_this_iter_s": 14.195598125457764, "time_total_s": 2115.6473145484924, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2115.6473145484924, "timesteps_since_restore": 0, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 34.614285714285714, "ram_util_percent": 33.89999999999999}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.689057549995699, "episode_reward_min": 5.147047264607303, "episode_reward_mean": 5.452266262223863, "episode_len_mean": 70.09734513274336, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2723636073566054, "reward_component_totals/rejoin_dist_change_reward_min": 0.9465295779957228, "reward_component_totals/rejoin_dist_change_reward_max": 1.5093603296311588, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9299026548672564, "reward_component_totals/success_reward_min": 1.851, "reward_component_totals/success_reward_max": 1.963}, "hist_stats": {"episode_reward": [5.394508262496309, 5.423344600589872, 5.460745742481869, 5.600065712410761, 5.411742874299092, 5.617843751523471, 5.422666922390471, 5.359977732281221, 5.578084171045907, 5.601961306599177, 5.282174640324433, 5.55339600108409, 5.472699013579295, 5.679587181844064, 5.575851244274127, 5.624392192230879, 5.65802404162061, 5.434302252622368, 5.560236211246938, 5.5665630243073325, 5.332317764383282, 5.268194461132361, 5.570989249225639, 5.285749019627927, 5.525716032711643, 5.56397629165281, 5.560478286336795, 5.665360329631159, 5.50908845266993, 5.305513787701127, 5.679289787116406, 5.397538668597878, 5.593318307699083, 5.463675273566297, 5.26787848134762, 5.603473899647895, 5.437276730280868, 5.633332903788666, 5.284832274267101, 5.5123648761250585, 5.40665711936175, 5.353598066525063, 5.447340209231907, 5.275727644682641, 5.396820523183131, 5.268776124910321, 5.446700944715962, 5.233061158065265, 5.554951976121197, 5.649860590229127, 5.583437493009761, 5.5071045889577, 5.536547288268141, 5.204041696176753, 5.246372975769961, 5.524002339331075, 5.514826066578914, 5.526974666487778, 5.213282986175617, 5.683903593098808, 5.30137039301861, 5.147047264607303, 5.4384596117146415, 5.593802036656942, 5.370203295537705, 5.401246082100698, 5.207550872057277, 5.653845756276238, 5.689057549995699, 5.469496537379269, 5.5097831628592715, 5.318929955271745, 5.223505225134906, 5.60314127585541, 5.567489792678555, 5.5764912743531045, 5.528915748771833, 5.158879821456217, 5.362408022677338, 5.611984554109409, 5.182614874921528, 5.409759277865026, 5.618457139353364, 5.601240756498289, 5.313273450684557, 5.318021353715753, 5.546483235154615, 5.633070332704369, 5.364409280968688, 5.320680115121534, 5.409535500700983, 5.644404874040242, 5.486768857488858, 5.287990841880022, 5.554330099423275, 5.286000437414476, 5.16251201421484, 5.481932290309758, 5.267383563884177, 5.67971492681569, 5.406572395904812, 5.147529577995724, 5.6306096275513635, 5.322858293926963, 5.375615356424101, 5.510674516892362, 5.499992035593107, 5.5899166330028365, 5.3275751493519055, 5.18654640926358, 5.431201954205491, 5.6543092996560675, 5.407975118213197], "episode_lengths": [83, 64, 45, 93, 76, 50, 46, 58, 69, 83, 71, 47, 60, 54, 120, 50, 86, 71, 66, 72, 52, 39, 99, 95, 113, 119, 81, 94, 64, 46, 65, 55, 56, 55, 51, 57, 53, 51, 52, 61, 59, 54, 59, 41, 59, 46, 62, 88, 97, 78, 109, 57, 94, 73, 44, 74, 85, 83, 84, 69, 54, 53, 82, 91, 52, 63, 53, 69, 61, 63, 109, 74, 52, 64, 97, 60, 62, 91, 42, 145, 100, 85, 45, 48, 76, 60, 56, 52, 71, 37, 75, 65, 59, 55, 149, 104, 52, 78, 48, 59, 72, 49, 107, 66, 72, 56, 74, 94, 64, 98, 57, 60, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29252177345117747, "mean_inference_ms": 1.5963625528045613, "mean_action_processing_ms": 0.15023520637447232, "mean_env_wait_ms": 2.9470362594204413, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1270728, "agent_timesteps_total": 1270728, "timers": {"sample_time_ms": 7181.807, "sample_throughput": 1112.812, "load_time_ms": 3.325, "load_throughput": 2403791.866, "learn_time_ms": 6371.956, "learn_throughput": 1254.246, "update_time_ms": 3.027}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03664093092083931, "policy_loss": -0.015256323851644993, "vf_loss": 0.048522137105464935, "vf_explained_var": 0.8169182538986206, "kl": 0.01687558926641941, "entropy": 0.18908239901065826, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1270728, "num_agent_steps_sampled": 1270728, "num_steps_trained": 1270728, "num_agent_steps_trained": 1270728}, "done": false, "episodes_total": 14482, "training_iteration": 159, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-11-27", "timestamp": 1716405087, "time_this_iter_s": 14.0757896900177, "time_total_s": 2129.72310423851, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2129.72310423851, "timesteps_since_restore": 0, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 34.425, "ram_util_percent": 33.980000000000004}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.709386828520364, "episode_reward_min": 0.30034025409250353, "episode_reward_mean": 5.379779812752853, "episode_len_mean": 69.03389830508475, "episode_media": {}, "episodes_this_iter": 118, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9915254237288136, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.00847457627118644, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9830508474576274, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.2478813559322034, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.243110321227428, "reward_component_totals/rejoin_dist_change_reward_min": 0.9367607010472032, "reward_component_totals/rejoin_dist_change_reward_max": 1.5153868285203647, "reward_component_totals/failure_reward_mean": -0.00847457627118644, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.91421186440678, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.962, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.249980591086141, 5.5045329835844505, 5.404201454869089, 5.329679079134281, 5.471580714645637, 5.561582071660061, 5.41221777153942, 5.244985150048592, 5.331204773989033, 0.30034025409250353, 5.504320602370779, 5.413137532959851, 5.4365196595016005, 5.221936352891442, 5.6237404879514585, 5.561176358550804, 5.515210960149984, 5.295564774285564, 5.578460975226125, 5.320820026463437, 5.583463417158918, 5.484588590561488, 5.377628988644673, 5.493306984541759, 5.190474336257283, 5.3288528988667565, 5.157431823357537, 5.427108449329349, 5.387447464251149, 5.567639522156351, 5.427441987305866, 5.422629131714329, 5.676470467304337, 5.584613069914824, 5.2426847923706585, 5.6407832533540105, 5.582662840138441, 5.20609918374739, 5.519594564016687, 5.5525857070795395, 5.324726899318252, 5.569919360623677, 5.1899009457914405, 5.485550168111254, 5.297662721410177, 5.385697434618958, 5.341979355121973, 5.233190036179208, 5.566567197011174, 5.23166615633943, 5.444582274122575, 5.5619678489569555, 5.410051334096562, 5.225187281835115, 5.66105843501515, 5.279525696758167, 5.138659571965699, 5.5527844474264185, 5.32663469193811, 5.450346078781607, 5.677100366203236, 5.38932257238729, 5.309027604303617, 5.303185195429704, 5.454023211923954, 5.4978475634281505, 5.133760701047204, 5.242094133970335, 5.161796962119354, 5.117912244185435, 5.444268865521952, 5.412317652851659, 5.458488849638633, 5.52445347448195, 5.365856710596093, 5.558158463748193, 5.343386457714877, 5.597300500613766, 5.351129393440189, 5.709386828520364, 5.449527546174855, 5.353618699020107, 5.639765478362044, 5.676187367547797, 5.421152992120169, 5.572040066281074, 5.695515770887332, 5.604598192578485, 5.485989215374345, 5.4525511103438, 5.359770724204342, 5.620457571366921, 5.509175477177942, 5.497956494215517, 5.33629467758527, 5.210422216484951, 5.379874357001969, 5.357329446621401, 5.549363473401183, 5.325697974096936, 5.195955416349816, 5.6176954879363725, 5.542389309948095, 5.299583893495461, 5.271263937030222, 5.519426087615529, 5.4990680706687, 5.224513030638381, 5.28834267890309, 5.550490729828859, 5.12460296993606, 5.539162067927453, 5.440229430087051, 5.544931265765267, 5.390202689641219, 5.636843366233132, 5.5740819582606225, 5.194770929105285], "episode_lengths": [75, 96, 55, 51, 89, 46, 65, 71, 43, 23, 52, 82, 70, 71, 69, 47, 56, 78, 71, 38, 95, 119, 47, 48, 103, 38, 66, 58, 57, 65, 46, 57, 67, 52, 68, 65, 109, 63, 48, 94, 62, 129, 59, 73, 65, 80, 50, 86, 61, 95, 74, 75, 71, 72, 55, 72, 82, 48, 74, 55, 59, 53, 51, 62, 65, 57, 53, 61, 66, 83, 79, 79, 66, 95, 70, 94, 44, 93, 66, 56, 91, 104, 52, 74, 63, 144, 57, 48, 76, 77, 41, 93, 68, 143, 65, 103, 42, 52, 83, 67, 78, 72, 60, 39, 56, 68, 63, 53, 87, 43, 86, 94, 88, 59, 69, 78, 59, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29295341721924917, "mean_inference_ms": 1.597913639298488, "mean_action_processing_ms": 0.15040953152319173, "mean_env_wait_ms": 2.9500330591643786, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1278720, "agent_timesteps_total": 1278720, "timers": {"sample_time_ms": 7361.707, "sample_throughput": 1085.618, "load_time_ms": 3.321, "load_throughput": 2406345.75, "learn_time_ms": 6408.631, "learn_throughput": 1247.068, "update_time_ms": 2.992}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.044225938618183136, "policy_loss": -0.011974827386438847, "vf_loss": 0.05320999398827553, "vf_explained_var": 0.8148732781410217, "kl": 0.01495386939495802, "entropy": 0.13220974802970886, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1278720, "num_agent_steps_sampled": 1278720, "num_steps_trained": 1278720, "num_agent_steps_trained": 1278720}, "done": false, "episodes_total": 14600, "training_iteration": 160, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-11-42", "timestamp": 1716405102, "time_this_iter_s": 14.685248851776123, "time_total_s": 2144.4083530902863, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2144.4083530902863, "timesteps_since_restore": 0, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 34.59523809523809, "ram_util_percent": 34.0}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.7203598600851295, "episode_reward_min": 5.105334306341728, "episode_reward_mean": 5.438960947597833, "episode_len_mean": 70.61061946902655, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2595715670668581, "reward_component_totals/rejoin_dist_change_reward_min": 0.9616809264740194, "reward_component_totals/rejoin_dist_change_reward_max": 1.52235986008513, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9293893805309734, "reward_component_totals/success_reward_min": 1.838, "reward_component_totals/success_reward_max": 1.964}, "hist_stats": {"episode_reward": [5.602554880414877, 5.571866313880656, 5.5624888721036205, 5.336075588696973, 5.321349386980186, 5.460300455341802, 5.464108045790414, 5.421232198991426, 5.526154183342522, 5.629985334661336, 5.519126504060857, 5.543116126881412, 5.398726297038032, 5.152436613160304, 5.550642348248503, 5.425066068654653, 5.373475031397261, 5.3197816789713865, 5.3419938093877715, 5.631439497138297, 5.528037966971079, 5.300383513174667, 5.580508040239046, 5.589818067395916, 5.5113804731869, 5.5414751047832835, 5.348932824107946, 5.55265573718807, 5.377705885874061, 5.586776376090365, 5.506623701054772, 5.7203598600851295, 5.305354972799574, 5.559261897391418, 5.387464245273922, 5.619662463501783, 5.668459085211701, 5.415832871115624, 5.496849747866349, 5.483153607240838, 5.340637782631317, 5.105334306341728, 5.359572789611638, 5.2360560881337825, 5.3725969580271435, 5.369070535584455, 5.61254897108466, 5.487529509943096, 5.347733670321572, 5.550943192909116, 5.136316823826529, 5.578186232076378, 5.323031719141355, 5.585232200676824, 5.457309331201501, 5.679946067278525, 5.594168560227072, 5.495676842432043, 5.310121227415738, 5.285042453908501, 5.312273986171776, 5.548521915091794, 5.6301495645591135, 5.668772034893186, 5.238450170098215, 5.58005185104962, 5.192352657329335, 5.662159128865901, 5.324049023765392, 5.197431625708215, 5.3668597557192435, 5.308950666753493, 5.536877503205779, 5.464600673174975, 5.64676791313967, 5.176412140481827, 5.423840079323287, 5.407561092011576, 5.286102922160593, 5.546978920739397, 5.636743091005679, 5.533604144393442, 5.45094175041063, 5.273918192152527, 5.272933503173878, 5.368286621468313, 5.203113387384116, 5.3784870520117565, 5.476917386567491, 5.577401774010099, 5.457989942471247, 5.3571992397611545, 5.540892431067877, 5.373913747079003, 5.656119198777379, 5.579636310142706, 5.240768781934245, 5.45086042420845, 5.373997625410576, 5.154555658155872, 5.556104583253642, 5.276992271065822, 5.4504621632859, 5.179668875368602, 5.611960837343682, 5.621774977854903, 5.134680926474019, 5.45454773224756, 5.156131651997804, 5.431521335113873, 5.259466814163809, 5.557400763543242, 5.574759322545628], "episode_lengths": [118, 90, 88, 51, 45, 66, 103, 75, 102, 55, 61, 92, 47, 65, 54, 57, 47, 46, 51, 66, 61, 61, 69, 94, 85, 52, 54, 45, 44, 83, 56, 52, 107, 106, 67, 57, 49, 51, 107, 47, 47, 117, 63, 51, 94, 102, 73, 76, 55, 81, 84, 72, 37, 59, 159, 62, 58, 140, 67, 93, 59, 82, 106, 64, 46, 125, 62, 69, 50, 58, 53, 49, 50, 68, 46, 52, 48, 94, 78, 58, 60, 70, 82, 79, 40, 65, 83, 42, 49, 87, 80, 77, 56, 53, 74, 70, 36, 71, 61, 162, 72, 45, 71, 36, 75, 59, 77, 81, 91, 77, 63, 95, 107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2921628013296321, "mean_inference_ms": 1.59876051580969, "mean_action_processing_ms": 0.15045655678919928, "mean_env_wait_ms": 2.951805344296816, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1286712, "agent_timesteps_total": 1286712, "timers": {"sample_time_ms": 7455.663, "sample_throughput": 1071.937, "load_time_ms": 3.331, "load_throughput": 2399593.223, "learn_time_ms": 6430.189, "learn_throughput": 1242.887, "update_time_ms": 3.003}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.034203849732875824, "policy_loss": -0.009568475186824799, "vf_loss": 0.04049324989318848, "vf_explained_var": 0.8522757291793823, "kl": 0.016395356506109238, "entropy": 0.11686636507511139, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1286712, "num_agent_steps_sampled": 1286712, "num_steps_trained": 1286712, "num_agent_steps_trained": 1286712}, "done": false, "episodes_total": 14713, "training_iteration": 161, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-11-56", "timestamp": 1716405116, "time_this_iter_s": 14.142223358154297, "time_total_s": 2158.5505764484406, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2158.5505764484406, "timesteps_since_restore": 0, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 34.67, "ram_util_percent": 34.10000000000001}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.7054762803870345, "episode_reward_min": 0.28337373011247813, "episode_reward_mean": 5.405470248595014, "episode_len_mean": 71.04424778761062, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9911504424778761, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.008849557522123894, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9823008849557524, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24778761061946902, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2728242308958992, "reward_component_totals/rejoin_dist_change_reward_min": 0.9630769855043626, "reward_component_totals/rejoin_dist_change_reward_max": 1.5114762803870343, "reward_component_totals/failure_reward_mean": -0.008849557522123894, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9114070796460176, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.963, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.42897413896034, 5.4409872848774645, 5.550103720693581, 5.4097679324983705, 5.396181160429395, 5.4509476015805, 5.595942086301943, 5.434877806660474, 5.521072439990668, 5.389018677676116, 5.633197128900733, 5.463102926955537, 5.6772784992773975, 5.581705359736263, 5.370030239520454, 5.569281890210065, 5.504632627935437, 5.23801801478212, 5.509491285592368, 5.675245108600653, 5.474887062764347, 5.266108931373379, 5.406491898655922, 5.340856354880273, 5.402148889566097, 5.642188275200636, 5.423287937562967, 5.374658381396359, 5.584847313344412, 5.617746615694391, 5.345801662282884, 5.570357275519875, 5.4279323158602475, 5.5224816775563905, 5.206675857707064, 5.417513846843515, 5.357120479090198, 5.532400112921954, 5.555663653142403, 5.168787687069276, 5.398656721285596, 5.554428818947809, 5.550772864429701, 5.147591852638429, 5.393534166572673, 5.558844954094722, 5.461569448923711, 5.597517698896037, 5.172477264389596, 5.4347799870646405, 5.600005713003128, 5.454627983637368, 5.214998647030983, 5.294243899786663, 5.58166078808558, 5.42682026480034, 5.161076985504363, 0.28337373011247813, 5.381942455528296, 5.360616715500077, 5.630991872745794, 5.557094355837684, 5.262505430145842, 5.66146904120333, 5.560807155121476, 5.48729371945916, 5.3154881177524835, 5.443322918718298, 5.362220104736758, 5.550287063009581, 5.3356491575147675, 5.3631829502784125, 5.454689165824674, 5.15878120201174, 5.552387055320544, 5.3505319870102, 5.177143125206937, 5.549471055422578, 5.37268344957235, 5.341761511756527, 5.4910206060788855, 5.520805583942061, 5.611906081737822, 5.322677930395724, 5.529149768604864, 5.661723261940008, 5.552890874102554, 5.604257563729496, 5.50803986740763, 5.639234234973685, 5.54833490487553, 5.185904718329422, 5.625916558101503, 5.317110022697786, 5.442649472489599, 5.566276084627336, 5.7054762803870345, 5.43084546787647, 5.393535544487742, 5.383034065534213, 5.66698685191702, 5.5157697185403, 5.361579613787917, 5.350274511111208, 5.509610491227021, 5.528575777686539, 5.499870478159213, 5.27787048125319, 5.431281246262486, 5.608753080465814, 5.572741396822837, 5.243031707369614, 5.215890285820285], "episode_lengths": [128, 49, 92, 50, 60, 60, 56, 81, 89, 69, 59, 98, 63, 67, 55, 146, 46, 71, 133, 79, 54, 47, 52, 59, 44, 58, 109, 122, 122, 70, 67, 149, 102, 92, 82, 66, 81, 91, 75, 89, 64, 51, 73, 79, 77, 80, 70, 84, 46, 45, 75, 70, 37, 54, 94, 66, 52, 17, 50, 65, 54, 51, 60, 53, 55, 53, 48, 44, 43, 51, 46, 66, 66, 87, 43, 78, 89, 90, 63, 63, 49, 74, 55, 70, 51, 77, 55, 92, 64, 100, 77, 127, 65, 79, 56, 111, 56, 49, 82, 99, 77, 162, 65, 96, 60, 46, 48, 44, 94, 49, 48, 60, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2916923334833276, "mean_inference_ms": 1.6015038351375603, "mean_action_processing_ms": 0.15064861400052773, "mean_env_wait_ms": 2.9548809676518957, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1294704, "agent_timesteps_total": 1294704, "timers": {"sample_time_ms": 7544.542, "sample_throughput": 1059.309, "load_time_ms": 3.328, "load_throughput": 2401467.032, "learn_time_ms": 6455.226, "learn_throughput": 1238.067, "update_time_ms": 3.031}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03190409019589424, "policy_loss": -0.014850789681077003, "vf_loss": 0.04407128691673279, "vf_explained_var": 0.8544418215751648, "kl": 0.013417979702353477, "entropy": 0.07861782610416412, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1294704, "num_agent_steps_sampled": 1294704, "num_steps_trained": 1294704, "num_agent_steps_trained": 1294704}, "done": false, "episodes_total": 14826, "training_iteration": 162, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-12-11", "timestamp": 1716405131, "time_this_iter_s": 14.458767890930176, "time_total_s": 2173.0093443393707, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2173.0093443393707, "timesteps_since_restore": 0, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 34.82380952380952, "ram_util_percent": 34.10000000000001}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.684058758108669, "episode_reward_min": 0.12024157031978233, "episode_reward_mean": 5.415999657408616, "episode_len_mean": 72.03636363636363, "episode_media": {}, "episodes_this_iter": 110, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.990909090909091, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.00909090909090909, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9818181818181821, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24772727272727274, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.285490566499525, "reward_component_totals/rejoin_dist_change_reward_min": 0.9561918362360009, "reward_component_totals/rejoin_dist_change_reward_max": 1.5122855143586118, "reward_component_totals/failure_reward_mean": -0.00909090909090909, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9100545454545452, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.962, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.38377290455424, 5.294340552989183, 5.666176220206774, 5.552440122549133, 5.6555943254113, 5.339695860448296, 5.46690706914343, 5.484226048090738, 5.547101014492929, 5.2108058506789305, 5.382495271831903, 5.285391946666168, 5.43259912854529, 5.2977994633243775, 5.360045981304343, 5.534056640458604, 5.270847712728509, 5.246054507414865, 5.482037767412967, 5.241948413812938, 5.324919497536343, 5.149191836236001, 5.6382127298674005, 5.674285514358611, 5.684058758108669, 5.489865838541968, 5.549524245054988, 5.3781953263406255, 5.5336142331982145, 5.650959376681169, 5.43359029665709, 5.4856986975815385, 5.37259827223191, 5.545396641155653, 5.4404338919037905, 5.440940836199936, 5.561465625126961, 5.5727578435175165, 5.669447098600371, 5.598265557546394, 5.39426490654731, 5.664668056131562, 5.504706555147914, 5.317243560981494, 0.12024157031978233, 5.19080207649621, 5.582813706419449, 5.502226999223408, 5.576975551980445, 5.2801030363866825, 5.329135135963198, 5.5922757521428315, 5.433083495217272, 5.263380822739885, 5.402236474328087, 5.615329992327787, 5.506254165040533, 5.580105354469735, 5.510921490905936, 5.369029656480108, 5.461774450324647, 5.5834814039661715, 5.420866784824984, 5.292162497724469, 5.368188979932603, 5.575904317983488, 5.553079207876676, 5.603729480858252, 5.324379091027888, 5.486424364049218, 5.531039623369496, 5.526223721435652, 5.514043435775603, 5.551420251380683, 5.505046977669304, 5.453250440434137, 5.470702477357159, 5.432876183943787, 5.67202479858293, 5.466442572596194, 5.673978614577177, 5.279137231286985, 5.313942564947945, 5.256887929483117, 5.3767026571919905, 5.400034600584011, 5.656122990349472, 5.617403391651057, 5.520936994156344, 5.652510830635949, 5.428122468837989, 5.467311349609615, 5.413802058295694, 5.541792793166365, 5.471015569745154, 5.475564081765793, 5.537425659547352, 5.366769296269518, 5.565336868279912, 5.470220893001798, 5.618146931942379, 5.416265625387829, 5.292343234219008, 5.62200896931369, 5.464493699719885, 5.259052307427447, 5.576275606648381, 5.506131208375184, 5.178774854551545, 5.484832695106135], "episode_lengths": [79, 61, 66, 94, 66, 70, 41, 63, 78, 105, 54, 50, 67, 100, 108, 99, 99, 93, 49, 57, 63, 57, 83, 88, 67, 102, 59, 82, 86, 80, 98, 70, 98, 106, 49, 130, 70, 105, 83, 48, 62, 72, 86, 63, 30, 90, 72, 119, 55, 45, 72, 94, 47, 89, 92, 96, 99, 114, 43, 79, 78, 49, 66, 57, 94, 61, 83, 52, 94, 44, 57, 46, 63, 48, 121, 72, 52, 62, 70, 74, 56, 62, 55, 50, 61, 76, 58, 62, 63, 102, 101, 74, 56, 53, 88, 57, 91, 43, 48, 44, 76, 74, 62, 62, 61, 55, 87, 74, 38, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2913557008116045, "mean_inference_ms": 1.6009162561224453, "mean_action_processing_ms": 0.15074857457446317, "mean_env_wait_ms": 2.956889813399639, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1302696, "agent_timesteps_total": 1302696, "timers": {"sample_time_ms": 7625.349, "sample_throughput": 1048.083, "load_time_ms": 3.333, "load_throughput": 2397996.779, "learn_time_ms": 6472.482, "learn_throughput": 1234.766, "update_time_ms": 3.033}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.046618517488241196, "policy_loss": -0.015240122564136982, "vf_loss": 0.05864071846008301, "vf_explained_var": 0.7938879132270813, "kl": 0.016089634969830513, "entropy": 0.13867008686065674, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1302696, "num_agent_steps_sampled": 1302696, "num_steps_trained": 1302696, "num_agent_steps_trained": 1302696}, "done": false, "episodes_total": 14936, "training_iteration": 163, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-12-25", "timestamp": 1716405145, "time_this_iter_s": 14.556251525878906, "time_total_s": 2187.5655958652496, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2187.5655958652496, "timesteps_since_restore": 0, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 35.31428571428571, "ram_util_percent": 34.15238095238096}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.712959130983835, "episode_reward_min": 0.24015735504696067, "episode_reward_mean": 5.4237785942548395, "episode_len_mean": 69.06837606837607, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9914529914529915, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.008547008547008548, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9829059829059832, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24786324786324787, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2874965429727883, "reward_component_totals/rejoin_dist_change_reward_min": 0.9443363596243819, "reward_component_totals/rejoin_dist_change_reward_max": 1.5191505589460155, "reward_component_totals/failure_reward_mean": -0.008547008547008548, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.914059829059829, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.9609999999999999, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.4794348923023755, 5.574739935179808, 5.61294983680317, 5.532008112804512, 5.464075639393384, 5.25750664513005, 0.24015735504696067, 5.6661467560846965, 5.157244728459164, 5.438807681357868, 5.297932139527463, 5.6482142012366925, 5.679930102714179, 5.523997903838419, 5.7064548346256005, 5.5457656000365505, 5.408765309807555, 5.384438179732042, 5.393231486228206, 5.66475440561222, 5.267897108333485, 5.397543935334847, 5.369929082988344, 5.707150558946015, 5.5602824399459045, 5.448518127793378, 5.514365812685478, 5.621589620463616, 5.559341070728703, 5.500962846364904, 5.481949947994801, 5.197603334493037, 5.70370566082576, 5.573212446340176, 5.293742042919265, 5.574328910419036, 5.589169505240214, 5.130244876005982, 5.29726879691967, 5.207056625229637, 5.564864562622943, 5.406661047863484, 5.556650159023233, 5.37471210035471, 5.348334899673047, 5.635182123534333, 5.314464893287663, 5.540931485348434, 5.210015493175822, 5.347750226622944, 5.617359271959016, 5.17023165999882, 5.21289793211182, 5.541124627598161, 5.54791361837389, 5.35445706169606, 5.4440509362191065, 5.6295849316775595, 5.605292469902302, 5.583393775697344, 5.462884255669503, 5.396918572516709, 5.203984254862387, 5.52932612373643, 5.369058449546442, 5.3109889091214395, 5.325028277018325, 5.554946833983237, 5.469019345139179, 5.242248197359997, 5.2377631607419435, 5.612329664967912, 5.2755552279317905, 5.262588738972559, 5.469235184382912, 5.338495578750862, 5.616855479527626, 5.660940808911822, 5.451910618097713, 5.529334675563348, 5.484132083300918, 5.579662934061291, 5.55966027023868, 5.6412056335344065, 5.52264561587802, 5.458418599451251, 5.44123904329423, 5.540449752382277, 5.332631651660957, 5.307441558792812, 5.526393813080316, 5.700245716102593, 5.369018102400483, 5.467614839905657, 5.363993192720452, 5.658284781833599, 5.623842861721611, 5.489605463852154, 5.607803787847439, 5.669184915016674, 5.475543400978411, 5.3837046069142565, 5.671296928481338, 5.382295282340122, 5.712959130983835, 5.132336359624382, 5.511945385210296, 5.5235632853917975, 5.535054648598685, 5.467925092843407, 5.279219840250044, 5.589260947752282, 5.598357002871678, 5.589527895118288, 5.417621145115414, 5.429261175292113, 5.541044653538048], "episode_lengths": [57, 117, 92, 113, 78, 65, 26, 74, 50, 69, 63, 52, 56, 101, 62, 141, 90, 64, 73, 58, 48, 82, 46, 62, 51, 45, 52, 77, 43, 82, 90, 63, 62, 48, 65, 110, 47, 93, 88, 60, 51, 57, 69, 47, 71, 54, 58, 43, 67, 63, 98, 76, 71, 125, 49, 57, 82, 54, 69, 44, 57, 80, 80, 116, 63, 48, 43, 55, 48, 70, 53, 65, 85, 56, 43, 64, 98, 60, 41, 47, 124, 78, 47, 50, 100, 69, 70, 44, 62, 39, 132, 50, 55, 61, 75, 53, 53, 91, 57, 51, 117, 64, 47, 86, 52, 62, 147, 56, 90, 74, 50, 63, 49, 54, 113, 113, 91]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2917297016817006, "mean_inference_ms": 1.6025078227644278, "mean_action_processing_ms": 0.15077942778105843, "mean_env_wait_ms": 2.9601521158266926, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1310688, "agent_timesteps_total": 1310688, "timers": {"sample_time_ms": 7672.3, "sample_throughput": 1041.669, "load_time_ms": 3.304, "load_throughput": 2418551.185, "learn_time_ms": 6484.062, "learn_throughput": 1232.561, "update_time_ms": 3.053}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04847750440239906, "policy_loss": -0.016873156651854515, "vf_loss": 0.06217392161488533, "vf_explained_var": 0.8126184344291687, "kl": 0.015883658081293106, "entropy": 0.058875974267721176, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1310688, "num_agent_steps_sampled": 1310688, "num_steps_trained": 1310688, "num_agent_steps_trained": 1310688}, "done": false, "episodes_total": 15053, "training_iteration": 164, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-12-40", "timestamp": 1716405160, "time_this_iter_s": 14.33538007736206, "time_total_s": 2201.9009759426117, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2201.9009759426117, "timesteps_since_restore": 0, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 34.53000000000001, "ram_util_percent": 34.10000000000001}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.7110264254303456, "episode_reward_min": 5.127188216442833, "episode_reward_mean": 5.477133928114872, "episode_len_mean": 71.6036036036036, "episode_media": {}, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2987375317184762, "reward_component_totals/rejoin_dist_change_reward_min": 0.956438003640429, "reward_component_totals/rejoin_dist_change_reward_max": 1.519026425430346, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9283963963963962, "reward_component_totals/success_reward_min": 1.8679999999999999, "reward_component_totals/success_reward_max": 1.962}, "hist_stats": {"episode_reward": [5.173393999899484, 5.568811454102914, 5.612082560681436, 5.511207643842415, 5.643612275727925, 5.62203697095879, 5.422071444259874, 5.3532479530388715, 5.641262432638223, 5.5498331222429265, 5.232258365878012, 5.7110264254303456, 5.385998902339312, 5.575202491356789, 5.5599875413090665, 5.681066996574467, 5.539490458011706, 5.2543978837781875, 5.530152788025707, 5.607457144174191, 5.530902978153847, 5.285332933216836, 5.18250571189208, 5.621088813104563, 5.281072976567554, 5.513463551727181, 5.512101727342926, 5.509665283956707, 5.375670532381252, 5.485803661441848, 5.284898203931919, 5.643678194287133, 5.507700039488268, 5.138438003640429, 5.281920890502219, 5.262739143026661, 5.163131459340163, 5.507698544914932, 5.514050326056317, 5.286583400785817, 5.374400892920273, 5.498359303639722, 5.5871321808980134, 5.401523439605892, 5.525512216473346, 5.377429687847121, 5.616460171338829, 5.567091231099439, 5.60867765612506, 5.589064722299735, 5.563481571549563, 5.662843514079456, 5.127188216442833, 5.477326468525995, 5.671859362287937, 5.285475769598738, 5.563018379991311, 5.25074023513357, 5.519586142965812, 5.154559732541503, 5.521459115464832, 5.328350675233004, 5.615838620320995, 5.524891780834995, 5.576935687574013, 5.536983422774153, 5.671210626848675, 5.557738914392985, 5.615872118267635, 5.688210565097914, 5.614385322583806, 5.5311314483464695, 5.57356896230867, 5.535639289233109, 5.341349414550557, 5.451425166510271, 5.544210086716555, 5.409514749358527, 5.632071483458054, 5.5987004011299435, 5.290361672373041, 5.567914789794456, 5.493276556774785, 5.618634930521967, 5.182232159613423, 5.608468404792939, 5.235766819320627, 5.34689816571621, 5.60056975507147, 5.30193123244998, 5.599131583661477, 5.583730215346409, 5.597494241089976, 5.414540902417041, 5.668169151144918, 5.209234860624167, 5.329571704604872, 5.419494478862035, 5.488030890351865, 5.341196339382536, 5.625606318689211, 5.310508986420917, 5.702199092303687, 5.578581303153912, 5.239165483167211, 5.594574932286394, 5.581244741156987, 5.63216141852185, 5.295518285901552, 5.6503400603413905, 5.501052568494923], "episode_lengths": [63, 106, 85, 119, 51, 63, 94, 74, 60, 74, 57, 58, 74, 65, 132, 57, 71, 79, 116, 87, 56, 38, 45, 58, 88, 55, 93, 62, 55, 68, 52, 99, 51, 68, 67, 97, 65, 108, 81, 110, 88, 47, 53, 62, 44, 53, 50, 92, 92, 81, 62, 88, 100, 52, 55, 44, 72, 72, 77, 75, 117, 122, 56, 67, 65, 99, 65, 74, 72, 58, 97, 51, 49, 66, 55, 84, 54, 70, 80, 51, 55, 130, 97, 54, 64, 92, 84, 90, 70, 44, 120, 67, 51, 73, 54, 49, 49, 72, 88, 59, 55, 44, 50, 57, 60, 102, 56, 66, 60, 60, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29168222278321715, "mean_inference_ms": 1.6025299095833987, "mean_action_processing_ms": 0.15098954272709292, "mean_env_wait_ms": 2.9614099807085816, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1318680, "agent_timesteps_total": 1318680, "timers": {"sample_time_ms": 7714.013, "sample_throughput": 1036.037, "load_time_ms": 3.351, "load_throughput": 2385250.371, "learn_time_ms": 6501.615, "learn_throughput": 1229.233, "update_time_ms": 3.02}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.025669706985354424, "policy_loss": -0.016837438568472862, "vf_loss": 0.03929710388183594, "vf_explained_var": 0.8441839814186096, "kl": 0.016050217673182487, "entropy": 0.08494361490011215, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1318680, "num_agent_steps_sampled": 1318680, "num_steps_trained": 1318680, "num_agent_steps_trained": 1318680}, "done": false, "episodes_total": 15164, "training_iteration": 165, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-12-54", "timestamp": 1716405174, "time_this_iter_s": 14.252198934555054, "time_total_s": 2216.1531748771667, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2216.1531748771667, "timesteps_since_restore": 0, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 35.09, "ram_util_percent": 34.239999999999995}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.701152679026167, "episode_reward_min": 0.3293987630294004, "episode_reward_mean": 5.440841925127975, "episode_len_mean": 71.42342342342343, "episode_media": {}, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.990990990990991, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.009009009009009009, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9819819819819822, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24774774774774774, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.3092923755784263, "reward_component_totals/rejoin_dist_change_reward_min": 0.9340266630790159, "reward_component_totals/rejoin_dist_change_reward_max": 1.5001089429297658, "reward_component_totals/failure_reward_mean": -0.009009009009009009, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9108288288288289, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.9609999999999999, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.542712935717361, 5.343475781661482, 5.443774537069293, 5.587250218447563, 5.626242233902439, 5.24648435227492, 5.6838205652313585, 5.677355627106563, 5.591522711108807, 5.558764910341536, 5.56057684632399, 5.5696994210216175, 5.232120795014593, 5.497457440195291, 5.29105875694219, 5.446007793287125, 5.644676041589933, 5.521315718784872, 5.248927467342016, 5.638417843470068, 5.590732994708809, 5.629238153740509, 5.471119948539531, 5.628832716187132, 5.312208746241464, 5.626985312984742, 5.566908998075377, 5.422330466654296, 5.5341806555975745, 5.520145691002606, 5.401419173947265, 5.623038449783701, 5.541110120229169, 5.362245500952128, 5.486919459367438, 5.419925481634529, 5.539050435397103, 5.680689800684904, 5.564222870896343, 5.566685220689003, 5.430482210390023, 5.552748322016679, 5.39090557499613, 5.5331465955886525, 5.5633808939542515, 5.105895142360576, 5.462949483858079, 5.551494891401618, 5.631635239160586, 5.29982116466711, 5.477730816343168, 5.462597495649192, 5.264073176045516, 5.561226537889749, 5.441105975042003, 5.548596612785916, 5.547972912518812, 5.6096967491574, 5.319510751196771, 5.477531823463739, 5.407065765252939, 5.55142218723822, 5.608867809396186, 5.183493959009697, 5.421995891761881, 5.33021625648278, 5.607206072290296, 5.4534592018671, 5.644871693347543, 5.405711517995931, 5.144026663079016, 5.362429754815679, 5.634537273983316, 5.2516865114194395, 5.581125624289335, 5.504689202070372, 5.520506104533162, 5.532330095764414, 5.329307918068776, 5.688108942929765, 5.438658198478739, 5.582384068205675, 5.539076444496, 5.640599957192956, 5.5002627769768235, 5.39131993761448, 5.305659756525802, 5.238850297286283, 0.3293987630294004, 5.547815090586587, 5.213478217173899, 5.595281907865369, 5.5151001740270065, 5.4373065572745976, 5.534705471912223, 5.4115950548212925, 5.552567797263579, 5.550281499332242, 5.674201078561648, 5.575272862233798, 5.567410507851175, 5.557906219088039, 5.239379737890303, 5.473101382952895, 5.462397598717628, 5.623467302083017, 5.576781463306701, 5.701152679026167, 5.437637209476568, 5.295021060281908, 5.590169609444092], "episode_lengths": [91, 107, 54, 102, 52, 78, 55, 62, 89, 78, 64, 58, 79, 45, 93, 61, 53, 123, 64, 61, 78, 55, 60, 53, 67, 53, 91, 84, 106, 127, 51, 77, 76, 63, 63, 53, 52, 57, 102, 69, 62, 65, 58, 55, 81, 85, 43, 84, 86, 86, 90, 51, 83, 101, 45, 70, 102, 107, 58, 61, 62, 87, 65, 57, 75, 73, 70, 49, 74, 119, 40, 39, 105, 93, 72, 69, 57, 49, 68, 62, 87, 59, 62, 62, 78, 109, 48, 56, 30, 54, 68, 48, 85, 87, 65, 96, 75, 112, 63, 71, 49, 78, 92, 94, 62, 88, 61, 47, 79, 40, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2927812676428427, "mean_inference_ms": 1.6037617571215717, "mean_action_processing_ms": 0.15098480364652908, "mean_env_wait_ms": 2.963350118133311, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1326672, "agent_timesteps_total": 1326672, "timers": {"sample_time_ms": 7722.725, "sample_throughput": 1034.868, "load_time_ms": 3.331, "load_throughput": 2399369.936, "learn_time_ms": 6491.4, "learn_throughput": 1231.167, "update_time_ms": 3.037}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03212830424308777, "policy_loss": -0.017554128542542458, "vf_loss": 0.04697504639625549, "vf_explained_var": 0.8376232385635376, "kl": 0.013536921702325344, "entropy": 0.019486162811517715, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1326672, "num_agent_steps_sampled": 1326672, "num_steps_trained": 1326672, "num_agent_steps_trained": 1326672}, "done": false, "episodes_total": 15275, "training_iteration": 166, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-13-08", "timestamp": 1716405188, "time_this_iter_s": 13.714945316314697, "time_total_s": 2229.8681201934814, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2229.8681201934814, "timesteps_since_restore": 0, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 34.004999999999995, "ram_util_percent": 34.29499999999999}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.6840163128688985, "episode_reward_min": 5.1280588232494, "episode_reward_mean": 5.449018892237681, "episode_len_mean": 70.51304347826087, "episode_media": {}, "episodes_this_iter": 115, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2695319357159411, "reward_component_totals/rejoin_dist_change_reward_min": 0.9387720834711375, "reward_component_totals/rejoin_dist_change_reward_max": 1.5100163128688993, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9294869565217394, "reward_component_totals/success_reward_min": 1.869, "reward_component_totals/success_reward_max": 1.964}, "hist_stats": {"episode_reward": [5.620508390756178, 5.6709374887075175, 5.407767129912813, 5.590554824038547, 5.321894365811412, 5.591511878040468, 5.157740691818166, 5.537602895860946, 5.239972413787602, 5.671700641019159, 5.663579837413163, 5.363096890586672, 5.60398643338306, 5.677585364208743, 5.6218063411300765, 5.226711523912947, 5.207767270816637, 5.28333482017975, 5.47940057603682, 5.33892228372093, 5.228788414855348, 5.220056059715988, 5.550406226265626, 5.357291834618291, 5.281428285547602, 5.4063888481270315, 5.35780870684824, 5.221124782728071, 5.395194991550482, 5.426470811883425, 5.683580196717262, 5.2476169083207775, 5.5843971756411594, 5.325829632710088, 5.4567623083659, 5.43708602519345, 5.264660434290224, 5.67326305448333, 5.612083504761323, 5.608965520422239, 5.583479288605901, 5.1280588232494, 5.534335214796833, 5.5454600627487824, 5.594675564466529, 5.4982104210877525, 5.216679506809935, 5.6840163128688985, 5.597719173683412, 5.3021862486489075, 5.136772083471138, 5.5695347357377125, 5.47954740621936, 5.37074921057525, 5.262328929058535, 5.3379961503377125, 5.611938446978758, 5.545123206145821, 5.605482177794638, 5.3170729100013645, 5.647763677280867, 5.251788129361463, 5.483741645251731, 5.390324080864457, 5.640895706850117, 5.621328849327533, 5.598493564930353, 5.338857290390056, 5.254947503236782, 5.374455080346353, 5.416970404844449, 5.546282949918095, 5.406680542233358, 5.6097742169277165, 5.413694505278977, 5.40842810423314, 5.459003049558072, 5.398291178814634, 5.335592736107406, 5.506647169983623, 5.539146999189342, 5.289016347966271, 5.564378768709741, 5.450181951094475, 5.411588761885849, 5.640708724481449, 5.412987865936422, 5.540697592816123, 5.420818695964646, 5.6125421439147924, 5.18064282461482, 5.337482436001505, 5.596202762527119, 5.436306768101183, 5.613003515180109, 5.419170528285953, 5.321261296569727, 5.310768084320284, 5.455187746791585, 5.61199807768574, 5.253510955350323, 5.248892625488887, 5.407516218056914, 5.422103200235465, 5.602294355691225, 5.5406369212377875, 5.253895928427488, 5.4363175727240485, 5.679168868555125, 5.4682287713053555, 5.471383430503091, 5.626401317748833, 5.628859876531585, 5.398677508825992, 5.394281121400679], "episode_lengths": [52, 58, 81, 99, 78, 51, 101, 53, 48, 75, 49, 73, 75, 59, 121, 74, 36, 75, 81, 59, 73, 50, 103, 60, 62, 80, 61, 97, 129, 58, 68, 63, 48, 49, 52, 63, 64, 78, 76, 59, 63, 92, 86, 49, 80, 83, 51, 76, 131, 61, 52, 129, 46, 68, 58, 68, 56, 96, 84, 102, 52, 49, 52, 83, 60, 51, 50, 80, 52, 100, 126, 91, 116, 76, 50, 76, 67, 74, 80, 46, 104, 58, 84, 45, 74, 81, 95, 78, 56, 83, 73, 60, 59, 65, 55, 46, 53, 53, 58, 61, 43, 70, 89, 67, 122, 63, 59, 83, 70, 53, 50, 68, 48, 55, 75]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29304336843737977, "mean_inference_ms": 1.6031934123878344, "mean_action_processing_ms": 0.15101179835633133, "mean_env_wait_ms": 2.962622425438463, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1334664, "agent_timesteps_total": 1334664, "timers": {"sample_time_ms": 7657.294, "sample_throughput": 1043.711, "load_time_ms": 3.35, "load_throughput": 2385895.511, "learn_time_ms": 6479.159, "learn_throughput": 1233.493, "update_time_ms": 3.091}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0286637544631958, "policy_loss": -0.013370470143854618, "vf_loss": 0.03844091296195984, "vf_explained_var": 0.8493785858154297, "kl": 0.01796654239296913, "entropy": -0.0002078038960462436, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1334664, "num_agent_steps_sampled": 1334664, "num_steps_trained": 1334664, "num_agent_steps_trained": 1334664}, "done": false, "episodes_total": 15390, "training_iteration": 167, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-13-21", "timestamp": 1716405201, "time_this_iter_s": 13.173330545425415, "time_total_s": 2243.041450738907, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2243.041450738907, "timesteps_since_restore": 0, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 33.568421052631585, "ram_util_percent": 34.4}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.696119819773683, "episode_reward_min": 5.120304326885432, "episode_reward_mean": 5.446744007442682, "episode_len_mean": 70.53508771929825, "episode_media": {}, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2672790951619797, "reward_component_totals/rejoin_dist_change_reward_min": 0.9473043268854313, "reward_component_totals/rejoin_dist_change_reward_max": 1.4971198197736824, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9294649122807017, "reward_component_totals/success_reward_min": 1.8559999999999999, "reward_component_totals/success_reward_max": 1.96}, "hist_stats": {"episode_reward": [5.527708816160039, 5.406523099292009, 5.655558257719202, 5.252483450011594, 5.300020072306436, 5.631221584566534, 5.528678034243288, 5.5369958086515, 5.398164713622489, 5.494118966167116, 5.450461114128258, 5.448628759241105, 5.511878653107655, 5.62727239987861, 5.3934240291196796, 5.140755876246091, 5.367402048651881, 5.311637998464418, 5.6455994580113895, 5.246126818483998, 5.428433792299661, 5.5305387476231544, 5.5481612565868135, 5.621093035515572, 5.696119819773683, 5.37894574553168, 5.219402717295975, 5.458501805562681, 5.507190476603256, 5.440400158782239, 5.589586438451089, 5.66561202365345, 5.299454549319839, 5.528065073168335, 5.451680544439769, 5.4667908720156575, 5.264823368590144, 5.231108567104582, 5.600599710709021, 5.53613251421329, 5.55570998087106, 5.229165449708754, 5.549805587624849, 5.153090652465207, 5.5533325936432005, 5.176788750915775, 5.342199855186265, 5.341551597456912, 5.581452969301404, 5.585456182135909, 5.511441974538044, 5.537437348759859, 5.346991186063921, 5.321635569401552, 5.2089099696543535, 5.62930997979573, 5.564553123979057, 5.161052749485169, 5.246858675288828, 5.255210583860268, 5.120304326885432, 5.294974996364928, 5.322438956961369, 5.537746483166998, 5.488858633414506, 5.58633324301821, 5.4796996460030645, 5.638873640982093, 5.627141299108734, 5.602702710630061, 5.375894889566409, 5.310713104727357, 5.202132600395773, 5.524288850184648, 5.291860316652819, 5.364505836280035, 5.618274980155376, 5.370361550832843, 5.546599893190201, 5.568533536323414, 5.520416231313444, 5.261654085994069, 5.452015137825619, 5.5712836286736405, 5.418180792820312, 5.61510133919789, 5.210092871596136, 5.610937550644217, 5.30325834578403, 5.1992527858855535, 5.318441877928237, 5.412640636050735, 5.197608451587708, 5.6723022662072236, 5.492360114494164, 5.6561432231026885, 5.636231040618721, 5.293999342263367, 5.162399840363372, 5.477412032750244, 5.433620793570511, 5.6936471942290865, 5.414292767959028, 5.639197867633711, 5.507891216372414, 5.457855595801673, 5.521679797711531, 5.562029023410668, 5.612093997123424, 5.421214020230563, 5.563361828070206, 5.5888829225920205, 5.515347093896368, 5.454475684469553], "episode_lengths": [103, 81, 54, 45, 59, 59, 62, 132, 65, 58, 85, 48, 78, 80, 86, 86, 144, 87, 67, 57, 60, 69, 51, 58, 51, 51, 75, 60, 88, 76, 52, 59, 49, 82, 81, 78, 49, 45, 55, 108, 57, 44, 75, 124, 50, 41, 52, 95, 102, 57, 70, 105, 42, 60, 132, 64, 110, 52, 46, 61, 77, 44, 93, 65, 91, 73, 113, 48, 54, 77, 103, 48, 80, 50, 40, 80, 45, 82, 83, 109, 61, 53, 45, 59, 67, 50, 62, 75, 56, 43, 70, 93, 97, 58, 74, 56, 63, 100, 65, 81, 51, 49, 90, 66, 66, 53, 76, 108, 63, 54, 45, 128, 48, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2919896571715855, "mean_inference_ms": 1.6052898879646051, "mean_action_processing_ms": 0.15120495899993552, "mean_env_wait_ms": 2.96713724550658, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1342656, "agent_timesteps_total": 1342656, "timers": {"sample_time_ms": 7741.34, "sample_throughput": 1032.379, "load_time_ms": 3.312, "load_throughput": 2413362.245, "learn_time_ms": 6455.451, "learn_throughput": 1238.023, "update_time_ms": 3.068}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.027992982417345047, "policy_loss": -0.011153328232467175, "vf_loss": 0.03570534661412239, "vf_explained_var": 0.8644681572914124, "kl": 0.017204809933900833, "entropy": 0.038460154086351395, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1342656, "num_agent_steps_sampled": 1342656, "num_steps_trained": 1342656, "num_agent_steps_trained": 1342656}, "done": false, "episodes_total": 15504, "training_iteration": 168, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-13-36", "timestamp": 1716405216, "time_this_iter_s": 14.798701047897339, "time_total_s": 2257.840151786804, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2257.840151786804, "timesteps_since_restore": 0, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 37.966666666666676, "ram_util_percent": 34.25714285714286}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.653624725635915, "episode_reward_min": 5.133715309275154, "episode_reward_mean": 5.444964300969457, "episode_len_mean": 71.16216216216216, "episode_media": {}, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2661264631316178, "reward_component_totals/rejoin_dist_change_reward_min": 0.9237153092751544, "reward_component_totals/rejoin_dist_change_reward_max": 1.456642072502812, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9288378378378372, "reward_component_totals/success_reward_min": 1.876, "reward_component_totals/success_reward_max": 1.964}, "hist_stats": {"episode_reward": [5.199809446208608, 5.494028004535382, 5.368912091913806, 5.530212435404021, 5.564558929917043, 5.322440796914555, 5.438891941780893, 5.48808090112344, 5.212625369841968, 5.57351718343493, 5.38062901096999, 5.556992031115984, 5.356370672082951, 5.444583756307237, 5.530014036619203, 5.622248151630814, 5.429549455867998, 5.3806583556053775, 5.556215813676376, 5.644043178084639, 5.64158945163964, 5.382832266137095, 5.419716606808926, 5.396722753777672, 5.582099765211673, 5.376877544145382, 5.543988929438145, 5.340528073041862, 5.485403061179417, 5.611669760539766, 5.539910266907855, 5.133715309275154, 5.468582426000621, 5.490931327260946, 5.590347551576628, 5.250378546081483, 5.386240467609701, 5.480513190198993, 5.290297010602103, 5.561071514025877, 5.216300690652295, 5.286622133390717, 5.2094687271933875, 5.190770846570067, 5.587961082528036, 5.461828410889567, 5.532166370364089, 5.531895233381993, 5.367859825677783, 5.419502561838266, 5.345637682235846, 5.423456862159615, 5.611811045314964, 5.5364904871272085, 5.495598376864905, 5.3521125404099745, 5.388771671925441, 5.41829386083384, 5.147936631246279, 5.5913771698340025, 5.337852513958722, 5.376055901996896, 5.558755083433258, 5.546164319620182, 5.265902366514525, 5.469815413157657, 5.357485452659764, 5.23320876201233, 5.161273448950087, 5.51250593832366, 5.499210348694397, 5.5761125099702475, 5.251713479810439, 5.205411542214426, 5.529695657371715, 5.330950204525944, 5.3846066260928325, 5.311082600884651, 5.256076332002044, 5.564949552491967, 5.5461557438425135, 5.4523632145725465, 5.611346749092721, 5.570152433299425, 5.601090855714594, 5.5504169874353115, 5.392694978638634, 5.496223613864748, 5.280627751951375, 5.445433313635055, 5.653624725635915, 5.627642072502811, 5.591544999317263, 5.600021680043111, 5.429925174769892, 5.38347372073397, 5.587715000235435, 5.2112825842573, 5.576645118538828, 5.221532232949636, 5.633555562702094, 5.56350677632634, 5.635356818184375, 5.429554164889851, 5.533831510097774, 5.610729922236489, 5.406789063768244, 5.366570659953095, 5.555011717416905, 5.415700812441868, 5.49802979894331], "episode_lengths": [84, 50, 49, 73, 118, 64, 63, 69, 62, 92, 69, 69, 80, 74, 50, 56, 92, 59, 49, 49, 56, 55, 87, 43, 115, 73, 111, 110, 53, 60, 70, 40, 73, 84, 51, 49, 44, 71, 41, 56, 77, 48, 88, 58, 98, 70, 60, 114, 61, 76, 63, 67, 81, 48, 124, 44, 98, 49, 82, 95, 82, 56, 62, 51, 51, 57, 111, 52, 82, 76, 63, 53, 66, 61, 113, 93, 68, 86, 68, 54, 88, 62, 52, 50, 76, 115, 96, 98, 102, 65, 52, 79, 100, 54, 49, 90, 51, 36, 55, 70, 65, 54, 68, 54, 122, 83, 72, 77, 98, 68, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29425283785546436, "mean_inference_ms": 1.6059854878375845, "mean_action_processing_ms": 0.15121294560184928, "mean_env_wait_ms": 2.967745179808616, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1350648, "agent_timesteps_total": 1350648, "timers": {"sample_time_ms": 7668.631, "sample_throughput": 1042.168, "load_time_ms": 3.312, "load_throughput": 2413136.388, "learn_time_ms": 6427.715, "learn_throughput": 1243.366, "update_time_ms": 3.048}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.030345967039465904, "policy_loss": -0.010668428614735603, "vf_loss": 0.03733788803219795, "vf_explained_var": 0.8522335290908813, "kl": 0.018382549285888672, "entropy": 0.037336546927690506, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1350648, "num_agent_steps_sampled": 1350648, "num_steps_trained": 1350648, "num_agent_steps_trained": 1350648}, "done": false, "episodes_total": 15615, "training_iteration": 169, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-13-49", "timestamp": 1716405229, "time_this_iter_s": 13.070516347885132, "time_total_s": 2270.9106681346893, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2270.9106681346893, "timesteps_since_restore": 0, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 34.273684210526326, "ram_util_percent": 34.1421052631579}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.725382302252156, "episode_reward_min": 0.2590727180400729, "episode_reward_mean": 5.389489425339371, "episode_len_mean": 70.6140350877193, "episode_media": {}, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9912280701754386, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.008771929824561403, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9824561403508774, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24780701754385964, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2560069691990212, "reward_component_totals/rejoin_dist_change_reward_min": 0.9709649850483677, "reward_component_totals/rejoin_dist_change_reward_max": 1.5273823022521562, "reward_component_totals/failure_reward_mean": -0.008771929824561403, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9119912280701756, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.9609999999999999, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.657844734667007, 5.2693888150079005, 5.429351582690849, 5.427934448282162, 5.361617457582089, 5.385035938863683, 5.526016521193668, 5.176883284568952, 5.317341414459664, 5.591296148421762, 5.552212450430581, 5.247498162605986, 5.22284895024633, 5.581621014950597, 5.6167591822877885, 5.376170335720099, 5.279992966506741, 5.637591454135989, 5.279387278092216, 5.6165291169151565, 5.18098817309236, 5.690031475445515, 5.656341905532075, 5.434329162509512, 5.693889430113368, 5.589547927199739, 5.386606094666197, 5.725382302252156, 5.451599590372695, 5.4506372411609165, 5.455635138667745, 5.391993406571947, 5.543443220386143, 5.627045319359763, 5.21370809445254, 5.554429909547331, 5.394267955574643, 5.415513667365937, 5.225192382015931, 5.590035718649008, 5.226808616406716, 5.430654940959999, 5.560019015542811, 5.586971444181744, 5.484050174004372, 5.4779455079013175, 5.462366359411952, 5.328074601932495, 5.517867706219317, 5.561532438932115, 0.2590727180400729, 5.381551666286445, 5.219427182250898, 5.308755929808598, 5.414066490996996, 5.518335011799204, 5.376050434505888, 5.311880836473158, 5.582490904273307, 5.274418323400897, 5.433280631430172, 5.417952943954227, 5.497928038448018, 5.358030244821629, 5.550841388722416, 5.5194387918533945, 5.430648051917622, 5.602095863924124, 5.273402588903425, 5.567180156672979, 5.534895321308005, 5.377561294331697, 5.604630448794449, 5.500696671631928, 5.539830319067999, 5.234158017303757, 5.39868087807309, 5.597236878371694, 5.659944371071639, 5.651571231108193, 5.473926113583189, 5.370985850246887, 5.317157988056348, 5.281202199837265, 5.637464088175383, 5.402250956494275, 5.311011732462864, 5.290460868276397, 5.414190754670122, 5.260648617446921, 5.2925149515232315, 5.261595877492439, 5.523349399329219, 5.192862782430563, 5.541060053634956, 5.6277416291502815, 5.535445412482973, 5.428840080638514, 5.509773076739964, 5.547324050098858, 5.664035644682787, 5.4818611579736345, 5.343790783413569, 5.2819039549541635, 5.189832690885739, 5.170964985048368, 5.482814691153951, 5.20638000951055, 5.3716940722282, 5.185202108562821, 5.407401695863301, 5.2315815829003816, 5.409889142502754, 5.4983516786340605], "episode_lengths": [52, 68, 48, 120, 75, 39, 100, 94, 58, 52, 65, 57, 64, 85, 53, 73, 44, 64, 51, 56, 53, 60, 60, 56, 52, 67, 53, 52, 95, 114, 56, 58, 71, 126, 48, 72, 60, 69, 83, 67, 81, 59, 98, 60, 106, 58, 104, 66, 64, 82, 17, 80, 83, 70, 47, 98, 91, 65, 59, 41, 51, 81, 64, 58, 74, 83, 48, 67, 78, 116, 53, 99, 61, 50, 58, 62, 55, 79, 60, 83, 66, 65, 68, 72, 52, 94, 57, 55, 93, 84, 65, 59, 65, 63, 115, 78, 119, 84, 160, 85, 51, 94, 46, 76, 60, 50, 87, 66, 76, 40, 120, 74, 41, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2955261560852989, "mean_inference_ms": 1.6065671821125516, "mean_action_processing_ms": 0.15120647240804558, "mean_env_wait_ms": 2.967567216679851, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1358640, "agent_timesteps_total": 1358640, "timers": {"sample_time_ms": 7546.322, "sample_throughput": 1059.059, "load_time_ms": 3.313, "load_throughput": 2412597.978, "learn_time_ms": 6387.492, "learn_throughput": 1251.195, "update_time_ms": 3.047}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.033346932381391525, "policy_loss": -0.015783831477165222, "vf_loss": 0.04640025272965431, "vf_explained_var": 0.8407000303268433, "kl": 0.01365258265286684, "entropy": 0.08176017552614212, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1358640, "num_agent_steps_sampled": 1358640, "num_steps_trained": 1358640, "num_agent_steps_trained": 1358640}, "done": false, "episodes_total": 15729, "training_iteration": 170, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-14-02", "timestamp": 1716405242, "time_this_iter_s": 13.05866813659668, "time_total_s": 2283.969336271286, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2283.969336271286, "timesteps_since_restore": 0, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 33.99999999999999, "ram_util_percent": 34.1}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.702154685757669, "episode_reward_min": 5.134171870040281, "episode_reward_mean": 5.461168946008438, "episode_len_mean": 72.22935779816514, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.283398303806602, "reward_component_totals/rejoin_dist_change_reward_min": 0.9271718700402807, "reward_component_totals/rejoin_dist_change_reward_max": 1.5071546857576688, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.927770642201835, "reward_component_totals/success_reward_min": 1.867, "reward_component_totals/success_reward_max": 1.964}, "hist_stats": {"episode_reward": [5.530434107493516, 5.342684905288808, 5.561942321227544, 5.228240741951911, 5.331175563487227, 5.478991657748616, 5.23590539932428, 5.357633736096348, 5.562064463258586, 5.56087326744194, 5.43502376314342, 5.548133768243664, 5.409884758434918, 5.675917052020505, 5.408543678649786, 5.665808380095924, 5.543657858044872, 5.581847856122475, 5.195033152822107, 5.134171870040281, 5.622648852821294, 5.607210148114228, 5.501634924414725, 5.489995033917959, 5.644359697902756, 5.5872681223745335, 5.212175691919615, 5.675621266873011, 5.44071049118493, 5.560282964058775, 5.585628393924586, 5.291227355729147, 5.552083000929713, 5.506613500010032, 5.4201091983585155, 5.403854767677283, 5.666355770029497, 5.179772648830422, 5.517286857662173, 5.598888397109155, 5.59305139687103, 5.5857340310124854, 5.605721804670132, 5.593413177976299, 5.570768118814452, 5.664194670518158, 5.507623038783142, 5.299531623072182, 5.596654704688284, 5.43832954415178, 5.702154685757669, 5.295990572438328, 5.389934950975475, 5.595181911923631, 5.5170271432247615, 5.353121381942387, 5.443871949212209, 5.367384388702797, 5.628291265933859, 5.568144387619932, 5.545887456561939, 5.292295586733783, 5.2749760843471245, 5.5529715667056685, 5.337058478940593, 5.2451716117189005, 5.43722539023412, 5.1778650693906165, 5.6355474934324645, 5.58673479381676, 5.389614041612081, 5.527691656977787, 5.688757484699455, 5.187593512227697, 5.341557574637749, 5.195376723095001, 5.285243288363838, 5.321257995111332, 5.321941551920617, 5.444698218644891, 5.317309315519798, 5.638221749297543, 5.469155935523641, 5.312090201847806, 5.229182131245169, 5.541385372619645, 5.2219161311509295, 5.523294022049429, 5.276842260254, 5.529910216318839, 5.324720208061509, 5.622953033815045, 5.523047381942536, 5.476787720696245, 5.600563763936864, 5.493380673999169, 5.635569779320463, 5.621005768114598, 5.152342638739029, 5.384790178134494, 5.618966096824508, 5.259856043002644, 5.592599824230821, 5.31709358847726, 5.317624278535238, 5.695314360044888, 5.625980865129014, 5.5076861633542835, 5.480539700493704], "episode_lengths": [81, 86, 44, 106, 119, 55, 91, 81, 92, 54, 96, 108, 96, 51, 80, 49, 108, 82, 67, 43, 84, 79, 69, 81, 69, 114, 80, 48, 51, 113, 95, 76, 90, 63, 89, 52, 57, 47, 73, 60, 53, 95, 53, 50, 68, 65, 119, 43, 116, 72, 55, 79, 65, 60, 41, 70, 82, 79, 96, 79, 50, 83, 77, 64, 93, 124, 86, 37, 66, 75, 87, 91, 64, 69, 55, 107, 55, 48, 36, 51, 84, 47, 61, 83, 63, 58, 67, 58, 38, 49, 85, 133, 64, 62, 50, 67, 69, 78, 37, 92, 55, 39, 101, 47, 46, 57, 72, 104, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2916329813388945, "mean_inference_ms": 1.6047807795181246, "mean_action_processing_ms": 0.1511317097816603, "mean_env_wait_ms": 2.9664668715944287, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1366632, "agent_timesteps_total": 1366632, "timers": {"sample_time_ms": 7467.581, "sample_throughput": 1070.226, "load_time_ms": 3.334, "load_throughput": 2397362.225, "learn_time_ms": 6362.369, "learn_throughput": 1256.136, "update_time_ms": 3.073}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.024601805955171585, "policy_loss": -0.012399774976074696, "vf_loss": 0.03425157070159912, "vf_explained_var": 0.8723118305206299, "kl": 0.013750032521784306, "entropy": 0.14133980870246887, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1366632, "num_agent_steps_sampled": 1366632, "num_steps_trained": 1366632, "num_agent_steps_trained": 1366632}, "done": false, "episodes_total": 15838, "training_iteration": 171, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-14-15", "timestamp": 1716405255, "time_this_iter_s": 13.103946208953857, "time_total_s": 2297.07328248024, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2297.07328248024, "timesteps_since_restore": 0, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 34.11578947368421, "ram_util_percent": 34.121052631578955}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.691670180371916, "episode_reward_min": -0.04463496008634649, "episode_reward_mean": 5.2890376126967995, "episode_len_mean": 71.47747747747748, "episode_media": {}, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.972972972972973, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.02702702702702703, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9459459459459463, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24324324324324326, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2519745496337364, "reward_component_totals/rejoin_dist_change_reward_min": 0.9528068906638341, "reward_component_totals/rejoin_dist_change_reward_max": 1.5066701803719162, "reward_component_totals/failure_reward_mean": -0.02702702702702703, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.8749009009009008, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.964, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.512554887669315, 5.477597033534206, 5.309201047920753, 5.414552616315611, 5.6630211534571, 5.198413744383631, 5.591453624665622, 5.510703907474712, 5.40596222009585, 5.369680630697179, 5.4480064443472, 5.412024771667387, 5.646166992410548, 5.2856953576114964, 5.398090263891852, 5.562592616937799, 5.192912739451769, 5.462094448898265, -0.04463496008634649, 5.480018507151133, 5.329794017272945, 5.56053109509032, 5.4568936662980505, 5.3686535185893485, 5.219618021325049, 5.125806890663835, 5.3346806083794025, 5.307675882337268, 5.669127888214315, 5.416027796792742, 5.33316497543545, 5.307972866358606, 5.417471541941424, 5.461956240925915, 5.362534291607033, 5.354863391440526, 0.31168127613164853, 5.194857449771604, 5.389777724672928, 5.4257540133855695, 5.591833250666449, 5.312399244609402, 5.638237953753503, 5.534370632267359, 5.51100702681056, 5.596065665427458, 5.564955031005995, 5.493098322403839, 5.574660415817483, 5.556212953136473, 5.232215154972877, 5.189845751673729, 5.402687840427372, 5.159730234355232, 5.512463330465291, 5.2736887364771965, 5.691670180371916, 5.37956720236963, 5.150472871751688, 5.653136353240487, 5.394925799000928, 5.403851428832777, 5.583698863445475, 5.263893224718553, 5.459095603109985, 0.19623882993963804, 5.288893624276407, 5.310522783589104, 5.371560681802889, 5.31624986138725, 5.596492111632379, 5.584567356502007, 5.34087986607281, 5.511151729537825, 5.300955755508092, 5.4087677052270875, 5.307446466751303, 5.588304129049092, 5.5576717833816, 5.4659524202679055, 5.644396733754682, 5.627420973748292, 5.427167260312676, 5.325422706104856, 5.27799510240227, 5.465541152498066, 5.344673403526945, 5.508357603431679, 5.459584134471159, 5.57640231464392, 5.670993388736358, 5.396418871764164, 5.397359287378258, 5.274119947708201, 5.362991729204447, 5.486927442790854, 5.598483760106529, 5.565656612380664, 5.471489118714834, 5.256159576510487, 5.615292550914056, 5.4716940291271765, 5.556417855195893, 5.296520331308541, 5.351051563268669, 5.5760409689353025, 5.423990568396803, 5.408469718495226, 5.637450738591822, 5.336102473186688, 5.358193710569126], "episode_lengths": [74, 129, 60, 49, 53, 77, 57, 49, 63, 75, 76, 51, 68, 67, 77, 63, 36, 46, 14, 40, 84, 120, 49, 142, 76, 77, 99, 95, 73, 62, 68, 66, 57, 44, 90, 71, 18, 74, 79, 103, 115, 57, 58, 54, 69, 74, 77, 135, 85, 47, 88, 106, 39, 108, 109, 58, 65, 59, 84, 57, 104, 65, 74, 78, 50, 16, 74, 52, 66, 59, 65, 87, 74, 82, 142, 53, 85, 85, 71, 52, 78, 81, 66, 41, 54, 77, 67, 103, 145, 57, 54, 50, 83, 51, 58, 89, 68, 130, 68, 92, 53, 60, 47, 50, 61, 103, 52, 54, 86, 43, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2959460817025447, "mean_inference_ms": 1.606455990005899, "mean_action_processing_ms": 0.15122634250292763, "mean_env_wait_ms": 2.9660809279281257, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1374624, "agent_timesteps_total": 1374624, "timers": {"sample_time_ms": 7327.309, "sample_throughput": 1090.714, "load_time_ms": 3.35, "load_throughput": 2385691.745, "learn_time_ms": 6327.582, "learn_throughput": 1263.042, "update_time_ms": 3.063}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0626264438033104, "policy_loss": -0.014889203011989594, "vf_loss": 0.07400625199079514, "vf_explained_var": 0.7813761830329895, "kl": 0.017546944320201874, "entropy": 0.16532130539417267, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1374624, "num_agent_steps_sampled": 1374624, "num_steps_trained": 1374624, "num_agent_steps_trained": 1374624}, "done": false, "episodes_total": 15949, "training_iteration": 172, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-14-28", "timestamp": 1716405268, "time_this_iter_s": 12.707243204116821, "time_total_s": 2309.7805256843567, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2309.7805256843567, "timesteps_since_restore": 0, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 34.28333333333333, "ram_util_percent": 34.17222222222223}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.695820569433709, "episode_reward_min": 0.06498607950773261, "episode_reward_mean": 5.410905070982748, "episode_len_mean": 73.74545454545455, "episode_media": {}, "episodes_this_iter": 110, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.990909090909091, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.00909090909090909, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9818181818181821, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24772727272727274, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2821868891645651, "reward_component_totals/rejoin_dist_change_reward_min": 0.9194010803794812, "reward_component_totals/rejoin_dist_change_reward_max": 1.5058205694337097, "reward_component_totals/failure_reward_mean": -0.00909090909090909, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.908263636363636, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.962, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.5278731244020705, 5.395067331326745, 5.354313303836314, 5.468436460936208, 5.5203316383231495, 5.452272053619771, 5.349373280492551, 5.583662847868197, 5.506929495252965, 5.4565001083726425, 5.677224025485254, 5.179203569273588, 5.6211922968415085, 5.532189908979438, 5.443386276138, 5.63611958557286, 5.638942737641398, 5.333620852452181, 5.521889741983172, 5.614417258863431, 5.389518885215013, 5.354653805241417, 5.474226368620057, 5.569849597041371, 5.4839461331755714, 5.51306067132062, 5.381742566111999, 5.209508206834035, 5.113401080379482, 5.490004021102005, 5.547969169956365, 5.34217094696897, 5.347111858116241, 5.502728840209104, 5.244570022441971, 5.275829363298513, 5.470142600109414, 5.594211657044916, 5.44728281257558, 5.643494931062786, 5.454904382076354, 5.306598715179975, 5.2259796483467404, 5.303172499316665, 5.671341543042389, 5.5078689998179176, 5.2751408319583435, 5.300833387956672, 5.348270655419208, 5.434301123001248, 5.609371045773659, 5.350185557936934, 5.619441039671107, 5.592740656099461, 5.487850020597782, 5.654293455498308, 5.310888921122529, 5.574738594921521, 5.641775255037168, 5.645639333160368, 5.530097783464964, 5.442073578883903, 5.277508654844009, 5.574006084401638, 5.499743779767114, 5.637649938667254, 5.284228728400777, 5.272509099122144, 5.5968450343403235, 5.5477681298620265, 5.58671986646519, 5.51927950202538, 5.564203686744722, 5.642832812850857, 5.536271637792533, 5.316235062816759, 5.525144457142946, 5.200819175086831, 5.592164533515209, 5.489740070323434, 5.50732573384591, 5.6173197979908505, 5.5596881380312535, 5.492770009995379, 5.3020239497292, 5.472420821656529, 5.695820569433709, 5.524006416819477, 0.06498607950773261, 5.40152038507269, 5.387597784828301, 5.356049980866975, 5.6093959387346395, 5.2069405234774, 5.457771631353553, 5.4219632935908475, 5.287748339990279, 5.197970588334465, 5.44276800806378, 5.250349141112881, 5.434590137246268, 5.676791874019676, 5.421978480594435, 5.5458322394422, 5.635073257344038, 5.518836365885485, 5.287758293242122, 5.573257658920369, 5.47554363271889, 5.213912019313574], "episode_lengths": [85, 71, 97, 63, 106, 96, 63, 111, 82, 66, 75, 92, 90, 48, 88, 58, 79, 58, 120, 87, 60, 49, 48, 68, 76, 60, 114, 45, 56, 57, 54, 82, 75, 71, 101, 52, 48, 125, 40, 68, 90, 78, 83, 42, 55, 78, 43, 52, 89, 84, 52, 45, 58, 106, 112, 58, 98, 66, 82, 95, 83, 73, 98, 87, 84, 67, 44, 58, 99, 94, 53, 86, 46, 75, 99, 77, 94, 58, 62, 96, 139, 74, 78, 52, 50, 43, 60, 69, 21, 84, 68, 38, 103, 43, 52, 102, 59, 40, 113, 84, 72, 59, 57, 104, 96, 86, 108, 53, 49, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2923957427578097, "mean_inference_ms": 1.60344469679503, "mean_action_processing_ms": 0.1510246736457648, "mean_env_wait_ms": 2.964834172058355, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1382616, "agent_timesteps_total": 1382616, "timers": {"sample_time_ms": 7189.774, "sample_throughput": 1111.579, "load_time_ms": 3.325, "load_throughput": 2403395.465, "learn_time_ms": 6275.084, "learn_throughput": 1273.608, "update_time_ms": 3.042}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.027671806514263153, "policy_loss": -0.019537674263119698, "vf_loss": 0.043643321841955185, "vf_explained_var": 0.8354153037071228, "kl": 0.017830751836299896, "entropy": 0.141845703125, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1382616, "num_agent_steps_sampled": 1382616, "num_steps_trained": 1382616, "num_agent_steps_trained": 1382616}, "done": false, "episodes_total": 16059, "training_iteration": 173, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-14-41", "timestamp": 1716405281, "time_this_iter_s": 12.659234762191772, "time_total_s": 2322.4397604465485, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2322.4397604465485, "timesteps_since_restore": 0, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 34.42777777777778, "ram_util_percent": 33.91111111111111}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.7096519686067335, "episode_reward_min": 0.1297806120068261, "episode_reward_mean": 5.390596052268732, "episode_len_mean": 72.5, "episode_media": {}, "episodes_this_iter": 108, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9907407407407407, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.009259259259259259, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9814814814814818, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24768518518518517, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2615682744909538, "reward_component_totals/rejoin_dist_change_reward_min": 0.9564797342782179, "reward_component_totals/rejoin_dist_change_reward_max": 1.5162256450720923, "reward_component_totals/failure_reward_mean": -0.009259259259259259, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9091203703703703, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.963, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.394499753828935, 5.4741680748362676, 5.647176921760797, 5.485184855583302, 5.1252147935677606, 5.546227089594302, 5.4195007324628035, 5.471446734252048, 5.242085224706205, 0.1297806120068261, 5.603925110414293, 5.534841865159386, 5.4864977990387285, 5.347521550663736, 5.3424247399881075, 5.495172269842634, 5.22386533299944, 5.5519515634514365, 5.6979819390159605, 5.449961037027704, 5.191844873331561, 5.437525604510448, 5.309880205595174, 5.3368177560435015, 5.672018158656256, 5.199858251217051, 5.623871355424171, 5.233135628314583, 5.309532895609262, 5.361334572808364, 5.294334861420399, 5.597553712450175, 5.488625807707145, 5.380158499220572, 5.314412736147133, 5.551709888855397, 5.4269556739535485, 5.348023820169871, 5.396557368811415, 5.61656064081677, 5.555076683895459, 5.701225645072091, 5.5743067222016425, 5.7096519686067335, 5.569137629500421, 5.5214532724695164, 5.439165031839865, 5.455045994968181, 5.130674496101179, 5.681619700445118, 5.626918250498115, 5.537001007805562, 5.521297813639776, 5.579775642271805, 5.37807703247608, 5.547740082914225, 5.42990119525861, 5.22468400210122, 5.255119771066319, 5.164479734278219, 5.340134040262686, 5.598980545251781, 5.431049368041622, 5.573041354332002, 5.555997291441715, 5.2270453789933065, 5.17396109660482, 5.569741976289549, 5.403306307260442, 5.258843755028048, 5.33726333562878, 5.222896756292716, 5.465873138578525, 5.637849866722489, 5.376190361321683, 5.180266700700575, 5.459390207819078, 5.572316471096499, 5.492994920107681, 5.5716083708790975, 5.544278574801309, 5.171273170564733, 5.448306170761443, 5.2606670126364055, 5.5354132556365085, 5.235330089743911, 5.665124117160298, 5.416849913121662, 5.401339089407479, 5.466030673056237, 5.472897052250618, 5.605452866862384, 5.609481974158196, 5.338960507908805, 5.630919116879188, 5.1871878127496664, 5.576491959365113, 5.475782594050317, 5.189880190557183, 5.398076856259644, 5.308692078061513, 5.564048672204013, 5.36944193814327, 5.322898030811142, 5.6216223619307755, 5.459592344272539, 5.604298325313363, 5.492793665028611], "episode_lengths": [99, 59, 66, 93, 129, 46, 94, 83, 65, 15, 61, 62, 55, 77, 83, 93, 75, 65, 66, 42, 112, 45, 77, 53, 54, 42, 95, 68, 52, 67, 91, 75, 60, 81, 67, 83, 59, 51, 48, 69, 50, 65, 85, 45, 93, 82, 77, 46, 96, 54, 99, 48, 94, 95, 62, 92, 46, 53, 68, 42, 49, 67, 42, 91, 55, 37, 41, 70, 62, 56, 73, 78, 46, 66, 38, 56, 54, 63, 146, 83, 118, 108, 79, 69, 51, 62, 52, 91, 96, 85, 53, 87, 93, 115, 51, 76, 102, 102, 115, 66, 69, 94, 72, 90, 114, 58, 115, 105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29288038507635755, "mean_inference_ms": 1.605108620633611, "mean_action_processing_ms": 0.1509906341278695, "mean_env_wait_ms": 2.964791298586275, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1390608, "agent_timesteps_total": 1390608, "timers": {"sample_time_ms": 7064.505, "sample_throughput": 1131.289, "load_time_ms": 3.275, "load_throughput": 2440082.516, "learn_time_ms": 6224.087, "learn_throughput": 1284.044, "update_time_ms": 3.002}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03541882708668709, "policy_loss": -0.017154734581708908, "vf_loss": 0.04958176240324974, "vf_explained_var": 0.8271915912628174, "kl": 0.014958982355892658, "entropy": 0.17891332507133484, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1390608, "num_agent_steps_sampled": 1390608, "num_steps_trained": 1390608, "num_agent_steps_trained": 1390608}, "done": false, "episodes_total": 16167, "training_iteration": 174, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-14-53", "timestamp": 1716405293, "time_this_iter_s": 12.570025205612183, "time_total_s": 2335.0097856521606, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2335.0097856521606, "timesteps_since_restore": 0, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 33.59444444444445, "ram_util_percent": 34.0}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.697440055666123, "episode_reward_min": 0.014309534564451054, "episode_reward_mean": 5.354222982305536, "episode_len_mean": 69.24786324786325, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9829059829059829, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.017094017094017096, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9658119658119662, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24572649572649571, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2628981959807504, "reward_component_totals/rejoin_dist_change_reward_min": 0.94057193512125, "reward_component_totals/rejoin_dist_change_reward_max": 1.5184400556661228, "reward_component_totals/failure_reward_mean": -0.017094017094017096, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.896880341880342, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.962, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.31178164134447, 5.315537567007844, 5.322335552042189, 5.683507308674585, 0.24032657208632924, 5.483522080541919, 5.646845508617136, 5.5011604608750915, 5.201244520950902, 5.474806389600106, 5.302469363564701, 5.589980939442736, 5.6076777409020835, 5.625033020498153, 5.199613322058537, 5.41526547643492, 5.566944435918253, 5.423404700370744, 5.5237230119330984, 5.155395374153401, 5.46667194599702, 5.268944066425715, 5.568895127853985, 5.508990927775646, 5.238172823242409, 5.397647985717883, 5.434763545471798, 5.515382439736949, 5.393736057771735, 5.697440055666123, 5.5982062794930725, 5.555912541615167, 5.380731132710733, 5.461898246988975, 5.352334601849703, 5.626804496679835, 5.235793635142491, 5.365990385303271, 5.5091546221639325, 5.356047195117111, 5.414010437843624, 5.435559870381571, 5.6383343672380235, 5.559445163312272, 5.5591505157406935, 5.174249335799958, 5.41812987719552, 5.584593611858443, 5.366468387211647, 5.421050145611574, 5.3582350378906884, 5.239402878881169, 5.445544444957527, 5.215034364413866, 5.622031688220881, 5.274510656092147, 5.2516214149397875, 5.2297477878058745, 5.629779081501212, 5.6311147223823355, 5.255338780550089, 5.378400185199964, 5.632816806112439, 5.619779931136795, 5.6304949252261185, 5.47168091152119, 5.4137783838693245, 5.323917836756433, 5.2763144642964175, 5.600037758851556, 5.589952778366239, 5.313043309350049, 5.314947186502924, 5.420973249872665, 5.358073010153977, 5.335637670323247, 5.600507033939888, 5.681339648179307, 5.51314432996629, 5.485279781941976, 5.565189019559218, 5.59195191633245, 5.345126567163581, 5.340335955606681, 5.318506052170805, 5.267240814593592, 5.330299047717066, 5.427978318194535, 0.014309534564451054, 5.245515971063272, 5.6271659309547335, 5.4405227382831995, 5.688974807954644, 5.659557688571939, 5.612188302013083, 5.51049841870943, 5.645755965606121, 5.377389876881197, 5.2562959611116975, 5.587023124203347, 5.414735025252691, 5.471105963158005, 5.525560042406228, 5.55697176767212, 5.272864971740342, 5.597979143464561, 5.404550110773784, 5.593373822493776, 5.401698161897201, 5.552548930600439, 5.152571935121252, 5.437979106191137, 5.2895547659184565, 5.398766777299908, 5.62443402903696, 5.316730843754286, 5.37327265057516], "episode_lengths": [110, 57, 62, 61, 25, 63, 77, 82, 48, 85, 57, 50, 59, 59, 44, 59, 49, 60, 54, 101, 46, 82, 84, 56, 77, 45, 69, 114, 57, 71, 89, 84, 74, 110, 63, 46, 65, 81, 155, 85, 99, 66, 54, 64, 63, 107, 61, 92, 124, 54, 110, 118, 114, 60, 48, 43, 119, 55, 102, 50, 71, 49, 53, 83, 54, 66, 43, 51, 54, 65, 79, 99, 42, 88, 75, 49, 87, 54, 82, 95, 97, 99, 76, 67, 72, 58, 59, 76, 12, 65, 55, 94, 62, 99, 50, 53, 71, 66, 42, 51, 104, 56, 78, 47, 41, 46, 70, 51, 73, 72, 38, 79, 39, 75, 59, 44, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2956022746961851, "mean_inference_ms": 1.604446355840522, "mean_action_processing_ms": 0.15115119881120148, "mean_env_wait_ms": 2.9630697746664616, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1398600, "agent_timesteps_total": 1398600, "timers": {"sample_time_ms": 6961.513, "sample_throughput": 1148.026, "load_time_ms": 3.251, "load_throughput": 2458245.214, "learn_time_ms": 6190.008, "learn_throughput": 1291.113, "update_time_ms": 2.973}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.050085801631212234, "policy_loss": -0.014333938248455524, "vf_loss": 0.06192174553871155, "vf_explained_var": 0.8115386962890625, "kl": 0.01248995028436184, "entropy": 0.13542839884757996, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1398600, "num_agent_steps_sampled": 1398600, "num_steps_trained": 1398600, "num_agent_steps_trained": 1398600}, "done": false, "episodes_total": 16284, "training_iteration": 175, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-15-06", "timestamp": 1716405306, "time_this_iter_s": 12.879312753677368, "time_total_s": 2347.889098405838, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2347.889098405838, "timesteps_since_restore": 0, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 34.12105263157895, "ram_util_percent": 34.0}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.704883889209244, "episode_reward_min": 0.3738116324131133, "episode_reward_mean": 5.400691442575628, "episode_len_mean": 66.94117647058823, "episode_media": {}, "episodes_this_iter": 119, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9915966386554622, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.008403361344537815, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9831932773109247, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24789915966386555, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2615485854327708, "reward_component_totals/rejoin_dist_change_reward_min": 0.9384691251361841, "reward_component_totals/rejoin_dist_change_reward_max": 1.5050089426804838, "reward_component_totals/failure_reward_mean": -0.008403361344537815, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.916453781512605, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.9609999999999999, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.576284597380118, 5.487701047269016, 5.314495750227438, 5.3063587935248435, 5.509089239206652, 5.522544933024321, 5.560173127963189, 5.383963254267336, 5.214087935688672, 5.157780523866508, 5.436745062339951, 5.380074033721165, 0.3738116324131133, 5.6364113107044425, 5.436133447990638, 5.5624355269744274, 5.27746567897627, 5.600229741427016, 5.523906378922675, 5.653483732619726, 5.608984389468905, 5.327061795932487, 5.283077117601505, 5.409006597882198, 5.307918504376139, 5.425589921737596, 5.490577255521728, 5.51784085873938, 5.393496291001154, 5.576495788947083, 5.40924366751359, 5.551938858971606, 5.679105352811803, 5.566626660117802, 5.428449090546501, 5.302034814168426, 5.632922205557657, 5.149469125136184, 5.4545208639125535, 5.619605731576604, 5.587837353171927, 5.447162593280612, 5.4809304188871995, 5.336361937287882, 5.350053241358632, 5.3196183008602596, 5.44753412157616, 5.506211122280476, 5.384756483396481, 5.508918410183197, 5.501799249817504, 5.544375968290858, 5.649115193393002, 5.12902208340282, 5.301919492648341, 5.412146951599521, 5.511188595046943, 5.283828037366033, 5.608366007666945, 5.255526171835451, 5.422348953971683, 5.239163259118291, 5.462925908210249, 5.668077393297684, 5.646420595717148, 5.128159889799056, 5.553102072589034, 5.257477466212503, 5.4538040751983665, 5.5487320498274455, 5.554725559738699, 5.401050713227602, 5.677008942680483, 5.2045385508331865, 5.529694622874115, 5.417756403660201, 5.564071027229996, 5.2597238370716415, 5.392214674581581, 5.201701137099658, 5.432747048967407, 5.49414544557798, 5.479866270083151, 5.454168042483656, 5.266336011261668, 5.52074707283704, 5.373639731288767, 5.572327456774317, 5.6009686193764425, 5.278928832420382, 5.22892742253348, 5.6414081701327525, 5.578763610733931, 5.3219269001654705, 5.494842706762049, 5.569258064144082, 5.258355265625282, 5.5780965396917725, 5.516039968320072, 5.401805152483945, 5.43329549210426, 5.517141025846536, 5.664885210170901, 5.257469716687869, 5.593829425656981, 5.609931041492413, 5.306249993566158, 5.478889115125698, 5.143226724370654, 5.604545790309819, 5.417398852388114, 5.3857778500355655, 5.518109279524429, 5.704883889209244, 5.214579173906952, 5.530449282261769, 5.341366691345512, 5.526094392624136, 5.1743508818918365], "episode_lengths": [74, 93, 53, 80, 46, 54, 57, 105, 59, 52, 109, 56, 24, 67, 64, 50, 48, 70, 75, 60, 50, 54, 54, 86, 74, 51, 49, 88, 80, 63, 69, 119, 59, 61, 47, 60, 55, 39, 90, 73, 94, 54, 86, 44, 59, 82, 49, 65, 63, 53, 70, 68, 49, 66, 50, 63, 61, 63, 71, 60, 78, 97, 59, 86, 72, 75, 59, 81, 52, 50, 93, 63, 78, 97, 74, 90, 99, 78, 46, 55, 106, 68, 99, 85, 58, 48, 40, 72, 91, 43, 47, 77, 72, 45, 82, 151, 75, 49, 60, 41, 104, 43, 79, 71, 83, 55, 59, 66, 53, 48, 52, 65, 47, 49, 53, 88, 67, 51, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29350222913953783, "mean_inference_ms": 1.6018293552678968, "mean_action_processing_ms": 0.15092505399645983, "mean_env_wait_ms": 2.9616056640993924, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1406592, "agent_timesteps_total": 1406592, "timers": {"sample_time_ms": 6854.759, "sample_throughput": 1165.905, "load_time_ms": 3.229, "load_throughput": 2475235.56, "learn_time_ms": 6165.199, "learn_throughput": 1296.309, "update_time_ms": 2.976}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.035961050540208817, "policy_loss": -0.015536177903413773, "vf_loss": 0.04851756989955902, "vf_explained_var": 0.8338038325309753, "kl": 0.014898289926350117, "entropy": 0.07123963534832001, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1406592, "num_agent_steps_sampled": 1406592, "num_steps_trained": 1406592, "num_agent_steps_trained": 1406592}, "done": false, "episodes_total": 16403, "training_iteration": 176, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-15-19", "timestamp": 1716405319, "time_this_iter_s": 12.400087118148804, "time_total_s": 2360.289185523987, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2360.289185523987, "timesteps_since_restore": 0, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 33.43333333333334, "ram_util_percent": 34.09444444444445}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.668575998663688, "episode_reward_min": 5.166249153968282, "episode_reward_mean": 5.451475063474862, "episode_len_mean": 71.22321428571429, "episode_media": {}, "episodes_this_iter": 112, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2726982777605775, "reward_component_totals/rejoin_dist_change_reward_min": 0.9722491539682818, "reward_component_totals/rejoin_dist_change_reward_max": 1.4965759986636886, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9287767857142857, "reward_component_totals/success_reward_min": 1.865, "reward_component_totals/success_reward_max": 1.962}, "hist_stats": {"episode_reward": [5.349274819033121, 5.283335278525918, 5.570347949423568, 5.6412879255057735, 5.520781847239815, 5.506364794457748, 5.47627299856015, 5.570229668767243, 5.508197445487118, 5.397331878732825, 5.441128287753042, 5.332834085123318, 5.421641611512792, 5.449043275246693, 5.376958407273726, 5.386927306906848, 5.597160701462522, 5.607808764552144, 5.510949732998732, 5.651452416779055, 5.637121257413694, 5.291395980262429, 5.2724622120270315, 5.285254889156288, 5.4025522742990475, 5.605115254994428, 5.391868690305184, 5.426508633572162, 5.32340869198469, 5.339219553638253, 5.395316090695372, 5.607455512876344, 5.37859702167484, 5.251361716115692, 5.4691608454356695, 5.621365539211892, 5.556796555196213, 5.38570567754267, 5.506196038673268, 5.367151796710109, 5.413875863062282, 5.5264356467410245, 5.564718058769881, 5.295791945027284, 5.475823582325172, 5.304292605062222, 5.469468960762837, 5.613520958425173, 5.298131459387708, 5.478784405322385, 5.376702857555701, 5.28346582501199, 5.386777628665179, 5.288016493873851, 5.202014333519044, 5.41627407752642, 5.527188342664483, 5.543055125436316, 5.400356877224644, 5.42780394687842, 5.4102774250875125, 5.464203648640676, 5.178848777308913, 5.595598970662235, 5.6128865336899505, 5.507681567676652, 5.383109243899399, 5.372218647661446, 5.639606338253927, 5.604380100429532, 5.668575998663688, 5.54529606699411, 5.507692790195198, 5.566279519126537, 5.440022668284259, 5.366035421734532, 5.249135277307843, 5.254500076570996, 5.472414759709984, 5.648467742918575, 5.243860575886336, 5.280774207400404, 5.214669577335593, 5.583260446197324, 5.445631251983317, 5.6135889105254515, 5.430382054978043, 5.633777189770281, 5.621520706447796, 5.166249153968282, 5.422466899569039, 5.6318312092892455, 5.631276443751778, 5.262349990448001, 5.551295765482352, 5.561636350933812, 5.276988989724743, 5.3037681032090145, 5.5995117379740975, 5.284079493801446, 5.505783939353444, 5.570344213522746, 5.52715509483918, 5.52820006429834, 5.568904805753638, 5.593950512534077, 5.612054389726088, 5.345633464594909, 5.458557470439081, 5.283677239494928, 5.2610886477429535, 5.657864213023526], "episode_lengths": [99, 39, 53, 54, 93, 63, 58, 53, 46, 87, 53, 45, 112, 59, 72, 52, 127, 71, 64, 84, 45, 117, 109, 63, 89, 63, 54, 60, 66, 68, 87, 92, 90, 59, 50, 51, 135, 47, 92, 72, 45, 51, 66, 61, 53, 70, 80, 96, 57, 47, 86, 65, 74, 50, 70, 68, 51, 116, 80, 65, 46, 79, 106, 58, 66, 51, 52, 38, 64, 50, 78, 57, 50, 51, 54, 43, 80, 104, 111, 55, 65, 46, 54, 56, 94, 59, 49, 65, 58, 56, 132, 74, 75, 48, 57, 88, 107, 81, 57, 69, 98, 63, 85, 91, 122, 60, 66, 132, 111, 46, 119, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29454976940111977, "mean_inference_ms": 1.6034830409424876, "mean_action_processing_ms": 0.15075427447686893, "mean_env_wait_ms": 2.9608002699266858, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1414584, "agent_timesteps_total": 1414584, "timers": {"sample_time_ms": 6776.0, "sample_throughput": 1179.457, "load_time_ms": 3.204, "load_throughput": 2494539.807, "learn_time_ms": 6134.528, "learn_throughput": 1302.79, "update_time_ms": 2.915}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.025790030136704445, "policy_loss": -0.020106399431824684, "vf_loss": 0.041944846510887146, "vf_explained_var": 0.8429685831069946, "kl": 0.019757894799113274, "entropy": 0.07417333871126175, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1414584, "num_agent_steps_sampled": 1414584, "num_steps_trained": 1414584, "num_agent_steps_trained": 1414584}, "done": false, "episodes_total": 16515, "training_iteration": 177, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-15-31", "timestamp": 1716405331, "time_this_iter_s": 12.07332706451416, "time_total_s": 2372.362512588501, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2372.362512588501, "timesteps_since_restore": 0, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 33.48823529411765, "ram_util_percent": 34.1}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.6905652923771335, "episode_reward_min": -0.05187667603927948, "episode_reward_mean": 5.394712436680254, "episode_len_mean": 69.44444444444444, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9914529914529915, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.008547008547008548, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9829059829059832, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24786324786324787, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2589432059110226, "reward_component_totals/rejoin_dist_change_reward_min": 0.9481233239607205, "reward_component_totals/rejoin_dist_change_reward_max": 1.5117298764360845, "reward_component_totals/failure_reward_mean": -0.008547008547008548, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9135470085470083, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.963, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.235259564148185, 5.268389342794585, 5.586986582281247, 5.642062947226885, 5.689408888778207, 5.612140399172263, 5.335003484101877, 5.62508484609873, 5.497321531885714, 5.518539971206772, 5.375313291534394, 5.676932812020617, 5.555772296369814, 5.3773857123098345, 5.553107007258442, 5.5284235993759285, 5.383238642054953, 5.503982667110035, 5.2752888653653525, 5.3154803669846995, 5.59167261658047, 5.354207488394273, 5.6905652923771335, 5.384714674412146, 5.588442393606287, 5.321477187955354, 5.317639384433887, 5.5120768495641155, 5.467125558649204, 5.396866764565046, 5.591598219175088, 5.6682627823896485, 5.642438208208665, 5.392451779458136, 5.321167744586695, 5.515072840985217, 5.309136371864406, 5.4432430384909525, 5.20834687506454, 5.267185674236856, 5.439337679033748, 5.523837111066153, 5.467082245141041, 5.440252702612826, 5.229782442263726, 5.606530732844773, 5.3229160704285015, 5.250752195854759, 5.379072998927619, 5.342489025027829, 5.293213345567869, 5.447990691891657, 5.6052139599842485, 5.334846127884328, 5.488776889827698, 5.2575075350351845, 5.623729876436084, 5.405976305502779, 5.680259212472808, 5.257205526613032, 5.20333083028112, 5.308690013747359, 5.683786494484032, -0.05187667603927948, 5.418655390984638, 5.484216937680306, 5.390274583739196, 5.2218546372339265, 5.6507746925150135, 5.478199514949958, 5.60277036084042, 5.195639597496105, 5.565954933194755, 5.514029272698188, 5.480624118337717, 5.5295602657092315, 5.453778311000381, 5.3345610753505035, 5.4035635736844565, 5.430517915186062, 5.432573253938907, 5.499285241430255, 5.622557614537538, 5.1808768908538365, 5.24436784904333, 5.2014456740343125, 5.506634683064158, 5.426026495042611, 5.579348936040931, 5.234152223504701, 5.484469203450821, 5.5704467198802, 5.5057315708900525, 5.315542743521698, 5.3596033283278, 5.440886443127062, 5.211688932301788, 5.354459835440981, 5.3441644686845144, 5.220618022865719, 5.660419194727989, 5.59457599674297, 5.334289418100056, 5.483209835232227, 5.480202242085525, 5.416995410240527, 5.579221210423221, 5.421717889999052, 5.416809211409741, 5.596388137557623, 5.242804359572285, 5.559906142592407, 5.380042584173951, 5.37973591334054, 5.481071262634602, 5.56318000516929, 5.6214130670390485], "episode_lengths": [54, 52, 104, 52, 66, 57, 45, 57, 170, 55, 46, 58, 51, 77, 82, 50, 98, 80, 40, 60, 107, 63, 61, 56, 94, 43, 79, 50, 124, 50, 49, 59, 54, 53, 78, 91, 65, 46, 56, 46, 44, 45, 91, 60, 67, 63, 47, 63, 54, 69, 85, 106, 93, 59, 93, 49, 138, 49, 66, 63, 90, 55, 50, 10, 47, 111, 77, 61, 61, 94, 83, 37, 54, 128, 56, 73, 88, 41, 51, 43, 51, 50, 53, 109, 71, 62, 113, 64, 111, 61, 74, 63, 77, 63, 99, 58, 50, 48, 48, 83, 96, 57, 40, 95, 57, 110, 67, 110, 68, 108, 77, 113, 79, 56, 48, 84, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29346974608047177, "mean_inference_ms": 1.6002831592277438, "mean_action_processing_ms": 0.1506486431221349, "mean_env_wait_ms": 2.95682843876096, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1422576, "agent_timesteps_total": 1422576, "timers": {"sample_time_ms": 6488.515, "sample_throughput": 1231.715, "load_time_ms": 3.164, "load_throughput": 2526083.661, "learn_time_ms": 6134.992, "learn_throughput": 1302.691, "update_time_ms": 2.903}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03208683431148529, "policy_loss": -0.014180540107190609, "vf_loss": 0.043176911771297455, "vf_explained_var": 0.849375307559967, "kl": 0.015452341176569462, "entropy": 0.029979554936289787, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1422576, "num_agent_steps_sampled": 1422576, "num_steps_trained": 1422576, "num_agent_steps_trained": 1422576}, "done": false, "episodes_total": 16632, "training_iteration": 178, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-15-43", "timestamp": 1716405343, "time_this_iter_s": 11.929376363754272, "time_total_s": 2384.2918889522552, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2384.2918889522552, "timesteps_since_restore": 0, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 34.493750000000006, "ram_util_percent": 34.1}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.687192309938846, "episode_reward_min": 5.119293391870977, "episode_reward_mean": 5.418838384158705, "episode_len_mean": 70.49090909090908, "episode_media": {}, "episodes_this_iter": 110, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2393292932496143, "reward_component_totals/rejoin_dist_change_reward_min": 0.9372933918709776, "reward_component_totals/rejoin_dist_change_reward_max": 1.4978098420676653, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9295090909090908, "reward_component_totals/success_reward_min": 1.842, "reward_component_totals/success_reward_max": 1.962}, "hist_stats": {"episode_reward": [5.327937321154043, 5.220309780397381, 5.490606033419108, 5.193168783745087, 5.205848515237797, 5.583858932753582, 5.3355585310325315, 5.550728301024171, 5.54767625617714, 5.62554082465401, 5.63730247834903, 5.533646965324394, 5.609492251046863, 5.275964629111068, 5.654549990196703, 5.568892108913738, 5.505407414785568, 5.236159053418989, 5.327158359577358, 5.273930853892561, 5.47395019854698, 5.547966019739539, 5.188888738736379, 5.326909851580799, 5.334194681398366, 5.669809842067665, 5.351408740119818, 5.6464634677372185, 5.456316653024272, 5.532739930406625, 5.3015308127380365, 5.58389854549901, 5.383183286979574, 5.243807297154236, 5.2269664651354475, 5.536396204049429, 5.167821061012171, 5.630997881962138, 5.36838349954256, 5.322850883073549, 5.586630396876555, 5.554066481531402, 5.567461467675514, 5.634280525813443, 5.295361811215461, 5.362163112167114, 5.326780013271565, 5.247274336077085, 5.167494722010243, 5.328073016391558, 5.397889481122521, 5.439586187220387, 5.428608139610853, 5.602644516392271, 5.44705102066894, 5.211976103639333, 5.435447605873568, 5.622248397436844, 5.34956057670607, 5.5768627396812755, 5.439287221271023, 5.520136992634114, 5.475604697287279, 5.364910158202491, 5.453569725913546, 5.545745578481579, 5.304672327749843, 5.198492133546014, 5.387553255248251, 5.434945614856181, 5.261902023435899, 5.546403425540694, 5.283063595923684, 5.580269490810854, 5.390333434446175, 5.611274573507172, 5.5306985435368246, 5.119293391870977, 5.350278505384924, 5.366085634521603, 5.653132935911454, 5.542519495486883, 5.232087646355598, 5.317119343084112, 5.597450028166255, 5.299508008323469, 5.233622259152602, 5.393115576489736, 5.26346120555732, 5.1580545433567835, 5.630637431073131, 5.687192309938846, 5.571754816114682, 5.5477593482227086, 5.6235455565437515, 5.550086736745721, 5.177047365270797, 5.34072924477397, 5.312857789065466, 5.442149532153734, 5.518879987961635, 5.241263436774094, 5.500190769383691, 5.354586878120496, 5.36947511916567, 5.278899459262017, 5.487652737053011, 5.489547752158625, 5.319865475478, 5.193827050047209], "episode_lengths": [62, 109, 59, 67, 48, 84, 56, 53, 48, 97, 89, 55, 94, 94, 74, 84, 69, 39, 38, 50, 54, 71, 56, 88, 79, 78, 52, 50, 72, 54, 122, 50, 54, 39, 68, 59, 86, 65, 60, 40, 58, 59, 52, 58, 79, 41, 64, 65, 92, 56, 67, 94, 67, 109, 54, 43, 51, 100, 57, 76, 70, 49, 95, 107, 89, 61, 55, 82, 86, 71, 95, 151, 41, 49, 65, 79, 139, 68, 49, 55, 58, 140, 58, 66, 59, 94, 85, 61, 79, 57, 77, 60, 57, 44, 52, 158, 60, 64, 71, 68, 72, 49, 66, 83, 82, 67, 67, 79, 91, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2933546248794747, "mean_inference_ms": 1.5979789455533062, "mean_action_processing_ms": 0.15048695240822701, "mean_env_wait_ms": 2.9539043522924726, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1430568, "agent_timesteps_total": 1430568, "timers": {"sample_time_ms": 6381.716, "sample_throughput": 1252.328, "load_time_ms": 3.156, "load_throughput": 2532457.792, "learn_time_ms": 6111.546, "learn_throughput": 1307.689, "update_time_ms": 2.926}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.024199625477194786, "policy_loss": -0.015032967552542686, "vf_loss": 0.03623499721288681, "vf_explained_var": 0.866849958896637, "kl": 0.014988006092607975, "entropy": 0.0725363940000534, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1430568, "num_agent_steps_sampled": 1430568, "num_steps_trained": 1430568, "num_agent_steps_trained": 1430568}, "done": false, "episodes_total": 16742, "training_iteration": 179, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-15-54", "timestamp": 1716405354, "time_this_iter_s": 11.767409801483154, "time_total_s": 2396.0592987537384, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2396.0592987537384, "timesteps_since_restore": 0, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 33.252941176470586, "ram_util_percent": 34.15882352941178}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.699244398627821, "episode_reward_min": 5.138774799588058, "episode_reward_mean": 5.448808315026772, "episode_len_mean": 73.38938053097345, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.272197695557745, "reward_component_totals/rejoin_dist_change_reward_min": 0.9437747995880572, "reward_component_totals/rejoin_dist_change_reward_max": 1.5112443986278203, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9266106194690265, "reward_component_totals/success_reward_min": 1.867, "reward_component_totals/success_reward_max": 1.9609999999999999}, "hist_stats": {"episode_reward": [5.604230607050992, 5.578850749884799, 5.590421869927171, 5.557621968735473, 5.40227225132331, 5.490378901404858, 5.401892325048961, 5.470979464720081, 5.518382188952298, 5.497244879333471, 5.363861381082612, 5.4209481151013765, 5.341429142556967, 5.529706187333636, 5.549801747804869, 5.44809536882072, 5.359867579214232, 5.329248051316507, 5.601511390591687, 5.2878950802820945, 5.163955758535746, 5.480726022186695, 5.18889402462985, 5.289367245459095, 5.5556202139840964, 5.60904366316303, 5.479541255784486, 5.243950065551049, 5.1886981110296855, 5.3248415166275285, 5.6216409329522214, 5.264867109394922, 5.446762367865164, 5.293241114167871, 5.622731610438636, 5.246509483910686, 5.5136174584093744, 5.386647910542586, 5.470158253714693, 5.565399932600647, 5.4673426811625045, 5.401541532721904, 5.577026511925256, 5.322857998357707, 5.655614395383117, 5.550299908402149, 5.486229134407543, 5.529520237832735, 5.541552644654132, 5.530758355232858, 5.599922641569488, 5.6252959344669105, 5.6015788777002555, 5.5297214646017405, 5.699244398627821, 5.350484207241158, 5.361784015704655, 5.586654297220427, 5.529820015693581, 5.267046899924756, 5.289511594780283, 5.593844639641711, 5.42733506054564, 5.601162619642249, 5.398232232275145, 5.525053842004535, 5.3116339792309315, 5.256482557009551, 5.346894641152289, 5.1876469994697185, 5.627858464332489, 5.541480614302274, 5.4558234969615995, 5.206503599460557, 5.533787528815429, 5.513407188172338, 5.320116051550638, 5.569702300020756, 5.213181529306352, 5.67085072972089, 5.21199756012601, 5.593402654009061, 5.30388725175581, 5.289091615007183, 5.302699021045177, 5.453815533026557, 5.599291580913139, 5.139975290047246, 5.455089617464372, 5.228412129441355, 5.138774799588058, 5.206769824136211, 5.617239311715142, 5.626668812815028, 5.632229161962309, 5.492229859700055, 5.5897595990891, 5.244303282732568, 5.645769179263802, 5.577190099366721, 5.652685161806606, 5.417629376288909, 5.530786598129858, 5.303189125352537, 5.183543667008352, 5.512436728486135, 5.541799473968824, 5.600861217301324, 5.376921140658105, 5.49923843890975, 5.4724452828562935, 5.5758935993711605, 5.593654482022185], "episode_lengths": [67, 58, 103, 64, 72, 72, 58, 116, 105, 49, 48, 53, 49, 60, 56, 67, 90, 98, 63, 74, 59, 60, 87, 48, 54, 48, 112, 95, 52, 51, 78, 42, 74, 83, 54, 39, 114, 75, 93, 120, 78, 70, 61, 82, 57, 72, 119, 71, 54, 78, 74, 76, 53, 83, 62, 47, 65, 97, 118, 50, 62, 104, 84, 55, 95, 133, 92, 75, 101, 76, 100, 124, 69, 58, 115, 67, 72, 59, 50, 63, 121, 106, 75, 69, 42, 61, 74, 76, 81, 64, 55, 59, 78, 49, 50, 68, 54, 92, 108, 59, 46, 63, 88, 47, 67, 48, 61, 55, 64, 80, 75, 57, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2927516074540582, "mean_inference_ms": 1.5969738528481179, "mean_action_processing_ms": 0.1504628118555725, "mean_env_wait_ms": 2.9525428789822317, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1438560, "agent_timesteps_total": 1438560, "timers": {"sample_time_ms": 6350.944, "sample_throughput": 1258.396, "load_time_ms": 3.168, "load_throughput": 2522699.758, "learn_time_ms": 6098.021, "learn_throughput": 1310.589, "update_time_ms": 2.969}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.029084231704473495, "policy_loss": -0.012136179022490978, "vf_loss": 0.0372905358672142, "vf_explained_var": 0.8510398268699646, "kl": 0.019649382680654526, "entropy": 0.055686093866825104, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1438560, "num_agent_steps_sampled": 1438560, "num_steps_trained": 1438560, "num_agent_steps_trained": 1438560}, "done": false, "episodes_total": 16855, "training_iteration": 180, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-16-07", "timestamp": 1716405367, "time_this_iter_s": 12.614711046218872, "time_total_s": 2408.6740097999573, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2408.6740097999573, "timesteps_since_restore": 0, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 34.31666666666667, "ram_util_percent": 34.06111111111111}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.718805031001191, "episode_reward_min": 5.10793949728979, "episode_reward_mean": 5.452117959013311, "episode_len_mean": 68.29565217391304, "episode_media": {}, "episodes_this_iter": 115, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2704136111872244, "reward_component_totals/rejoin_dist_change_reward_min": 0.9209394972897895, "reward_component_totals/rejoin_dist_change_reward_max": 1.5208050310011905, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9317043478260871, "reward_component_totals/success_reward_min": 1.865, "reward_component_totals/success_reward_max": 1.962}, "hist_stats": {"episode_reward": [5.672689701403355, 5.226677586378665, 5.5156954506359686, 5.4211815663806355, 5.64674264587878, 5.278259038850511, 5.612256540090158, 5.45556588534331, 5.1521224102592, 5.413582278984316, 5.395939189676037, 5.520194671509279, 5.5650498172403235, 5.55229712621884, 5.493581305639426, 5.390586644948907, 5.308804433590545, 5.6153172620896825, 5.337764894178108, 5.176667081057385, 5.253444311908119, 5.364101369701679, 5.421186365630481, 5.435691067786966, 5.661017028388946, 5.464815253976792, 5.590805126079103, 5.623106203286149, 5.332271042265398, 5.203003659947695, 5.456187526122113, 5.604156920613651, 5.675861647464735, 5.1336313819788355, 5.6044737409127885, 5.399354938832722, 5.3767780454970655, 5.327264167797887, 5.586716614967143, 5.425086569894244, 5.339426530966159, 5.512594374777649, 5.10793949728979, 5.4931795499977705, 5.623567095612866, 5.547148442717445, 5.676310657957961, 5.5373792099151835, 5.225087752828532, 5.176092546376577, 5.194907080903679, 5.279339743854399, 5.574194989611229, 5.652680967563812, 5.3994946548140454, 5.409362955190392, 5.500572360695967, 5.475911445024078, 5.59998798812053, 5.5513963639152575, 5.330788624383905, 5.697291898427509, 5.445155492691013, 5.673191673957184, 5.544823980243787, 5.276653994710767, 5.3812271227983315, 5.600120729441128, 5.6899169738287405, 5.193382303774662, 5.558895586301659, 5.632396770400541, 5.2600342623796195, 5.550589236279143, 5.563735986958467, 5.495157935246599, 5.2260073406145615, 5.400583279109595, 5.115723387837216, 5.44011322917517, 5.549896044125517, 5.566090557275597, 5.363485696551664, 5.612070416881747, 5.290519745414423, 5.515789545291443, 5.431323244299119, 5.425303303569028, 5.480778114184265, 5.4943659633725925, 5.208127398262407, 5.453686692154076, 5.559959479393887, 5.30120768677477, 5.631388450637425, 5.400950886623731, 5.628490949391946, 5.399715654358015, 5.5952540214918915, 5.442906102490428, 5.331884734207582, 5.581652204556754, 5.664489061899453, 5.4926850810657974, 5.5422785483126145, 5.476851171309789, 5.718805031001191, 5.221400166908826, 5.1866726050346985, 5.544279571821082, 5.360604935051267, 5.551644019819594, 5.320321027542143, 5.599379191654684, 5.407015453702481], "episode_lengths": [45, 101, 116, 52, 45, 65, 53, 112, 73, 44, 60, 105, 80, 65, 50, 49, 40, 53, 69, 54, 57, 124, 47, 88, 76, 103, 64, 60, 116, 69, 44, 49, 51, 54, 47, 61, 89, 55, 80, 79, 92, 98, 63, 49, 53, 70, 71, 110, 60, 92, 105, 61, 80, 76, 52, 57, 48, 85, 74, 49, 49, 52, 53, 51, 135, 70, 55, 43, 52, 39, 90, 54, 56, 45, 130, 70, 79, 50, 76, 77, 42, 103, 38, 81, 88, 59, 50, 62, 119, 58, 43, 50, 78, 67, 55, 46, 65, 77, 66, 47, 60, 64, 53, 49, 101, 75, 52, 55, 118, 68, 53, 69, 57, 71, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29324056631079853, "mean_inference_ms": 1.5979066079647608, "mean_action_processing_ms": 0.15043699365099422, "mean_env_wait_ms": 2.950835191854001, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1446552, "agent_timesteps_total": 1446552, "timers": {"sample_time_ms": 6265.984, "sample_throughput": 1275.458, "load_time_ms": 3.119, "load_throughput": 2562542.719, "learn_time_ms": 6068.537, "learn_throughput": 1316.957, "update_time_ms": 2.892}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.029038704931735992, "policy_loss": -0.014752830378711224, "vf_loss": 0.04042460769414902, "vf_explained_var": 0.856477677822113, "kl": 0.016834620386362076, "entropy": -0.02803352102637291, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1446552, "num_agent_steps_sampled": 1446552, "num_steps_trained": 1446552, "num_agent_steps_trained": 1446552}, "done": false, "episodes_total": 16970, "training_iteration": 181, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-16-19", "timestamp": 1716405379, "time_this_iter_s": 11.958067178726196, "time_total_s": 2420.6320769786835, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2420.6320769786835, "timesteps_since_restore": 0, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 33.476470588235294, "ram_util_percent": 33.9}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.707824308167172, "episode_reward_min": 0.2614968464049703, "episode_reward_mean": 5.372437601364031, "episode_len_mean": 72.46788990825688, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9908256880733946, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.009174311926605505, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9816513761467893, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24770642201834864, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2428504454007276, "reward_component_totals/rejoin_dist_change_reward_min": 0.9133895872604039, "reward_component_totals/rejoin_dist_change_reward_max": 1.5118243081671727, "reward_component_totals/failure_reward_mean": -0.009174311926605505, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9094036697247705, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.962, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.589698754701773, 5.362404354766732, 5.4910480588009865, 5.59503798717896, 5.442861707025992, 5.5112752898158295, 5.247077093190623, 5.391588791111184, 5.51320286867624, 5.32223517861687, 5.242215204680132, 5.478580318770023, 5.641170031477337, 5.628001730642272, 5.5150100046504225, 5.2044070555735615, 5.4008320562297945, 5.39828964787668, 5.192817751536495, 5.695787363535283, 5.243148465492405, 5.101002620454262, 5.19313588361274, 5.56528408312956, 5.238765092233205, 5.616006789402235, 5.205212871697568, 5.231021732136915, 5.384701474337676, 5.260469990466241, 5.61859516867282, 5.6482604299832415, 5.458628568673928, 5.419975809584603, 5.587065722042455, 5.707824308167172, 5.559572860397484, 5.1326875889186905, 5.556781555986879, 5.326067212409023, 5.52788972416155, 5.341183729540852, 5.388600360190106, 5.4480761738525, 5.238171470463374, 5.355930324705794, 5.477493805579349, 5.546089261093647, 5.499265916801459, 5.280185776496424, 5.328596119253508, 5.529839168782315, 5.661007894588069, 5.3189636951417905, 5.58085392366052, 5.2434628786573825, 5.328398471066324, 5.568319597782402, 5.6030047262660965, 5.311376293903946, 5.279440113539046, 5.2834350485114285, 5.225113226769576, 5.4283401632990795, 5.367726472169178, 0.2614968464049703, 5.244334594998721, 5.53460620477107, 5.373054425629134, 5.558473850604586, 5.454963607798266, 5.569531287266734, 5.595246780756543, 5.501246629529863, 5.59194783834336, 5.6296704558285935, 5.562465089928731, 5.619103097377331, 5.249834111676778, 5.0603895872604046, 5.182495408161152, 5.253214737851835, 5.278972184996215, 5.240161291370687, 5.589234037442994, 5.3165709933204495, 5.538525216624448, 5.175272605761208, 5.257472402773454, 5.184152730073295, 5.252250646875586, 5.59099640829025, 5.194068172865954, 5.4857281482786515, 5.531840157455699, 5.497748087891537, 5.136058777604802, 5.191169012522865, 5.59510054276611, 5.588156361556708, 5.612839307284999, 5.640792219880279, 5.6076038077163375, 5.428289543432168, 5.527767113194776, 5.5159067425251695, 5.39436215962567, 5.5794401637224205, 5.324631345706512], "episode_lengths": [58, 62, 67, 54, 70, 87, 41, 70, 86, 51, 93, 55, 101, 65, 76, 49, 101, 48, 39, 60, 58, 119, 65, 50, 125, 60, 53, 105, 72, 95, 110, 57, 91, 87, 57, 54, 86, 46, 80, 51, 123, 44, 114, 89, 43, 86, 99, 49, 45, 58, 111, 100, 54, 75, 57, 70, 71, 54, 80, 62, 81, 95, 66, 81, 38, 24, 92, 47, 75, 78, 108, 96, 69, 88, 89, 52, 77, 66, 64, 103, 59, 38, 65, 54, 56, 41, 88, 94, 89, 62, 89, 54, 106, 77, 52, 87, 51, 57, 83, 96, 71, 89, 53, 130, 56, 61, 104, 49, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2932405407966204, "mean_inference_ms": 1.5973901004781286, "mean_action_processing_ms": 0.15036042675123035, "mean_env_wait_ms": 2.9504749384753266, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1454544, "agent_timesteps_total": 1454544, "timers": {"sample_time_ms": 6294.685, "sample_throughput": 1269.642, "load_time_ms": 3.083, "load_throughput": 2592027.525, "learn_time_ms": 6072.036, "learn_throughput": 1316.198, "update_time_ms": 2.895}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03764045983552933, "policy_loss": -0.014064289629459381, "vf_loss": 0.049183279275894165, "vf_explained_var": 0.820023775100708, "kl": 0.012607368640601635, "entropy": 0.05362435430288315, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1454544, "num_agent_steps_sampled": 1454544, "num_steps_trained": 1454544, "num_agent_steps_trained": 1454544}, "done": false, "episodes_total": 17079, "training_iteration": 182, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-16-32", "timestamp": 1716405392, "time_this_iter_s": 13.027832269668579, "time_total_s": 2433.659909248352, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2433.659909248352, "timesteps_since_restore": 0, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 34.347368421052636, "ram_util_percent": 33.80526315789473}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.6639388184624115, "episode_reward_min": 5.134029046458071, "episode_reward_mean": 5.467774382357057, "episode_len_mean": 71.10526315789474, "episode_media": {}, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2888796455149527, "reward_component_totals/rejoin_dist_change_reward_min": 0.9390290464580711, "reward_component_totals/rejoin_dist_change_reward_max": 1.4879388184624116, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9288947368421052, "reward_component_totals/success_reward_min": 1.846, "reward_component_totals/success_reward_max": 1.963}, "hist_stats": {"episode_reward": [5.596110645274193, 5.582885535544504, 5.238939389074089, 5.3312097572769055, 5.486805339275962, 5.497599276556752, 5.134029046458071, 5.576847591269457, 5.649923449159033, 5.530520153124646, 5.466319391854733, 5.6012545872688495, 5.612486306186899, 5.350138117792698, 5.368178708660388, 5.375566538100069, 5.389014780050745, 5.562502827559102, 5.519583721541736, 5.361480113847996, 5.425780453336751, 5.641986835349421, 5.594426404343964, 5.469145850103139, 5.190268566820622, 5.547056937854455, 5.356018153247932, 5.392562921755553, 5.629818432612915, 5.569491028252515, 5.6525125228450115, 5.509899339963654, 5.319572077299753, 5.586663188512953, 5.435637373973261, 5.2952132325692345, 5.329567938022026, 5.543082979841594, 5.3536407723276405, 5.5124103516203995, 5.549402854056847, 5.474928707407556, 5.212394396364585, 5.6396722386394345, 5.650785787510516, 5.598570530030333, 5.505839493020863, 5.598590376331654, 5.598196146229627, 5.2229276052448625, 5.38937822288067, 5.606569779157603, 5.551954142127832, 5.261398519118538, 5.236378497793103, 5.536530824912264, 5.289795083356083, 5.594234947371862, 5.455926590336903, 5.3821214943456335, 5.661896933957687, 5.308961118644241, 5.384173778104529, 5.486324459948987, 5.622560632027923, 5.628094219868386, 5.466968389136852, 5.578125199145954, 5.288380983215383, 5.210822690597551, 5.5195086337063906, 5.423044439763452, 5.523345023703283, 5.557503448998247, 5.365126851287149, 5.446261016393466, 5.329141544111486, 5.419549762457019, 5.540028007452313, 5.536501742659115, 5.258759271202122, 5.536702041929004, 5.572214069866035, 5.6639388184624115, 5.330560188559257, 5.539862423015766, 5.654702773904939, 5.515691974104641, 5.633569031511092, 5.247395014297705, 5.634360218449272, 5.282986301579839, 5.283553914205573, 5.551503934470464, 5.472315459437866, 5.213971623272103, 5.424270676285817, 5.545318314047751, 5.640497423394663, 5.480164528847769, 5.632059457792325, 5.581559839240342, 5.468149269564812, 5.38917684370236, 5.513625036397579, 5.625132283575707, 5.559139824210936, 5.522168415318951, 5.501660366415644, 5.401634016659369, 5.336564582974062, 5.6351256210228815, 5.154376770781196, 5.28550351225854], "episode_lengths": [85, 46, 86, 99, 70, 66, 55, 81, 57, 81, 93, 66, 80, 37, 72, 51, 50, 49, 59, 75, 44, 84, 106, 70, 58, 87, 52, 41, 58, 46, 48, 46, 52, 65, 49, 83, 55, 91, 83, 48, 76, 64, 121, 53, 57, 55, 82, 82, 83, 49, 81, 109, 57, 80, 61, 57, 46, 77, 122, 118, 54, 51, 54, 98, 58, 56, 65, 62, 41, 93, 50, 119, 126, 58, 42, 85, 54, 77, 106, 127, 154, 55, 83, 74, 55, 86, 70, 100, 71, 83, 51, 43, 43, 71, 65, 68, 54, 46, 57, 120, 52, 73, 93, 52, 47, 50, 81, 98, 153, 73, 43, 68, 90, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2934120628745405, "mean_inference_ms": 1.59656841671343, "mean_action_processing_ms": 0.15036174781910425, "mean_env_wait_ms": 2.9498951904183364, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1462536, "agent_timesteps_total": 1462536, "timers": {"sample_time_ms": 6301.389, "sample_throughput": 1268.292, "load_time_ms": 3.144, "load_throughput": 2542137.37, "learn_time_ms": 6095.155, "learn_throughput": 1311.205, "update_time_ms": 2.896}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.02594892494380474, "policy_loss": -0.01625334657728672, "vf_loss": 0.03829652816057205, "vf_explained_var": 0.8636704683303833, "kl": 0.01952870935201645, "entropy": -0.03729542717337608, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1462536, "num_agent_steps_sampled": 1462536, "num_steps_trained": 1462536, "num_agent_steps_trained": 1462536}, "done": false, "episodes_total": 17193, "training_iteration": 183, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-16-45", "timestamp": 1716405405, "time_this_iter_s": 12.953857421875, "time_total_s": 2446.613766670227, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2446.613766670227, "timesteps_since_restore": 0, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 34.17368421052632, "ram_util_percent": 33.80526315789473}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.701544072123546, "episode_reward_min": -0.07559480707708532, "episode_reward_mean": 5.386866449608788, "episode_len_mean": 66.5126050420168, "episode_media": {}, "episodes_this_iter": 119, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9915966386554622, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.008403361344537815, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9831932773109247, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24789915966386555, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2474126680961843, "reward_component_totals/rejoin_dist_change_reward_min": 0.9244051929229147, "reward_component_totals/rejoin_dist_change_reward_max": 1.511544072123546, "reward_component_totals/failure_reward_mean": -0.008403361344537815, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9167647058823531, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.9609999999999999, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.53063549557689, 5.27657766532773, 5.165453580235408, 5.389274707814131, 5.191496709179761, 5.402207764899517, 5.246152814185303, 5.583712276975486, 5.338809271752979, 5.217167861089292, 5.549687610836712, 5.328955567786335, 5.623187485517774, 5.68005360812796, 5.358510515290737, 5.594775989719799, 5.262319144627844, 5.49606124040842, 5.523570805994631, 5.311152416007793, 5.337805814639578, 5.236845343199278, 5.382123208878433, 5.13560875448008, 5.6832136052038535, 5.259511290123758, 5.60076116242495, 5.596919305112012, 5.469122021091271, 5.350122737989277, 5.509502223413089, 5.609176469342774, 5.5107358853261825, 5.61143780768843, 5.401997921245005, 5.579741499964714, 5.2932407826477, 5.450638903062245, 5.27710451016222, 5.4118268430434, 5.429866955192265, 5.5529742855819695, 5.6106268884615424, 5.299531616717206, 5.619848109786782, 5.268925676746623, 5.606943652363679, 5.543652988235356, -0.07559480707708532, 5.379198667962055, 5.519227927842955, 5.6123335084215284, 5.615559599176026, 5.152349568008054, 5.641478502640046, 5.459678336072987, 5.132624098499655, 5.270011679818987, 5.550250248082422, 5.333250573253993, 5.544028474961095, 5.152559689379862, 5.381916765999215, 5.606542825570961, 5.578938033586511, 5.413963608463487, 5.610027497077789, 5.404572738788496, 5.159968267598384, 5.316214407216675, 5.130110736190398, 5.414641805937546, 5.38753520898215, 5.5831326274535815, 5.550027176998745, 5.548587141797255, 5.5507858907703795, 5.345457197239301, 5.594812777121179, 5.631227939505196, 5.551272472497187, 5.6504256260830825, 5.529786131339078, 5.364008154251536, 5.429140047283301, 5.484699735627959, 5.6373797819859135, 5.152510368127456, 5.49875158462656, 5.429210656842226, 5.6560443000320655, 5.209249822294978, 5.256743239862986, 5.443919421111117, 5.482317620853275, 5.601106028432712, 5.345334726367753, 5.385866312285627, 5.236812233224713, 5.1046473443846425, 5.55731034221196, 5.519060052832776, 5.3665207359121, 5.498514190076904, 5.522006617171711, 5.327905272341794, 5.515337918521594, 5.382907556670778, 5.513523302266238, 5.380925343967597, 5.39347518044, 5.276768909225914, 5.557288723699651, 5.478738774603521, 5.701544072123546, 5.58306291050079, 5.3079913055764205, 5.379259472780085, 5.120753708190342], "episode_lengths": [56, 68, 87, 47, 127, 57, 60, 69, 61, 62, 59, 70, 54, 54, 63, 86, 108, 47, 60, 59, 51, 111, 65, 104, 58, 63, 62, 62, 161, 56, 49, 46, 60, 72, 60, 96, 69, 45, 76, 47, 65, 69, 85, 46, 74, 51, 56, 123, 10, 51, 72, 54, 72, 56, 57, 60, 48, 70, 51, 73, 67, 51, 82, 57, 61, 56, 46, 65, 64, 88, 92, 47, 56, 52, 57, 58, 64, 68, 68, 57, 67, 65, 78, 58, 63, 98, 59, 39, 104, 41, 59, 75, 87, 51, 45, 53, 45, 87, 43, 104, 58, 59, 122, 97, 42, 97, 67, 41, 83, 96, 43, 49, 93, 66, 60, 62, 54, 46, 93]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29267614313714313, "mean_inference_ms": 1.5974659290987157, "mean_action_processing_ms": 0.1502690122984143, "mean_env_wait_ms": 2.949741074860482, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1470528, "agent_timesteps_total": 1470528, "timers": {"sample_time_ms": 6316.707, "sample_throughput": 1265.216, "load_time_ms": 3.173, "load_throughput": 2518870.563, "learn_time_ms": 6119.715, "learn_throughput": 1305.943, "update_time_ms": 2.907}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03140995278954506, "policy_loss": -0.018513105809688568, "vf_loss": 0.046200282871723175, "vf_explained_var": 0.8419854640960693, "kl": 0.01861388422548771, "entropy": -0.08840657770633698, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1470528, "num_agent_steps_sampled": 1470528, "num_steps_trained": 1470528, "num_agent_steps_trained": 1470528}, "done": false, "episodes_total": 17312, "training_iteration": 184, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-16-58", "timestamp": 1716405418, "time_this_iter_s": 12.971049547195435, "time_total_s": 2459.5848162174225, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2459.5848162174225, "timesteps_since_restore": 0, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 34.33888888888888, "ram_util_percent": 33.80555555555555}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.671855138412967, "episode_reward_min": 5.143549218388495, "episode_reward_mean": 5.426449149465471, "episode_len_mean": 73.16216216216216, "episode_media": {}, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2496113116276342, "reward_component_totals/rejoin_dist_change_reward_min": 0.9874296766408712, "reward_component_totals/rejoin_dist_change_reward_max": 1.4933961082150944, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9268378378378377, "reward_component_totals/success_reward_min": 1.8599999999999999, "reward_component_totals/success_reward_max": 1.96}, "hist_stats": {"episode_reward": [5.548240540369989, 5.323952904803598, 5.564743840470954, 5.244081375062152, 5.608659785229634, 5.666278105752397, 5.54554404846155, 5.533236212983686, 5.143549218388495, 5.480161977379257, 5.394703276393628, 5.402706782824838, 5.629646427497018, 5.480773669391156, 5.307857206600778, 5.395039130082899, 5.364693385723843, 5.285164230568057, 5.502768960782525, 5.485962317773925, 5.611980315285953, 5.360829126965035, 5.313682229998812, 5.587394900824034, 5.3267241433588275, 5.58871934675302, 5.425765646831582, 5.201225483293481, 5.608478839329167, 5.392792766501747, 5.63425775075125, 5.236812949554704, 5.299002246664248, 5.671855138412967, 5.226195915142439, 5.286201084814138, 5.525255490430807, 5.401232778129951, 5.631266201147861, 5.6542475818095514, 5.51247875887843, 5.260626964846731, 5.242143831376759, 5.208107892931196, 5.565100604894969, 5.377645353380304, 5.579273948749996, 5.481607493308822, 5.594901827085615, 5.596635627028633, 5.4937980323700035, 5.28942740650996, 5.195429676640871, 5.292015919125984, 5.211805653515516, 5.550807174424529, 5.607229497392241, 5.441549668153478, 5.483418298294879, 5.4855030234986355, 5.670871138806739, 5.245257899083149, 5.4083050308738665, 5.551594315269534, 5.273046610379682, 5.65133864679642, 5.269748405465489, 5.185644092606431, 5.558195002839028, 5.316358930454854, 5.657396108215094, 5.415263606801204, 5.520412189511487, 5.429083751129795, 5.628777895599863, 5.530770974688233, 5.452549457175259, 5.3784386017549375, 5.301225357502695, 5.398811110547287, 5.493560030039292, 5.386230750396055, 5.1817667618798495, 5.274821365800326, 5.586726435845987, 5.461218689367539, 5.314450669157495, 5.234787398293589, 5.262838115321345, 5.319776362567435, 5.280873538567317, 5.595878202686553, 5.429042560224614, 5.339154065741141, 5.618043940465059, 5.36806077144025, 5.392680899208446, 5.38781598818605, 5.430008946139127, 5.380508490269408, 5.51093188237411, 5.223533627209047, 5.227486000761438, 5.55194007036285, 5.540963595051746, 5.2797789062458556, 5.297318968027506, 5.461658012744333, 5.340840478143827, 5.630933895109281, 5.327947062591928], "episode_lengths": [75, 42, 49, 97, 69, 63, 72, 136, 101, 53, 85, 61, 60, 45, 91, 113, 53, 52, 51, 57, 93, 71, 67, 50, 100, 140, 122, 40, 111, 77, 52, 58, 58, 50, 69, 54, 52, 108, 67, 68, 120, 62, 98, 75, 80, 55, 95, 53, 49, 83, 77, 77, 42, 104, 66, 56, 50, 65, 114, 44, 65, 97, 87, 57, 65, 85, 51, 75, 71, 81, 86, 60, 111, 59, 65, 110, 93, 69, 55, 63, 43, 60, 67, 94, 50, 115, 86, 67, 77, 45, 48, 47, 46, 70, 116, 58, 123, 102, 88, 111, 51, 72, 52, 50, 49, 70, 88, 73, 73, 73, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29207105247809406, "mean_inference_ms": 1.5962898546392927, "mean_action_processing_ms": 0.1503025666937102, "mean_env_wait_ms": 2.949478543616618, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1478520, "agent_timesteps_total": 1478520, "timers": {"sample_time_ms": 6358.049, "sample_throughput": 1256.989, "load_time_ms": 3.156, "load_throughput": 2532534.324, "learn_time_ms": 6139.495, "learn_throughput": 1301.736, "update_time_ms": 2.928}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.028826996684074402, "policy_loss": -0.010466034524142742, "vf_loss": 0.03629908338189125, "vf_explained_var": 0.8642414212226868, "kl": 0.014969722367823124, "entropy": -0.03221268579363823, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1478520, "num_agent_steps_sampled": 1478520, "num_steps_trained": 1478520, "num_agent_steps_trained": 1478520}, "done": false, "episodes_total": 17423, "training_iteration": 185, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-17-12", "timestamp": 1716405432, "time_this_iter_s": 13.490703344345093, "time_total_s": 2473.0755195617676, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2473.0755195617676, "timesteps_since_restore": 0, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 35.178947368421056, "ram_util_percent": 33.9}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.700299313819242, "episode_reward_min": 0.2340153457626959, "episode_reward_mean": 5.373280288505238, "episode_len_mean": 68.23931623931624, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9914529914529915, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.008547008547008548, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9829059829059832, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24786324786324787, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2362631944881435, "reward_component_totals/rejoin_dist_change_reward_min": 0.9619309231264028, "reward_component_totals/rejoin_dist_change_reward_max": 1.509299313819242, "reward_component_totals/failure_reward_mean": -0.008547008547008548, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.914794871794872, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.964, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.6592080823557325, 5.311423347028031, 5.221954534257174, 5.299196880451454, 5.608374638872059, 5.221550631207114, 5.482475292889168, 5.49973082516879, 5.6162715720213825, 5.190845744967884, 5.443608752645309, 5.555435608786947, 5.46386264729199, 5.346063631493811, 5.364659187626101, 5.43375238056283, 5.337764062820433, 5.45708036590532, 5.285611670379705, 5.604988422903456, 5.2972121471910185, 5.664997202102104, 5.270360579332818, 5.594218289788552, 5.282073133981657, 5.226655298960161, 5.498544050724445, 5.532923613593104, 5.597184634715493, 5.227670261247366, 5.263814462308495, 5.3383521224972075, 5.31024440669502, 5.682387874572836, 5.641282361518179, 5.405887204095425, 5.293052289840373, 5.233391225436831, 5.478654247136527, 5.550582793095962, 5.234013093724684, 5.432489172802713, 5.612499882787874, 5.446272605495276, 5.302207614914273, 5.375599995597853, 5.360157807423803, 5.428226897121481, 5.578483979552535, 5.635548180410113, 5.59775668651832, 5.623142762289917, 5.600821340876239, 5.2418657096237045, 5.316002402408111, 5.334596425380882, 5.692072401646014, 5.355135117678008, 5.489820193534064, 5.5322240777394, 5.2222044057777275, 5.588484108281812, 5.623477661408433, 5.540408377466447, 5.50760584795681, 5.411046849954367, 5.516850450404592, 5.296114222740616, 5.192378158328897, 5.329306334197314, 5.526067610765205, 5.338312331212989, 5.578608358672158, 5.494380809157443, 5.700299313819242, 5.546617780143562, 0.2340153457626959, 5.378288591292291, 5.243693066141598, 5.249672113690649, 5.298626221666761, 5.606031391478105, 5.577183011303793, 5.621919894520729, 5.175472353942823, 5.676469095860588, 5.595993037524666, 5.461836664145768, 5.429545771287191, 5.16181395618251, 5.302003971506543, 5.370939963097122, 5.413688039345145, 5.176214344451283, 5.582444394824023, 5.32735501572175, 5.615570578686786, 5.640018207628954, 5.539578226173003, 5.216891195950472, 5.60280618049781, 5.4637283256835785, 5.130281068866449, 5.187261997226882, 5.423332368497901, 5.425650065638562, 5.219065884092819, 5.145034267628843, 5.367398539145528, 5.230127156880625, 5.39257555791472, 5.42131228774787, 5.127930923126403, 5.380472063308212, 5.1890406971529455, 5.284817094880939, 5.393249378356341], "episode_lengths": [54, 82, 36, 123, 54, 53, 62, 96, 66, 83, 72, 73, 61, 86, 57, 54, 77, 42, 105, 111, 78, 67, 46, 97, 46, 86, 69, 56, 68, 63, 53, 46, 79, 61, 52, 63, 59, 42, 75, 130, 69, 53, 51, 53, 49, 87, 73, 45, 53, 57, 63, 48, 79, 80, 86, 42, 59, 61, 106, 54, 47, 105, 61, 49, 60, 41, 51, 76, 106, 52, 45, 86, 47, 94, 59, 49, 15, 55, 95, 45, 52, 69, 47, 114, 65, 60, 50, 75, 52, 59, 78, 67, 74, 85, 75, 86, 89, 54, 54, 44, 75, 131, 107, 98, 71, 75, 55, 104, 61, 57, 50, 71, 84, 64, 116, 73, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29232745231844587, "mean_inference_ms": 1.597586574330232, "mean_action_processing_ms": 0.15032256630109908, "mean_env_wait_ms": 2.95114383990949, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1486512, "agent_timesteps_total": 1486512, "timers": {"sample_time_ms": 6449.655, "sample_throughput": 1239.136, "load_time_ms": 3.217, "load_throughput": 2484279.309, "learn_time_ms": 6191.052, "learn_throughput": 1290.895, "update_time_ms": 2.911}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.037703294306993484, "policy_loss": -0.013289546594023705, "vf_loss": 0.04724135249853134, "vf_explained_var": 0.8286365866661072, "kl": 0.018757443875074387, "entropy": -0.05897156149148941, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1486512, "num_agent_steps_sampled": 1486512, "num_steps_trained": 1486512, "num_agent_steps_trained": 1486512}, "done": false, "episodes_total": 17540, "training_iteration": 186, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-17-26", "timestamp": 1716405446, "time_this_iter_s": 13.840251684188843, "time_total_s": 2486.9157712459564, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2486.9157712459564, "timesteps_since_restore": 0, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 34.86, "ram_util_percent": 33.89999999999999}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.691798565796961, "episode_reward_min": 5.134275053313733, "episode_reward_mean": 5.461001088344606, "episode_len_mean": 69.09482758620689, "episode_media": {}, "episodes_this_iter": 116, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2800959159308123, "reward_component_totals/rejoin_dist_change_reward_min": 0.9375808714761102, "reward_component_totals/rejoin_dist_change_reward_max": 1.508062121099558, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.930905172413793, "reward_component_totals/success_reward_min": 1.867, "reward_component_totals/success_reward_max": 1.9609999999999999}, "hist_stats": {"episode_reward": [5.203444595647975, 5.515250331627807, 5.188326743044334, 5.573604813013467, 5.552651125157976, 5.4540897927423675, 5.342013712337675, 5.418660353683878, 5.5036320980002325, 5.44095174396918, 5.552114374116197, 5.631317223632179, 5.651002344428219, 5.441310141349891, 5.354479790670873, 5.658174066812979, 5.4699851214054265, 5.585826965026937, 5.285199108978022, 5.138644122873206, 5.451600166178076, 5.485525897097352, 5.432411054284753, 5.643973882745051, 5.40928425048865, 5.4499566901911045, 5.67993544789379, 5.269917200847565, 5.264070307162934, 5.691798565796961, 5.491283738013794, 5.572575395644301, 5.485603915223685, 5.445530218005211, 5.353765347892049, 5.532286041221033, 5.224146625496854, 5.42249568803642, 5.640449053841657, 5.679093638168112, 5.491593343966519, 5.3622971084410604, 5.649233164808976, 5.4202038314896495, 5.5238527826770465, 5.5414522282915115, 5.501767464503642, 5.497496960126806, 5.146580871476111, 5.300168677356324, 5.603282580253878, 5.624421188803301, 5.5987326708319864, 5.567459459402647, 5.637364516957236, 5.190458592872755, 5.478440591617286, 5.3259364461198135, 5.415339032612813, 5.591806262578537, 5.300905089280937, 5.338281039265427, 5.494735390227994, 5.284576563545588, 5.564376468681074, 5.662781363672036, 5.548162818278316, 5.631399624713156, 5.39351506169257, 5.575792958353724, 5.664796741895955, 5.453911651552431, 5.326928803585705, 5.674062121099557, 5.522709678211976, 5.338831469500756, 5.540569849680466, 5.4409098475584505, 5.299321580385136, 5.62351741482488, 5.637835202888827, 5.418408490275041, 5.224715119257999, 5.558089305247826, 5.203290640842928, 5.245029210145539, 5.2244080395247465, 5.277275729823424, 5.608368008044599, 5.602498964440176, 5.652995808248132, 5.474832017906358, 5.271397832425728, 5.683661717323732, 5.561514072006053, 5.548043901548157, 5.387175919830571, 5.486624195036223, 5.444882206129888, 5.3277182017495734, 5.288085159253613, 5.294146878783286, 5.250673463995472, 5.560805363775159, 5.134275053313733, 5.543020671346506, 5.533205110700262, 5.422244245335798, 5.494625249860737, 5.4467830597506035, 5.304796681184083, 5.428628820371636, 5.341668810385121, 5.652412182438384, 5.657489761161749, 5.5501461496803834], "episode_lengths": [96, 50, 103, 82, 46, 61, 48, 76, 88, 56, 52, 51, 50, 47, 70, 53, 91, 50, 58, 110, 49, 93, 41, 47, 47, 79, 68, 66, 47, 55, 92, 86, 63, 53, 58, 84, 81, 49, 51, 64, 45, 67, 56, 46, 119, 59, 98, 54, 41, 82, 47, 74, 107, 133, 61, 63, 83, 100, 70, 63, 72, 106, 60, 86, 68, 84, 48, 59, 55, 92, 53, 59, 63, 84, 59, 58, 45, 50, 83, 65, 50, 50, 68, 87, 39, 65, 67, 50, 85, 56, 74, 62, 123, 54, 116, 53, 51, 49, 55, 44, 62, 62, 76, 95, 69, 113, 104, 47, 106, 109, 70, 111, 77, 60, 64, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2934667030073535, "mean_inference_ms": 1.5981734927253795, "mean_action_processing_ms": 0.15042489418352517, "mean_env_wait_ms": 2.9525456381358786, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1494504, "agent_timesteps_total": 1494504, "timers": {"sample_time_ms": 6592.238, "sample_throughput": 1212.335, "load_time_ms": 3.219, "load_throughput": 2483046.361, "learn_time_ms": 6232.126, "learn_throughput": 1282.387, "update_time_ms": 2.919}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.026772694662213326, "policy_loss": -0.013357880525290966, "vf_loss": 0.03740181028842926, "vf_explained_var": 0.8572998046875, "kl": 0.013643800280988216, "entropy": -0.051024336367845535, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1494504, "num_agent_steps_sampled": 1494504, "num_steps_trained": 1494504, "num_agent_steps_trained": 1494504}, "done": false, "episodes_total": 17656, "training_iteration": 187, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-17-40", "timestamp": 1716405460, "time_this_iter_s": 13.911225080490112, "time_total_s": 2500.8269963264465, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2500.8269963264465, "timesteps_since_restore": 0, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 35.415, "ram_util_percent": 33.915}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.7070061300301305, "episode_reward_min": -0.03034543461316075, "episode_reward_mean": 5.387945715133506, "episode_len_mean": 69.46902654867256, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9911504424778761, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.008849557522123894, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9823008849557524, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24778761061946902, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2537156266379315, "reward_component_totals/rejoin_dist_change_reward_min": 0.9382638325233881, "reward_component_totals/rejoin_dist_change_reward_max": 1.51200613003013, "reward_component_totals/failure_reward_mean": -0.008849557522123894, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.912991150442478, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.96, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.557316764699209, 5.55134981820958, 5.593246818064091, 5.38225480249097, 5.613544812930383, 5.573811222757491, 5.454355795831479, 5.551999056898414, 5.389635556832232, 5.459170521051689, 5.507581524312202, 5.327154237412666, 5.698032981192485, 5.275211751294631, 5.39577811955812, 5.364789132153648, 5.613002062348022, 5.597822157008004, 5.459799799618487, 5.3164107217757905, 5.4224188921713985, 5.420896692978868, 5.527851578896508, 5.229289061396176, 5.591416271490993, 5.563288438451755, 5.571990768470942, 5.535895500201633, 5.304891168766639, 5.512860088351115, 5.554189895943358, 5.139263832523389, 5.6223582755688355, 5.560318697597856, 5.477121679363101, 5.390672063572616, 5.390180566726018, 5.36113955320525, 5.643409046098919, 5.379154577303172, 5.603993134737031, 5.494940214402288, 5.2200969903392425, 5.482747161731075, 5.519547784604802, 5.304965669414164, 5.449410875900213, 5.25709986021897, 5.266306734471193, 5.26533760878874, 5.615133339490709, 5.457544470666507, 5.158980189868982, 5.239771033640563, 5.539403773326593, 5.425618910844858, 5.283639655178222, 5.409188928390133, 5.424546010744095, 5.361764228574198, 5.526214576236068, 5.342963156199836, 5.672162001234331, 5.4064217975407844, 5.257303145598544, 5.262635346151322, 5.372286893010736, 5.532073835825264, -0.03034543461316075, 5.270799868434648, 5.3441384410524435, 5.547972718214874, 5.491470827217299, 5.425627861553515, 5.296139640327331, 5.422945084314598, 5.351152985545008, 5.400884036886518, 5.582443506190408, 5.179240286163426, 5.4893777110444315, 5.500644630030596, 5.427908035535304, 5.3589020424549485, 5.7070061300301305, 5.319763244591538, 5.222432117865052, 5.312879786785899, 5.463963908177435, 5.531945179038642, 5.146669686984769, 5.462725449091123, 5.63640940068052, 5.447265483317485, 5.416996840708627, 5.279470766263028, 5.257671862182356, 5.330308222046709, 5.358431107567176, 5.560933271602453, 5.604058016760968, 5.546698698095282, 5.516738029881624, 5.387706505874501, 5.576392692486765, 5.162832285955886, 5.568862600558424, 5.446579327161846, 5.41994212002832, 5.689897599697272, 5.559053657280822, 5.367555178638171, 5.444402767733658], "episode_lengths": [46, 83, 78, 87, 110, 136, 83, 49, 53, 44, 137, 60, 60, 45, 64, 75, 56, 47, 87, 93, 60, 56, 97, 53, 87, 90, 69, 58, 75, 71, 45, 49, 69, 50, 80, 139, 62, 50, 52, 64, 63, 47, 64, 50, 94, 42, 66, 66, 82, 114, 53, 58, 52, 89, 77, 75, 79, 77, 73, 69, 94, 84, 51, 42, 133, 151, 46, 80, 18, 40, 59, 61, 54, 50, 51, 66, 99, 67, 65, 90, 44, 47, 76, 59, 55, 41, 64, 98, 47, 84, 43, 62, 102, 62, 49, 95, 50, 60, 50, 58, 70, 100, 63, 66, 66, 72, 77, 57, 83, 70, 104, 63, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2924387125900324, "mean_inference_ms": 1.5992336222782328, "mean_action_processing_ms": 0.15056717919038534, "mean_env_wait_ms": 2.954882529903172, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1502496, "agent_timesteps_total": 1502496, "timers": {"sample_time_ms": 6856.771, "sample_throughput": 1165.563, "load_time_ms": 3.414, "load_throughput": 2340876.099, "learn_time_ms": 7015.792, "learn_throughput": 1139.144, "update_time_ms": 3.141}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.034305453300476074, "policy_loss": -0.017513055354356766, "vf_loss": 0.04864406958222389, "vf_explained_var": 0.83499675989151, "kl": 0.015872182324528694, "entropy": -0.025965437293052673, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1502496, "num_agent_steps_sampled": 1502496, "num_steps_trained": 1502496, "num_agent_steps_trained": 1502496}, "done": false, "episodes_total": 17769, "training_iteration": 188, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-18-02", "timestamp": 1716405482, "time_this_iter_s": 22.43115258216858, "time_total_s": 2523.258148908615, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2523.258148908615, "timesteps_since_restore": 0, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 43.134375, "ram_util_percent": 34.165625000000006}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.709632220610606, "episode_reward_min": -0.09173539815660725, "episode_reward_mean": 5.40898435552938, "episode_len_mean": 70.33043478260869, "episode_media": {}, "episodes_this_iter": 115, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.991304347826087, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.008695652173913044, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9826086956521742, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24782608695652175, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.274766964225033, "reward_component_totals/rejoin_dist_change_reward_min": 0.9082646018433927, "reward_component_totals/rejoin_dist_change_reward_max": 1.5116322206106063, "reward_component_totals/failure_reward_mean": -0.008695652173913044, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9124782608695654, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.963, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.151914353447492, 5.451607161571987, 5.199440531691129, 5.513366329197558, 5.4921292289335355, 5.35839283349714, 5.497897514079222, 5.278940935144092, 5.4646954520551265, 5.658552621933414, 5.280175743461385, 5.451258496893065, 5.63918878932628, 5.567457328940623, 5.340275289879813, 5.08194033102634, 5.666197331445002, 5.3290760350810285, 5.6691257340309456, 5.4887026676238, 5.548905513083176, 5.460596625765068, 5.194079125091326, 5.662922348815695, 5.378031743197279, 5.604150179501055, 5.587398819904557, 5.694449063892611, 5.584398208372942, 5.658921690799064, 5.247661941149432, 5.608111846492313, 5.606878995269573, 5.472519263576181, 5.2590047410747065, 5.3334440141801975, 5.366356184686394, 5.635692267260993, 5.622233937697455, 5.532677681478457, 5.472280956385173, 5.4559640846382225, 5.709632220610606, 5.3235640708721235, 5.253790815400869, 5.514075851888627, 5.56824505041434, 5.245990694318413, 5.406796336250672, 5.260920914782407, 5.654007371976158, 5.338703077083386, 5.481648833233247, 5.644950637859374, 5.498814742020426, 5.449313225755653, 5.488748117883738, 5.348772311736322, 5.42125218273771, 5.405455755829792, 5.402648476962812, 5.27409076163906, 5.612149968079642, 5.406143019195005, 5.582882895547595, 5.187220259275512, 5.638284636219774, 5.493872822448616, 5.645287678287541, 5.451734790962064, 5.448928441401244, 5.596408115466961, 5.425983158978093, 5.213286892622049, 5.509387507617937, 5.533829251713269, 5.359004341321303, 5.595923090959982, -0.09173539815660725, 5.469141665815887, 5.315534503104239, 5.548017438420159, 5.196408384790723, 5.355418810958669, 5.434212676186938, 5.3945384288941955, 5.583759242395751, 5.233676618313469, 5.2617365290083855, 5.617122865530746, 5.645425779466597, 5.211946907709665, 5.396714999941993, 5.686935950365019, 5.42293117871308, 5.657534095835736, 5.494639132535923, 5.550694922953435, 5.538067388613241, 5.336104113872295, 5.418235717923577, 5.68434687559931, 5.605250887583447, 5.515988147716831, 5.509761862929768, 5.266381599264374, 5.50895651349998, 5.149056670262293, 5.6233045605068614, 5.530044107856672, 5.224109633988174, 5.32077397233279, 5.671056976228155, 5.5695184252224905, 5.218826438771381], "episode_lengths": [60, 63, 58, 51, 103, 48, 76, 45, 47, 68, 37, 52, 51, 127, 74, 117, 48, 93, 70, 83, 100, 102, 39, 74, 95, 77, 55, 57, 52, 61, 65, 64, 53, 67, 104, 40, 68, 71, 118, 88, 45, 96, 52, 84, 61, 55, 61, 62, 86, 71, 59, 76, 101, 77, 57, 54, 47, 55, 69, 109, 89, 66, 54, 50, 101, 70, 61, 158, 59, 50, 123, 52, 45, 80, 57, 81, 113, 87, 23, 62, 82, 75, 65, 46, 57, 62, 52, 86, 55, 51, 56, 87, 119, 64, 69, 53, 65, 60, 87, 59, 55, 52, 125, 49, 69, 61, 42, 83, 56, 129, 64, 89, 45, 58, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2946628721355133, "mean_inference_ms": 1.6037667301675818, "mean_action_processing_ms": 0.15098793773150251, "mean_env_wait_ms": 2.9624144506965435, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1510488, "agent_timesteps_total": 1510488, "timers": {"sample_time_ms": 7304.727, "sample_throughput": 1094.086, "load_time_ms": 3.528, "load_throughput": 2265536.467, "learn_time_ms": 7095.566, "learn_throughput": 1126.337, "update_time_ms": 3.157}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04722170904278755, "policy_loss": -0.017426839098334312, "vf_loss": 0.0615256167948246, "vf_explained_var": 0.8049154877662659, "kl": 0.015614689327776432, "entropy": -0.04768773540854454, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1510488, "num_agent_steps_sampled": 1510488, "num_steps_trained": 1510488, "num_agent_steps_trained": 1510488}, "done": false, "episodes_total": 17884, "training_iteration": 189, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-18-19", "timestamp": 1716405499, "time_this_iter_s": 17.04642653465271, "time_total_s": 2540.304575443268, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2540.304575443268, "timesteps_since_restore": 0, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 41.474999999999994, "ram_util_percent": 34.54583333333333}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.703975821100059, "episode_reward_min": 0.14646109557457354, "episode_reward_mean": 5.341893397346253, "episode_len_mean": 70.58928571428571, "episode_media": {}, "episodes_this_iter": 112, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9821428571428571, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.017857142857142856, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9642857142857146, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24553571428571427, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2558755402033956, "reward_component_totals/rejoin_dist_change_reward_min": 0.9471500991311343, "reward_component_totals/rejoin_dist_change_reward_max": 1.5109758211000583, "reward_component_totals/failure_reward_mean": -0.017857142857142856, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.8940535714285713, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.9609999999999999, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.135390378692868, 5.208301579645553, 5.260683247554333, 5.502905686552775, 5.387142616774849, 5.468208615421534, 5.4056296290532435, 5.583062434077298, 5.573626416442114, 5.585366516117842, 5.619148532325597, 5.208210611368595, 5.287432525684737, 5.589771317725029, 5.203340721191125, 5.522799733444867, 5.243121716894459, 5.151248509232252, 5.464249567952063, 5.213365514485128, 5.597602264640385, 5.628326055253224, 5.331694077875776, 5.435916201119217, 5.53820214434655, 5.308983168064341, 5.5087921878698065, 5.571327988353367, 5.616466229718933, 5.406954377362591, 5.118219538869528, 5.703975821100059, 5.372841662386884, 5.216193636019684, 5.359030309915731, 5.262447108074325, 5.582123624558486, 5.403136605825198, 5.591692576412859, 5.6480883664562525, 5.185781153536443, 5.617909857004154, 5.589281269975446, 5.512701841374318, 5.168092075450922, 5.429004852835169, 5.380065336056738, 5.371461260093177, 5.478660261906147, 5.451448318947121, 5.6033569000137025, 5.551006813234347, 5.1911618539197395, 5.376358494381023, 5.536437644098312, 5.414401646399787, 5.480934109139618, 5.26435203728904, 5.154150099131135, 5.520539173860978, 0.15143184853612301, 5.53202399150474, 5.569985559276077, 5.428024505786068, 5.287443375204918, 5.381479288176431, 5.452163905428529, 5.543110096795105, 5.679723429247918, 5.241007657906606, 5.504825339239927, 5.6949008632468345, 5.505472369084835, 5.521113371182158, 5.503276972624871, 5.540442936379928, 5.2848372422863985, 5.468507881964898, 5.398958253618517, 5.317758802927662, 5.242873449128677, 5.4054212657445575, 5.241407081786352, 5.520906208135794, 0.14646109557457354, 5.222744052319219, 5.626554287783436, 5.362315880200367, 5.261023420443918, 5.3163941359653855, 5.58886499718574, 5.220651237624272, 5.6310058044456, 5.30545558965707, 5.1799517271204625, 5.451957396582674, 5.561168252974459, 5.454315055414458, 5.258002938318427, 5.611713573405615, 5.555266596902335, 5.567059490237764, 5.649381046508841, 5.653137278793559, 5.407216846600612, 5.652283614220243, 5.4265009675937135, 5.676666772340353, 5.494364287057678, 5.596022552177365, 5.417158003925609, 5.489203092685866], "episode_lengths": [62, 78, 65, 63, 61, 59, 105, 114, 111, 69, 57, 85, 94, 50, 73, 65, 49, 60, 97, 79, 113, 61, 84, 67, 119, 40, 51, 55, 48, 141, 105, 57, 54, 43, 69, 57, 58, 122, 83, 59, 42, 71, 102, 81, 90, 55, 44, 55, 85, 59, 86, 49, 77, 93, 54, 63, 112, 96, 43, 62, 19, 48, 95, 51, 65, 103, 96, 55, 72, 103, 52, 55, 68, 135, 67, 69, 42, 66, 68, 41, 59, 49, 72, 46, 21, 116, 69, 55, 113, 42, 78, 63, 52, 94, 64, 61, 52, 50, 77, 57, 82, 103, 62, 55, 39, 59, 103, 57, 56, 55, 76, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2916269217465963, "mean_inference_ms": 1.6033293958292778, "mean_action_processing_ms": 0.1510025298182259, "mean_env_wait_ms": 2.9619762947043364, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1518480, "agent_timesteps_total": 1518480, "timers": {"sample_time_ms": 7344.506, "sample_throughput": 1088.16, "load_time_ms": 3.552, "load_throughput": 2250025.344, "learn_time_ms": 7139.386, "learn_throughput": 1119.424, "update_time_ms": 3.15}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04230891540646553, "policy_loss": -0.018472636118531227, "vf_loss": 0.05684090778231621, "vf_explained_var": 0.8267518877983093, "kl": 0.019703252241015434, "entropy": 0.02999986708164215, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1518480, "num_agent_steps_sampled": 1518480, "num_steps_trained": 1518480, "num_agent_steps_trained": 1518480}, "done": false, "episodes_total": 17996, "training_iteration": 190, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-18-33", "timestamp": 1716405513, "time_this_iter_s": 13.452789545059204, "time_total_s": 2553.757364988327, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2553.757364988327, "timesteps_since_restore": 0, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 34.239999999999995, "ram_util_percent": 34.455}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.688312040189993, "episode_reward_min": 5.110926979024288, "episode_reward_mean": 5.448885935707963, "episode_len_mean": 73.60550458715596, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2724914402951204, "reward_component_totals/rejoin_dist_change_reward_min": 0.9424379160953802, "reward_component_totals/rejoin_dist_change_reward_max": 1.5109715455027795, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.926394495412844, "reward_component_totals/success_reward_min": 1.855, "reward_component_totals/success_reward_max": 1.96}, "hist_stats": {"episode_reward": [5.516216004593163, 5.454252648275738, 5.623197225835291, 5.425636158603179, 5.554913413951124, 5.5308020545412475, 5.544394841394339, 5.608274584770497, 5.269573353667638, 5.501650966810438, 5.642055164095472, 5.528272146131919, 5.238847829293257, 5.4847951748497366, 5.516103269538186, 5.347061955840829, 5.467973429514217, 5.474466435471166, 5.382329850792433, 5.281468983873157, 5.688312040189993, 5.673594809513744, 5.36658477297312, 5.527817692087702, 5.529174387115137, 5.155036996192543, 5.610966589729216, 5.591841966207583, 5.602817164602868, 5.3670136877961845, 5.619372528617204, 5.252411241737715, 5.686164308910596, 5.219142292975935, 5.665114895605216, 5.482246472848239, 5.14543791609538, 5.476874232173167, 5.469280262880817, 5.513658719633346, 5.548561955124808, 5.611361722253131, 5.656546628345303, 5.642887995322436, 5.3253008325533155, 5.14906713510713, 5.222953061558027, 5.273972722485829, 5.612729192436608, 5.44817869361668, 5.232138354340858, 5.54180751976048, 5.233081609093094, 5.53063605199503, 5.310454494114547, 5.391115867277964, 5.4192717523514204, 5.190437648031475, 5.335696430753041, 5.319817358810253, 5.5528626181550536, 5.680971545502779, 5.475401148954351, 5.61302270582167, 5.581070770449445, 5.234344879981914, 5.515984714575271, 5.3288862219164965, 5.661101430881629, 5.1471841474582405, 5.56275909958463, 5.343331392771864, 5.459486661794259, 5.333758176711388, 5.571005570190065, 5.59778974999201, 5.34726106691357, 5.365431443628573, 5.657852297040119, 5.619937719114392, 5.471905687794194, 5.4113891628013695, 5.32830440302441, 5.396919570919824, 5.496547507728398, 5.560029156383472, 5.424991678191453, 5.134107880234485, 5.587500210130415, 5.6552861099344724, 5.512281584524299, 5.496897595898005, 5.198833339376449, 5.408900978305473, 5.297509636664797, 5.327150098033225, 5.549096464477569, 5.5403740010885425, 5.333944616221068, 5.464200990198297, 5.528108154906361, 5.646603690253857, 5.363634981113345, 5.110926979024288, 5.5473490644474035, 5.311440440939691, 5.302419786582981, 5.5314612354998145, 5.3098431309722836], "episode_lengths": [145, 110, 50, 72, 142, 52, 43, 61, 47, 91, 83, 121, 41, 55, 115, 68, 83, 49, 85, 71, 58, 57, 40, 84, 116, 88, 47, 90, 92, 55, 93, 57, 60, 83, 53, 62, 47, 63, 49, 53, 119, 65, 51, 56, 80, 97, 68, 51, 59, 62, 74, 100, 77, 57, 93, 77, 68, 41, 64, 63, 62, 80, 88, 56, 102, 62, 109, 83, 68, 61, 107, 57, 80, 89, 127, 87, 62, 58, 54, 70, 45, 49, 106, 61, 62, 51, 94, 66, 127, 53, 86, 47, 46, 114, 55, 76, 67, 67, 43, 102, 61, 61, 57, 101, 59, 117, 54, 74, 107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29401434452581426, "mean_inference_ms": 1.6038046772564494, "mean_action_processing_ms": 0.15101794332258087, "mean_env_wait_ms": 2.963859790234146, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1526472, "agent_timesteps_total": 1526472, "timers": {"sample_time_ms": 7490.106, "sample_throughput": 1067.008, "load_time_ms": 3.569, "load_throughput": 2239457.892, "learn_time_ms": 7367.279, "learn_throughput": 1084.797, "update_time_ms": 3.224}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.024909475818276405, "policy_loss": -0.01694672927260399, "vf_loss": 0.03853217139840126, "vf_explained_var": 0.8540624976158142, "kl": 0.016620179638266563, "entropy": 0.04180922731757164, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1526472, "num_agent_steps_sampled": 1526472, "num_steps_trained": 1526472, "num_agent_steps_trained": 1526472}, "done": false, "episodes_total": 18105, "training_iteration": 191, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-18-48", "timestamp": 1716405528, "time_this_iter_s": 15.697864294052124, "time_total_s": 2569.455229282379, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2569.455229282379, "timesteps_since_restore": 0, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 37.17727272727273, "ram_util_percent": 34.5}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.693962378965596, "episode_reward_min": 0.14152283830662649, "episode_reward_mean": 5.411189339183913, "episode_len_mean": 69.99130434782609, "episode_media": {}, "episodes_this_iter": 115, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.991304347826087, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.008695652173913044, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9826086956521742, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24782608695652175, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2767110783143476, "reward_component_totals/rejoin_dist_change_reward_min": 0.9215906192647736, "reward_component_totals/rejoin_dist_change_reward_max": 1.5082184354514496, "reward_component_totals/failure_reward_mean": -0.008695652173913044, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9127391304347827, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.962, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.363435271896904, 5.49765432962243, 5.453935598145637, 5.361818130802942, 5.576432991219215, 5.614313525293824, 5.627189314838785, 5.395223456576388, 5.438635521657753, 5.307729926931222, 5.52183843727866, 5.251845249009262, 5.251160721256007, 5.464888546133471, 5.5292781820457835, 5.44647244597903, 5.438393225642239, 5.462724465687821, 5.357573792908391, 5.513344546727092, 5.530068827150606, 5.691276833065183, 5.532686781944351, 5.566521234098813, 5.643647576438742, 5.279461885685617, 0.14152283830662649, 5.593733421196818, 5.614341331295933, 5.578980877959799, 5.488269130797598, 5.591386301775878, 5.540691080013998, 5.538183174478195, 5.4929079376839836, 5.291096179160439, 5.436903334546634, 5.375412802050713, 5.504346288562042, 5.3228891273427825, 5.2460802943898095, 5.653559657489508, 5.395629794199591, 5.334095635860455, 5.494277803913088, 5.626151491129139, 5.243745581546097, 5.235827266928477, 5.411989754684253, 5.492060407749737, 5.630733608491507, 5.571886995535181, 5.556831339706232, 5.47329734754042, 5.488093936845003, 5.562239307116844, 5.606812291856425, 5.232450160257102, 5.494418030294185, 5.341704665202363, 5.608265876321958, 5.397635072343189, 5.661143514467121, 5.536024432878209, 5.080590619264774, 5.495281913837933, 5.238474823651435, 5.693962378965596, 5.104270100890449, 5.544229644694884, 5.367312926439945, 5.479149888329781, 5.112225703537819, 5.163626165241615, 5.598387033493472, 5.393783371991375, 5.595260042046297, 5.28951078974931, 5.567335837983768, 5.557536927814404, 5.509894613664111, 5.365118541095528, 5.3022519953869445, 5.414631714762486, 5.309225026558053, 5.645377198781446, 5.5690270288157375, 5.240718583932553, 5.686218435451449, 5.5204229665644835, 5.537329108459569, 5.394222588450255, 5.250782607486734, 5.485425024396439, 5.313298506805339, 5.441325454904223, 5.2082077805206275, 5.611594351552723, 5.676389535097629, 5.2719285333688815, 5.433495111589363, 5.537786895439837, 5.586877558304832, 5.404678932201419, 5.490720987811553, 5.631288146068366, 5.4927976586632905, 5.363539385650917, 5.484257909230168, 5.612078082786375, 5.511751156827989, 5.449469514362834, 5.4084776506243415, 5.273558902322426, 5.6484994403246676], "episode_lengths": [38, 54, 57, 75, 73, 51, 61, 41, 96, 51, 77, 53, 84, 51, 65, 59, 58, 107, 92, 51, 43, 59, 131, 111, 65, 45, 14, 103, 113, 98, 93, 93, 104, 73, 139, 90, 39, 59, 107, 59, 70, 50, 91, 48, 55, 52, 71, 53, 64, 75, 70, 53, 83, 68, 139, 110, 94, 65, 54, 43, 81, 46, 75, 48, 91, 80, 45, 56, 100, 42, 43, 41, 70, 49, 63, 61, 56, 78, 67, 71, 78, 81, 83, 40, 61, 51, 82, 57, 72, 99, 110, 59, 38, 49, 61, 58, 53, 50, 79, 70, 121, 106, 57, 52, 60, 54, 97, 51, 113, 46, 67, 78, 120, 40, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29629453081533685, "mean_inference_ms": 1.6085920535009688, "mean_action_processing_ms": 0.15132014483252013, "mean_env_wait_ms": 2.9690247965767624, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1534464, "agent_timesteps_total": 1534464, "timers": {"sample_time_ms": 7706.882, "sample_throughput": 1036.995, "load_time_ms": 3.619, "load_throughput": 2208139.176, "learn_time_ms": 7386.442, "learn_throughput": 1081.982, "update_time_ms": 3.202}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.029617609456181526, "policy_loss": -0.01643672212958336, "vf_loss": 0.0431550033390522, "vf_explained_var": 0.8480669260025024, "kl": 0.01449664868414402, "entropy": 0.043343685567379, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1534464, "num_agent_steps_sampled": 1534464, "num_steps_trained": 1534464, "num_agent_steps_trained": 1534464}, "done": false, "episodes_total": 18220, "training_iteration": 192, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-19-04", "timestamp": 1716405544, "time_this_iter_s": 15.388932466506958, "time_total_s": 2584.844161748886, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2584.844161748886, "timesteps_since_restore": 0, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 37.304545454545455, "ram_util_percent": 34.540909090909096}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.707834413405503, "episode_reward_min": 0.046634020851255786, "episode_reward_mean": 5.393628076723043, "episode_len_mean": 72.69444444444444, "episode_media": {}, "episodes_this_iter": 108, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9907407407407407, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.009259259259259259, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9814814814814818, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24768518518518517, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2647021507971183, "reward_component_totals/rejoin_dist_change_reward_min": 0.9373371342306998, "reward_component_totals/rejoin_dist_change_reward_max": 1.5208344134055023, "reward_component_totals/failure_reward_mean": -0.009259259259259259, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9090185185185182, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.962, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.257089821402728, 5.408608649108917, 5.653996659197501, 5.360513423175733, 5.198819045405607, 5.519161104210079, 5.612450710235822, 5.276637367702976, 5.504057391333383, 5.2717683584395125, 5.300184278606386, 5.2759195766309706, 5.5595037412013335, 5.551762500198449, 5.347910621055297, 5.1203371342307005, 5.246568070621877, 5.514791742002007, 5.416076837350699, 5.213502598141693, 5.4761525567864044, 5.432268372201605, 5.542934917810484, 5.378179353346317, 5.673816407849451, 5.528132088287527, 5.2540612092512475, 5.248290550187354, 5.492410415433543, 5.434286971080866, 5.405989152954568, 5.116340399318443, 5.677838032073934, 5.546690936600076, 5.372128288911987, 5.380506506567668, 5.196998557642496, 5.453236738708998, 5.707834413405503, 5.532331466466202, 5.424406292162543, 5.308084743088909, 5.61080212005729, 5.320116104650027, 5.206888396667834, 5.450526038259019, 5.475933441020624, 5.524381793361233, 5.544387808608165, 5.554922453923498, 5.56871485146665, 5.411285891721722, 5.450950072287344, 5.591522877393572, 5.464972393532592, 5.493853034617482, 5.620242113711754, 5.653820094317586, 5.325304190673072, 5.514568164943597, 5.4726555876664955, 5.09377741173453, 5.343146359711691, 5.379658004911774, 5.29082625063122, 5.421658450221795, 5.531322265042146, 5.537346912187431, 5.355261638962592, 5.649890358407577, 5.406582759567666, 5.4471608119216715, 5.361211177730817, 5.477305502545671, 5.632749689431834, 5.359281232373064, 0.046634020851255786, 5.527985252734773, 5.559414053307755, 5.4679095394624735, 5.561503002705413, 5.55977516844667, 5.6247142103710726, 5.383169986277593, 5.683131951972616, 5.59800036411924, 5.4860086002438795, 5.338253840151761, 5.524369126413729, 5.640408126660393, 5.639226744910046, 5.28108884267775, 5.6493073334140504, 5.58048228513195, 5.693858782617879, 5.668553131773976, 5.592283155966342, 5.4582978202373305, 5.18928517992368, 5.183195911904123, 5.370859528854522, 5.53421485591867, 5.254358913146149, 5.377620018269484, 5.247205991389942, 5.24264525437812, 5.310535346952765, 5.50193169025451], "episode_lengths": [70, 57, 50, 99, 79, 51, 106, 94, 67, 61, 115, 38, 108, 97, 58, 67, 46, 93, 47, 139, 93, 64, 68, 50, 52, 43, 80, 75, 49, 76, 93, 91, 62, 92, 82, 71, 65, 81, 63, 88, 56, 47, 60, 100, 50, 64, 75, 59, 52, 116, 54, 59, 82, 118, 114, 117, 68, 73, 136, 60, 60, 110, 61, 64, 55, 106, 55, 93, 59, 87, 47, 76, 80, 59, 47, 65, 25, 82, 45, 89, 48, 74, 81, 70, 48, 62, 121, 77, 66, 50, 59, 60, 69, 71, 56, 56, 74, 62, 107, 66, 46, 100, 56, 50, 105, 62, 40, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2948470906524247, "mean_inference_ms": 1.607341331707197, "mean_action_processing_ms": 0.15130462373786907, "mean_env_wait_ms": 2.9700462013047226, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1542456, "agent_timesteps_total": 1542456, "timers": {"sample_time_ms": 7806.888, "sample_throughput": 1023.711, "load_time_ms": 3.633, "load_throughput": 2199907.961, "learn_time_ms": 7478.354, "learn_throughput": 1068.684, "update_time_ms": 3.218}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.050184424966573715, "policy_loss": -0.01713528297841549, "vf_loss": 0.06419933587312698, "vf_explained_var": 0.800927460193634, "kl": 0.015601882711052895, "entropy": 0.08379508554935455, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1542456, "num_agent_steps_sampled": 1542456, "num_steps_trained": 1542456, "num_agent_steps_trained": 1542456}, "done": false, "episodes_total": 18328, "training_iteration": 193, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-19-19", "timestamp": 1716405559, "time_this_iter_s": 14.874968767166138, "time_total_s": 2599.7191305160522, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2599.7191305160522, "timesteps_since_restore": 0, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 36.099999999999994, "ram_util_percent": 34.61904761904763}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.664068058821281, "episode_reward_min": 5.119054009426778, "episode_reward_mean": 5.4526713050523385, "episode_len_mean": 72.12389380530973, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2747951988576476, "reward_component_totals/rejoin_dist_change_reward_min": 0.9190540094267767, "reward_component_totals/rejoin_dist_change_reward_max": 1.4961038604139463, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9278761061946903, "reward_component_totals/success_reward_min": 1.839, "reward_component_totals/success_reward_max": 1.9609999999999999}, "hist_stats": {"episode_reward": [5.605364033403033, 5.6598291597522055, 5.308475440342333, 5.160940666219414, 5.374833643179262, 5.25642990886314, 5.442767167615216, 5.463678420597671, 5.333144322434798, 5.556961289457387, 5.535815530890925, 5.47056439708965, 5.464437948667314, 5.1814552097121265, 5.584061210501801, 5.436522901188617, 5.3042617555345695, 5.556081022040341, 5.46177646688135, 5.4398027868503025, 5.389816629078821, 5.266388560875022, 5.5512454291369275, 5.463782041671369, 5.154514580136461, 5.5184672979841665, 5.26979596579381, 5.413380084043082, 5.416028096370675, 5.613134728843082, 5.435354998821156, 5.320841721649291, 5.645387988922948, 5.664068058821281, 5.368287662127461, 5.349037974353029, 5.468806436503503, 5.378141040671576, 5.422861630462524, 5.634621720633008, 5.169676075398483, 5.565147812929808, 5.413517439254582, 5.424424831849696, 5.586459538854054, 5.556519211660344, 5.640528864461894, 5.253672409909139, 5.2862754384777215, 5.119054009426778, 5.127630473426398, 5.584779189985474, 5.536606078372911, 5.6238001990672135, 5.538268677078019, 5.2891788225692355, 5.188394510689022, 5.615303558901136, 5.656963926054567, 5.403586434435876, 5.51109819652475, 5.228687879559097, 5.278352866290095, 5.402844804824459, 5.455301312705979, 5.514445402516133, 5.655845208222722, 5.659869858443838, 5.552347518811459, 5.347669387911259, 5.379315229912545, 5.457901110811777, 5.517516393700131, 5.492367461068717, 5.278093034005833, 5.532807049043759, 5.6509982826454745, 5.4824027373661375, 5.574594266338347, 5.614890731807888, 5.502624628775077, 5.554252628017848, 5.565442733216077, 5.4565985171274995, 5.209080943384439, 5.510087313568085, 5.6335942358143605, 5.210324360307726, 5.6585991394896595, 5.585896689810943, 5.281560618261279, 5.536811623294293, 5.395098131329238, 5.564720795877841, 5.520581957085019, 5.471837593562626, 5.63897937812599, 5.607662512719106, 5.296207086960369, 5.558978522924081, 5.655103860413946, 5.591741923806362, 5.630726604468281, 5.246550095660407, 5.510807366229703, 5.2883023687963995, 5.512948600770502, 5.176554711983393, 5.53729978357091, 5.308016656043124, 5.3338691904162925, 5.431264981305099, 5.661429754364804], "episode_lengths": [93, 56, 55, 68, 61, 65, 72, 46, 58, 49, 90, 46, 52, 107, 50, 40, 71, 92, 45, 57, 88, 43, 119, 51, 103, 94, 63, 101, 67, 90, 59, 45, 59, 53, 64, 68, 47, 129, 129, 71, 67, 72, 113, 111, 57, 144, 64, 74, 44, 50, 43, 133, 47, 71, 125, 40, 65, 51, 67, 66, 70, 88, 40, 63, 90, 80, 62, 55, 49, 109, 54, 58, 72, 57, 87, 51, 87, 49, 60, 102, 72, 51, 71, 53, 54, 60, 53, 75, 53, 70, 49, 81, 69, 85, 85, 161, 66, 64, 43, 128, 91, 64, 50, 39, 135, 72, 121, 70, 85, 73, 62, 93, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2964712382061958, "mean_inference_ms": 1.6113506619708806, "mean_action_processing_ms": 0.15164596285157592, "mean_env_wait_ms": 2.9751721080488434, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1550448, "agent_timesteps_total": 1550448, "timers": {"sample_time_ms": 8043.235, "sample_throughput": 993.63, "load_time_ms": 3.757, "load_throughput": 2127391.194, "learn_time_ms": 8055.099, "learn_throughput": 992.167, "update_time_ms": 3.343}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.026403391733765602, "policy_loss": -0.01768496073782444, "vf_loss": 0.04078604280948639, "vf_explained_var": 0.8496863842010498, "kl": 0.01651155762374401, "entropy": 0.03125137463212013, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1550448, "num_agent_steps_sampled": 1550448, "num_steps_trained": 1550448, "num_agent_steps_trained": 1550448}, "done": false, "episodes_total": 18441, "training_iteration": 194, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-19-40", "timestamp": 1716405580, "time_this_iter_s": 21.108444929122925, "time_total_s": 2620.827575445175, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2620.827575445175, "timesteps_since_restore": 0, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 42.687096774193556, "ram_util_percent": 34.677419354838705}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.714846642381135, "episode_reward_min": 5.042084994283957, "episode_reward_mean": 5.419457842308232, "episode_len_mean": 69.03448275862068, "episode_media": {}, "episodes_this_iter": 116, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2384923250668536, "reward_component_totals/rejoin_dist_change_reward_min": 0.9160849942839573, "reward_component_totals/rejoin_dist_change_reward_max": 1.5138466423811356, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9309655172413789, "reward_component_totals/success_reward_min": 1.865, "reward_component_totals/success_reward_max": 1.963}, "hist_stats": {"episode_reward": [5.587492756354813, 5.482495725055881, 5.280467770386735, 5.551085312352647, 5.171157523349233, 5.450505180047099, 5.428539368380534, 5.67367677474527, 5.232880369884448, 5.324838866357768, 5.228837941823022, 5.323133656733326, 5.4170177874952365, 5.642367871743456, 5.478644762441212, 5.167347653359036, 5.184062063549524, 5.276430664285051, 5.500740950331023, 5.496399464487883, 5.422375507061178, 5.292772817006148, 5.38934404571885, 5.488935787708689, 5.042084994283957, 5.428252233230326, 5.310501998254166, 5.130407283241134, 5.564475988635263, 5.294045919146898, 5.59515507452698, 5.545588393704496, 5.610876931576285, 5.364008377018764, 5.437928355886904, 5.4459430751034414, 5.321831720334677, 5.441088151344964, 5.302093307945824, 5.580026655291203, 5.2057676997728155, 5.213641156360419, 5.493528620736505, 5.539957443473213, 5.6653060834119735, 5.281364030108504, 5.354379932472561, 5.434485157231743, 5.5871827459430605, 5.516011002182692, 5.574647303930074, 5.379458800421412, 5.4474671734808355, 5.181053746458302, 5.532986462272111, 5.668449540935734, 5.1752026073013075, 5.530818886859031, 5.368114055546729, 5.16838308787395, 5.543356105653015, 5.59780246180326, 5.560510402103025, 5.489800258657761, 5.4733099653279, 5.61688730723362, 5.404198961834104, 5.20678428743942, 5.271721478961515, 5.584459412881128, 5.559839302895991, 5.3023051840686435, 5.459823326724534, 5.403457607422494, 5.250829851966628, 5.467361700620164, 5.366746454284176, 5.163589303352963, 5.274726439032053, 5.478890612081993, 5.567210908555731, 5.186204094349722, 5.314332158552199, 5.597279178044728, 5.554075691153458, 5.466149803047768, 5.666955173664123, 5.4832516420815045, 5.350328517589856, 5.180832429827408, 5.521474116487107, 5.444107866995173, 5.404121139491458, 5.516070168489232, 5.186862387361862, 5.455144601185255, 5.649474845544821, 5.380818470404629, 5.5333081586026225, 5.383328310785463, 5.550163971573537, 5.2453477838271745, 5.534380018260126, 5.295568367476015, 5.127776143169418, 5.608892194954845, 5.415741054774445, 5.425379352144438, 5.497520050633744, 5.476328094759289, 5.561096642133698, 5.714846642381135, 5.507149679372244, 5.424416797501076, 5.263443812639448, 5.467264398639571], "episode_lengths": [93, 60, 108, 48, 37, 85, 45, 63, 43, 69, 74, 78, 51, 69, 50, 48, 66, 52, 57, 65, 78, 38, 40, 61, 124, 47, 61, 81, 135, 58, 78, 89, 73, 69, 49, 61, 37, 45, 62, 53, 105, 71, 82, 69, 58, 106, 86, 94, 91, 66, 93, 107, 40, 47, 64, 77, 38, 106, 86, 55, 124, 59, 77, 131, 67, 50, 59, 39, 63, 44, 69, 71, 102, 119, 40, 101, 63, 38, 97, 62, 70, 68, 47, 102, 54, 54, 53, 60, 56, 59, 79, 82, 74, 76, 55, 65, 68, 85, 84, 90, 59, 71, 83, 65, 87, 55, 64, 56, 61, 85, 65, 49, 61, 50, 47, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2987969442240755, "mean_inference_ms": 1.6167603949484624, "mean_action_processing_ms": 0.15219512716556477, "mean_env_wait_ms": 2.9847546611606917, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1558440, "agent_timesteps_total": 1558440, "timers": {"sample_time_ms": 8503.036, "sample_throughput": 939.9, "load_time_ms": 3.943, "load_throughput": 2027096.44, "learn_time_ms": 8892.216, "learn_throughput": 898.764, "update_time_ms": 3.596}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.028249140828847885, "policy_loss": -0.01547381840646267, "vf_loss": 0.04065390303730965, "vf_explained_var": 0.8428053855895996, "kl": 0.015345289371907711, "entropy": -0.005850487854331732, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1558440, "num_agent_steps_sampled": 1558440, "num_steps_trained": 1558440, "num_agent_steps_trained": 1558440}, "done": false, "episodes_total": 18557, "training_iteration": 195, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-20-06", "timestamp": 1716405606, "time_this_iter_s": 26.480411767959595, "time_total_s": 2647.3079872131348, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2647.3079872131348, "timesteps_since_restore": 0, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 53.7972972972973, "ram_util_percent": 35.00810810810811}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.670078576699481, "episode_reward_min": -0.03624773467066755, "episode_reward_mean": 5.390215797565523, "episode_len_mean": 70.97321428571429, "episode_media": {}, "episodes_this_iter": 112, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 0.9910714285714286, "outcome/success_min": 0, "outcome/success_max": 1, "outcome/failure_mean": 0.008928571428571428, "outcome/failure_min": 0, "outcome/failure_max": 1, "reward_component_totals/rejoin_reward_mean": 1.9821428571428574, "reward_component_totals/rejoin_reward_min": 0.0, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.24776785714285715, "reward_component_totals/rejoin_first_time_reward_min": 0.0, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.257974726136952, "reward_component_totals/rejoin_dist_change_reward_min": 0.9637522653293324, "reward_component_totals/rejoin_dist_change_reward_max": 1.4856239716395636, "reward_component_totals/failure_reward_mean": -0.008928571428571428, "reward_component_totals/failure_reward_min": -1, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9112589285714285, "reward_component_totals/success_reward_min": 0.0, "reward_component_totals/success_reward_max": 1.9609999999999999, "failure_code_ratio/crash_mean": 1.0, "failure_code_ratio/crash_min": 1, "failure_code_ratio/crash_max": 1, "failure_code_ratio/distance_mean": 0.0, "failure_code_ratio/distance_min": 0, "failure_code_ratio/distance_max": 0, "failure_code_ratio/timeout_mean": 0.0, "failure_code_ratio/timeout_min": 0, "failure_code_ratio/timeout_max": 0, "failure_code_ratio/leave_rejoin_mean": 0.0, "failure_code_ratio/leave_rejoin_min": 0, "failure_code_ratio/leave_rejoin_max": 0}, "hist_stats": {"episode_reward": [5.670078576699481, 5.21571747500038, 5.603866017527368, 5.218302242144192, 5.570604685829016, 5.651539423937791, 5.605486180280861, 5.50480896276666, 5.4313140563179285, 5.313080280624893, 5.20170186596897, 5.571800927129393, 5.152414103440566, 5.3078671465727485, 5.625626635574928, 5.41065019250786, 5.526116043568313, 5.173595648520311, 5.527922725568716, 5.312853885506787, 5.225523513050788, 5.398612657616855, 5.279207542647622, 5.35540823849257, 5.586820093414449, 5.4408707261495, 5.486506285914527, 5.353570134494166, 5.265304199936182, 5.5628950015520235, 5.202783058362403, 5.361180031293803, 5.190284973098695, 5.471494842141604, 5.52995918593237, 5.59198882728808, 5.655107733050329, 5.509642529764067, 5.593653369353502, 5.271522430711176, 5.562075747007673, -0.03624773467066755, 5.369912242566226, 5.552572867732364, 5.648808926865124, 5.242235898187303, 5.499097776199949, 5.45855327973138, 5.4271494361342185, 5.468292818814783, 5.574651196802021, 5.563128147618635, 5.499388338860223, 5.586335096584239, 5.475704868684796, 5.479614555959323, 5.494189135894409, 5.4857010811209035, 5.215102422873876, 5.292658815360959, 5.5708338790160274, 5.132785953008041, 5.6416239716395635, 5.184890747735114, 5.617928385521342, 5.351267601233939, 5.261781850719752, 5.505245098642666, 5.258856887397467, 5.54876882545037, 5.4744435105123905, 5.487539988830791, 5.579242491884596, 5.622779569591348, 5.416792252209582, 5.582639695599653, 5.1903775474576515, 5.255532738907349, 5.262117229893189, 5.522534496395528, 5.173640702790804, 5.299609838974375, 5.641636251212522, 5.648773232393374, 5.562739411571159, 5.295705728897679, 5.295129324285073, 5.642211218442566, 5.492199655984326, 5.278672830643368, 5.601578775908385, 5.493129599100575, 5.4833958160906775, 5.310439389622234, 5.6394809704410935, 5.300412313929608, 5.404994743022015, 5.585597496087484, 5.552775196666476, 5.552671574866571, 5.285199838750429, 5.609229814497869, 5.279002399569499, 5.599855641497388, 5.371483530845312, 5.3577004272910935, 5.405606222180015, 5.660133451690111, 5.47125053577056, 5.460193005371579, 5.379190088746568, 5.31594021047185], "episode_lengths": [65, 45, 66, 71, 85, 56, 89, 97, 61, 72, 85, 68, 82, 41, 58, 92, 77, 96, 124, 39, 52, 75, 89, 44, 78, 72, 72, 42, 49, 55, 75, 60, 55, 53, 61, 65, 56, 54, 73, 75, 68, 10, 53, 49, 55, 90, 99, 83, 45, 85, 48, 47, 62, 122, 42, 46, 45, 77, 98, 68, 69, 92, 94, 89, 106, 93, 66, 89, 63, 80, 145, 53, 99, 69, 74, 79, 63, 68, 83, 57, 73, 85, 63, 74, 60, 62, 106, 61, 46, 55, 74, 63, 123, 70, 80, 87, 90, 96, 80, 53, 90, 66, 44, 54, 90, 66, 68, 53, 49, 83, 52, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2968642250341042, "mean_inference_ms": 1.6199922002764413, "mean_action_processing_ms": 0.15248778520218792, "mean_env_wait_ms": 2.99271990768262, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1566432, "agent_timesteps_total": 1566432, "timers": {"sample_time_ms": 8851.774, "sample_throughput": 902.87, "load_time_ms": 4.021, "load_throughput": 1987576.641, "learn_time_ms": 9465.186, "learn_throughput": 844.357, "update_time_ms": 3.689}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03776339069008827, "policy_loss": -0.010687648318707943, "vf_loss": 0.04437633976340294, "vf_explained_var": 0.8345285058021545, "kl": 0.020373500883579254, "entropy": -0.016805721446871758, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1566432, "num_agent_steps_sampled": 1566432, "num_steps_trained": 1566432, "num_agent_steps_trained": 1566432}, "done": false, "episodes_total": 18669, "training_iteration": 196, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-20-30", "timestamp": 1716405630, "time_this_iter_s": 23.094495058059692, "time_total_s": 2670.4024822711945, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2670.4024822711945, "timesteps_since_restore": 0, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 44.27272727272727, "ram_util_percent": 35.13333333333333}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.710835776441092, "episode_reward_min": 5.133272607897869, "episode_reward_mean": 5.438231025573037, "episode_len_mean": 72.1981981981982, "episode_media": {}, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2604292237712351, "reward_component_totals/rejoin_dist_change_reward_min": 0.9331853782805457, "reward_component_totals/rejoin_dist_change_reward_max": 1.5098357764410932, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9278018018018017, "reward_component_totals/success_reward_min": 1.858, "reward_component_totals/success_reward_max": 1.959}, "hist_stats": {"episode_reward": [5.167046045939868, 5.449604452007641, 5.6248292409562115, 5.334327146165412, 5.366179656240622, 5.496273658545784, 5.386048777181594, 5.452531466500432, 5.511673690550559, 5.27219191925005, 5.5515737697298295, 5.465072835145839, 5.602767652038354, 5.254598052502553, 5.538678965732071, 5.4484961881467, 5.423331491342388, 5.425450293728254, 5.366927041008525, 5.5947109353277895, 5.612192730213637, 5.407737855700301, 5.385712877018534, 5.615272471776193, 5.620297686804301, 5.432833053969221, 5.515874312438035, 5.583622849386966, 5.405360157022299, 5.662748784363433, 5.574764650057272, 5.57293125346192, 5.605811241833804, 5.454773500213732, 5.333370111941271, 5.236045947457022, 5.595312237206028, 5.471173272216195, 5.407139813725324, 5.339915307438636, 5.535649007311545, 5.579332245594157, 5.491680134680431, 5.467593896253577, 5.479106282675324, 5.261761514641557, 5.485101998488375, 5.31356562803706, 5.1381853782805464, 5.556557971732622, 5.297181041317598, 5.69830053596821, 5.133272607897869, 5.442017999158036, 5.3190000774000366, 5.2368127003334966, 5.27479595540904, 5.416655774493851, 5.493488609898344, 5.236180219620236, 5.16871867173185, 5.286574124766306, 5.499899092267349, 5.405721221559848, 5.6281048028181235, 5.5724575983032825, 5.512118262216591, 5.5027426375906785, 5.673186956448186, 5.309137422875419, 5.388629363128198, 5.433526135614873, 5.457571417115009, 5.300666552705428, 5.453643019794436, 5.487422284133768, 5.283743270164463, 5.642251977607755, 5.499624385179967, 5.572664190766353, 5.55105037615414, 5.195037449629702, 5.325378830306385, 5.456511938243578, 5.5670960113159715, 5.632145544529224, 5.424640483001175, 5.533261611165924, 5.259494901438259, 5.318347931883499, 5.196177734997116, 5.405636199151788, 5.2511318103979985, 5.710835776441092, 5.589991994525657, 5.55368593959726, 5.1976728310715625, 5.454861770787762, 5.333786313273919, 5.333411201314624, 5.520997095458982, 5.29900043410127, 5.616381997955663, 5.590549320842946, 5.344980876868501, 5.4645392520077065, 5.266048859420453, 5.52951567290636, 5.406696342220274, 5.410610966280739, 5.404320013053232], "episode_lengths": [57, 52, 54, 54, 70, 125, 43, 66, 44, 44, 100, 125, 80, 73, 51, 61, 59, 78, 52, 83, 53, 73, 41, 49, 79, 66, 53, 83, 78, 56, 50, 113, 81, 110, 50, 83, 59, 77, 77, 109, 103, 59, 64, 50, 92, 84, 99, 97, 45, 72, 80, 60, 51, 58, 64, 49, 58, 99, 67, 142, 100, 41, 110, 72, 91, 73, 83, 48, 73, 91, 71, 46, 93, 42, 84, 90, 55, 85, 43, 57, 90, 61, 44, 62, 93, 77, 49, 104, 81, 55, 72, 114, 81, 49, 93, 76, 75, 48, 54, 54, 59, 50, 114, 125, 45, 75, 52, 55, 67, 98, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29858255467855516, "mean_inference_ms": 1.619356918302088, "mean_action_processing_ms": 0.1524200361225975, "mean_env_wait_ms": 2.9900340695959673, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1574424, "agent_timesteps_total": 1574424, "timers": {"sample_time_ms": 8676.522, "sample_throughput": 921.106, "load_time_ms": 4.009, "load_throughput": 1993415.572, "learn_time_ms": 9538.062, "learn_throughput": 837.906, "update_time_ms": 3.773}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03130321949720383, "policy_loss": -0.016258085146546364, "vf_loss": 0.04328589141368866, "vf_explained_var": 0.834722101688385, "kl": 0.01425140630453825, "entropy": -0.015110773965716362, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1574424, "num_agent_steps_sampled": 1574424, "num_steps_trained": 1574424, "num_agent_steps_trained": 1574424}, "done": false, "episodes_total": 18780, "training_iteration": 197, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-20-43", "timestamp": 1716405643, "time_this_iter_s": 12.89150333404541, "time_total_s": 2683.29398560524, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2683.29398560524, "timesteps_since_restore": 0, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 36.226315789473674, "ram_util_percent": 34.64736842105264}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.675680204638995, "episode_reward_min": 5.102662209497805, "episode_reward_mean": 5.414785858297353, "episode_len_mean": 75.07619047619048, "episode_media": {}, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2398620487735441, "reward_component_totals/rejoin_dist_change_reward_min": 0.9222111723349105, "reward_component_totals/rejoin_dist_change_reward_max": 1.5106802046389955, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9249238095238095, "reward_component_totals/success_reward_min": 1.8599999999999999, "reward_component_totals/success_reward_max": 1.9609999999999999}, "hist_stats": {"episode_reward": [5.235944236529734, 5.478510652201942, 5.279095583791699, 5.548721361667715, 5.385908433818275, 5.217650801120913, 5.49327675067425, 5.326908837907791, 5.271459760882344, 5.102662209497805, 5.5824442131277445, 5.485352127271929, 5.649617794297744, 5.296615540911148, 5.634593523180005, 5.435751247221291, 5.452682233015592, 5.34082995073541, 5.384780017527604, 5.3650645949953955, 5.265353238000618, 5.675680204638995, 5.314292880675518, 5.536586020333907, 5.565486894127005, 5.178646728182557, 5.444190537219441, 5.347728786771247, 5.517271995410068, 5.39934494035177, 5.635368968653037, 5.31455772008983, 5.675065145048016, 5.2761765035299915, 5.5634528345989676, 5.556264816542415, 5.321223917799889, 5.534538768029332, 5.58330399140395, 5.528490019603224, 5.2714021154109085, 5.471216619400911, 5.581753734856584, 5.432125684251345, 5.5092044458396074, 5.149915095601921, 5.273200467918302, 5.358751473804847, 5.5799490944763726, 5.394431755565082, 5.5095713657703875, 5.569390940032849, 5.544338483858475, 5.408769723049299, 5.29436150035411, 5.188819393866906, 5.27669840275818, 5.259792870517376, 5.660290484080429, 5.483317718063876, 5.332759301771883, 5.3897363955911235, 5.371407832910335, 5.508061201705036, 5.304414686073496, 5.605720279853501, 5.382252083465564, 5.307443254221991, 5.333363268673752, 5.195728895333687, 5.515005719997734, 5.390478250272961, 5.483146739515027, 5.1764104949514556, 5.324046437352841, 5.446612212052866, 5.657010620205648, 5.431853770156824, 5.313558341375262, 5.536073911950044, 5.22338807067657, 5.470540084760557, 5.638190483363224, 5.658455908875789, 5.356203485681688, 5.118211172334911, 5.314074584829611, 5.368086476263104, 5.429093773581574, 5.363829506497673, 5.170632556562377, 5.595660968609944, 5.266483100418245, 5.531574899502536, 5.398263126169425, 5.29900012998385, 5.607538763268172, 5.491341344166484, 5.181862677856152, 5.576136646255938, 5.321928808715195, 5.664510542107313, 5.272955511000155, 5.623097446824717, 5.188175204622026], "episode_lengths": [91, 74, 54, 77, 48, 55, 70, 68, 65, 107, 85, 70, 60, 71, 55, 58, 113, 48, 57, 77, 73, 85, 61, 111, 91, 72, 89, 59, 49, 52, 58, 109, 51, 39, 96, 62, 100, 81, 80, 52, 50, 59, 104, 51, 80, 121, 61, 80, 76, 47, 107, 110, 82, 110, 133, 75, 47, 66, 50, 140, 56, 51, 51, 52, 110, 85, 98, 47, 53, 84, 89, 94, 118, 71, 67, 51, 60, 78, 111, 100, 69, 100, 58, 53, 47, 54, 76, 67, 115, 53, 62, 95, 121, 123, 75, 48, 101, 48, 57, 93, 55, 60, 74, 77, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29826309888817254, "mean_inference_ms": 1.6227740635336874, "mean_action_processing_ms": 0.1526848333347902, "mean_env_wait_ms": 2.9949772815940006, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1582416, "agent_timesteps_total": 1582416, "timers": {"sample_time_ms": 8744.334, "sample_throughput": 913.963, "load_time_ms": 3.909, "load_throughput": 2044442.128, "learn_time_ms": 8792.387, "learn_throughput": 908.968, "update_time_ms": 3.806}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03179141506552696, "policy_loss": -0.008011258207261562, "vf_loss": 0.0353892482817173, "vf_explained_var": 0.8594915270805359, "kl": 0.014711461961269379, "entropy": 0.01705896109342575, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1582416, "num_agent_steps_sampled": 1582416, "num_steps_trained": 1582416, "num_agent_steps_trained": 1582416}, "done": false, "episodes_total": 18885, "training_iteration": 198, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-20-58", "timestamp": 1716405658, "time_this_iter_s": 15.639275550842285, "time_total_s": 2698.933261156082, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2698.933261156082, "timesteps_since_restore": 0, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 41.60454545454546, "ram_util_percent": 34.845454545454544}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.682490265491732, "episode_reward_min": 5.07363263227773, "episode_reward_mean": 5.430851018731663, "episode_len_mean": 73.68807339449542, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2545390921261566, "reward_component_totals/rejoin_dist_change_reward_min": 0.9326326322777296, "reward_component_totals/rejoin_dist_change_reward_max": 1.5010367739165744, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9263119266055047, "reward_component_totals/success_reward_min": 1.8399999999999999, "reward_component_totals/success_reward_max": 1.96}, "hist_stats": {"episode_reward": [5.279474406048319, 5.35884410492722, 5.2553660121178885, 5.25957166239778, 5.32193000942646, 5.4302808959739055, 5.5062342046952, 5.570772323043338, 5.372294327824621, 5.516295353739242, 5.165936176991302, 5.563104354801105, 5.578051275089225, 5.281110571005721, 5.1850589859893805, 5.5979392540491, 5.3799574998348, 5.407989266702106, 5.186082973708617, 5.404436598083965, 5.439045038127112, 5.622239405279105, 5.4025920790619555, 5.542779901002571, 5.583888795809553, 5.250775169078619, 5.07363263227773, 5.454391172618808, 5.557551927806438, 5.236750378963116, 5.42377839980889, 5.2381185912728, 5.510923394296892, 5.324505118665906, 5.53770713570339, 5.387753881413461, 5.39263399853973, 5.458593542447282, 5.536756271716958, 5.536354223430612, 5.560866170357837, 5.6330220257584855, 5.480777711404203, 5.5902574599627375, 5.266384436845598, 5.511265600894783, 5.413474919380394, 5.27034134223535, 5.563171650493652, 5.591004483450392, 5.480569773184486, 5.448821688907948, 5.533812052293078, 5.319130061755517, 5.677036773916575, 5.326907276790946, 5.525858819040918, 5.297574825063431, 5.2175984466762095, 5.543988847699506, 5.494117543955145, 5.299662022796355, 5.372661385222293, 5.441478024846354, 5.540934770522573, 5.3674016064465935, 5.393760707315387, 5.240133136270126, 5.605466579011013, 5.510805189268398, 5.5895335185792145, 5.498517877329444, 5.618838226593459, 5.300704992083686, 5.435127750753267, 5.663881797587715, 5.287466881024299, 5.508427881644625, 5.3271231530459815, 5.54084490132315, 5.285698290670812, 5.486111140766917, 5.522129943524625, 5.543687801992151, 5.572785180569049, 5.450930599658311, 5.507415110963178, 5.295879413801744, 5.428645853357781, 5.21389768746468, 5.3658605526661365, 5.5417173419087575, 5.406839069892083, 5.511105964839876, 5.342861189407568, 5.409373098914358, 5.526361150505425, 5.128171020601861, 5.43366064987314, 5.205492666145327, 5.281934866127037, 5.560401797843829, 5.369979309704, 5.667522417716521, 5.620707626905945, 5.218325883866294, 5.538968959824047, 5.423552561246526, 5.682490265491732], "episode_lengths": [82, 71, 68, 90, 89, 100, 71, 43, 90, 52, 92, 89, 124, 54, 64, 56, 143, 52, 66, 65, 74, 83, 76, 160, 60, 63, 109, 75, 52, 48, 60, 64, 86, 74, 78, 69, 99, 65, 61, 89, 78, 47, 60, 63, 71, 54, 49, 82, 56, 102, 101, 62, 97, 107, 74, 57, 65, 86, 63, 52, 66, 91, 95, 56, 56, 43, 70, 66, 88, 93, 86, 122, 54, 78, 47, 66, 81, 56, 46, 71, 48, 43, 66, 55, 97, 65, 92, 64, 104, 40, 70, 76, 60, 86, 48, 56, 50, 96, 129, 44, 112, 45, 66, 57, 63, 89, 92, 99, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29742381291371184, "mean_inference_ms": 1.626509524249235, "mean_action_processing_ms": 0.15302754206239716, "mean_env_wait_ms": 3.001316493458352, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1590408, "agent_timesteps_total": 1590408, "timers": {"sample_time_ms": 8742.194, "sample_throughput": 914.187, "load_time_ms": 3.95, "load_throughput": 2023352.301, "learn_time_ms": 9387.002, "learn_throughput": 851.39, "update_time_ms": 3.835}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03632267192006111, "policy_loss": -0.008172881789505482, "vf_loss": 0.03912778198719025, "vf_explained_var": 0.8499892354011536, "kl": 0.01789255440235138, "entropy": -0.020295271649956703, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1590408, "num_agent_steps_sampled": 1590408, "num_steps_trained": 1590408, "num_agent_steps_trained": 1590408}, "done": false, "episodes_total": 18994, "training_iteration": 199, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-21-21", "timestamp": 1716405681, "time_this_iter_s": 22.97544240951538, "time_total_s": 2721.9087035655975, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2721.9087035655975, "timesteps_since_restore": 0, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 48.827272727272735, "ram_util_percent": 35.018181818181816}, "trial_id": "15bc3_00000"}
{"episode_reward_max": 5.710027869970504, "episode_reward_min": 5.116062830869909, "episode_reward_mean": 5.452209489809901, "episode_len_mean": 71.02678571428571, "episode_media": {}, "episodes_this_iter": 112, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"outcome/success_mean": 1.0, "outcome/success_min": 1, "outcome/success_max": 1, "outcome/failure_mean": 0.0, "outcome/failure_min": 0, "outcome/failure_max": 0, "reward_component_totals/rejoin_reward_mean": 2.0000000000000004, "reward_component_totals/rejoin_reward_min": 2.0000000000000004, "reward_component_totals/rejoin_reward_max": 2.0000000000000004, "reward_component_totals/rejoin_first_time_reward_mean": 0.25, "reward_component_totals/rejoin_first_time_reward_min": 0.25, "reward_component_totals/rejoin_first_time_reward_max": 0.25, "reward_component_totals/rejoin_dist_change_reward_mean": 1.2732362755241862, "reward_component_totals/rejoin_dist_change_reward_min": 0.9430628308699089, "reward_component_totals/rejoin_dist_change_reward_max": 1.5111898160873534, "reward_component_totals/failure_reward_mean": 0.0, "reward_component_totals/failure_reward_min": 0, "reward_component_totals/failure_reward_max": 0, "reward_component_totals/success_reward_mean": 1.9289732142857143, "reward_component_totals/success_reward_min": 1.871, "reward_component_totals/success_reward_max": 1.963}, "hist_stats": {"episode_reward": [5.501840122396919, 5.449217570910556, 5.17584977892999, 5.477805603958597, 5.596841552265695, 5.5058508723166035, 5.466632007062685, 5.390795306304119, 5.6812923444119905, 5.428708116386714, 5.6072797466053235, 5.587142198508269, 5.340023717697663, 5.513495273829164, 5.491402599113319, 5.393852832370186, 5.5943165989385815, 5.644790917800016, 5.415407480756116, 5.451020324801214, 5.318114220374866, 5.33265204653809, 5.566320571713841, 5.3520754727778606, 5.483965920522989, 5.528350781492003, 5.389014349752501, 5.547600264834738, 5.406450456289621, 5.315410766866733, 5.612472773768151, 5.417105520996348, 5.547961921242056, 5.49593975637371, 5.508032622189059, 5.205493191645049, 5.648082960327494, 5.56121674397872, 5.202776122632928, 5.363492107248493, 5.2545874743807985, 5.284397721388447, 5.231527910540011, 5.626151714658405, 5.513315168037012, 5.116062830869909, 5.33331532188234, 5.629762473879568, 5.358637728624485, 5.60782414164389, 5.474320736590114, 5.710027869970504, 5.422952857339757, 5.280361460491337, 5.240755802920578, 5.652601657439745, 5.575638577613363, 5.483760425561863, 5.3091342624340845, 5.241768956422625, 5.5505882532524815, 5.262014258682603, 5.506480600954851, 5.512487190218354, 5.698386086478436, 5.675162116925085, 5.347524326712557, 5.656874760979448, 5.517096609119208, 5.425728845353844, 5.400484179518417, 5.425094805365779, 5.488210294645199, 5.369963349593249, 5.343171206011808, 5.2971259408998925, 5.553216843186979, 5.4290451013634105, 5.209726743917128, 5.656193310929518, 5.5980061573752815, 5.289239477356712, 5.3856666255693355, 5.300604674182187, 5.19411876679343, 5.680765317705044, 5.568997225990387, 5.653994022118109, 5.6023460331404475, 5.246693769602876, 5.6372114290153466, 5.521710402910292, 5.2074867433239085, 5.581951849506256, 5.3790751557795495, 5.3526373465819415, 5.524241581979099, 5.337993577762521, 5.266162000338171, 5.528438305196749, 5.117500454340654, 5.465510633958246, 5.493127571862726, 5.544584125695884, 5.458447371458062, 5.592264776465871, 5.3022474967332975, 5.36762630423064, 5.642123517289267, 5.684189816087352, 5.607247253292343, 5.327679621340854], "episode_lengths": [102, 65, 74, 77, 64, 53, 65, 70, 79, 88, 53, 82, 70, 125, 71, 43, 81, 73, 52, 84, 45, 63, 82, 62, 51, 48, 66, 56, 64, 58, 94, 76, 78, 59, 98, 80, 56, 71, 37, 69, 56, 75, 47, 60, 129, 77, 62, 77, 83, 65, 47, 48, 114, 55, 87, 53, 129, 59, 46, 69, 79, 57, 115, 45, 56, 60, 69, 52, 61, 126, 119, 59, 75, 76, 71, 75, 94, 65, 45, 57, 84, 106, 86, 62, 84, 57, 113, 58, 79, 66, 73, 49, 57, 52, 63, 57, 106, 68, 57, 112, 92, 75, 45, 70, 60, 51, 47, 55, 52, 77, 86, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2981332911850058, "mean_inference_ms": 1.6271401154473253, "mean_action_processing_ms": 0.1531556060507238, "mean_env_wait_ms": 3.003046276347727, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 6, "timesteps_total": 1598400, "agent_timesteps_total": 1598400, "timers": {"sample_time_ms": 8834.877, "sample_throughput": 904.597, "load_time_ms": 3.906, "load_throughput": 2046114.35, "learn_time_ms": 9679.515, "learn_throughput": 825.661, "update_time_ms": 3.949}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03645594045519829, "policy_loss": -0.012495341710746288, "vf_loss": 0.04528709873557091, "vf_explained_var": 0.8192041516304016, "kl": 0.012213939800858498, "entropy": -0.04709174484014511, "entropy_coeff": 0.0, "model": {}}}}, "num_steps_sampled": 1598400, "num_agent_steps_sampled": 1598400, "num_steps_trained": 1598400, "num_agent_steps_trained": 1598400}, "done": true, "episodes_total": 19106, "training_iteration": 200, "experiment_id": "afc25ac115254a3eb19165251283b7c7", "date": "2024-05-22_15-21-39", "timestamp": 1716405699, "time_this_iter_s": 17.311054229736328, "time_total_s": 2739.219757795334, "pid": 38153, "hostname": "stan-ThinkPad-P1-Gen-4i", "node_ip": "10.143.199.169", "config": {"num_workers": 6, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 666, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "DubinsRejoin", "observation_space": null, "action_space": null, "env_config": {"agent": "wingman", "step_size": 1, "env_objs": [{"name": "lead", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>", "heading": [0, 6.283185307179586], "v": [250, 300], "x": [5000, 10000], "y": [5000, 10000]}}}, {"name": "wingman", "class": "<class 'saferl.aerospace.models.dubins.platforms.Dubins2dPlatform'>", "config": {"v_min": 200, "v_max": 400, "integration_method": "RK45", "controller": {"class": "<class 'saferl.environment.models.platforms.AgentController'>", "actuators": [{"name": "rudder", "space": "continuous", "rescale": true, "bounds": [-0.174533, 0.174533]}, {"name": "throttle", "space": "continuous", "rescale": true, "bounds": [-96.5, 96.5]}]}, "init": {"initializer": "<class 'saferl.aerospace.tasks.rejoin.initializers.WingmanPolarInitializer'>", "heading": [0, 6.283185307179586], "v": [200, 400], "ref": "lead", "radius": [5000, 10000], "angle": [0, 6.283185307179586]}}}, {"name": "rejoin_region", "class": "<class 'saferl.environment.models.geometry.RelativeCircle'>", "config": {"ref": "lead", "aspect_angle": 60, "r_offset": 500, "radius": 150, "track_orientation": true, "init": {"initializer": "<class 'saferl.environment.tasks.initializers.RandBoundsInitializer'>"}}}], "observation": [{"name": "observation_processor", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsObservationProcessor'>", "config": {"lead": "lead", "mode": "magnorm", "reference": "wingman", "rejoin_region": "rejoin_region", "wingman": "wingman"}}], "reward": [{"name": "rejoin_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinRewardProcessor'>", "config": {"rejoin_prev_status": "in_rejoin_prev", "rejoin_status": "in_rejoin", "reward": 0.1, "refund": true}}, {"name": "rejoin_first_time_reward", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.RejoinFirstTimeRewardProcessor'>", "config": {"rejoin_status": "in_rejoin", "reward": 0.25}}, {"name": "rejoin_dist_change_reward", "class": "<class 'saferl.environment.tasks.processor.reward.DistanceExponentialChangeRewardProcessor'>", "config": {"agent": "wingman", "target": "rejoin_region", "pivot": 5000}}, {"name": "failure_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.FailureRewardProcessor'>", "config": {"failure_status": "failure", "reward": {"crash": -1, "distance": -1, "timeout": -1, "leave_rejoin": 0}}}, {"name": "success_reward", "class": "<class 'saferl.aerospace.tasks.docking.processors.SuccessRewardProcessor'>", "config": {"reward": 1, "success_status": "success", "timeout": 1000}}], "status": [{"name": "in_rejoin", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoin'>", "config": {"rejoin_region": "rejoin_region", "wingman": "wingman"}}, {"name": "in_rejoin_prev", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsInRejoinPrev'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "rejoin_time", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsRejoinTime'>", "config": {"rejoin_status": "in_rejoin"}}, {"name": "time_elapsed", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsTimeElapsed'>", "config": {}}, {"name": "lead_distance", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsLeadDistance'>", "config": {"lead": "lead", "wingman": "wingman"}}, {"name": "failure", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsFailureStatus'>", "config": {"lead_distance": "lead_distance", "max_goal_distance": 40000, "safety_margin": {"aircraft": 100}, "time_elapsed": "time_elapsed", "timeout": 1000, "on_leave_rejoin": false}}, {"name": "success", "class": "<class 'saferl.aerospace.tasks.rejoin.processors.DubinsSuccessStatus'>", "config": {"rejoin_time": "rejoin_time", "success_time": 20}}], "verbose": false}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": false, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'saferl.environment.callbacks.build_callbacks_caller.<locals>.CallbacksCaller'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": 0, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2739.219757795334, "timesteps_since_restore": 0, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 44.104, "ram_util_percent": 34.9}, "trial_id": "15bc3_00000"}
